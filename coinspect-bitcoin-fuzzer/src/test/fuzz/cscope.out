cscope 15 /volume/IOV/btc-node/bitcoin/src/test/fuzz               0000518627
	@FuzzedDataProvider.h

13 #iâdeà
LLVM_FUZZER_FUZZED_DATA_PROVIDER_H_


14 
	#LLVM_FUZZER_FUZZED_DATA_PROVIDER_H_


	)

16 
	~<®gÜ™hm
>

17 
	~<¬¿y
>

18 
	~<şim™s
>

19 
	~<c¡ddef
>

20 
	~<c¡dšt
>

21 
	~<c¡ršg
>

22 
	~<š™Ÿliz”_li¡
>

23 
	~<lim™s
>

24 
	~<¡ršg
>

25 
	~<ty³_Œa™s
>

26 
	~<ut™y
>

27 
	~<veùÜ
>

31 şas 
	cFuzzedD©aProvid”
 {

32 
	mpublic
:

35 
	$FuzzedD©aProvid”
(cÚ¡ 
ušt8_t
 *
d©a
, 
size_t
 
size
)

36 : 
	`d©a_±r_
(
d©a
), 
	$»maššg_by‹s_
(
size
) {}

37 ~
	`FuzzedD©aProvid”
() = ;

46 
‹m¶©e
 <
ty³Çme
 
T
> 
¡d
::
veùÜ
<T> 
	`CÚsumeBy‹s
(
size_t
 
num_by‹s
);

47 
‹m¶©e
 <
ty³Çme
 
T
>

48 
¡d
::
veùÜ
<
T
> 
	`CÚsumeBy‹sW™hT”mš©Ü
(
size_t
 
num_by‹s
, T 
‹rmš©Ü
 = 0);

49 
‹m¶©e
 <
ty³Çme
 
T
> 
¡d
::
veùÜ
<T> 
	`CÚsumeRemaššgBy‹s
();

53 
¡d
::
¡ršg
 
	`CÚsumeBy‹sAsSŒšg
(
size_t
 
num_by‹s
);

54 
¡d
::
¡ršg
 
	`CÚsumeRªdomL’gthSŒšg
(
size_t
 
max_Ëngth
);

55 
¡d
::
¡ršg
 
	`CÚsumeRªdomL’gthSŒšg
();

56 
¡d
::
¡ršg
 
	`CÚsumeRemaššgBy‹sAsSŒšg
();

59 
‹m¶©e
 <
ty³Çme
 
T
> T 
	`CÚsumeIÁeg¿l
();

60 
‹m¶©e
 <
ty³Çme
 
T
> T 
	`CÚsumeIÁeg¿lInRªge
(T 
mš
, T 
max
);

63 
‹m¶©e
 <
ty³Çme
 
T
> T 
	`CÚsumeFlßtšgPošt
();

64 
‹m¶©e
 <
ty³Çme
 
T
> T 
	`CÚsumeFlßtšgPoštInRªge
(T 
mš
, T 
max
);

67 
‹m¶©e
 <
ty³Çme
 
T
> T 
	`CÚsumeProbab™y
();

69 
boŞ
 
	`CÚsumeBoŞ
();

72 
‹m¶©e
 <
ty³Çme
 
T
> T 
	`CÚsumeEnum
();

75 
‹m¶©e
 <
ty³Çme
 
T
, 
size_t
 
size
> T 
	`PickV®ueInA¼ay
(cÚ¡ 
	`T
 (&
¬¿y
)[size]);

76 
‹m¶©e
 <
ty³Çme
 
T
, 
size_t
 
size
>

77 
T
 
	`PickV®ueInA¼ay
(cÚ¡ 
¡d
::
¬¿y
<T, 
size
> &array);

78 
‹m¶©e
 <
ty³Çme
 
T
> T 
	`PickV®ueInA¼ay
(
¡d
::
š™Ÿliz”_li¡
<cÚ¡ T> 
li¡
);

81 
size_t
 
	`CÚsumeD©a
(*
de¡š©iÚ
, size_ˆ
num_by‹s
);

84 
size_t
 
	$»maššg_by‹s
(è{  
»maššg_by‹s_
; 
	}
}

86 
	g´iv©e
:

87 
FuzzedD©aProvid”
(cÚ¡ FuzzedD©aProvid” &èğ
d–‘e
;

88 
	gFuzzedD©aProvid”
 &
	gİ”©Ü
=(cÚ¡ 
FuzzedD©aProvid”
 &èğ
d–‘e
;

90 
CİyAndAdvªû
(*
de¡š©iÚ
, 
size_t
 
num_by‹s
);

92 
Advªû
(
size_t
 
num_by‹s
);

94 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

95 
	g¡d
::
veùÜ
<
T
> 
CÚsumeBy‹s
(
size_t
 
size
, size_ˆ
num_by‹s
);

97 
	g‹m¶©e
 <
ty³Çme
 
	gTS
,y³Çm
	gTU
> 
TS
 
CÚv”tUnsigÃdToSigÃd
(
TU
 
v®ue
);

99 cÚ¡ 
ušt8_t
 *
	gd©a_±r_
;

100 
size_t
 
	g»maššg_by‹s_
;

107 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

108 
	g¡d
::
veùÜ
<
T
> 
FuzzedD©aProvid”
::
	$CÚsumeBy‹s
(
size_t
 
num_by‹s
) {

109 
num_by‹s
 = 
¡d
::
	`mš
Òum_by‹s, 
»maššg_by‹s_
);

110  
CÚsumeBy‹s
<
T
>(
num_by‹s
,‚um_bytes);

111 
	}
}

117 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

118 
	g¡d
::
veùÜ
<
T
> 
FuzzedD©aProvid”
::
	$CÚsumeBy‹sW™hT”mš©Ü
(
size_t
 
num_by‹s
,

119 
T
 
‹rmš©Ü
) {

120 
num_by‹s
 = 
¡d
::
	`mš
Òum_by‹s, 
»maššg_by‹s_
);

121 
¡d
::
veùÜ
<
T
> 
»suÉ
 = 
CÚsumeBy‹s
<T>(
num_by‹s
 + 1,‚um_bytes);

122 
»suÉ
.
	`back
(èğ
‹rmš©Ü
;

123  
»suÉ
;

124 
	}
}

127 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

128 
	g¡d
::
veùÜ
<
T
> 
FuzzedD©aProvid”
::
	$CÚsumeRemaššgBy‹s
() {

129  
CÚsumeBy‹s
<
T
>(
»maššg_by‹s_
);

130 
	}
}

136 
šlše
 
	g¡d
::
¡ršg
 
FuzzedD©aProvid”
::
	$CÚsumeBy‹sAsSŒšg
(
size_t
 
num_by‹s
) {

137 
	`¡©ic_as£¹
((
¡d
::
¡ršg
::
v®ue_ty³
è=ğ(
ušt8_t
),

140 
num_by‹s
 = 
¡d
::
	`mš
Òum_by‹s, 
»maššg_by‹s_
);

141 
¡d
::
¡ršg
 
	`»suÉ
(

142 
»š‹½»t_ÿ¡
<cÚ¡ 
¡d
::
¡ršg
::
v®ue_ty³
 *>(
d©a_±r_
), 
num_by‹s
);

143 
	`Advªû
(
num_by‹s
);

144  
»suÉ
;

145 
	}
}

151 
šlše
 
	g¡d
::
¡ršg


152 
FuzzedD©aProvid”
::
	$CÚsumeRªdomL’gthSŒšg
(
size_t
 
max_Ëngth
) {

159 
¡d
::
¡ršg
 
»suÉ
;

162 
»suÉ
.
	`»£rve
(
¡d
::
	`mš
(
max_Ëngth
, 
»maššg_by‹s_
));

163 
size_t
 
i
 = 0; i < 
max_Ëngth
 && 
»maššg_by‹s_
 != 0; ++i) {

164 
Ãxt
 = 
CÚv”tUnsigÃdToSigÃd
<>(
d©a_±r_
[0]);

165 
	`Advªû
(1);

166 ià(
Ãxt
 =ğ'\\' && 
»maššg_by‹s_
 != 0) {

167 
Ãxt
 = 
CÚv”tUnsigÃdToSigÃd
<>(
d©a_±r_
[0]);

168 
	`Advªû
(1);

169 ià(
Ãxt
 != '\\')

172 
»suÉ
 +ğ
Ãxt
;

175 
»suÉ
.
	`shršk_to_f™
();

176  
»suÉ
;

177 
	}
}

180 
šlše
 
	g¡d
::
¡ršg
 
FuzzedD©aProvid”
::
	$CÚsumeRªdomL’gthSŒšg
() {

181  
	`CÚsumeRªdomL’gthSŒšg
(
»maššg_by‹s_
);

182 
	}
}

187 
šlše
 
	g¡d
::
¡ršg
 
FuzzedD©aProvid”
::
	$CÚsumeRemaššgBy‹sAsSŒšg
() {

188  
	`CÚsumeBy‹sAsSŒšg
(
»maššg_by‹s_
);

189 
	}
}

194 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
T
 
	gFuzzedD©aProvid”
::
	$CÚsumeIÁeg¿l
() {

195  
	`CÚsumeIÁeg¿lInRªge
(
¡d
::
num”ic_lim™s
<
T
>::
	`mš
(),

196 
¡d
::
num”ic_lim™s
<
T
>::
	`max
());

197 
	}
}

203 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

204 
T
 
	gFuzzedD©aProvid”
::
	$CÚsumeIÁeg¿lInRªge
(
T
 
mš
, T 
max
) {

205 
	`¡©ic_as£¹
(
¡d
::
is_š‹g¿l
<
T
>::
v®ue
, "An integralype is„equired.");

206 
	`¡©ic_as£¹
((
T
è<ğ(
ušt64_t
), "Unsupported integralype.");

208 ià(
mš
 > 
max
)

209 
	`abÜt
();

212 
ušt64_t
 
¿nge
 = 
¡©ic_ÿ¡
<ušt64_t>(
max
è- 
mš
;

213 
ušt64_t
 
»suÉ
 = 0;

214 
size_t
 
off£t
 = 0;

216 
off£t
 < (
T
è* 
CHAR_BIT
 && (
¿nge
 >> offset) > 0 &&

217 
»maššg_by‹s_
 != 0) {

224 --
»maššg_by‹s_
;

225 
»suÉ
 = (»suÉ << 
CHAR_BIT
è| 
d©a_±r_
[
»maššg_by‹s_
];

226 
off£t
 +ğ
CHAR_BIT
;

230 ià(
¿nge
 !ğ
¡d
::
num”ic_lim™s
<
	`deşty³
Ôªge)>::
	`max
())

231 
»suÉ
 =„esuÉ % (
¿nge
 + 1);

233  
¡©ic_ÿ¡
<
T
>(
mš
 + 
»suÉ
);

234 
	}
}

239 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
T
 
	gFuzzedD©aProvid”
::
	$CÚsumeFlßtšgPošt
() {

240  
CÚsumeFlßtšgPoštInRªge
<
T
>(
¡d
::
num”ic_lim™s
<T>::
	`lowe¡
(),

241 
¡d
::
num”ic_lim™s
<
T
>::
	`max
());

242 
	}
}

247 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

248 
T
 
	gFuzzedD©aProvid”
::
	$CÚsumeFlßtšgPoštInRªge
(
T
 
mš
, T 
max
) {

249 ià(
mš
 > 
max
)

250 
	`abÜt
();

252 
T
 
¿nge
 = .0;

253 
T
 
»suÉ
 = 
mš
;

254 
cÚ¡ex´
 
T
 
	`z”o
(.0);

255 ià(
max
 > 
z”o
 && 
mš
 < z”Ø&& max > mš + 
¡d
::
num”ic_lim™s
<
T
>::
	`max
()) {

259 
¿nge
 = (
max
 / 2.0è- (
mš
 / 2.0);

260 ià(
	`CÚsumeBoŞ
()) {

261 
»suÉ
 +ğ
¿nge
;

264 
¿nge
 = 
max
 - 
mš
;

267  
»suÉ
 + 
¿nge
 * 
CÚsumeProbab™y
<
T
>();

268 
	}
}

272 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
T
 
	gFuzzedD©aProvid”
::
	$CÚsumeProbab™y
() {

273 
	`¡©ic_as£¹
(
¡d
::
is_æßtšg_pošt
<
T
>::
v®ue
,

278 
usšg
 
IÁeg¿lTy³
 =

279 
ty³Çme
 
¡d
::
cÚd™iÚ®
<((
T
è<ğ(
ušt32_t
)), uint32_t,

280 
ušt64_t
>::
ty³
;

282 
T
 
»suÉ
 = 
¡©ic_ÿ¡
<T>(
CÚsumeIÁeg¿l
<
IÁeg¿lTy³
>());

283 
»suÉ
 /ğ
¡©ic_ÿ¡
<
T
>(
¡d
::
num”ic_lim™s
<
IÁeg¿lTy³
>::
	`max
());

284  
»suÉ
;

285 
	}
}

288 
šlše
 
boŞ
 
	gFuzzedD©aProvid”
::
	$CÚsumeBoŞ
() {

289  1 & 
CÚsumeIÁeg¿l
<
ušt8_t
>();

290 
	}
}

295 
	g‹m¶©e
 <
ty³Çme
 
	gT
> 
T
 
	gFuzzedD©aProvid”
::
	$CÚsumeEnum
() {

296 
	`¡©ic_as£¹
(
¡d
::
is_’um
<
T
>::
v®ue
, "|T| must be‡nƒnumype.");

297  
¡©ic_ÿ¡
<
T
>(

298 
CÚsumeIÁeg¿lInRªge
<
ušt32_t
>(0, 
¡©ic_ÿ¡
<ušt32_t>(
T
::
kMaxV®ue
)));

299 
	}
}

302 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
size_t
 
	gsize
>

303 
T
 
	gFuzzedD©aProvid”
::
PickV®ueInA¼ay
(cÚ¡ T (&
¬¿y
)[
size
]) {

304 
¡©ic_as£¹
(
size
 > 0, "The‡rray must be‚onƒmpty.");

305  
	g¬¿y
[
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
size
 - 1)];

308 
	g‹m¶©e
 <
ty³Çme
 
	gT
, 
size_t
 
	gsize
>

309 
T
 
	gFuzzedD©aProvid”
::
PickV®ueInA¼ay
(cÚ¡ 
¡d
::
¬¿y
<T, 
size
> &array) {

310 
¡©ic_as£¹
(
size
 > 0, "The‡rray must be‚onƒmpty.");

311  
	g¬¿y
[
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
size
 - 1)];

314 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

315 
T
 
	gFuzzedD©aProvid”
::
PickV®ueInA¼ay
(
¡d
::
š™Ÿliz”_li¡
<cÚ¡ T> 
li¡
) {

317 ià(!
li¡
.
size
())

318 
abÜt
();

320  *(
	gli¡
.
begš
(è+ 
	gCÚsumeIÁeg¿lInRªge
<
	gsize_t
>(0,†i¡.
size
() - 1));

329 
šlše
 
size_t
 
	gFuzzedD©aProvid”
::
	$CÚsumeD©a
(*
de¡š©iÚ
,

330 
size_t
 
num_by‹s
) {

331 
num_by‹s
 = 
¡d
::
	`mš
Òum_by‹s, 
»maššg_by‹s_
);

332 
	`CİyAndAdvªû
(
de¡š©iÚ
, 
num_by‹s
);

333  
num_by‹s
;

334 
	}
}

337 
šlše
 
	gFuzzedD©aProvid”
::
	$CİyAndAdvªû
(*
de¡š©iÚ
,

338 
size_t
 
num_by‹s
) {

339 
¡d
::
	`memıy
(
de¡š©iÚ
, 
d©a_±r_
, 
num_by‹s
);

340 
	`Advªû
(
num_by‹s
);

341 
	}
}

343 
šlše
 
	gFuzzedD©aProvid”
::
	$Advªû
(
size_t
 
num_by‹s
) {

344 ià(
num_by‹s
 > 
»maššg_by‹s_
)

345 
	`abÜt
();

347 
d©a_±r_
 +ğ
num_by‹s
;

348 
»maššg_by‹s_
 -ğ
num_by‹s
;

349 
	}
}

351 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

352 
	g¡d
::
veùÜ
<
T
> 
FuzzedD©aProvid”
::
	$CÚsumeBy‹s
(
size_t
 
size
, size_ˆ
num_by‹s
) {

353 
	`¡©ic_as£¹
((
T
è=ğ(
ušt8_t
), "Incompatible dataype.");

361 
¡d
::
veùÜ
<
T
> 
	`»suÉ
(
size
);

362 ià(
size
 == 0) {

363 ià(
num_by‹s
 != 0)

364 
	`abÜt
();

365  
»suÉ
;

368 
	`CİyAndAdvªû
(
»suÉ
.
	`d©a
(), 
num_by‹s
);

373 
»suÉ
.
	`shršk_to_f™
();

374  
»suÉ
;

375 
	}
}

377 
	g‹m¶©e
 <
ty³Çme
 
	gTS
,y³Çm
	gTU
>

378 
TS
 
	gFuzzedD©aProvid”
::
	$CÚv”tUnsigÃdToSigÃd
(
TU
 
v®ue
) {

379 
	`¡©ic_as£¹
((
TS
è=ğ(
TU
), "Incompatible dataypes.");

380 
	`¡©ic_as£¹
(!
¡d
::
num”ic_lim™s
<
TU
>::
is_sigÃd
,

384 ià(
¡d
::
num”ic_lim™s
<
TS
>::
is_modulo
)

385  
¡©ic_ÿ¡
<
TS
>(
v®ue
);

389 ià(
v®ue
 <ğ
¡d
::
num”ic_lim™s
<
TS
>::
	`max
()) {

390  
¡©ic_ÿ¡
<
TS
>(
v®ue
);

392 
cÚ¡ex´
‡utØ
TS_mš
 = 
¡d
::
num”ic_lim™s
<
TS
>::
	`mš
();

393  
TS_mš
 + 
¡©ic_ÿ¡
<>(
v®ue
 - TS_min);

395 
	}
}

	@addition_overflow.cpp

5 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

6 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<‹¡/fuzz/ut.h
>

8 
	~<ut/ov”æow.h
>

10 
	~<c¡dšt
>

11 
	~<¡ršg
>

12 
	~<veùÜ
>

14 #ià
defšed
(
__has_butš
)

15 #ià
__has_butš
(
__butš_add_ov”æow
)

16 
	#HAVE_BUILTIN_ADD_OVERFLOW


	)

18 #–ià
defšed
(
__GNUC__
)

19 
	#HAVE_BUILTIN_ADD_OVERFLOW


	)

22 
	gÇme¥aû
 {

23 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

24 
Te¡Add™iÚOv”æow
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
)

26 cÚ¡ 
T
 
	gi
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<T>();

27 cÚ¡ 
T
 
	gj
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<T>();

28 cÚ¡ 
boŞ
 
	gis_add™iÚ_ov”æow_cu¡om
 = 
Add™iÚOv”æow
(
i
, 
j
);

29 cÚ¡‡utØ
	gmaybe_add
{
CheckedAdd
(
i
, 
j
)};

30 cÚ¡‡utØ
	g§t_add
{
S©u¿tšgAdd
(
i
, 
j
)};

31 
as£¹
(
is_add™iÚ_ov”æow_cu¡om
 =ğ!
maybe_add
.
has_v®ue
());

32 
as£¹
(
is_add™iÚ_ov”æow_cu¡om
 =ğ
Add™iÚOv”æow
(
j
, 
i
));

33 
as£¹
(
maybe_add
 =ğ
CheckedAdd
(
j
, 
i
));

34 
as£¹
(
§t_add
 =ğ
S©u¿tšgAdd
(
j
, 
i
));

35 #ià
defšed
(
HAVE_BUILTIN_ADD_OVERFLOW
)

36 
T
 
	g»suÉ_butš
;

37 cÚ¡ 
boŞ
 
	gis_add™iÚ_ov”æow_butš
 = 
__butš_add_ov”æow
(
i
, 
j
, &
»suÉ_butš
);

38 
as£¹
(
is_add™iÚ_ov”æow_cu¡om
 =ğ
is_add™iÚ_ov”æow_butš
);

39 ià(!
	gis_add™iÚ_ov”æow_cu¡om
) {

40 
as£¹
(
i
 + 
j
 =ğ
»suÉ_butš
);

43 ià(
	gis_add™iÚ_ov”æow_cu¡om
) {

44 
as£¹
(
§t_add
 =ğ
¡d
::
num”ic_lim™s
<
T
>::
mš
(è|| s©_add =ğ¡d::num”ic_lim™s<T>::
max
());

46 cÚ¡‡utØ
	gadd
{
	gi
 + 
	gj
};

47 
as£¹
(
add
 =ğ
maybe_add
.
v®ue
());

48 
as£¹
(
add
 =ğ
§t_add
);

53 
	$FUZZ_TARGET
(
add™iÚ_ov”æow
)

55 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

56 
Te¡Add™iÚOv”æow
<
št64_t
>(
fuzzed_d©a_´ovid”
);

57 
Te¡Add™iÚOv”æow
<
ušt64_t
>(
fuzzed_d©a_´ovid”
);

58 
Te¡Add™iÚOv”æow
<
št32_t
>(
fuzzed_d©a_´ovid”
);

59 
Te¡Add™iÚOv”æow
<
ušt32_t
>(
fuzzed_d©a_´ovid”
);

60 
Te¡Add™iÚOv”æow
<
št16_t
>(
fuzzed_d©a_´ovid”
);

61 
Te¡Add™iÚOv”æow
<
ušt16_t
>(
fuzzed_d©a_´ovid”
);

62 
Te¡Add™iÚOv”æow
<>(
fuzzed_d©a_´ovid”
);

63 
Te¡Add™iÚOv”æow
<>(
fuzzed_d©a_´ovid”
);

64 
Te¡Add™iÚOv”æow
<sigÃd >(
fuzzed_d©a_´ovid”
);

65 
	}
}

	@addrman.cpp

5 
	~<addrdb.h
>

6 
	~<addrmª.h
>

7 
	~<addrmª_im¶.h
>

8 
	~<chaš·¿ms.h
>

9 
	~<m”kËblock.h
>

10 
	~<¿ndom.h
>

11 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

12 
	~<‹¡/fuzz/fuzz.h
>

13 
	~<‹¡/fuzz/ut.h
>

14 
	~<‹¡/ut/£tup_commÚ.h
>

15 
	~<time.h
>

16 
	~<ut/asm­.h
>

17 
	~<ut/sy¡em.h
>

19 
	~<ÿs£¹
>

20 
	~<c¡dšt
>

21 
	~<İtiÚ®
>

22 
	~<¡ršg
>

23 
	~<veùÜ
>

25 
	gÇme¥aû
 {

26 cÚ¡ 
BasicTe¡šgS‘up
* 
	gg_£tup
;

28 
št32_t
 
G‘CheckR©io
()

30  
	g¡d
::
şamp
<
št32_t
>(
g_£tup
->
m_node
.
¬gs
->
G‘IÁArg
("-checkaddrman", 0), 0, 1000000);

34 
	$š™Ÿlize_addrmª
()

36 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>(
CBa£ChašP¬ams
::
REGTEST
);

37 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

38 
	}
}

40 [[
nodisÿrd
]] 
šlše
 
N‘GroupMªag”
 
	$CÚsumeN‘GroupMªag”
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


42 
¡d
::
veùÜ
<
boŞ
> 
asm­
 = 
	`CÚsumeRªdomL’gthB™VeùÜ
(
fuzzed_d©a_´ovid”
);

43 ià(!
	`Sª™yCheckASM­
(
asm­
, 128)èasm­.
	`ş—r
();

44  
	`N‘GroupMªag”
(
asm­
);

45 
	}
}

47 
	$FUZZ_TARGET_INIT
(
d©a_¡»am_addr_mª
, 
š™Ÿlize_addrmª
)

49 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

50 
CD©aSŒ—m
 
d©a_¡»am
 = 
	`CÚsumeD©aSŒ—m
(
fuzzed_d©a_´ovid”
);

51 
N‘GroupMªag”
 
Ãtgroupmª
{
	`CÚsumeN‘GroupMªag”
(
fuzzed_d©a_´ovid”
)};

52 
AddrMª
 
	`addr_mª
(
Ãtgroupmª
, 
çl£
, 
	`G‘CheckR©io
());

53 
Œy
 {

54 
	`R—dFromSŒ—m
(
addr_mª
, 
d©a_¡»am
);

55 } 
	`ÿtch
 (cÚ¡ 
¡d
::
exû±iÚ
&) {

57 
	}
}

62 
CN‘Addr
 
	$RªdAddr
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, 
Fa¡RªdomCÚ‹xt
& 
ç¡_¿ndom_cÚ‹xt
)

64 
CN‘Addr
 
addr
;

65 ià(
fuzzed_d©a_´ovid”
.
	`»maššg_by‹s
(è> 1 && fuzzed_d©a_´ovid”.
	`CÚsumeBoŞ
()) {

66 
addr
 = 
	`CÚsumeN‘Addr
(
fuzzed_d©a_´ovid”
);

69 cÚ¡ 
¡d
::
m­
<
ušt8_t
, ušt8_t> 
Ãt_Ën_m­
 = {{1, 
ADDR_IPV4_SIZE
},

70 {2, 
ADDR_IPV6_SIZE
},

71 {4, 
ADDR_TORV3_SIZE
},

72 {5, 
ADDR_I2P_SIZE
},

73 {6, 
ADDR_CJDNS_SIZE
}};

74 
ušt8_t
 
Ãt
 = 
ç¡_¿ndom_cÚ‹xt
.
	`¿nd¿nge
(5) + 1;

75 ià(
Ãt
 == 3) {

76 
Ãt
 = 6;

79 
CD©aSŒ—m
 
	`s
(
SER_NETWORK
, 
PROTOCOL_VERSION
 | 
ADDRV2_FORMAT
);

81 
s
 << 
Ãt
;

82 
s
 << 
ç¡_¿ndom_cÚ‹xt
.
	`¿ndby‹s
(
Ãt_Ën_m­
.
	`©
(
Ãt
));

84 
s
 >> 
addr
;

88 ià(!
addr
.
	`IsV®id
()) {

89 
š_addr
 
v4_addr
 = {};

90 
v4_addr
.
s_addr
 = 0x05050505;

91 
addr
 = 
CN‘Addr
{
v4_addr
};

94  
addr
;

95 
	}
}

98 
	$FlAddrmª
(
AddrMª
& 
addrmª
, 
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
)

102 cÚ¡ 
size_t
 
n
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 3);

104 cÚ¡ 
size_t
 
num_sourûs
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(1, 50);

105 
CN‘Addr
 
´ev_sourû
;

109 
Fa¡RªdomCÚ‹xt
 
ç¡_¿ndom_cÚ‹xt
{
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
)};

110 
size_t
 
i
 = 0; i < 
num_sourûs
; ++i) {

111 cÚ¡‡utØ
sourû
 = 
	`RªdAddr
(
fuzzed_d©a_´ovid”
, 
ç¡_¿ndom_cÚ‹xt
);

112 cÚ¡ 
size_t
 
num_add»s£s
 = 
ç¡_¿ndom_cÚ‹xt
.
	`¿nd¿nge
(500) + 1;

114 
size_t
 
j
 = 0; j < 
num_add»s£s
; ++j) {

115 cÚ¡‡utØ
addr
 = 
CAdd»ss
{
CS”viû
{
	`RªdAddr
(
fuzzed_d©a_´ovid”
, 
ç¡_¿ndom_cÚ‹xt
), 8333}, 
NODE_NETWORK
};

116 cÚ¡ 
¡d
::
chrÚo
::
£cÚds
 
time_³ÇÉy
{
ç¡_¿ndom_cÚ‹xt
.
	`¿nd¿nge
(100000001)};

117 
addrmª
.
	`Add
({
addr
}, 
sourû
, 
time_³ÇÉy
);

119 ià(
n
 > 0 && 
addrmª
.
	`size
() %‚ == 0) {

120 
addrmª
.
	`Good
(
addr
, 
Now
<
NodeSecÚds
>());

124 ià(
ç¡_¿ndom_cÚ‹xt
.
	`¿nd¿nge
(10è=ğ0 && 
´ev_sourû
.
	`IsV®id
()) {

125 
addrmª
.
	`Add
({
addr
}, 
´ev_sourû
, 
time_³ÇÉy
);

128 
´ev_sourû
 = 
sourû
;

130 
	}
}

132 şas 
	cAddrMªD‘”mši¡ic
 : 
public
 
AddrMª


134 
public
:

135 
ex¶ic™
 
	$AddrMªD‘”mši¡ic
(cÚ¡ 
N‘GroupMªag”
& 
Ãtgroupmª
, 
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
)

136 : 
	`AddrMª
(
Ãtgroupmª
, 
Œue
, 
	$G‘CheckR©io
())

138 
	`WITH_LOCK
(
m_im¶
->
cs
, m_im¶->
š£cu»_¿nd
 = 
Fa¡RªdomCÚ‹xt
{
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
)});

148 
boŞ
 
İ”©Ü
==(cÚ¡ 
AddrMªD‘”mši¡ic
& 
Ùh”
) const

150 
	`LOCK2
(
m_im¶
->
cs
, 
Ùh”
.m_impl->cs);

152 ià(
m_im¶
->
m­Info
.
	`size
(è!ğ
Ùh”
.m_im¶->m­Info.size(è|| m_im¶->
nNew
 != other.m_impl->nNew ||

153 
m_im¶
->
nTr›d
 !ğ
Ùh”
.m_impl->nTried) {

154  
çl£
;

160 autØ
addršfo_hash”
 = [](cÚ¡ 
AddrInfo
& 
a
) {

161 
CSHash”
 
	`hash”
(0, 0);

162 autØ
addr_key
 = 
a
.
	`G‘Key
();

163 autØ
sourû_key
 = 
a
.
sourû
.
	`G‘AddrBy‹s
();

164 
hash”
.
	`Wr™e
(
TicksSšûEpoch
<
¡d
::
chrÚo
::
£cÚds
>(
a
.
m_Ï¡_sucûss
));

165 
hash”
.
	`Wr™e
(
a
.
nA‰em±s
);

166 
hash”
.
	`Wr™e
(
a
.
nRefCouÁ
);

167 
hash”
.
	`Wr™e
(
a
.
fInTr›d
);

168 
hash”
.
	`Wr™e
(
a
.
	`G‘N‘wÜk
());

169 
hash”
.
	`Wr™e
(
a
.
sourû
.
	`G‘N‘wÜk
());

170 
hash”
.
	`Wr™e
(
addr_key
.
	`size
());

171 
hash”
.
	`Wr™e
(
sourû_key
.
	`size
());

172 
hash”
.
	`Wr™e
(
addr_key
.
	`d©a
(),‡ddr_key.
	`size
());

173 
hash”
.
	`Wr™e
(
sourû_key
.
	`d©a
(), sourû_key.
	`size
());

174  (
size_t
)
hash”
.
	`Fš®ize
();

177 autØ
addršfo_eq
 = [](cÚ¡ 
AddrInfo
& 
lhs
, cÚ¡ AddrInfo& 
rhs
) {

178  
¡d
::
	`t›
(
¡©ic_ÿ¡
<cÚ¡ 
CS”viû
&>(
lhs
),†hs.
sourû
,†hs.
m_Ï¡_sucûss
,†hs.
nA‰em±s
,†hs.
nRefCouÁ
,†hs.
fInTr›d
) ==

179 
¡d
::
	`t›
(
¡©ic_ÿ¡
<cÚ¡ 
CS”viû
&>(
rhs
),„hs.
sourû
,„hs.
m_Ï¡_sucûss
,„hs.
nA‰em±s
,„hs.
nRefCouÁ
,„hs.
fInTr›d
);

182 
usšg
 
Add»s£s
 = 
¡d
::
unÜd”ed_£t
<
AddrInfo
, 
	`deşty³
(
addršfo_hash”
), deşty³(
addršfo_eq
)>;

184 cÚ¡ 
size_t
 
num_add»s£s
{
m_im¶
->
m­Info
.
	`size
()};

186 
Add»s£s
 
add»s£s
{
num_add»s£s
, 
addršfo_hash”
, 
addršfo_eq
};

187 cÚ¡‡uto& [
id
, 
addr
] : 
m_im¶
->
m­Info
) {

188 
add»s£s
.
	`š£¹
(
addr
);

191 
Add»s£s
 
Ùh”_add»s£s
{
num_add»s£s
, 
addršfo_hash”
, 
addršfo_eq
};

192 cÚ¡‡uto& [
id
, 
addr
] : 
Ùh”
.
m_im¶
->
m­Info
) {

193 
Ùh”_add»s£s
.
	`š£¹
(
addr
);

196 ià(
add»s£s
 !ğ
Ùh”_add»s£s
) {

197  
çl£
;

200 autØ
IdsReãrToSameAdd»ss
 = [&](
id
, 
Ùh”_id
è
	`EXCLUSIVE_LOCKS_REQUIRED
(
m_im¶
->
cs
, 
Ùh”
.m_impl->cs) {

201 ià(
id
 =ğ-1 && 
Ùh”_id
 == -1) {

202  
Œue
;

204 ià((
id
 =ğ-1 && 
Ùh”_id
 != -1) || (id != -1 && other_id == -1)) {

205  
çl£
;

207  
m_im¶
->
m­Info
.
	`©
(
id
è=ğ
Ùh”
.m_im¶->m­Info.©(
Ùh”_id
);

213 
size_t
 
i
 = 0; i < 
ADDRMAN_NEW_BUCKET_COUNT
; ++i) {

214 
size_t
 
j
 = 0; j < 
ADDRMAN_BUCKET_SIZE
; ++j) {

215 ià(!
	`IdsReãrToSameAdd»ss
(
m_im¶
->
vvNew
[
i
][
j
], 
Ùh”
.m_impl->vvNew[i][j])) {

216  
çl£
;

222 
size_t
 
i
 = 0; i < 
ADDRMAN_TRIED_BUCKET_COUNT
; ++i) {

223 
size_t
 
j
 = 0; j < 
ADDRMAN_BUCKET_SIZE
; ++j) {

224 ià(!
	`IdsReãrToSameAdd»ss
(
m_im¶
->
vvTr›d
[
i
][
j
], 
Ùh”
.m_impl->vvTried[i][j])) {

225  
çl£
;

230  
Œue
;

231 
	}
}

234 
	$FUZZ_TARGET_INIT
(
addrmª
, 
š™Ÿlize_addrmª
)

236 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

237 
	`S‘MockTime
(
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
));

238 
N‘GroupMªag”
 
Ãtgroupmª
{
	`CÚsumeN‘GroupMªag”
(
fuzzed_d©a_´ovid”
)};

239 autØ
addr_mª_±r
 = 
¡d
::
make_unique
<
AddrMªD‘”mši¡ic
>(
Ãtgroupmª
, 
fuzzed_d©a_´ovid”
);

240 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

241 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
£rŸlized_d©a
{
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
)};

242 
CD©aSŒ—m
 
	`ds
(
£rŸlized_d©a
, 
SER_DISK
, 
INIT_PROTO_VERSION
);

243 cÚ¡‡utØ
£r_v”siÚ
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št32_t
>()};

244 
ds
.
	`S‘V”siÚ
(
£r_v”siÚ
);

245 
Œy
 {

246 
ds
 >> *
addr_mª_±r
;

247 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

248 
addr_mª_±r
 = 
¡d
::
make_unique
<
AddrMªD‘”mši¡ic
>(
Ãtgroupmª
, 
fuzzed_d©a_´ovid”
);

251 
AddrMªD‘”mši¡ic
& 
addr_mª
 = *
addr_mª_±r
;

252 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

253 
	`C®lOÃOf
(

254 
fuzzed_d©a_´ovid”
,

256 
addr_mª
.
	`ResŞveCŞlisiÚs
();

259 ()
addr_mª
.
	`S–eùTr›dCŞlisiÚ
();

262 
¡d
::
veùÜ
<
CAdd»ss
> 
add»s£s
;

263 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

264 cÚ¡ 
¡d
::
İtiÚ®
<
CAdd»ss
> 
İt_add»ss
 = 
CÚsumeDe£rŸlizabË
<CAdd»ss>(
fuzzed_d©a_´ovid”
);

265 ià(!
İt_add»ss
) {

268 
add»s£s
.
	`push_back
(*
İt_add»ss
);

270 cÚ¡ 
¡d
::
İtiÚ®
<
CN‘Addr
> 
İt_Ãt_addr
 = 
CÚsumeDe£rŸlizabË
<CN‘Addr>(
fuzzed_d©a_´ovid”
);

271 ià(
İt_Ãt_addr
) {

272 
addr_mª
.
	`Add
(
add»s£s
, *
İt_Ãt_addr
, 
¡d
::
chrÚo
::
£cÚds
{
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
, 0, 100000000)});

276 cÚ¡ 
¡d
::
İtiÚ®
<
CS”viû
> 
İt_£rviû
 = 
CÚsumeDe£rŸlizabË
<CS”viû>(
fuzzed_d©a_´ovid”
);

277 ià(
İt_£rviû
) {

278 
addr_mª
.
	`Good
(*
İt_£rviû
, 
NodeSecÚds
{
¡d
::
chrÚo
::
£cÚds
{
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
)}});

282 cÚ¡ 
¡d
::
İtiÚ®
<
CS”viû
> 
İt_£rviû
 = 
CÚsumeDe£rŸlizabË
<CS”viû>(
fuzzed_d©a_´ovid”
);

283 ià(
İt_£rviû
) {

284 
addr_mª
.
	`A‰em±
(*
İt_£rviû
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 
NodeSecÚds
{
¡d
::
chrÚo
::
£cÚds
{
	`CÚsumeTime
(fuzzed_data_provider)}});

288 cÚ¡ 
¡d
::
İtiÚ®
<
CS”viû
> 
İt_£rviû
 = 
CÚsumeDe£rŸlizabË
<CS”viû>(
fuzzed_d©a_´ovid”
);

289 ià(
İt_£rviû
) {

290 
addr_mª
.
	`CÚÃùed
(*
İt_£rviû
, 
NodeSecÚds
{
¡d
::
chrÚo
::
£cÚds
{
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
)}});

294 cÚ¡ 
¡d
::
İtiÚ®
<
CS”viû
> 
İt_£rviû
 = 
CÚsumeDe£rŸlizabË
<CS”viû>(
fuzzed_d©a_´ovid”
);

295 ià(
İt_£rviû
) {

296 
addr_mª
.
	`S‘S”viûs
(*
İt_£rviû
, 
	`CÚsumeW—kEnum
(
fuzzed_d©a_´ovid”
, 
ALL_SERVICE_FLAGS
));

300 cÚ¡ 
AddrMª
& 
cÚ¡_addr_mª
{
addr_mª
};

301 ()
cÚ¡_addr_mª
.
	`G‘Addr
(

302  
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 4096),

303  
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 4096),

304  
¡d
::
nuÎİt
);

305 ()
cÚ¡_addr_mª
.
	`S–eù
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

306 ()
cÚ¡_addr_mª
.
	`size
();

307 
CD©aSŒ—m
 
	`d©a_¡»am
(
SER_NETWORK
, 
PROTOCOL_VERSION
);

308 
d©a_¡»am
 << 
cÚ¡_addr_mª
;

309 
	}
}

312 
	$FUZZ_TARGET_INIT
(
addrmª_£rde£r
, 
š™Ÿlize_addrmª
)

314 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

315 
	`S‘MockTime
(
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
));

317 
N‘GroupMªag”
 
Ãtgroupmª
{
	`CÚsumeN‘GroupMªag”
(
fuzzed_d©a_´ovid”
)};

318 
AddrMªD‘”mši¡ic
 
addr_mª1
{
Ãtgroupmª
, 
fuzzed_d©a_´ovid”
};

319 
AddrMªD‘”mši¡ic
 
addr_mª2
{
Ãtgroupmª
, 
fuzzed_d©a_´ovid”
};

321 
CD©aSŒ—m
 
	`d©a_¡»am
(
SER_NETWORK
, 
PROTOCOL_VERSION
);

323 
	`FlAddrmª
(
addr_mª1
, 
fuzzed_d©a_´ovid”
);

324 
d©a_¡»am
 << 
addr_mª1
;

325 
d©a_¡»am
 >> 
addr_mª2
;

326 
	`as£¹
(
addr_mª1
 =ğ
addr_mª2
);

327 
	}
}

	@asmap.cpp

5 
	~<Ãdd»ss.h
>

6 
	~<Ãtgroup.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<ut/asm­.h
>

10 
	~<c¡dšt
>

11 
	~<veùÜ
>

14 cÚ¡ 
	g¡d
::
veùÜ
<
boŞ
> 
IPV6_PREFIX_ASMAP
 = {};

17 cÚ¡ 
	g¡d
::
veùÜ
<
boŞ
> 
IPV4_PREFIX_ASMAP
 = {

18 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue, false, false, false, false, false, false, false, false,

19 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue, false, false, false, false, false, false, false, false,

20 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue, false, false, false, false, false, false, false, false,

21 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue, false, false, false, false, false, false, false, false,

22 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue, false, false, false, false, false, false, false, false,

23 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue, false, false, false, false, false, false, false, false,

24 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue, false, false, false, false, false, false, false, false,

25 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue, false, false, false, false, false, false, false, false,

26 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue, false, false, false, false, false, false, false, false,

27 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue, false, false, false, false, false, false, false, false,

28 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue,

29 
Œue
,rue, 
çl£
,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue,rue

32 
	$FUZZ_TARGET
(
asm­
)

35 ià(
bufãr
.
	`size
() < 1 + 3 + 4) ;

36 
asm­_size
 = 3 + (
bufãr
[0] & 127);

37 
boŞ
 
v6
 = 
bufãr
[0] & 128;

38 cÚ¡ 
size_t
 
addr_size
 = 
v6
 ? 
ADDR_IPV6_SIZE
 : 
ADDR_IPV4_SIZE
;

39 ià(
bufãr
.
	`size
(è< 
	`size_t
(1 + 
asm­_size
 + 
addr_size
)) ;

40 
¡d
::
veùÜ
<
boŞ
> 
asm­
 = 
v6
 ? 
IPV6_PREFIX_ASMAP
 : 
IPV4_PREFIX_ASMAP
;

41 
asm­
.
	`»£rve
×sm­.
	`size
(è+ 8 * 
asm­_size
);

42 
i
 = 0; i < 
asm­_size
; ++i) {

43 
j
 = 0; j < 8; ++j) {

44 
asm­
.
	`push_back
((
bufãr
[1 + 
i
] >> 
j
) & 1);

47 ià(!
	`Sª™yCheckASM­
(
asm­
, 128)) ;

49 cÚ¡ 
ušt8_t
* 
addr_d©a
 = 
bufãr
.
	`d©a
(è+ 1 + 
asm­_size
;

50 
CN‘Addr
 
Ãt_addr
;

51 ià(
v6
) {

52 
	`as£¹
(
addr_size
 =ğ
ADDR_IPV6_SIZE
);

53 
Ãt_addr
.
	`S‘LegacyIPv6
({
addr_d©a
, 
addr_size
});

55 
	`as£¹
(
addr_size
 =ğ
ADDR_IPV4_SIZE
);

56 
š_addr
 
v4
;

57 
	`memıy
(&
v4
, 
addr_d©a
, 
addr_size
);

58 
Ãt_addr
.
	`S‘IP
(
CN‘Addr
{
v4
});

60 
N‘GroupMªag”
 
Ãtgroupmª
{
asm­
};

61 ()
Ãtgroupmª
.
	`G‘M­³dAS
(
Ãt_addr
);

62 
	}
}

	@asmap_direct.cpp

5 
	~<Ãdd»ss.h
>

6 
	~<ut/asm­.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<c¡dšt
>

10 
	~<İtiÚ®
>

11 
	~<veùÜ
>

13 
	~<as£¹.h
>

15 
	$FUZZ_TARGET
(
asm­_dœeù
)

18 
¡d
::
İtiÚ®
<
size_t
> 
£p_pos_İt
;

19 
size_t
 
pos
 = 0;…o < 
bufãr
.
	`size
(); ++pos) {

20 
ušt8_t
 
x
 = 
bufãr
[
pos
];

21 ià((
x
 & 0xFE) == 0) ;

22 ià(
x
 == 0xFF) {

23 ià(
£p_pos_İt
) ;

24 
£p_pos_İt
 = 
pos
;

29 ià(!
£p_pos_İt
) ;

30 cÚ¡ 
size_t
 
£p_pos
{
£p_pos_İt
.
	`v®ue
()};

31 ià(
bufãr
.
	`size
(è- 
£p_pos
 - 1 > 128) ;

34 
¡d
::
veùÜ
<
boŞ
> 
	`asm­
(
bufãr
.
	`begš
(), bufãr.begš(è+ 
£p_pos
);

35 ià(
	`Sª™yCheckASM­
(
asm­
, 
bufãr
.
	`size
(è- 1 - 
£p_pos
)) {

37 
¡d
::
veùÜ
<
boŞ
> 
asm­_´efix
 = 
asm­
;

38 !
asm­_´efix
.
	`em±y
(è&&‡sm­_´efix.
	`size
(è+ 7 > 
asm­
.size(è&&‡sm­_´efix.
	`back
(è=ğ
çl£
) {

39 
asm­_´efix
.
	`pİ_back
();

41 !
asm­_´efix
.
	`em±y
()) {

42 
asm­_´efix
.
	`pİ_back
();

43 
	`as£¹
(!
	`Sª™yCheckASM­
(
asm­_´efix
, 
bufãr
.
	`size
(è- 1 - 
£p_pos
));

46 
¡d
::
veùÜ
<
boŞ
> 
	`addr
(
bufãr
.
	`begš
(è+ 
£p_pos
 + 1, bufãr.
	`’d
());

47 ()
	`IÁ”´‘
(
asm­
, 
addr
);

49 
	}
}

	@autofile.cpp

5 
	~<¡»ams.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<¬¿y
>

11 
	~<c¡dšt
>

12 
	~<io¡»am
>

13 
	~<İtiÚ®
>

14 
	~<¡ršg
>

15 
	~<veùÜ
>

17 
	$FUZZ_TARGET
(
autofe
)

19 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

20 
FuzzedAutoFeProvid”
 
fuzzed_auto_fe_´ovid”
 = 
	`CÚsumeAutoFe
(
fuzzed_d©a_´ovid”
);

21 
AutoFe
 
auto_fe
{
fuzzed_auto_fe_´ovid”
.
	`İ’
()};

22 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

23 
	`C®lOÃOf
(

24 
fuzzed_d©a_´ovid”
,

26 
¡d
::
¬¿y
<¡d::
by‹
, 4096> 
¬r
{};

27 
Œy
 {

28 
auto_fe
.
	`»ad
({
¬r
.
	`d©a
(), 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 4096)});

29 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

33 cÚ¡ 
¡d
::
¬¿y
<¡d::
by‹
, 4096> 
¬r
{};

34 
Œy
 {

35 
auto_fe
.
	`wr™e
({
¬r
.
	`d©a
(), 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 4096)});

36 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

40 
Œy
 {

41 
auto_fe
.
	`ignÜe
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 4096));

42 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

46 
auto_fe
.
	`fşo£
();

49 
	`R—dFromSŒ—m
(
fuzzed_d©a_´ovid”
, 
auto_fe
);

52 
	`Wr™eToSŒ—m
(
fuzzed_d©a_´ovid”
, 
auto_fe
);

55 ()
auto_fe
.
	`G‘
();

56 ()
auto_fe
.
	`IsNuÎ
();

57 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

58 
FILE
* 
f
 = 
auto_fe
.
	`»Ëa£
();

59 ià(
f
 !ğ
nuÎ±r
) {

60 
	`fşo£
(
f
);

63 
	}
}

	@banman.cpp

5 
	~<bªmª.h
>

6 
	~<fs.h
>

7 
	~<Ãdd»ss.h
>

8 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

9 
	~<‹¡/fuzz/fuzz.h
>

10 
	~<‹¡/fuzz/ut.h
>

11 
	~<‹¡/ut/£tup_commÚ.h
>

12 
	~<ut/»adwr™efe.h
>

13 
	~<ut/sy¡em.h
>

15 
	~<ÿs£¹
>

16 
	~<c¡dšt
>

17 
	~<lim™s
>

18 
	~<¡ršg
>

19 
	~<veùÜ
>

21 
	gÇme¥aû
 {

22 
št64_t
 
CÚsumeBªTimeOff£t
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
	gnÛxû±


26  
	gfuzzed_d©a_´ovid”
.
	gCÚsumeIÁeg¿lInRªge
<
	gšt64_t
>(
	g¡d
::
num”ic_lim™s
<
št64_t
>::
mš
(), std::num”ic_lim™s<
št32_t
>::
max
());

30 
	$š™Ÿlize_bªmª
()

32 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>();

33 
	}
}

35 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
CBªEÁry
& 
lhs
, cÚ¡ 
	gCBªEÁry
& 
	grhs
)

37  
	glhs
.
	gnV”siÚ
 =ğ
rhs
.
nV”siÚ
 &&

38 
lhs
.
nC»©eTime
 =ğ
rhs
.nCreateTime &&

39 
lhs
.
nBªUÁ
 =ğ
rhs
.nBanUntil;

42 
	$FUZZ_TARGET_INIT
(
bªmª
, 
š™Ÿlize_bªmª
)

44 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

45 
	`S‘MockTime
(
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
));

46 
fs
::
·th
 
bªli¡_fe
 = 
gArgs
.
	`G‘D©aDœN‘
() / "fuzzed_banlist";

48 cÚ¡ 
boŞ
 
¡¬t_w™h_cÜru±ed_bªli¡
{
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()};

49 
boŞ
 
fÜû_»ad_ªd_wr™e_to_”r
{
çl£
};

50 ià(
¡¬t_w™h_cÜru±ed_bªli¡
) {

51 
	`as£¹
(
	`Wr™eBš¬yFe
(
bªli¡_fe
 + ".json",

52 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
()));

54 
fÜû_»ad_ªd_wr™e_to_”r
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

55 ià(
fÜû_»ad_ªd_wr™e_to_”r
) {

56 
bªli¡_fe
 = 
fs
::
·th
{"path"} / "to" / "inaccessible" / "fuzzed_banlist";

61 
BªMª
 
bª_mª
{
bªli¡_fe
, 
nuÎ±r
, 
	`CÚsumeBªTimeOff£t
(
fuzzed_d©a_´ovid”
)};

65 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 300)

67 
	`C®lOÃOf
(

68 
fuzzed_d©a_´ovid”
,

70 
bª_mª
.
	`Bª
(
	`CÚsumeN‘Addr
(
fuzzed_d©a_´ovid”
),

71 
	`CÚsumeBªTimeOff£t
(
fuzzed_d©a_´ovid”
), fuzzed_d©a_´ovid”.
	`CÚsumeBoŞ
());

74 
bª_mª
.
	`Bª
(
	`CÚsumeSubN‘
(
fuzzed_d©a_´ovid”
),

75 
	`CÚsumeBªTimeOff£t
(
fuzzed_d©a_´ovid”
), fuzzed_d©a_´ovid”.
	`CÚsumeBoŞ
());

78 
bª_mª
.
	`CË¬BªÃd
();

81 
bª_mª
.
	`IsBªÃd
(
	`CÚsumeN‘Addr
(
fuzzed_d©a_´ovid”
));

84 
bª_mª
.
	`IsBªÃd
(
	`CÚsumeSubN‘
(
fuzzed_d©a_´ovid”
));

87 
bª_mª
.
	`Unbª
(
	`CÚsumeN‘Addr
(
fuzzed_d©a_´ovid”
));

90 
bª_mª
.
	`Unbª
(
	`CÚsumeSubN‘
(
fuzzed_d©a_´ovid”
));

93 
bªm­_t
 
bªm­
;

94 
bª_mª
.
	`G‘BªÃd
(
bªm­
);

97 
bª_mª
.
	`DumpBªli¡
();

100 
bª_mª
.
	`Discou¿ge
(
	`CÚsumeN‘Addr
(
fuzzed_d©a_´ovid”
));

103 ià(!
fÜû_»ad_ªd_wr™e_to_”r
) {

104 
bª_mª
.
	`DumpBªli¡
();

105 
	`S‘MockTime
(
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
));

106 
bªm­_t
 
bªm­
;

107 
bª_mª
.
	`G‘BªÃd
(
bªm­
);

108 
BªMª
 
bª_mª_»ad
{
bªli¡_fe
, 
nuÎ±r
, 0};

109 
bªm­_t
 
bªm­_»ad
;

110 
bª_mª_»ad
.
	`G‘BªÃd
(
bªm­_»ad
);

111 
	`as£¹
(
bªm­
 =ğ
bªm­_»ad
);

114 
fs
::
	`»move
(fs::
	`P©hToSŒšg
(
bªli¡_fe
 + ".json"));

115 
	}
}

	@base_encode_decode.cpp

5 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<ba£58.h
>

8 
	~<psbt.h
>

9 
	~<ut/¡»ncodšgs.h
>

10 
	~<ut/¡ršg.h
>

12 
	~<ÿs£¹
>

13 
	~<c¡dšt
>

14 
	~<¡ršg
>

15 
	~<veùÜ
>

17 
	$š™Ÿlize_ba£_’code_decode
()

19 cÚ¡ 
ECCV”ifyHªdË
 
v”ify_hªdË
;

20 
	}
}

22 
	$FUZZ_TARGET_INIT
(
ba£_’code_decode
, 
š™Ÿlize_ba£_’code_decode
)

24 cÚ¡ 
¡d
::
¡ršg
 
	`¿ndom_’coded_¡ršg
(
bufãr
.
	`begš
(), bufãr.
	`’d
());

26 
¡d
::
veùÜ
<> 
decoded
;

27 ià(
	`DecodeBa£58
(
¿ndom_’coded_¡ršg
, 
decoded
, 100)) {

28 cÚ¡ 
¡d
::
¡ršg
 
’coded_¡ršg
 = 
	`EncodeBa£58
(
decoded
);

29 
	`as£¹
(
’coded_¡ršg
 =ğ
	`TrimSŒšgV›w
(encoded_string));

30 
	`as£¹
(
	`ToLow”
(
’coded_¡ršg
è=ğToLow”(
	`TrimSŒšg
(
¿ndom_’coded_¡ršg
)));

33 ià(
	`DecodeBa£58Check
(
¿ndom_’coded_¡ršg
, 
decoded
, 100)) {

34 cÚ¡ 
¡d
::
¡ršg
 
’coded_¡ršg
 = 
	`EncodeBa£58Check
(
decoded
);

35 
	`as£¹
(
’coded_¡ršg
 =ğ
	`TrimSŒšg
(encoded_string));

36 
	`as£¹
(
	`ToLow”
(
’coded_¡ršg
è=ğToLow”(
	`TrimSŒšg
(
¿ndom_’coded_¡ršg
)));

39 autØ
»suÉ
 = 
	`DecodeBa£32
(
¿ndom_’coded_¡ršg
);

40 ià(
»suÉ
) {

41 cÚ¡ 
¡d
::
¡ršg
 
’coded_¡ršg
 = 
	`EncodeBa£32
(*
»suÉ
);

42 
	`as£¹
(
’coded_¡ršg
 =ğ
	`TrimSŒšgV›w
(encoded_string));

43 
	`as£¹
(
	`ToLow”
(
’coded_¡ršg
è=ğToLow”(
	`TrimSŒšg
(
¿ndom_’coded_¡ršg
)));

46 
»suÉ
 = 
	`DecodeBa£64
(
¿ndom_’coded_¡ršg
);

47 ià(
»suÉ
) {

48 cÚ¡ 
¡d
::
¡ršg
 
’coded_¡ršg
 = 
	`EncodeBa£64
(*
»suÉ
);

49 
	`as£¹
(
’coded_¡ršg
 =ğ
	`TrimSŒšg
(encoded_string));

50 
	`as£¹
(
	`ToLow”
(
’coded_¡ršg
è=ğToLow”(
	`TrimSŒšg
(
¿ndom_’coded_¡ršg
)));

53 
P¬tŸÎySigÃdT¿n§ùiÚ
 
psbt
;

54 
¡d
::
¡ršg
 
”rÜ
;

55 ()
	`DecodeBa£64PSBT
(
psbt
, 
¿ndom_’coded_¡ršg
, 
”rÜ
);

56 
	}
}

	@bech32.cpp

5 
	~<bech32.h
>

6 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<‹¡/ut/¡r.h
>

8 
	~<ut/¡»ncodšgs.h
>

10 
	~<ÿs£¹
>

11 
	~<c¡dšt
>

12 
	~<¡ršg
>

13 
	~<ut™y
>

14 
	~<veùÜ
>

16 
	$FUZZ_TARGET
(
bech32
)

18 cÚ¡ 
¡d
::
¡ršg
 
	`¿ndom_¡ršg
(
bufãr
.
	`begš
(), bufãr.
	`’d
());

19 cÚ¡‡utØ
r1
 = 
bech32
::
	`Decode
(
¿ndom_¡ršg
);

20 ià(
r1
.
h½
.
	`em±y
()) {

21 
	`as£¹
(
r1
.
’codšg
 =ğ
bech32
::
Encodšg
::
INVALID
);

22 
	`as£¹
(
r1
.
d©a
.
	`em±y
());

24 
	`as£¹
(
r1
.
’codšg
 !ğ
bech32
::
Encodšg
::
INVALID
);

25 cÚ¡ 
¡d
::
¡ršg
 
»’coded
 = 
bech32
::
	`Encode
(
r1
.
’codšg
,„1.
h½
,„1.
d©a
);

26 
	`as£¹
(
	`Ca£In£ns™iveEqu®
(
¿ndom_¡ršg
, 
»’coded
));

29 
¡d
::
veùÜ
<> 
šput
;

30 
CÚv”tB™s
<8, 5, 
Œue
>([&](
c
è{ 
šput
.
	`push_back
(c); }, 
bufãr
.
	`begš
(), bufãr.
	`’d
());

32 ià(
šput
.
	`size
() + 3 + 6 <= 90) {

34 autØ
’codšg
 : {
bech32
::
Encodšg
::
BECH32
, bech32::Encodšg::
BECH32M
}) {

35 cÚ¡ 
¡d
::
¡ršg
 
’coded
 = 
bech32
::
	`Encode
(
’codšg
, "bc", 
šput
);

36 
	`as£¹
(!
’coded
.
	`em±y
());

37 cÚ¡‡utØ
r2
 = 
bech32
::
	`Decode
(
’coded
);

38 
	`as£¹
(
r2
.
’codšg
 ==ƒncoding);

39 
	`as£¹
(
r2
.
h½
 == "bc");

40 
	`as£¹
(
r2
.
d©a
 =ğ
šput
);

43 
	}
}

	@bitdeque.cpp

5 
	~<¿ndom.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/ut.h
>

8 
	~<ut/b™deque.h
>

10 
	~<deque
>

11 
	~<veùÜ
>

13 
	gÇme¥aû
 {

15 
cÚ¡ex´
 
	gLEN_BITS
 = 16;

16 
cÚ¡ex´
 
	gRANDDATA_BITS
 = 20;

18 
usšg
 
	gb™deque_ty³
 = 
b™deque
<128>;

21 
	g¡d
::
veùÜ
<
boŞ
> 
RANDDATA
;

23 
In™RªdD©a
()

25 
Fa¡RªdomCÚ‹xt
 
ùx
(
Œue
);

26 
	gRANDDATA
.
ş—r
();

27 
size_t
 
	gi
 = 0; i < (1U << 
	gRANDDATA_BITS
è+ (1U << 
	gLEN_BITS
); ++i) {

28 
	gRANDDATA
.
push_back
(
ùx
.
¿ndboŞ
());

34 
	$FUZZ_TARGET_INIT
(
b™deque
, 
In™RªdD©a
)

36 
FuzzedD©aProvid”
 
	`´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

37 
Fa¡RªdomCÚ‹xt
 
	`ùx
(
Œue
);

39 
size_t
 
maxËn
 = (1U << 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
LEN_BITS
)) - 1;

40 
size_t
 
lim™Ën
 = 4 * 
maxËn
;

42 
¡d
::
deque
<
boŞ
> 
deq
;

43 
b™deque_ty³
 
b™deq
;

45 cÚ¡‡uto& 
cdeq
 = 
deq
;

46 cÚ¡‡uto& 
cb™deq
 = 
b™deq
;

48 
size_t
 
š™Ën
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
maxËn
);

49 
š™Ën
) {

50 
boŞ
 
v®
 = 
ùx
.
	`¿ndboŞ
();

51 
deq
.
	`push_back
(
v®
);

52 
b™deq
.
	`push_back
(
v®
);

53 --
š™Ën
;

56 
	`LIMITED_WHILE
(
´ovid”
.
	`»maššg_by‹s
() > 0, 900)

59 
	`as£¹
(
deq
.
	`size
(è=ğ
b™deq
.size());

60 autØ
™
 = 
deq
.
	`begš
();

61 autØ
b™™
 = 
b™deq
.
	`begš
();

62 autØ
™’d
 = 
deq
.
	`’d
();

63 
™
 !ğ
™’d
) {

64 
	`as£¹
(*
™
 =ğ*
b™™
);

65 ++
™
;

66 ++
b™™
;

70 
	`C®lOÃOf
(
´ovid”
,

73 
deq
 = 
¡d
::
deque
<
boŞ
>{};

74 
b™deq
 = 
b™deque_ty³
{};

78 
deq
.
	`ş—r
();

79 
b™deq
.
	`ş—r
();

83 autØ
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
maxËn
);

84 
deq
.
	`»size
(
couÁ
);

85 
b™deq
.
	`»size
(
couÁ
);

89 autØ
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
maxËn
);

90 
boŞ
 
v®
 = 
ùx
.
	`¿ndboŞ
();

91 
deq
.
	`assign
(
couÁ
, 
v®
);

92 
b™deq
.
	`assign
(
couÁ
, 
v®
);

96 autØ
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
maxËn
);

97 
boŞ
 
v®
 = 
ùx
.
	`¿ndboŞ
();

98 
deq
 = 
¡d
::
deque
<
boŞ
>(
couÁ
, 
v®
);

99 
b™deq
 = 
	`b™deque_ty³
(
couÁ
, 
v®
);

103 autØ
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
maxËn
);

104 
deq
 = 
¡d
::
deque
<
boŞ
>(
couÁ
);

105 
b™deq
 = 
	`b™deque_ty³
(
couÁ
);

109 autØ
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
maxËn
);

110 autØ
¿nd_begš
 = 
RANDDATA
.
	`begš
(è+ 
ùx
.
	`¿ndb™s
(
RANDDATA_BITS
);

111 autØ
¿nd_’d
 = 
¿nd_begš
 + 
couÁ
;

112 
deq
 = 
¡d
::
deque
<
boŞ
>(
¿nd_begš
, 
¿nd_’d
);

113 
b™deq
 = 
	`b™deque_ty³
(
¿nd_begš
, 
¿nd_’d
);

117 autØ
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
maxËn
);

118 autØ
¿nd_begš
 = 
RANDDATA
.
	`begš
(è+ 
ùx
.
	`¿ndb™s
(
RANDDATA_BITS
);

119 autØ
¿nd_’d
 = 
¿nd_begš
 + 
couÁ
;

120 
deq
.
	`assign
(
¿nd_begš
, 
¿nd_’d
);

121 
b™deq
.
	`assign
(
¿nd_begš
, 
¿nd_’d
);

125 
¡d
::
š™Ÿliz”_li¡
<
boŞ
> 
i¡
{
ùx
.
	`¿ndboŞ
(), ctx.randbool(), ctx.randbool(), ctx.randbool(), ctx.randbool()};

126 
deq
 = 
¡d
::
deque
<
boŞ
>(
i¡
);

127 
b™deq
 = 
	`b™deque_ty³
(
i¡
);

131 
¡d
::
š™Ÿliz”_li¡
<
boŞ
> 
i¡
{
ùx
.
	`¿ndboŞ
(), ctx.randbool(), ctx.randbool()};

132 
deq
.
	`assign
(
i¡
);

133 
b™deq
.
	`assign
(
i¡
);

137 autØ
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
maxËn
);

138 
boŞ
 
v®
 = 
ùx
.
	`¿ndboŞ
();

139 cÚ¡ 
¡d
::
deque
<
boŞ
> 
	`deq2
(
couÁ
, 
v®
);

140 
deq
 = 
deq2
;

141 cÚ¡ 
b™deque_ty³
 
	`b™deq2
(
couÁ
, 
v®
);

142 
b™deq
 = 
b™deq2
;

146 autØ
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
maxËn
);

147 
boŞ
 
v®
 = 
ùx
.
	`¿ndboŞ
();

148 
¡d
::
deque
<
boŞ
> 
	`deq2
(
couÁ
, 
v®
);

149 
deq
 = 
¡d
::
	`move
(
deq2
);

150 
b™deque_ty³
 
	`b™deq2
(
couÁ
, 
v®
);

151 
b™deq
 = 
¡d
::
	`move
(
b™deq2
);

155 autØ
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
maxËn
);

156 autØ
¿nd_begš
 = 
RANDDATA
.
	`begš
(è+ 
ùx
.
	`¿ndb™s
(
RANDDATA_BITS
);

157 autØ
¿nd_’d
 = 
¿nd_begš
 + 
couÁ
;

158 
¡d
::
deque
<
boŞ
> 
	`deq2
(
¿nd_begš
, 
¿nd_’d
);

159 
b™deque_ty³
 
	`b™deq2
(
¿nd_begš
, 
¿nd_’d
);

160 
usšg
 
¡d
::
sw­
;

161 
	`as£¹
(
deq
.
	`size
(è=ğ
b™deq
.size());

162 
	`as£¹
(
deq2
.
	`size
(è=ğ
b™deq2
.size());

163 
	`sw­
(
deq
, 
deq2
);

164 
	`sw­
(
b™deq
, 
b™deq2
);

165 
	`as£¹
(
deq
.
	`size
(è=ğ
b™deq
.size());

166 
	`as£¹
(
deq2
.
	`size
(è=ğ
b™deq2
.size());

170 autØ
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
maxËn
);

171 autØ
¿nd_begš
 = 
RANDDATA
.
	`begš
(è+ 
ùx
.
	`¿ndb™s
(
RANDDATA_BITS
);

172 autØ
¿nd_’d
 = 
¿nd_begš
 + 
couÁ
;

173 
¡d
::
deque
<
boŞ
> 
	`deq2
(
¿nd_begš
, 
¿nd_’d
);

174 
b™deque_ty³
 
	`b™deq2
(
¿nd_begš
, 
¿nd_’d
);

175 
	`as£¹
(
deq
.
	`size
(è=ğ
b™deq
.size());

176 
	`as£¹
(
deq2
.
	`size
(è=ğ
b™deq2
.size());

177 
deq
.
	`sw­
(
deq2
);

178 
b™deq
.
	`sw­
(
b™deq2
);

179 
	`as£¹
(
deq
.
	`size
(è=ğ
b™deq
.size());

180 
	`as£¹
(
deq2
.
	`size
(è=ğ
b™deq2
.size());

184 
¡d
::
š™Ÿliz”_li¡
<
boŞ
> 
i¡
{
ùx
.
	`¿ndboŞ
(), ctx.randbool(), ctx.randbool()};

185 
deq
 = 
i¡
;

186 
b™deq
 = 
i¡
;

190 autØ
pos1
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 
cdeq
.
	`size
());

191 autØ
pos2
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 
cdeq
.
	`size
());

192 autØ
™
 = 
deq
.
	`begš
(è+ 
pos1
;

193 autØ
b™™
 = 
b™deq
.
	`begš
(è+ 
pos1
;

194 ià((
size_t
)
pos1
 !ğ
cdeq
.
	`size
()è
	`as£¹
(*
™
 =ğ*
b™™
);

195 
	`as£¹
(
™
 - 
deq
.
	`begš
(è=ğ
pos1
);

196 
	`as£¹
(
b™™
 - 
b™deq
.
	`begš
(è=ğ
pos1
);

197 ià(
´ovid”
.
	`CÚsumeBoŞ
()) {

198 
™
 +ğ
pos2
 - 
pos1
;

199 
b™™
 +ğ
pos2
 - 
pos1
;

201 
™
 -ğ
pos1
 - 
pos2
;

202 
b™™
 -ğ
pos1
 - 
pos2
;

204 ià((
size_t
)
pos2
 !ğ
cdeq
.
	`size
()è
	`as£¹
(*
™
 =ğ*
b™™
);

205 
	`as£¹
(
deq
.
	`’d
(è- 
™
 =ğ
b™deq
.’d(è- 
b™™
);

206 ià(
´ovid”
.
	`CÚsumeBoŞ
()) {

207 ià((
size_t
)
pos2
 !ğ
cdeq
.
	`size
()) {

208 ++
™
;

209 ++
b™™
;

212 ià(
pos2
 != 0) {

213 --
™
;

214 --
b™™
;

217 
	`as£¹
(
deq
.
	`’d
(è- 
™
 =ğ
b™deq
.’d(è- 
b™™
);

221 
	`as£¹
(
deq
.
	`’d
(è- deq.
	`begš
(è=ğ
b™deq
.end() - bitdeq.begin());

225 
	`as£¹
(
cdeq
.
	`’d
(è- cdeq.
	`begš
(è=ğ
cb™deq
.end() - cbitdeq.begin());

229 
	`as£¹
(
deq
.
	`»nd
(è- deq.
	`rbegš
(è=ğ
b™deq
.rend() - bitdeq.rbegin());

233 
	`as£¹
(
cdeq
.
	`»nd
(è- cdeq.
	`rbegš
(è=ğ
cb™deq
.rend() - cbitdeq.rbegin());

237 
	`as£¹
(
cdeq
.
	`ûnd
(è- cdeq.
	`cbegš
(è=ğ
cb™deq
.cend() - cbitdeq.cbegin());

241 
	`as£¹
(
cdeq
.
	`ü’d
(è- cdeq.
	`übegš
(è=ğ
cb™deq
.crend() - cbitdeq.crbegin());

245 
	`as£¹
(
cdeq
.
	`size
(è=ğ
cb™deq
.size());

246 
	`as£¹
(
cb™deq
.
	`size
(è<ğcb™deq.
	`max_size
());

250 
	`as£¹
(
cdeq
.
	`em±y
(è=ğ
cb™deq
.empty());

254 ià(!
cdeq
.
	`em±y
()) {

255 
size_t
 
pos
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
() - 1);

256 auto& 
»f
 = 
deq
.
	`©
(
pos
);

257 autØ
b™»f
 = 
b™deq
.
	`©
(
pos
);

258 
	`as£¹
(
»f
 =ğ
b™»f
);

259 ià(
ùx
.
	`¿ndboŞ
()) {

260 
»f
 = !ref;

261 
b™»f
.
	`æ
();

267 
size_t
 
pos
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
(è+ 
maxËn
);

268 
boŞ
 
Ãwv®
 = 
ùx
.
	`¿ndboŞ
();

269 
boŞ
 
throw_deq
{
çl£
}, 
throw_b™deq
{false};

270 
boŞ
 
v®_deq
{
çl£
}, 
v®_b™deq
{false};

271 
Œy
 {

272 auto& 
»f
 = 
deq
.
	`©
(
pos
);

273 
v®_deq
 = 
»f
;

274 
»f
 = 
Ãwv®
;

275 } 
	`ÿtch
 (cÚ¡ 
¡d
::
out_of_¿nge
&) {

276 
throw_deq
 = 
Œue
;

278 
Œy
 {

279 autØ
»f
 = 
b™deq
.
	`©
(
pos
);

280 
v®_b™deq
 = 
»f
;

281 
»f
 = 
Ãwv®
;

282 } 
	`ÿtch
 (cÚ¡ 
¡d
::
out_of_¿nge
&) {

283 
throw_b™deq
 = 
Œue
;

285 
	`as£¹
(
throw_deq
 =ğ
throw_b™deq
);

286 
	`as£¹
(
throw_b™deq
 =ğ(
pos
 >ğ
cdeq
.
	`size
()));

287 ià(!
throw_deq
è
	`as£¹
(
v®_deq
 =ğ
v®_b™deq
);

291 
size_t
 
pos
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
(è+ 
maxËn
);

292 
boŞ
 
throw_deq
{
çl£
}, 
throw_b™deq
{false};

293 
boŞ
 
v®_deq
{
çl£
}, 
v®_b™deq
{false};

294 
Œy
 {

295 auto& 
»f
 = 
cdeq
.
	`©
(
pos
);

296 
v®_deq
 = 
»f
;

297 } 
	`ÿtch
 (cÚ¡ 
¡d
::
out_of_¿nge
&) {

298 
throw_deq
 = 
Œue
;

300 
Œy
 {

301 autØ
»f
 = 
cb™deq
.
	`©
(
pos
);

302 
v®_b™deq
 = 
»f
;

303 } 
	`ÿtch
 (cÚ¡ 
¡d
::
out_of_¿nge
&) {

304 
throw_b™deq
 = 
Œue
;

306 
	`as£¹
(
throw_deq
 =ğ
throw_b™deq
);

307 
	`as£¹
(
throw_b™deq
 =ğ(
pos
 >ğ
cdeq
.
	`size
()));

308 ià(!
throw_deq
è
	`as£¹
(
v®_deq
 =ğ
v®_b™deq
);

312 ià(!
cdeq
.
	`em±y
()) {

313 
size_t
 
pos
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
() - 1);

314 
	`as£¹
(
deq
[
pos
] =ğ
b™deq
[pos]);

315 ià(
ùx
.
	`¿ndboŞ
()) {

316 
deq
[
pos
] = !deq[pos];

317 
b™deq
[
pos
].
	`æ
();

323 ià(!
cdeq
.
	`em±y
()) {

324 
size_t
 
pos
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
() - 1);

325 
	`as£¹
(
deq
[
pos
] =ğ
b™deq
[pos]);

330 ià(!
cdeq
.
	`em±y
()) {

331 auto& 
»f
 = 
deq
.
	`äÚt
();

332 autØ
b™»f
 = 
b™deq
.
	`äÚt
();

333 
	`as£¹
(
»f
 =ğ
b™»f
);

334 ià(
ùx
.
	`¿ndboŞ
()) {

335 
»f
 = !ref;

336 
b™»f
 = !bitref;

342 ià(!
cdeq
.
	`em±y
()) {

343 auto& 
»f
 = 
cdeq
.
	`äÚt
();

344 autØ
b™»f
 = 
cb™deq
.
	`äÚt
();

345 
	`as£¹
(
»f
 =ğ
b™»f
);

350 ià(!
cdeq
.
	`em±y
()) {

351 auto& 
»f
 = 
deq
.
	`back
();

352 autØ
b™»f
 = 
b™deq
.
	`back
();

353 
	`as£¹
(
»f
 =ğ
b™»f
);

354 ià(
ùx
.
	`¿ndboŞ
()) {

355 
»f
 = !ref;

356 
b™»f
.
	`æ
();

362 ià(!
cdeq
.
	`em±y
()) {

363 cÚ¡‡uto& 
cdeq
 = 
deq
;

364 cÚ¡‡uto& 
cb™deq
 = 
b™deq
;

365 auto& 
»f
 = 
cdeq
.
	`back
();

366 autØ
b™»f
 = 
cb™deq
.
	`back
();

367 
	`as£¹
(
»f
 =ğ
b™»f
);

372 ià(
cdeq
.
	`size
(è< 
lim™Ën
) {

373 
boŞ
 
v®
 = 
ùx
.
	`¿ndboŞ
();

374 ià(
cdeq
.
	`em±y
()) {

375 
deq
.
	`push_back
(
v®
);

376 
b™deq
.
	`push_back
(
v®
);

378 
size_t
 
pos
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
() - 1);

379 auto& 
»f
 = 
deq
[
pos
];

380 autØ
b™»f
 = 
b™deq
[
pos
];

381 
	`as£¹
(
»f
 =ğ
b™»f
);

382 
deq
.
	`push_back
(
v®
);

383 
b™deq
.
	`push_back
(
v®
);

384 
	`as£¹
(
»f
 =ğ
b™»f
);

390 ià(
cdeq
.
	`size
(è< 
lim™Ën
) {

391 
boŞ
 
v®
 = 
ùx
.
	`¿ndboŞ
();

392 ià(
cdeq
.
	`em±y
()) {

393 
deq
.
	`push_äÚt
(
v®
);

394 
b™deq
.
	`push_äÚt
(
v®
);

396 
size_t
 
pos
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
() - 1);

397 auto& 
»f
 = 
deq
[
pos
];

398 autØ
b™»f
 = 
b™deq
[
pos
];

399 
	`as£¹
(
»f
 =ğ
b™»f
);

400 
deq
.
	`push_äÚt
(
v®
);

401 
b™deq
.
	`push_äÚt
(
v®
);

402 
	`as£¹
(
»f
 =ğ
b™»f
);

408 ià(!
cdeq
.
	`em±y
()) {

409 ià(
cdeq
.
	`size
() == 1) {

410 
deq
.
	`pİ_back
();

411 
b™deq
.
	`pİ_back
();

413 
size_t
 
pos
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
() - 2);

414 auto& 
»f
 = 
deq
[
pos
];

415 autØ
b™»f
 = 
b™deq
[
pos
];

416 
	`as£¹
(
»f
 =ğ
b™»f
);

417 
deq
.
	`pİ_back
();

418 
b™deq
.
	`pİ_back
();

419 
	`as£¹
(
»f
 =ğ
b™»f
);

425 ià(!
cdeq
.
	`em±y
()) {

426 ià(
cdeq
.
	`size
() == 1) {

427 
deq
.
	`pİ_äÚt
();

428 
b™deq
.
	`pİ_äÚt
();

430 
size_t
 
pos
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(1, 
cdeq
.
	`size
() - 1);

431 auto& 
»f
 = 
deq
[
pos
];

432 autØ
b™»f
 = 
b™deq
[
pos
];

433 
	`as£¹
(
»f
 =ğ
b™»f
);

434 
deq
.
	`pİ_äÚt
();

435 
b™deq
.
	`pİ_äÚt
();

436 
	`as£¹
(
»f
 =ğ
b™»f
);

442 ià(!
cdeq
.
	`em±y
()) {

443 
size_t
 
befÜe
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
() - 1);

444 
size_t
 
aá”
 = 
cdeq
.
	`size
(è- 1 - 
befÜe
;

445 autØ
™
 = 
deq
.
	`”a£
(
cdeq
.
	`begš
(è+ 
befÜe
);

446 autØ
b™™
 = 
b™deq
.
	`”a£
(
cb™deq
.
	`begš
(è+ 
befÜe
);

447 
	`as£¹
(
™
 =ğ
cdeq
.
	`begš
(è+ 
befÜe
 && iˆ=ğcdeq.
	`’d
(è- 
aá”
);

448 
	`as£¹
(
b™™
 =ğ
cb™deq
.
	`begš
(è+ 
befÜe
 && b™™ =ğcb™deq.
	`’d
(è- 
aá”
);

453 
size_t
 
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
());

454 autØ
™
 = 
deq
.
	`”a£
(
cdeq
.
	`begš
(), cdeq.begš(è+ 
couÁ
);

455 autØ
b™™
 = 
b™deq
.
	`”a£
(
cb™deq
.
	`begš
(), cb™deq.begš(è+ 
couÁ
);

456 
	`as£¹
(
™
 =ğ
deq
.
	`begš
());

457 
	`as£¹
(
b™™
 =ğ
b™deq
.
	`begš
());

461 
size_t
 
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
());

462 autØ
™
 = 
deq
.
	`”a£
(
cdeq
.
	`’d
(è- 
couÁ
, cdeq.end());

463 autØ
b™™
 = 
b™deq
.
	`”a£
(
cb™deq
.
	`’d
(è- 
couÁ
, cbitdeq.end());

464 
	`as£¹
(
™
 =ğ
deq
.
	`’d
());

465 
	`as£¹
(
b™™
 =ğ
b™deq
.
	`’d
());

469 
size_t
 
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
());

470 
size_t
 
befÜe
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
(è- 
couÁ
);

471 
size_t
 
aá”
 = 
cdeq
.
	`size
(è- 
couÁ
 - 
befÜe
;

472 autØ
™
 = 
deq
.
	`”a£
(
cdeq
.
	`begš
(è+ 
befÜe
, cdeq.
	`’d
(è- 
aá”
);

473 autØ
b™™
 = 
b™deq
.
	`”a£
(
cb™deq
.
	`begš
(è+ 
befÜe
, cb™deq.
	`’d
(è- 
aá”
);

474 
	`as£¹
(
™
 =ğ
cdeq
.
	`begš
(è+ 
befÜe
 && iˆ=ğcdeq.
	`’d
(è- 
aá”
);

475 
	`as£¹
(
b™™
 =ğ
cb™deq
.
	`begš
(è+ 
befÜe
 && b™™ =ğcb™deq.
	`’d
(è- 
aá”
);

479 ià(
cdeq
.
	`size
(è< 
lim™Ën
) {

480 
size_t
 
befÜe
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
());

481 
boŞ
 
v®
 = 
ùx
.
	`¿ndboŞ
();

482 
boŞ
 
do_em¶aû
 = 
´ovid”
.
	`CÚsumeBoŞ
();

483 autØ
™
 = 
deq
.
	`š£¹
(
cdeq
.
	`begš
(è+ 
befÜe
, 
v®
);

484 autØ
b™™
 = 
do_em¶aû
 ? 
b™deq
.
	`em¶aû
(
cb™deq
.
	`begš
(è+ 
befÜe
, 
v®
)

485 : 
b™deq
.
	`š£¹
(
cb™deq
.
	`begš
(è+ 
befÜe
, 
v®
);

486 
	`as£¹
(
™
 =ğ
deq
.
	`begš
(è+ 
befÜe
);

487 
	`as£¹
(
b™™
 =ğ
b™deq
.
	`begš
(è+ 
befÜe
);

492 ià(
cdeq
.
	`size
(è< 
lim™Ën
) {

493 
size_t
 
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
maxËn
);

494 autØ
¿nd_begš
 = 
RANDDATA
.
	`begš
(è+ 
ùx
.
	`¿ndb™s
(
RANDDATA_BITS
);

495 autØ
¿nd_’d
 = 
¿nd_begš
 + 
couÁ
;

496 autØ
™
 = 
deq
.
	`š£¹
(
cdeq
.
	`begš
(), 
¿nd_begš
, 
¿nd_’d
);

497 autØ
b™™
 = 
b™deq
.
	`š£¹
(
cb™deq
.
	`begš
(), 
¿nd_begš
, 
¿nd_’d
);

498 
	`as£¹
(
™
 =ğ
cdeq
.
	`begš
());

499 
	`as£¹
(
b™™
 =ğ
cb™deq
.
	`begš
());

504 ià(
cdeq
.
	`size
(è< 
lim™Ën
) {

505 
size_t
 
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
maxËn
);

506 autØ
¿nd_begš
 = 
RANDDATA
.
	`begš
(è+ 
ùx
.
	`¿ndb™s
(
RANDDATA_BITS
);

507 autØ
¿nd_’d
 = 
¿nd_begš
 + 
couÁ
;

508 autØ
™
 = 
deq
.
	`š£¹
(
cdeq
.
	`’d
(), 
¿nd_begš
, 
¿nd_’d
);

509 autØ
b™™
 = 
b™deq
.
	`š£¹
(
cb™deq
.
	`’d
(), 
¿nd_begš
, 
¿nd_’d
);

510 
	`as£¹
(
™
 =ğ
cdeq
.
	`’d
(è- 
couÁ
);

511 
	`as£¹
(
b™™
 =ğ
cb™deq
.
	`’d
(è- 
couÁ
);

516 ià(
cdeq
.
	`size
(è< 
lim™Ën
) {

517 
size_t
 
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
maxËn
);

518 
size_t
 
befÜe
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
());

519 
boŞ
 
v®
 = 
ùx
.
	`¿ndboŞ
();

520 autØ
™
 = 
deq
.
	`š£¹
(
cdeq
.
	`begš
(è+ 
befÜe
, 
couÁ
, 
v®
);

521 autØ
b™™
 = 
b™deq
.
	`š£¹
(
cb™deq
.
	`begš
(è+ 
befÜe
, 
couÁ
, 
v®
);

522 
	`as£¹
(
™
 =ğ
deq
.
	`begš
(è+ 
befÜe
);

523 
	`as£¹
(
b™™
 =ğ
b™deq
.
	`begš
(è+ 
befÜe
);

528 ià(
cdeq
.
	`size
(è< 
lim™Ën
) {

529 
size_t
 
couÁ
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
maxËn
);

530 
size_t
 
befÜe
 = 
´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
cdeq
.
	`size
());

531 autØ
¿nd_begš
 = 
RANDDATA
.
	`begš
(è+ 
ùx
.
	`¿ndb™s
(
RANDDATA_BITS
);

532 autØ
¿nd_’d
 = 
¿nd_begš
 + 
couÁ
;

533 autØ
™
 = 
deq
.
	`š£¹
(
cdeq
.
	`begš
(è+ 
befÜe
, 
¿nd_begš
, 
¿nd_’d
);

534 autØ
b™™
 = 
b™deq
.
	`š£¹
(
cb™deq
.
	`begš
(è+ 
befÜe
, 
¿nd_begš
, 
¿nd_’d
);

535 
	`as£¹
(
™
 =ğ
deq
.
	`begš
(è+ 
befÜe
);

536 
	`as£¹
(
b™™
 =ğ
b™deq
.
	`begš
(è+ 
befÜe
);

541 
	}
}

	@block.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<cÚ£nsus/m”kË.h
>

7 
	~<cÚ£nsus/v®id©iÚ.h
>

8 
	~<cÜe_io.h
>

9 
	~<cÜe_memu§ge.h
>

10 
	~<´im™ives/block.h
>

11 
	~<pubkey.h
>

12 
	~<¡»ams.h
>

13 
	~<‹¡/fuzz/fuzz.h
>

14 
	~<v®id©iÚ.h
>

15 
	~<v”siÚ.h
>

17 
	~<ÿs£¹
>

18 
	~<¡ršg
>

20 
	$š™Ÿlize_block
()

22 cÚ¡ 
ECCV”ifyHªdË
 
v”ify_hªdË
;

23 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
REGTEST
);

24 
	}
}

26 
	$FUZZ_TARGET_INIT
(
block
, 
š™Ÿlize_block
)

28 
CD©aSŒ—m
 
	`ds
(
bufãr
, 
SER_NETWORK
, 
INIT_PROTO_VERSION
);

29 
CBlock
 
block
;

30 
Œy
 {

31 
nV”siÚ
;

32 
ds
 >> 
nV”siÚ
;

33 
ds
.
	`S‘V”siÚ
(
nV”siÚ
);

34 
ds
 >> 
block
;

35 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

38 cÚ¡ 
CÚ£nsus
::
P¬ams
& 
cÚ£nsus_·¿ms
 = 
	`P¬ams
().
	`G‘CÚ£nsus
();

39 
BlockV®id©iÚS‹
 
v®id©iÚ_¡©e_pow_ªd_m”kË
;

40 cÚ¡ 
boŞ
 
v®id_šş_pow_ªd_m”kË
 = 
	`CheckBlock
(
block
, 
v®id©iÚ_¡©e_pow_ªd_m”kË
, 
cÚ£nsus_·¿ms
, 
Œue
,rue);

41 
	`as£¹
(
v®id©iÚ_¡©e_pow_ªd_m”kË
.
	`IsV®id
(è|| v®id©iÚ_¡©e_pow_ªd_m”kË.
	`IsInv®id
(è|| v®id©iÚ_¡©e_pow_ªd_m”kË.
	`IsE¼Ü
());

42 ()
v®id©iÚ_¡©e_pow_ªd_m”kË
.
	`E¼Ü
("");

43 
BlockV®id©iÚS‹
 
v®id©iÚ_¡©e_pow
;

44 cÚ¡ 
boŞ
 
v®id_šş_pow
 = 
	`CheckBlock
(
block
, 
v®id©iÚ_¡©e_pow
, 
cÚ£nsus_·¿ms
, 
Œue
, 
çl£
);

45 
	`as£¹
(
v®id©iÚ_¡©e_pow
.
	`IsV®id
(è|| v®id©iÚ_¡©e_pow.
	`IsInv®id
(è|| v®id©iÚ_¡©e_pow.
	`IsE¼Ü
());

46 
BlockV®id©iÚS‹
 
v®id©iÚ_¡©e_m”kË
;

47 cÚ¡ 
boŞ
 
v®id_šş_m”kË
 = 
	`CheckBlock
(
block
, 
v®id©iÚ_¡©e_m”kË
, 
cÚ£nsus_·¿ms
, 
çl£
, 
Œue
);

48 
	`as£¹
(
v®id©iÚ_¡©e_m”kË
.
	`IsV®id
(è|| v®id©iÚ_¡©e_m”kË.
	`IsInv®id
(è|| v®id©iÚ_¡©e_m”kË.
	`IsE¼Ü
());

49 
BlockV®id©iÚS‹
 
v®id©iÚ_¡©e_nÚe
;

50 cÚ¡ 
boŞ
 
v®id_šş_nÚe
 = 
	`CheckBlock
(
block
, 
v®id©iÚ_¡©e_nÚe
, 
cÚ£nsus_·¿ms
, 
çl£
, false);

51 
	`as£¹
(
v®id©iÚ_¡©e_nÚe
.
	`IsV®id
(è|| v®id©iÚ_¡©e_nÚe.
	`IsInv®id
(è|| v®id©iÚ_¡©e_nÚe.
	`IsE¼Ü
());

52 ià(
v®id_šş_pow_ªd_m”kË
) {

53 
	`as£¹
(
v®id_šş_pow
 && 
v®id_šş_m”kË
 && 
v®id_šş_nÚe
);

54 } ià(
v®id_šş_m”kË
 || 
v®id_šş_pow
) {

55 
	`as£¹
(
v®id_šş_nÚe
);

57 ()
block
.
	`G‘Hash
();

58 ()
block
.
	`ToSŒšg
();

59 ()
	`BlockM”kËRoÙ
(
block
);

60 ià(!
block
.
vtx
.
	`em±y
()) {

61 ()
	`BlockW™ÃssM”kËRoÙ
(
block
);

63 ()
	`G‘BlockWeight
(
block
);

64 ()
	`G‘W™ÃssComm™m’tIndex
(
block
);

65 cÚ¡ 
size_t
 
¿w_memÜy_size
 = 
	`RecursiveDyÇmicU§ge
(
block
);

66 cÚ¡ 
size_t
 
¿w_memÜy_size_as_sh¬ed_±r
 = 
	`RecursiveDyÇmicU§ge
(
¡d
::
make_sh¬ed
<
CBlock
>(
block
));

67 
	`as£¹
(
¿w_memÜy_size_as_sh¬ed_±r
 > 
¿w_memÜy_size
);

68 
CBlock
 
block_cİy
 = 
block
;

69 
block_cİy
.
	`S‘NuÎ
();

70 cÚ¡ 
boŞ
 
is_nuÎ
 = 
block_cİy
.
	`IsNuÎ
();

71 
	`as£¹
(
is_nuÎ
);

72 
	}
}

	@block_header.cpp

5 
	~<´im™ives/block.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

9 
	~<ušt256.h
>

11 
	~<ÿs£¹
>

12 
	~<c¡dšt
>

13 
	~<İtiÚ®
>

14 
	~<¡ršg
>

15 
	~<veùÜ
>

17 
	$FUZZ_TARGET
(
block_h—d”
)

19 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

20 cÚ¡ 
¡d
::
İtiÚ®
<
CBlockH—d”
> 
block_h—d”
 = 
CÚsumeDe£rŸlizabË
<CBlockH—d”>(
fuzzed_d©a_´ovid”
);

21 ià(!
block_h—d”
) {

25 cÚ¡ 
ušt256
 
hash
 = 
block_h—d”
->
	`G‘Hash
();

26 cÚ¡ 
ušt256
 
	`u256_max
(
	`ušt256S
("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"));

27 
	`as£¹
(
hash
 !ğ
u256_max
);

28 
	`as£¹
(
block_h—d”
->
	`G‘BlockTime
(è=ğblock_h—d”->
nTime
);

29 
	`as£¹
(
block_h—d”
->
	`IsNuÎ
(è=ğ(block_h—d”->
nB™s
 == 0));

32 
CBlockH—d”
 
mut_block_h—d”
 = *
block_h—d”
;

33 
mut_block_h—d”
.
	`S‘NuÎ
();

34 
	`as£¹
(
mut_block_h—d”
.
	`IsNuÎ
());

35 
CBlock
 
block
{*
block_h—d”
};

36 
	`as£¹
(
block
.
	`G‘BlockH—d”
().
	`G‘Hash
(è=ğ
block_h—d”
->GetHash());

37 ()
block
.
	`ToSŒšg
();

38 
block
.
	`S‘NuÎ
();

39 
	`as£¹
(
block
.
	`G‘BlockH—d”
().
	`G‘Hash
(è=ğ
mut_block_h—d”
.GetHash());

42 
¡d
::
İtiÚ®
<
CBlockLoÿtÜ
> 
block_loÿtÜ
 = 
CÚsumeDe£rŸlizabË
<CBlockLoÿtÜ>(
fuzzed_d©a_´ovid”
);

43 ià(
block_loÿtÜ
) {

44 ()
block_loÿtÜ
->
	`IsNuÎ
();

45 
block_loÿtÜ
->
	`S‘NuÎ
();

46 
	`as£¹
(
block_loÿtÜ
->
	`IsNuÎ
());

49 
	}
}

	@blockfilter.cpp

5 
	~<blockf‹r.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<c¡dšt
>

11 
	~<İtiÚ®
>

12 
	~<¡ršg
>

13 
	~<veùÜ
>

15 
	$FUZZ_TARGET
(
blockf‹r
)

17 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

18 cÚ¡ 
¡d
::
İtiÚ®
<
BlockF‹r
> 
block_f‹r
 = 
CÚsumeDe£rŸlizabË
<BlockF‹r>(
fuzzed_d©a_´ovid”
);

19 ià(!
block_f‹r
) {

23 ()
block_f‹r
->
	`Compu‹H—d”
(
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
));

24 ()
block_f‹r
->
	`G‘BlockHash
();

25 ()
block_f‹r
->
	`G‘EncodedF‹r
();

26 ()
block_f‹r
->
	`G‘Hash
();

29 cÚ¡ 
BlockF‹rTy³
 
block_f‹r_ty³
 = 
block_f‹r
->
	`G‘F‹rTy³
();

30 ()
	`BlockF‹rTy³Name
(
block_f‹r_ty³
);

33 cÚ¡ 
GCSF‹r
 
gcs_f‹r
 = 
block_f‹r
->
	`G‘F‹r
();

34 ()
gcs_f‹r
.
	`G‘N
();

35 ()
gcs_f‹r
.
	`G‘P¬ams
();

36 ()
gcs_f‹r
.
	`G‘Encoded
();

37 ()
gcs_f‹r
.
	`M©ch
(
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
));

38 
GCSF‹r
::
EËm’tS‘
 
–em’t_£t
;

39 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 30000)

41 
–em’t_£t
.
	`š£¹
(
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
));

43 
gcs_f‹r
.
	`M©chAny
(
–em’t_£t
);

45 
	}
}

	@bloom_filter.cpp

5 
	~<commÚ/bloom.h
>

6 
	~<´im™ives/Œª§ùiÚ.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<ušt256.h
>

12 
	~<ÿs£¹
>

13 
	~<c¡dšt
>

14 
	~<İtiÚ®
>

15 
	~<¡ršg
>

16 
	~<veùÜ
>

18 
	$FUZZ_TARGET
(
bloom_f‹r
)

20 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

22 
CBloomF‹r
 
bloom_f‹r
{

23 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(1, 10000000),

24 1.0 / 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(1, 
¡d
::
num”ic_lim™s
<>::
	`max
()),

25 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>(),

26 
¡©ic_ÿ¡
<>(
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
({
BLOOM_UPDATE_NONE
, 
BLOOM_UPDATE_ALL
, 
BLOOM_UPDATE_P2PUBKEY_ONLY
, 
BLOOM_UPDATE_MASK
}))};

27 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`»maššg_by‹s
() > 0, 10000) {

28 
	`C®lOÃOf
(

29 
fuzzed_d©a_´ovid”
,

31 cÚ¡ 
¡d
::
veùÜ
<> 
b
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

32 ()
bloom_f‹r
.
	`cÚšs
(
b
);

33 
bloom_f‹r
.
	`š£¹
(
b
);

34 cÚ¡ 
boŞ
 
´e£Á
 = 
bloom_f‹r
.
	`cÚšs
(
b
);

35 
	`as£¹
(
´e£Á
);

38 cÚ¡ 
¡d
::
İtiÚ®
<
COutPošt
> 
out_pošt
 = 
CÚsumeDe£rŸlizabË
<COutPošt>(
fuzzed_d©a_´ovid”
);

39 ià(!
out_pošt
) {

42 ()
bloom_f‹r
.
	`cÚšs
(*
out_pošt
);

43 
bloom_f‹r
.
	`š£¹
(*
out_pošt
);

44 cÚ¡ 
boŞ
 
´e£Á
 = 
bloom_f‹r
.
	`cÚšs
(*
out_pošt
);

45 
	`as£¹
(
´e£Á
);

48 cÚ¡ 
¡d
::
İtiÚ®
<
ušt256
> 
u256
 = 
CÚsumeDe£rŸlizabË
<ušt256>(
fuzzed_d©a_´ovid”
);

49 ià(!
u256
) {

52 ()
bloom_f‹r
.
	`cÚšs
(*
u256
);

53 
bloom_f‹r
.
	`š£¹
(*
u256
);

54 cÚ¡ 
boŞ
 
´e£Á
 = 
bloom_f‹r
.
	`cÚšs
(*
u256
);

55 
	`as£¹
(
´e£Á
);

58 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
mut_tx
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

59 ià(!
mut_tx
) {

62 cÚ¡ 
CT¿n§ùiÚ
 
tx
{*
mut_tx
};

63 ()
bloom_f‹r
.
	`IsR–evªtAndUpd©e
(
tx
);

65 ()
bloom_f‹r
.
	`IsW™hšSizeCÚ¡¿šts
();

67 
	}
}

	@buffered_file.cpp

5 
	~<¡»ams.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<¬¿y
>

11 
	~<c¡dšt
>

12 
	~<io¡»am
>

13 
	~<İtiÚ®
>

14 
	~<¡ršg
>

15 
	~<veùÜ
>

17 
	$FUZZ_TARGET
(
bufã»d_fe
)

19 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

20 
FuzzedFeProvid”
 
fuzzed_fe_´ovid”
 = 
	`CÚsumeFe
(
fuzzed_d©a_´ovid”
);

21 
¡d
::
İtiÚ®
<
CBufã»dFe
> 
İt_bufã»d_fe
;

22 
FILE
* 
fuzzed_fe
 = 
fuzzed_fe_´ovid”
.
	`İ’
();

23 
Œy
 {

24 
İt_bufã»d_fe
.
	`em¶aû
(
fuzzed_fe
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
ušt64_t
>(0, 4096), fuzzed_d©a_´ovid”.CÚsumeIÁeg¿lInRªge<ušt64_t>(0, 4096), fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿l
<>(), fuzzed_data_provider.ConsumeIntegral<>());

25 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

26 ià(
fuzzed_fe
 !ğ
nuÎ±r
) {

27 
	`fşo£
(
fuzzed_fe
);

30 ià(
İt_bufã»d_fe
 && 
fuzzed_fe
 !ğ
nuÎ±r
) {

31 
boŞ
 
£os_ç
 = 
çl£
;

32 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

33 
	`C®lOÃOf
(

34 
fuzzed_d©a_´ovid”
,

36 
¡d
::
¬¿y
<¡d::
by‹
, 4096> 
¬r
{};

37 
Œy
 {

38 
İt_bufã»d_fe
->
	`»ad
({
¬r
.
	`d©a
(), 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 4096)});

39 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

43 
İt_bufã»d_fe
->
	`S‘Lim™
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
ušt64_t
>(0, 4096));

46 ià(!
İt_bufã»d_fe
->
	`S‘Pos
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
ušt64_t
>(0, 4096))) {

47 
£os_ç
 = 
Œue
;

51 ià(
£os_ç
) {

55 
Œy
 {

56 
İt_bufã»d_fe
->
	`FšdBy‹
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt8_t
>());

57 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

61 
	`R—dFromSŒ—m
(
fuzzed_d©a_´ovid”
, *
İt_bufã»d_fe
);

64 
İt_bufã»d_fe
->
	`G‘Pos
();

65 
İt_bufã»d_fe
->
	`G‘Ty³
();

66 
İt_bufã»d_fe
->
	`G‘V”siÚ
();

68 
	}
}

	@chain.cpp

5 
	~<chaš.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<c¡dšt
>

11 
	~<İtiÚ®
>

12 
	~<veùÜ
>

14 
	$FUZZ_TARGET
(
chaš
)

16 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

17 
¡d
::
İtiÚ®
<
CDiskBlockIndex
> 
disk_block_šdex
 = 
CÚsumeDe£rŸlizabË
<CDiskBlockIndex>(
fuzzed_d©a_´ovid”
);

18 ià(!
disk_block_šdex
) {

22 cÚ¡ 
ušt256
 
z”o
{};

23 
disk_block_šdex
->
phashBlock
 = &
z”o
;

25 
	`LOCK
(::
cs_maš
);

26 ()
disk_block_šdex
->
	`CÚ¡ruùBlockHash
();

27 ()
disk_block_šdex
->
	`G‘BlockPos
();

28 ()
disk_block_šdex
->
	`G‘BlockTime
();

29 ()
disk_block_šdex
->
	`G‘BlockTimeMax
();

30 ()
disk_block_šdex
->
	`G‘MedŸnTimePa¡
();

31 ()
disk_block_šdex
->
	`G‘UndoPos
();

32 ()
disk_block_šdex
->
	`HaveTxsDowÆßded
();

33 ()
disk_block_šdex
->
	`IsV®id
();

36 cÚ¡ 
CBlockH—d”
 
block_h—d”
 = 
disk_block_šdex
->
	`G‘BlockH—d”
();

37 ()
CDiskBlockIndex
{*
disk_block_šdex
};

38 ()
disk_block_šdex
->
	`BudSk
();

40 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

41 cÚ¡ 
BlockStus
 
block_¡©us
 = 
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
({

42 
BlockStus
::
BLOCK_VALID_UNKNOWN
,

43 
BlockStus
::
BLOCK_VALID_RESERVED
,

44 
BlockStus
::
BLOCK_VALID_TREE
,

45 
BlockStus
::
BLOCK_VALID_TRANSACTIONS
,

46 
BlockStus
::
BLOCK_VALID_CHAIN
,

47 
BlockStus
::
BLOCK_VALID_SCRIPTS
,

48 
BlockStus
::
BLOCK_VALID_MASK
,

49 
BlockStus
::
BLOCK_HAVE_DATA
,

50 
BlockStus
::
BLOCK_HAVE_UNDO
,

51 
BlockStus
::
BLOCK_HAVE_MASK
,

52 
BlockStus
::
BLOCK_FAILED_VALID
,

53 
BlockStus
::
BLOCK_FAILED_CHILD
,

54 
BlockStus
::
BLOCK_FAILED_MASK
,

55 
BlockStus
::
BLOCK_OPT_WITNESS
,

57 ià(
block_¡©us
 & ~
BLOCK_VALID_MASK
) {

60 
	`WITH_LOCK
(::
cs_maš
, ()
disk_block_šdex
->
	`Rai£V®id™y
(
block_¡©us
));

63 
CBlockIndex
 
block_šdex
{
block_h—d”
};

64 
block_šdex
.
phashBlock
 = &
z”o
;

65 ()
block_šdex
.
	`G‘BlockHash
();

66 ()
block_šdex
.
	`ToSŒšg
();

67 
	}
}

	@checkqueue.cpp

5 
	~<checkqueue.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<c¡dšt
>

11 
	~<¡ršg
>

12 
	~<veùÜ
>

14 
	gÇme¥aû
 {

15 
	sDumbCheck
 {

16 cÚ¡ 
boŞ
 
	g»suÉ
 = 
çl£
;

18 
DumbCheck
() = ;

20 
ex¶ic™
 
DumbCheck
(cÚ¡ 
boŞ
 
_»suÉ
è: 
»suÉ
(_result)

24 
boŞ
 
İ”©Ü
()() const

26  
»suÉ
;

29 
sw­
(
DumbCheck
& 
x
è
	gnÛxû±


35 
	$FUZZ_TARGET
(
checkqueue
)

37 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

39 cÚ¡ 
b©ch_size
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 1024);

40 
CCheckQueue
<
DumbCheck
> 
check_queue_1
{
b©ch_size
};

41 
CCheckQueue
<
DumbCheck
> 
check_queue_2
{
b©ch_size
};

42 
¡d
::
veùÜ
<
DumbCheck
> 
checks_1
;

43 
¡d
::
veùÜ
<
DumbCheck
> 
checks_2
;

44 cÚ¡ 
size
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 1024);

45 
i
 = 0; i < 
size
; ++i) {

46 cÚ¡ 
boŞ
 
»suÉ
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

47 
checks_1
.
	`em¶aû_back
(
»suÉ
);

48 
checks_2
.
	`em¶aû_back
(
»suÉ
);

50 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

51 
check_queue_1
.
	`Add
(
checks_1
);

53 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

54 ()
check_queue_1
.
	`Wa™
();

57 
CCheckQueueCÚŒŞ
<
DumbCheck
> 
check_queue_cÚŒŞ
{&
check_queue_2
};

58 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

59 
check_queue_cÚŒŞ
.
	`Add
(
checks_2
);

61 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

62 ()
check_queue_cÚŒŞ
.
	`Wa™
();

64 
	}
}

	@coins_view.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<chaš·¿msba£.h
>

7 
	~<cošs.h
>

8 
	~<cÚ£nsus/amouÁ.h
>

9 
	~<cÚ£nsus/tx_check.h
>

10 
	~<cÚ£nsus/tx_v”ify.h
>

11 
	~<cÚ£nsus/v®id©iÚ.h
>

12 
	~<key.h
>

13 
	~<pŞicy/pŞicy.h
>

14 
	~<´im™ives/Œª§ùiÚ.h
>

15 
	~<pubkey.h
>

16 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

17 
	~<‹¡/fuzz/fuzz.h
>

18 
	~<‹¡/fuzz/ut.h
>

19 
	~<‹¡/ut/£tup_commÚ.h
>

20 
	~<v®id©iÚ.h
>

22 
	~<c¡dšt
>

23 
	~<lim™s
>

24 
	~<İtiÚ®
>

25 
	~<¡ršg
>

26 
	~<veùÜ
>

28 
	gÇme¥aû
 {

29 cÚ¡ 
Te¡šgS‘up
* 
	gg_£tup
;

30 cÚ¡ 
Coš
 
	gEMPTY_COIN
{};

32 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Coš
& 
a
, cÚ¡ 
	gCoš
& 
	gb
)

34 ià(
	ga
.
IsS³Á
(è&& 
	gb
.IsS³Á()è 
	gŒue
;

35  
	ga
.
	gfCošBa£
 =ğ
b
.
fCošBa£
 && 
a
.
nHeight
 =ğb.nHeighˆ&&‡.
out
 == b.out;

39 
	$š™Ÿlize_cošs_v›w
()

41 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<cÚ¡ 
Te¡šgS‘up
>();

42 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

43 
	}
}

45 
	$FUZZ_TARGET_INIT
(
cošs_v›w
, 
š™Ÿlize_cošs_v›w
)

47 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

48 
CCošsV›w
 
back’d_cošs_v›w
;

49 
CCošsV›wCache
 
cošs_v›w_ÿche
{&
back’d_cošs_v›w
};

50 
COutPošt
 
¿ndom_out_pošt
;

51 
Coš
 
¿ndom_coš
;

52 
CMubËT¿n§ùiÚ
 
¿ndom_mubË_Œª§ùiÚ
;

53 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

54 
	`C®lOÃOf
(

55 
fuzzed_d©a_´ovid”
,

57 ià(
¿ndom_coš
.
	`IsS³Á
()) {

60 
Coš
 
coš
 = 
¿ndom_coš
;

61 
boŞ
 
ex³ùed_code_·th
 = 
çl£
;

62 cÚ¡ 
boŞ
 
possibË_ov”wr™e
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

63 
Œy
 {

64 
cošs_v›w_ÿche
.
	`AddCoš
(
¿ndom_out_pošt
, 
¡d
::
	`move
(
coš
), 
possibË_ov”wr™e
);

65 
ex³ùed_code_·th
 = 
Œue
;

66 } 
	`ÿtch
 (cÚ¡ 
¡d
::
logic_”rÜ
& 
e
) {

67 ià(
e
.
	`wh©
(è=ğ
¡d
::
¡ršg
{"Attemptedo overwrite‡n unspent coin (when…ossible_overwrite is false)"}) {

68 
	`as£¹
(!
possibË_ov”wr™e
);

69 
ex³ùed_code_·th
 = 
Œue
;

72 
	`as£¹
(
ex³ùed_code_·th
);

75 ()
cošs_v›w_ÿche
.
	`Flush
();

78 
cošs_v›w_ÿche
.
	`S‘Be¡Block
(
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
));

81 
Coš
 
move_to
;

82 ()
cošs_v›w_ÿche
.
	`S³ndCoš
(
¿ndom_out_pošt
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è? &
move_to
 : 
nuÎ±r
);

85 
cošs_v›w_ÿche
.
	`Unÿche
(
¿ndom_out_pošt
);

88 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

89 
back’d_cošs_v›w
 = 
CCošsV›w
{};

91 
cošs_v›w_ÿche
.
	`S‘Back’d
(
back’d_cošs_v›w
);

94 cÚ¡ 
¡d
::
İtiÚ®
<
COutPošt
> 
İt_out_pošt
 = 
CÚsumeDe£rŸlizabË
<COutPošt>(
fuzzed_d©a_´ovid”
);

95 ià(!
İt_out_pošt
) {

98 
¿ndom_out_pošt
 = *
İt_out_pošt
;

101 cÚ¡ 
¡d
::
İtiÚ®
<
Coš
> 
İt_coš
 = 
CÚsumeDe£rŸlizabË
<Coš>(
fuzzed_d©a_´ovid”
);

102 ià(!
İt_coš
) {

105 
¿ndom_coš
 = *
İt_coš
;

108 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
İt_mubË_Œª§ùiÚ
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

109 ià(!
İt_mubË_Œª§ùiÚ
) {

112 
¿ndom_mubË_Œª§ùiÚ
 = *
İt_mubË_Œª§ùiÚ
;

115 
CCošsM­
 
cošs_m­
;

116 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

117 
CCošsCacheEÁry
 
cošs_ÿche_’Œy
;

118 
cošs_ÿche_’Œy
.
æags
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

119 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

120 
cošs_ÿche_’Œy
.
coš
 = 
¿ndom_coš
;

122 cÚ¡ 
¡d
::
İtiÚ®
<
Coš
> 
İt_coš
 = 
CÚsumeDe£rŸlizabË
<Coš>(
fuzzed_d©a_´ovid”
);

123 ià(!
İt_coš
) {

126 
cošs_ÿche_’Œy
.
coš
 = *
İt_coš
;

128 
cošs_m­
.
	`em¶aû
(
¿ndom_out_pošt
, 
¡d
::
	`move
(
cošs_ÿche_’Œy
));

130 
boŞ
 
ex³ùed_code_·th
 = 
çl£
;

131 
Œy
 {

132 
cošs_v›w_ÿche
.
	`B©chWr™e
(
cošs_m­
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è? 
	`CÚsumeUIÁ256
(fuzzed_d©a_´ovid”è: cošs_v›w_ÿche.
	`G‘Be¡Block
());

133 
ex³ùed_code_·th
 = 
Œue
;

134 } 
	`ÿtch
 (cÚ¡ 
¡d
::
logic_”rÜ
& 
e
) {

135 ià(
e
.
	`wh©
(è=ğ
¡d
::
¡ršg
{"FRESH flag misappliedo coinhatƒxists in…arent cache"}) {

136 
ex³ùed_code_·th
 = 
Œue
;

139 
	`as£¹
(
ex³ùed_code_·th
);

144 cÚ¡ 
Coš
& 
coš_usšg_acûss_coš
 = 
cošs_v›w_ÿche
.
	`AcûssCoš
(
¿ndom_out_pošt
);

145 cÚ¡ 
boŞ
 
exi¡s_usšg_acûss_coš
 = !(
coš_usšg_acûss_coš
 =ğ
EMPTY_COIN
);

146 cÚ¡ 
boŞ
 
exi¡s_usšg_have_coš
 = 
cošs_v›w_ÿche
.
	`HaveCoš
(
¿ndom_out_pošt
);

147 cÚ¡ 
boŞ
 
exi¡s_usšg_have_coš_š_ÿche
 = 
cošs_v›w_ÿche
.
	`HaveCošInCache
(
¿ndom_out_pošt
);

148 
Coš
 
coš_usšg_g‘_coš
;

149 cÚ¡ 
boŞ
 
exi¡s_usšg_g‘_coš
 = 
cošs_v›w_ÿche
.
	`G‘Coš
(
¿ndom_out_pošt
, 
coš_usšg_g‘_coš
);

150 ià(
exi¡s_usšg_g‘_coš
) {

151 
	`as£¹
(
coš_usšg_g‘_coš
 =ğ
coš_usšg_acûss_coš
);

153 
	`as£¹
((
exi¡s_usšg_acûss_coš
 && 
exi¡s_usšg_have_coš_š_ÿche
 && 
exi¡s_usšg_have_coš
 && 
exi¡s_usšg_g‘_coš
) ||

154 (!
exi¡s_usšg_acûss_coš
 && !
exi¡s_usšg_have_coš_š_ÿche
 && !
exi¡s_usšg_have_coš
 && !
exi¡s_usšg_g‘_coš
));

155 cÚ¡ 
boŞ
 
exi¡s_usšg_have_coš_š_back’d
 = 
back’d_cošs_v›w
.
	`HaveCoš
(
¿ndom_out_pošt
);

156 ià(
exi¡s_usšg_have_coš_š_back’d
) {

157 
	`as£¹
(
exi¡s_usšg_have_coš
);

159 
Coš
 
coš_usšg_back’d_g‘_coš
;

160 ià(
back’d_cošs_v›w
.
	`G‘Coš
(
¿ndom_out_pošt
, 
coš_usšg_back’d_g‘_coš
)) {

161 
	`as£¹
(
exi¡s_usšg_have_coš_š_back’d
);

162 
	`as£¹
(
coš_usšg_g‘_coš
 =ğ
coš_usšg_back’d_g‘_coš
);

164 
	`as£¹
(!
exi¡s_usšg_have_coš_š_back’d
);

169 
boŞ
 
ex³ùed_code_·th
 = 
çl£
;

170 
Œy
 {

171 ()
cošs_v›w_ÿche
.
	`CursÜ
();

172 } 
	`ÿtch
 (cÚ¡ 
¡d
::
logic_”rÜ
&) {

173 
ex³ùed_code_·th
 = 
Œue
;

175 
	`as£¹
(
ex³ùed_code_·th
);

176 ()
cošs_v›w_ÿche
.
	`DyÇmicMemÜyU§ge
();

177 ()
cošs_v›w_ÿche
.
	`E¡im©eSize
();

178 ()
cošs_v›w_ÿche
.
	`G‘Be¡Block
();

179 ()
cošs_v›w_ÿche
.
	`G‘CacheSize
();

180 ()
cošs_v›w_ÿche
.
	`G‘H—dBlocks
();

181 ()
cošs_v›w_ÿche
.
	`HaveIÅuts
(
CT¿n§ùiÚ
{
¿ndom_mubË_Œª§ùiÚ
});

185 
¡d
::
unique_±r
<
CCošsV›wCursÜ
> 
cošs_v›w_cursÜ
 = 
back’d_cošs_v›w
.
	`CursÜ
();

186 
	`as£¹
(!
cošs_v›w_cursÜ
);

187 ()
back’d_cošs_v›w
.
	`E¡im©eSize
();

188 ()
back’d_cošs_v›w
.
	`G‘Be¡Block
();

189 ()
back’d_cošs_v›w
.
	`G‘H—dBlocks
();

192 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

193 
	`C®lOÃOf
(

194 
fuzzed_d©a_´ovid”
,

196 cÚ¡ 
CT¿n§ùiÚ
 
Œª§ùiÚ
{
¿ndom_mubË_Œª§ùiÚ
};

197 
boŞ
 
is_¥’t
 = 
çl£
;

198 cÚ¡ 
CTxOut
& 
tx_out
 : 
Œª§ùiÚ
.
vout
) {

199 ià(
Coš
{
tx_out
, 0, 
Œª§ùiÚ
.
	`IsCošBa£
()}.
	`IsS³Á
()) {

200 
is_¥’t
 = 
Œue
;

203 ià(
is_¥’t
) {

208 
boŞ
 
ex³ùed_code_·th
 = 
çl£
;

209 cÚ¡ 
height
{(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt32_t
>() >> 1)};

210 cÚ¡ 
boŞ
 
possibË_ov”wr™e
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

211 
Œy
 {

212 
	`AddCošs
(
cošs_v›w_ÿche
, 
Œª§ùiÚ
, 
height
, 
possibË_ov”wr™e
);

213 
ex³ùed_code_·th
 = 
Œue
;

214 } 
	`ÿtch
 (cÚ¡ 
¡d
::
logic_”rÜ
& 
e
) {

215 ià(
e
.
	`wh©
(è=ğ
¡d
::
¡ršg
{"Attemptedo overwrite‡n unspent coin (when…ossible_overwrite is false)"}) {

216 
	`as£¹
(!
possibË_ov”wr™e
);

217 
ex³ùed_code_·th
 = 
Œue
;

220 
	`as£¹
(
ex³ùed_code_·th
);

223 ()
	`A»IÅutsSnd¬d
(
CT¿n§ùiÚ
{
¿ndom_mubË_Œª§ùiÚ
}, 
cošs_v›w_ÿche
);

226 
TxV®id©iÚS‹
 
¡©e
;

227 
CAmouÁ
 
tx_ãe_out
;

228 cÚ¡ 
CT¿n§ùiÚ
 
Œª§ùiÚ
{
¿ndom_mubË_Œª§ùiÚ
};

229 ià(
	`CÚšsS³ÁIÅut
(
Œª§ùiÚ
, 
cošs_v›w_ÿche
)) {

234 
TxV®id©iÚS‹
 
dummy
;

235 ià(!
	`CheckT¿n§ùiÚ
(
Œª§ùiÚ
, 
dummy
)) {

239 ià(
CÚ£nsus
::
	`CheckTxIÅuts
(
Œª§ùiÚ
, 
¡©e
, 
cošs_v›w_ÿche
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 
¡d
::
num”ic_lim™s
<>::
	`max
()), 
tx_ãe_out
)) {

240 
	`as£¹
(
	`MÚeyRªge
(
tx_ãe_out
));

244 cÚ¡ 
CT¿n§ùiÚ
 
Œª§ùiÚ
{
¿ndom_mubË_Œª§ùiÚ
};

245 ià(
	`CÚšsS³ÁIÅut
(
Œª§ùiÚ
, 
cošs_v›w_ÿche
)) {

250 ()
	`G‘P2SHSigOpCouÁ
(
Œª§ùiÚ
, 
cošs_v›w_ÿche
);

253 cÚ¡ 
CT¿n§ùiÚ
 
Œª§ùiÚ
{
¿ndom_mubË_Œª§ùiÚ
};

254 ià(
	`CÚšsS³ÁIÅut
(
Œª§ùiÚ
, 
cošs_v›w_ÿche
)) {

259 cÚ¡‡utØ
æags
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt32_t
>()};

260 ià(!
Œª§ùiÚ
.
vš
.
	`em±y
(è&& (
æags
 & 
SCRIPT_VERIFY_WITNESS
è!ğ0 && (æag & 
SCRIPT_VERIFY_P2SH
) == 0) {

265 ()
	`G‘T¿n§ùiÚSigOpCo¡
(
Œª§ùiÚ
, 
cošs_v›w_ÿche
, 
æags
);

268 ()
	`IsW™ÃssSnd¬d
(
CT¿n§ùiÚ
{
¿ndom_mubË_Œª§ùiÚ
}, 
cošs_v›w_ÿche
);

271 
	}
}

	@connman.cpp

5 
	~<addrmª.h
>

6 
	~<chaš·¿ms.h
>

7 
	~<chaš·¿msba£.h
>

8 
	~<Ãt.h
>

9 
	~<Ãdd»ss.h
>

10 
	~<´ÙocŞ.h
>

11 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

12 
	~<‹¡/fuzz/fuzz.h
>

13 
	~<‹¡/fuzz/ut.h
>

14 
	~<‹¡/ut/£tup_commÚ.h
>

15 
	~<ut/sy¡em.h
>

16 
	~<ut/Œª¦©iÚ.h
>

18 
	~<c¡dšt
>

19 
	~<veùÜ
>

21 
	gÇme¥aû
 {

22 cÚ¡ 
Te¡šgS‘up
* 
	gg_£tup
;

25 
	$š™Ÿlize_cÚnmª
()

27 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<cÚ¡ 
Te¡šgS‘up
>();

28 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

29 
	}
}

31 
	$FUZZ_TARGET_INIT
(
cÚnmª
, 
š™Ÿlize_cÚnmª
)

33 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

34 
	`S‘MockTime
(
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
));

35 
CCÚnmª
 
cÚnmª
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>(),

36 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>(),

37 *
g_£tup
->
m_node
.
addrmª
,

38 *
g_£tup
->
m_node
.
Ãtgroupmª
,

39 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()};

40 
CN‘Addr
 
¿ndom_Ãddr
;

41 
CNode
 
¿ndom_node
 = 
	`CÚsumeNode
(
fuzzed_d©a_´ovid”
);

42 
CSubN‘
 
¿ndom_subÃt
;

43 
¡d
::
¡ršg
 
¿ndom_¡ršg
;

44 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

45 
	`C®lOÃOf
(

46 
fuzzed_d©a_´ovid”
,

48 
¿ndom_Ãddr
 = 
	`CÚsumeN‘Addr
(
fuzzed_d©a_´ovid”
);

51 
¿ndom_subÃt
 = 
	`CÚsumeSubN‘
(
fuzzed_d©a_´ovid”
);

54 
¿ndom_¡ršg
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(64);

57 
cÚnmª
.
	`AddNode
(
¿ndom_¡ršg
);

60 
cÚnmª
.
	`CheckIncomšgNÚû
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>());

63 
cÚnmª
.
	`DiscÚÃùNode
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
NodeId
>());

66 
cÚnmª
.
	`DiscÚÃùNode
(
¿ndom_Ãddr
);

69 
cÚnmª
.
	`DiscÚÃùNode
(
¿ndom_¡ršg
);

72 
cÚnmª
.
	`DiscÚÃùNode
(
¿ndom_subÃt
);

75 
cÚnmª
.
	`FÜEachNode
([](auto) {});

78 ()
cÚnmª
.
	`FÜNode
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
NodeId
>(), [&]×utoè{  fuzzed_d©a_´ovid”.
	`CÚsumeBoŞ
(); });

81 ()
cÚnmª
.
	`G‘Add»s£s
(

82  
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
size_t
>(),

83  
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
size_t
>(),

84  
¡d
::
nuÎİt
);

87 ()
cÚnmª
.
	`G‘Add»s£s
(

88  
¿ndom_node
,

89  
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
size_t
>(),

90  
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
size_t
>());

93 ()
cÚnmª
.
	`G‘D‘”mši¡icRªdomiz”
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>());

96 ()
cÚnmª
.
	`G‘NodeCouÁ
(
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
({
CÚÃùiÚDœeùiÚ
::
NÚe
, CÚÃùiÚDœeùiÚ::
In
, CÚÃùiÚDœeùiÚ::
Out
, CÚÃùiÚDœeùiÚ::
BÙh
}));

99 ()
cÚnmª
.
	`OutboundT¬g‘R—ched
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

102 
CS”ŸlizedN‘Msg
 
£rŸlized_Ãt_msg
;

103 
£rŸlized_Ãt_msg
.
m_ty³
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(
CMes§geH—d”
::
COMMAND_SIZE
);

104 
£rŸlized_Ãt_msg
.
d©a
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

105 
cÚnmª
.
	`PushMes§ge
(&
¿ndom_node
, 
¡d
::
	`move
(
£rŸlized_Ãt_msg
));

108 
cÚnmª
.
	`RemoveAddedNode
(
¿ndom_¡ršg
);

111 
cÚnmª
.
	`S‘N‘wÜkAùive
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

114 
cÚnmª
.
	`S‘TryNewOutboundP“r
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

117 ()
cÚnmª
.
	`G‘AddedNodeInfo
();

118 ()
cÚnmª
.
	`G‘ExŒaFuÎOutboundCouÁ
();

119 ()
cÚnmª
.
	`G‘LoÿlS”viûs
();

120 ()
cÚnmª
.
	`G‘MaxOutboundT¬g‘
();

121 ()
cÚnmª
.
	`G‘MaxOutboundTimeäame
();

122 ()
cÚnmª
.
	`G‘MaxOutboundTimeLeáInCyşe
();

123 ()
cÚnmª
.
	`G‘N‘wÜkAùive
();

124 
¡d
::
veùÜ
<
CNodeSts
> 
¡©s
;

125 
cÚnmª
.
	`G‘NodeSts
(
¡©s
);

126 ()
cÚnmª
.
	`G‘OutboundT¬g‘By‹sLeá
();

127 ()
cÚnmª
.
	`G‘ReûiveFloodSize
();

128 ()
cÚnmª
.
	`G‘TÙ®By‹sRecv
();

129 ()
cÚnmª
.
	`G‘TÙ®By‹sS’t
();

130 ()
cÚnmª
.
	`G‘TryNewOutboundP“r
();

131 ()
cÚnmª
.
	`G‘U£AddrmªOutgošg
();

132 
	}
}

	@crypto.cpp

5 
	~<üy±o/hmac_sha256.h
>

6 
	~<üy±o/hmac_sha512.h
>

7 
	~<üy±o/remd160.h
>

8 
	~<üy±o/sha1.h
>

9 
	~<üy±o/sha256.h
>

10 
	~<üy±o/sha3.h
>

11 
	~<üy±o/sha512.h
>

12 
	~<hash.h
>

13 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

14 
	~<‹¡/fuzz/fuzz.h
>

15 
	~<‹¡/fuzz/ut.h
>

17 
	~<c¡dšt
>

18 
	~<veùÜ
>

20 
	$FUZZ_TARGET
(
üy±o
)

22 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

23 
¡d
::
veùÜ
<
ušt8_t
> 
d©a
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

24 ià(
d©a
.
	`em±y
()) {

25 
d©a
.
	`»size
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(1, 4096), fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿l
<
ušt8_t
>());

28 
CHash160
 
hash160
;

29 
CHash256
 
hash256
;

30 
CHMAC_SHA256
 
hmac_sha256
{
d©a
.
	`d©a
(), d©a.
	`size
()};

31 
CHMAC_SHA512
 
hmac_sha512
{
d©a
.
	`d©a
(), d©a.
	`size
()};

32 
CRIPEMD160
 
remd160
;

33 
CSHA1
 
sha1
;

34 
CSHA256
 
sha256
;

35 
CSHA512
 
sha512
;

36 
SHA3_256
 
sha3
;

37 
CSHash”
 
s_hash”
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>(), fuzzed_data_provider.ConsumeIntegral<uint64_t>()};

39 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 30)

41 
	`C®lOÃOf
(

42 
fuzzed_d©a_´ovid”
,

44 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

45 
d©a
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

46 ià(
d©a
.
	`em±y
()) {

47 
d©a
.
	`»size
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(1, 4096), fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿l
<
ušt8_t
>());

51 ()
hash160
.
	`Wr™e
(
d©a
);

52 ()
hash256
.
	`Wr™e
(
d©a
);

53 ()
hmac_sha256
.
	`Wr™e
(
d©a
.
	`d©a
(), d©a.
	`size
());

54 ()
hmac_sha512
.
	`Wr™e
(
d©a
.
	`d©a
(), d©a.
	`size
());

55 ()
remd160
.
	`Wr™e
(
d©a
.
	`d©a
(), d©a.
	`size
());

56 ()
sha1
.
	`Wr™e
(
d©a
.
	`d©a
(), d©a.
	`size
());

57 ()
sha256
.
	`Wr™e
(
d©a
.
	`d©a
(), d©a.
	`size
());

58 ()
sha3
.
	`Wr™e
(
d©a
);

59 ()
sha512
.
	`Wr™e
(
d©a
.
	`d©a
(), d©a.
	`size
());

60 ()
s_hash”
.
	`Wr™e
(
d©a
.
	`d©a
(), d©a.
	`size
());

62 ()
	`Hash
(
d©a
);

63 ()
	`Hash160
(
d©a
);

64 ()
sha512
.
	`Size
();

67 ()
hash160
.
	`Re£t
();

68 ()
hash256
.
	`Re£t
();

69 ()
remd160
.
	`Re£t
();

70 ()
sha1
.
	`Re£t
();

71 ()
sha256
.
	`Re£t
();

72 ()
sha3
.
	`Re£t
();

73 ()
sha512
.
	`Re£t
();

76 
	`C®lOÃOf
(

77 
fuzzed_d©a_´ovid”
,

79 
d©a
.
	`»size
(
CHash160
::
OUTPUT_SIZE
);

80 
hash160
.
	`Fš®ize
(
d©a
);

83 
d©a
.
	`»size
(
CHash256
::
OUTPUT_SIZE
);

84 
hash256
.
	`Fš®ize
(
d©a
);

87 
d©a
.
	`»size
(
CHMAC_SHA256
::
OUTPUT_SIZE
);

88 
hmac_sha256
.
	`Fš®ize
(
d©a
.
	`d©a
());

91 
d©a
.
	`»size
(
CHMAC_SHA512
::
OUTPUT_SIZE
);

92 
hmac_sha512
.
	`Fš®ize
(
d©a
.
	`d©a
());

95 
d©a
.
	`»size
(
CRIPEMD160
::
OUTPUT_SIZE
);

96 
remd160
.
	`Fš®ize
(
d©a
.
	`d©a
());

99 
d©a
.
	`»size
(
CSHA1
::
OUTPUT_SIZE
);

100 
sha1
.
	`Fš®ize
(
d©a
.
	`d©a
());

103 
d©a
.
	`»size
(
CSHA256
::
OUTPUT_SIZE
);

104 
sha256
.
	`Fš®ize
(
d©a
.
	`d©a
());

107 
d©a
.
	`»size
(
CSHA512
::
OUTPUT_SIZE
);

108 
sha512
.
	`Fš®ize
(
d©a
.
	`d©a
());

111 
d©a
.
	`»size
(1);

112 
d©a
[0] = 
s_hash”
.
	`Fš®ize
() % 256;

115 
d©a
.
	`»size
(
SHA3_256
::
OUTPUT_SIZE
);

116 
sha3
.
	`Fš®ize
(
d©a
);

120 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

121 
ušt64_t
 
¡©e
[25];

122 
size_t
 
i
 = 0; i < 25; ++i) {

123 
¡©e
[
i
] = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>();

125 
	`KecÿkF
(
¡©e
);

127 
	}
}

	@crypto_aes256.cpp

5 
	~<üy±o/«s.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<ÿs£¹
>

11 
	~<c¡dšt
>

12 
	~<veùÜ
>

14 
	$FUZZ_TARGET
(
üy±o_«s256
)

16 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

17 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
key
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
AES256_KEYSIZE
);

19 
AES256Enüy±
 
’üy±
{
key
.
	`d©a
()};

20 
AES256Deüy±
 
deüy±
{
key
.
	`d©a
()};

22 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

23 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¶aš‹xt
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
AES_BLOCKSIZE
);

24 
¡d
::
veùÜ
<
ušt8_t
> 
	`ch”‹xt
(
AES_BLOCKSIZE
);

25 
’üy±
.
	`Enüy±
(
ch”‹xt
.
	`d©a
(), 
¶aš‹xt
.data());

26 
¡d
::
veùÜ
<
ušt8_t
> 
	`deüy±ed_¶aš‹xt
(
AES_BLOCKSIZE
);

27 
deüy±
.
	`Deüy±
(
deüy±ed_¶aš‹xt
.
	`d©a
(), 
ch”‹xt
.data());

28 
	`as£¹
(
deüy±ed_¶aš‹xt
 =ğ
¶aš‹xt
);

30 
	}
}

	@crypto_aes256cbc.cpp

5 
	~<üy±o/«s.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<ÿs£¹
>

11 
	~<c¡dšt
>

12 
	~<veùÜ
>

14 
	$FUZZ_TARGET
(
üy±o_«s256cbc
)

16 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

17 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
key
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
AES256_KEYSIZE
);

18 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
iv
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
AES_BLOCKSIZE
);

19 cÚ¡ 
boŞ
 
·d
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

21 
AES256CBCEnüy±
 
’üy±
{
key
.
	`d©a
(), 
iv
.d©a(), 
·d
};

22 
AES256CBCDeüy±
 
deüy±
{
key
.
	`d©a
(), 
iv
.d©a(), 
·d
};

24 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

25 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¶aš‹xt
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

26 
¡d
::
veùÜ
<
ušt8_t
> 
	`ch”‹xt
(
¶aš‹xt
.
	`size
(è+ 
AES_BLOCKSIZE
);

27 cÚ¡ 
’üy±_»t
 = 
’üy±
.
	`Enüy±
(
¶aš‹xt
.
	`d©a
(),…Ïš‹xt.
	`size
(), 
ch”‹xt
.data());

28 
ch”‹xt
.
	`»size
(
’üy±_»t
);

29 
¡d
::
veùÜ
<
ušt8_t
> 
	`deüy±ed_¶aš‹xt
(
ch”‹xt
.
	`size
());

30 cÚ¡ 
deüy±_»t
 = 
deüy±
.
	`Deüy±
(
ch”‹xt
.
	`d©a
(), ch”‹xt.
	`size
(), 
deüy±ed_¶aš‹xt
.data());

31 
deüy±ed_¶aš‹xt
.
	`»size
(
deüy±_»t
);

32 
	`as£¹
(
deüy±ed_¶aš‹xt
 =ğ
¶aš‹xt
 || (!
·d
 &&…Ïš‹xt.
	`size
(è% 
AES_BLOCKSIZE
 !ğ0 && 
’üy±_»t
 =ğ0 && 
deüy±_»t
 == 0));

34 
	}
}

	@crypto_chacha20.cpp

5 
	~<üy±o/chacha20.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<c¡dšt
>

11 
	~<veùÜ
>

13 
	$FUZZ_TARGET
(
üy±o_chacha20
)

15 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

17 
ChaCha20
 
chacha20
;

18 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

19 cÚ¡ 
¡d
::
veùÜ
<> 
key
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿lInRªge
<
size_t
>(16, 32));

20 
chacha20
 = 
ChaCha20
{
key
.
	`d©a
(), key.
	`size
()};

22 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

23 
	`C®lOÃOf
(

24 
fuzzed_d©a_´ovid”
,

26 cÚ¡ 
¡d
::
veùÜ
<> 
key
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿lInRªge
<
size_t
>(16, 32));

27 
chacha20
.
	`S‘Key
(
key
.
	`d©a
(), key.
	`size
());

30 
chacha20
.
	`S‘IV
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>());

33 
chacha20
.
	`S“k
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>());

36 
¡d
::
veùÜ
<
ušt8_t
> 
	`ouut
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 4096));

37 
chacha20
.
	`Key¡»am
(
ouut
.
	`d©a
(), ouut.
	`size
());

40 
¡d
::
veùÜ
<
ušt8_t
> 
	`ouut
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 4096));

41 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
šput
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
ouut
.
	`size
());

42 
chacha20
.
	`Cry±
(
šput
.
	`d©a
(), 
ouut
.d©a(), iÅut.
	`size
());

45 
	}
}

	@crypto_chacha20_poly1305_aead.cpp

5 
	~<üy±o/chacha_pŞy_«ad.h
>

6 
	~<üy±o/pŞy1305.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<ut/ov”æow.h
>

12 
	~<ÿs£¹
>

13 
	~<c¡dšt
>

14 
	~<lim™s
>

15 
	~<veùÜ
>

17 
	$FUZZ_TARGET
(
üy±o_chacha20_pŞy1305_«ad
)

19 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

21 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
k1
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
CHACHA20_POLY1305_AEAD_KEY_LEN
);

22 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
k2
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
CHACHA20_POLY1305_AEAD_KEY_LEN
);

24 
ChaCha20PŞy1305AEAD
 
	`«ad
(
k1
.
	`d©a
(), k1.
	`size
(), 
k2
.data(), k2.size());

25 
ušt64_t
 
£qÄ_·ylßd
 = 0;

26 
ušt64_t
 
£qÄ_¯d
 = 0;

27 
¯d_pos
 = 0;

28 
size_t
 
bufãr_size
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 4096);

29 
¡d
::
veùÜ
<
ušt8_t
> 
	`š
(
bufãr_size
 + 
CHACHA20_POLY1305_AEAD_AAD_LEN
 + 
POLY1305_TAGLEN
, 0);

30 
¡d
::
veùÜ
<
ušt8_t
> 
	`out
(
bufãr_size
 + 
CHACHA20_POLY1305_AEAD_AAD_LEN
 + 
POLY1305_TAGLEN
, 0);

31 
boŞ
 
is_’üy±
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

32 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

33 
	`C®lOÃOf
(

34 
fuzzed_d©a_´ovid”
,

36 
bufãr_size
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(64, 4096);

37 
š
 = 
¡d
::
veùÜ
<
ušt8_t
>(
bufãr_size
 + 
CHACHA20_POLY1305_AEAD_AAD_LEN
 + 
POLY1305_TAGLEN
, 0);

38 
out
 = 
¡d
::
veùÜ
<
ušt8_t
>(
bufãr_size
 + 
CHACHA20_POLY1305_AEAD_AAD_LEN
 + 
POLY1305_TAGLEN
, 0);

41 ()
«ad
.
	`Cry±
(
£qÄ_·ylßd
, 
£qÄ_¯d
, 
¯d_pos
, 
out
.
	`d©a
(), out.
	`size
(), 
š
.d©a(), 
bufãr_size
, 
is_’üy±
);

44 
ušt32_t
 
Ën
 = 0;

45 cÚ¡ 
boŞ
 
ok
 = 
«ad
.
	`G‘L’gth
(&
Ën
, 
£qÄ_¯d
, 
¯d_pos
, 
š
.
	`d©a
());

46 
	`as£¹
(
ok
);

49 ià(
	`Add™iÚOv”æow
(
£qÄ_·ylßd
, 
¡©ic_ÿ¡
<
ušt64_t
>(1))) {

52 
£qÄ_·ylßd
 += 1;

53 
¯d_pos
 +ğ
CHACHA20_POLY1305_AEAD_AAD_LEN
;

54 ià(
¯d_pos
 + 
CHACHA20_POLY1305_AEAD_AAD_LEN
 > 
CHACHA20_ROUND_OUTPUT
) {

55 
¯d_pos
 = 0;

56 ià(
	`Add™iÚOv”æow
(
£qÄ_¯d
, 
¡©ic_ÿ¡
<
ušt64_t
>(1))) {

59 
£qÄ_¯d
 += 1;

63 
£qÄ_·ylßd
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>();

66 
£qÄ_¯d
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>();

69 
is_’üy±
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

72 
	}
}

	@crypto_common.cpp

5 
	~<üy±o/commÚ.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<¬¿y
>

11 
	~<ÿs£¹
>

12 
	~<c¡dšt
>

13 
	~<c¡ršg
>

14 
	~<veùÜ
>

16 
	$FUZZ_TARGET
(
üy±o_commÚ
)

18 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

19 cÚ¡ 
ušt16_t
 
¿ndom_u16
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint16_t>();

20 cÚ¡ 
ušt32_t
 
¿ndom_u32
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>();

21 cÚ¡ 
ušt64_t
 
¿ndom_u64
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint64_t>();

22 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s_2
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 2);

23 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s_4
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 4);

24 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s_8
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 8);

26 
¡d
::
¬¿y
<
ušt8_t
, 2> 
wr™–e16_¬r
;

27 
	`Wr™eLE16
(
wr™–e16_¬r
.
	`d©a
(), 
¿ndom_u16
);

28 
	`as£¹
(
	`R—dLE16
(
wr™–e16_¬r
.
	`d©a
()è=ğ
¿ndom_u16
);

30 
¡d
::
¬¿y
<
ušt8_t
, 4> 
wr™–e32_¬r
;

31 
	`Wr™eLE32
(
wr™–e32_¬r
.
	`d©a
(), 
¿ndom_u32
);

32 
	`as£¹
(
	`R—dLE32
(
wr™–e32_¬r
.
	`d©a
()è=ğ
¿ndom_u32
);

34 
¡d
::
¬¿y
<
ušt8_t
, 8> 
wr™–e64_¬r
;

35 
	`Wr™eLE64
(
wr™–e64_¬r
.
	`d©a
(), 
¿ndom_u64
);

36 
	`as£¹
(
	`R—dLE64
(
wr™–e64_¬r
.
	`d©a
()è=ğ
¿ndom_u64
);

38 
¡d
::
¬¿y
<
ušt8_t
, 4> 
wr™ebe32_¬r
;

39 
	`Wr™eBE32
(
wr™ebe32_¬r
.
	`d©a
(), 
¿ndom_u32
);

40 
	`as£¹
(
	`R—dBE32
(
wr™ebe32_¬r
.
	`d©a
()è=ğ
¿ndom_u32
);

42 
¡d
::
¬¿y
<
ušt8_t
, 8> 
wr™ebe64_¬r
;

43 
	`Wr™eBE64
(
wr™ebe64_¬r
.
	`d©a
(), 
¿ndom_u64
);

44 
	`as£¹
(
	`R—dBE64
(
wr™ebe64_¬r
.
	`d©a
()è=ğ
¿ndom_u64
);

46 cÚ¡ 
ušt16_t
 
»adË16_»suÉ
 = 
	`R—dLE16
(
¿ndom_by‹s_2
.
	`d©a
());

47 
¡d
::
¬¿y
<
ušt8_t
, 2> 
»adË16_¬r
;

48 
	`Wr™eLE16
(
»adË16_¬r
.
	`d©a
(), 
»adË16_»suÉ
);

49 
	`as£¹
(
¡d
::
	`memcmp
(
¿ndom_by‹s_2
.
	`d©a
(), 
»adË16_¬r
.data(), 2) == 0);

51 cÚ¡ 
ušt32_t
 
»adË32_»suÉ
 = 
	`R—dLE32
(
¿ndom_by‹s_4
.
	`d©a
());

52 
¡d
::
¬¿y
<
ušt8_t
, 4> 
»adË32_¬r
;

53 
	`Wr™eLE32
(
»adË32_¬r
.
	`d©a
(), 
»adË32_»suÉ
);

54 
	`as£¹
(
¡d
::
	`memcmp
(
¿ndom_by‹s_4
.
	`d©a
(), 
»adË32_¬r
.data(), 4) == 0);

56 cÚ¡ 
ušt64_t
 
»adË64_»suÉ
 = 
	`R—dLE64
(
¿ndom_by‹s_8
.
	`d©a
());

57 
¡d
::
¬¿y
<
ušt8_t
, 8> 
»adË64_¬r
;

58 
	`Wr™eLE64
(
»adË64_¬r
.
	`d©a
(), 
»adË64_»suÉ
);

59 
	`as£¹
(
¡d
::
	`memcmp
(
¿ndom_by‹s_8
.
	`d©a
(), 
»adË64_¬r
.data(), 8) == 0);

61 cÚ¡ 
ušt32_t
 
»adbe32_»suÉ
 = 
	`R—dBE32
(
¿ndom_by‹s_4
.
	`d©a
());

62 
¡d
::
¬¿y
<
ušt8_t
, 4> 
»adbe32_¬r
;

63 
	`Wr™eBE32
(
»adbe32_¬r
.
	`d©a
(), 
»adbe32_»suÉ
);

64 
	`as£¹
(
¡d
::
	`memcmp
(
¿ndom_by‹s_4
.
	`d©a
(), 
»adbe32_¬r
.data(), 4) == 0);

66 cÚ¡ 
ušt64_t
 
»adbe64_»suÉ
 = 
	`R—dBE64
(
¿ndom_by‹s_8
.
	`d©a
());

67 
¡d
::
¬¿y
<
ušt8_t
, 8> 
»adbe64_¬r
;

68 
	`Wr™eBE64
(
»adbe64_¬r
.
	`d©a
(), 
»adbe64_»suÉ
);

69 
	`as£¹
(
¡d
::
	`memcmp
(
¿ndom_by‹s_8
.
	`d©a
(), 
»adbe64_¬r
.data(), 8) == 0);

70 
	}
}

	@crypto_diff_fuzz_chacha20.cpp

5 
	~<üy±o/chacha20.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<c¡dšt
>

11 
	~<veùÜ
>

20 
	tu32
;

21 
	tu8
;

23 
	#U8C
(
v
è(v##
U
)

	)

24 
	#U32C
(
v
è(v##
U
)

	)

26 
	#U8V
(
v
è((
u8
)(v)&
	`U8C
(0xFF))

	)

27 
	#U32V
(
v
è((
u32
)(v)&
	`U32C
(0xFFFFFFFF))

	)

29 
	#ROTL32
(
v
, 
n
è(
	`U32V
((vè<< (n)è| ((vè>> (32 - (n))))

	)

31 
	#U8TO32_LITTLE
(
p
) \

32 (((
u32
)((
p
)[0])) | ((u32)((p)[1]) << 8) | ((u32)((p)[2]) << 16) | \

33 ((
u32
)((
p
)[3]è<< 24))

	)

35 
	#U32TO8_LITTLE
(
p
, 
v
) \

37 (
p
)[0] = 
	`U8V
((
v
)); \

38 (
p
)[1] = 
	`U8V
((
v
) >> 8); \

39 (
p
)[2] = 
	`U8V
((
v
) >> 16); \

40 (
p
)[3] = 
	`U8V
((
v
) >> 24); \

41 } 0)

	)

48 
u32
 
	mšput
[16];

49 } 
	tECRYPT_ùx
;

54 
ECRYPT_key£tup
(

55 
ECRYPT_ùx
* 
ùx
,

56 cÚ¡ 
u8
* 
key
,

57 
u32
 
keysize
,

58 
u32
 
ivsize
);

60 
ECRYPT_iv£tup
(

61 
ECRYPT_ùx
* 
ùx
,

62 cÚ¡ 
u8
* 
iv
);

64 
ECRYPT_’üy±_by‹s
(

65 
ECRYPT_ùx
* 
ùx
,

66 cÚ¡ 
u8
* 
¶aš‹xt
,

67 
u8
* 
ch”‹xt
,

68 
u32
 
msgËn
);

74 
ECRYPT_key¡»am_by‹s
(

75 
ECRYPT_ùx
* 
ùx
,

76 
u8
* 
key¡»am
,

77 
u32
 
Ëngth
);

81 
	#ROTATE
(
v
, 
c
è(
	`ROTL32
(v, c))

	)

82 
	#XOR
(
v
, 
w
è((vè^ (w))

	)

83 
	#PLUS
(
v
, 
w
è(
	`U32V
((vè+ (w)))

	)

84 
	#PLUSONE
(
v
è(
	`PLUS
((v), 1))

	)

86 
	#QUARTERROUND
(
a
, 
b
, 
c
, 
d
) \

87 
a
 = 
	`PLUS
×, 
b
); 
d
 = 
	`ROTATE
(
	`XOR
(d,‡), 16); \

88 
c
 = 
	`PLUS
(c, 
d
); 
b
 = 
	`ROTATE
(
	`XOR
(b, c), 12); \

89 
a
 = 
	`PLUS
×, 
b
); 
d
 = 
	`ROTATE
(
	`XOR
(d,‡), 8); \

90 
c
 = 
	`PLUS
(c, 
d
); 
b
 = 
	`ROTATE
(
	`XOR
(b, c), 7);

	)

92 cÚ¡ 
	gsigma
[] = "expand 32-byte k";

93 cÚ¡ 
	gu
[] = "expand 16-byte k";

95 
	$ECRYPT_key£tup
(
ECRYPT_ùx
* 
x
, cÚ¡ 
u8
* 
k
, 
u32
 
kb™s
, u32 
ivb™s
)

97 cÚ¡ * 
cÚ¡ªts
;

99 
x
->
šput
[4] = 
	`U8TO32_LITTLE
(
k
 + 0);

100 
x
->
šput
[5] = 
	`U8TO32_LITTLE
(
k
 + 4);

101 
x
->
šput
[6] = 
	`U8TO32_LITTLE
(
k
 + 8);

102 
x
->
šput
[7] = 
	`U8TO32_LITTLE
(
k
 + 12);

103 ià(
kb™s
 == 256) {

104 
k
 += 16;

105 
cÚ¡ªts
 = 
sigma
;

107 
cÚ¡ªts
 = 
u
;

109 
x
->
šput
[8] = 
	`U8TO32_LITTLE
(
k
 + 0);

110 
x
->
šput
[9] = 
	`U8TO32_LITTLE
(
k
 + 4);

111 
x
->
šput
[10] = 
	`U8TO32_LITTLE
(
k
 + 8);

112 
x
->
šput
[11] = 
	`U8TO32_LITTLE
(
k
 + 12);

113 
x
->
šput
[0] = 
	`U8TO32_LITTLE
(
cÚ¡ªts
 + 0);

114 
x
->
šput
[1] = 
	`U8TO32_LITTLE
(
cÚ¡ªts
 + 4);

115 
x
->
šput
[2] = 
	`U8TO32_LITTLE
(
cÚ¡ªts
 + 8);

116 
x
->
šput
[3] = 
	`U8TO32_LITTLE
(
cÚ¡ªts
 + 12);

117 
	}
}

119 
	$ECRYPT_iv£tup
(
ECRYPT_ùx
* 
x
, cÚ¡ 
u8
* 
iv
)

121 
x
->
šput
[12] = 0;

122 
x
->
šput
[13] = 0;

123 
x
->
šput
[14] = 
	`U8TO32_LITTLE
(
iv
 + 0);

124 
x
->
šput
[15] = 
	`U8TO32_LITTLE
(
iv
 + 4);

125 
	}
}

127 
	$ECRYPT_’üy±_by‹s
(
ECRYPT_ùx
* 
x
, cÚ¡ 
u8
* 
m
, u8* 
c
, 
u32
 
by‹s
)

129 
u32
 
x0
, 
x1
, 
x2
, 
x3
, 
x4
, 
x5
, 
x6
, 
x7
, 
x8
, 
x9
, 
x10
, 
x11
, 
x12
, 
x13
, 
x14
, 
x15
;

130 
u32
 
j0
, 
j1
, 
j2
, 
j3
, 
j4
, 
j5
, 
j6
, 
j7
, 
j8
, 
j9
, 
j10
, 
j11
, 
j12
, 
j13
, 
j14
, 
j15
;

131 
u8
* 
ù¬g‘
 = 
nuÎ±r
;

132 
u8
 
tmp
[64];

133 
ušt32_t
 
i
;

135 ià(!
by‹s
) ;

137 
j0
 = 
x
->
šput
[0];

138 
j1
 = 
x
->
šput
[1];

139 
j2
 = 
x
->
šput
[2];

140 
j3
 = 
x
->
šput
[3];

141 
j4
 = 
x
->
šput
[4];

142 
j5
 = 
x
->
šput
[5];

143 
j6
 = 
x
->
šput
[6];

144 
j7
 = 
x
->
šput
[7];

145 
j8
 = 
x
->
šput
[8];

146 
j9
 = 
x
->
šput
[9];

147 
j10
 = 
x
->
šput
[10];

148 
j11
 = 
x
->
šput
[11];

149 
j12
 = 
x
->
šput
[12];

150 
j13
 = 
x
->
šput
[13];

151 
j14
 = 
x
->
šput
[14];

152 
j15
 = 
x
->
šput
[15];

155 ià(
by‹s
 < 64) {

156 
i
 = 0; i < 
by‹s
; ++i)

157 
tmp
[
i
] = 
m
[i];

158 
m
 = 
tmp
;

159 
ù¬g‘
 = 
c
;

160 
c
 = 
tmp
;

162 
x0
 = 
j0
;

163 
x1
 = 
j1
;

164 
x2
 = 
j2
;

165 
x3
 = 
j3
;

166 
x4
 = 
j4
;

167 
x5
 = 
j5
;

168 
x6
 = 
j6
;

169 
x7
 = 
j7
;

170 
x8
 = 
j8
;

171 
x9
 = 
j9
;

172 
x10
 = 
j10
;

173 
x11
 = 
j11
;

174 
x12
 = 
j12
;

175 
x13
 = 
j13
;

176 
x14
 = 
j14
;

177 
x15
 = 
j15
;

178 
i
 = 20; i > 0; i -= 2) {

179 
	`QUARTERROUND
(
x0
, 
x4
, 
x8
, 
x12
)

180 
	`QUARTERROUND
(
x1
, 
x5
, 
x9
, 
x13
)

181 
	`QUARTERROUND
(
x2
, 
x6
, 
x10
, 
x14
)

182 
	`QUARTERROUND
(
x3
, 
x7
, 
x11
, 
x15
)

183 
	`QUARTERROUND
(
x0
, 
x5
, 
x10
, 
x15
)

184 
	`QUARTERROUND
(
x1
, 
x6
, 
x11
, 
x12
)

185 
	`QUARTERROUND
(
x2
, 
x7
, 
x8
, 
x13
)

186 
	`QUARTERROUND
(
x3
, 
x4
, 
x9
, 
x14
)

188 
x0
 = 
	`PLUS
(x0, 
j0
);

189 
x1
 = 
	`PLUS
(x1, 
j1
);

190 
x2
 = 
	`PLUS
(x2, 
j2
);

191 
x3
 = 
	`PLUS
(x3, 
j3
);

192 
x4
 = 
	`PLUS
(x4, 
j4
);

193 
x5
 = 
	`PLUS
(x5, 
j5
);

194 
x6
 = 
	`PLUS
(x6, 
j6
);

195 
x7
 = 
	`PLUS
(x7, 
j7
);

196 
x8
 = 
	`PLUS
(x8, 
j8
);

197 
x9
 = 
	`PLUS
(x9, 
j9
);

198 
x10
 = 
	`PLUS
(x10, 
j10
);

199 
x11
 = 
	`PLUS
(x11, 
j11
);

200 
x12
 = 
	`PLUS
(x12, 
j12
);

201 
x13
 = 
	`PLUS
(x13, 
j13
);

202 
x14
 = 
	`PLUS
(x14, 
j14
);

203 
x15
 = 
	`PLUS
(x15, 
j15
);

205 
x0
 = 
	`XOR
(x0, 
	`U8TO32_LITTLE
(
m
 + 0));

206 
x1
 = 
	`XOR
(x1, 
	`U8TO32_LITTLE
(
m
 + 4));

207 
x2
 = 
	`XOR
(x2, 
	`U8TO32_LITTLE
(
m
 + 8));

208 
x3
 = 
	`XOR
(x3, 
	`U8TO32_LITTLE
(
m
 + 12));

209 
x4
 = 
	`XOR
(x4, 
	`U8TO32_LITTLE
(
m
 + 16));

210 
x5
 = 
	`XOR
(x5, 
	`U8TO32_LITTLE
(
m
 + 20));

211 
x6
 = 
	`XOR
(x6, 
	`U8TO32_LITTLE
(
m
 + 24));

212 
x7
 = 
	`XOR
(x7, 
	`U8TO32_LITTLE
(
m
 + 28));

213 
x8
 = 
	`XOR
(x8, 
	`U8TO32_LITTLE
(
m
 + 32));

214 
x9
 = 
	`XOR
(x9, 
	`U8TO32_LITTLE
(
m
 + 36));

215 
x10
 = 
	`XOR
(x10, 
	`U8TO32_LITTLE
(
m
 + 40));

216 
x11
 = 
	`XOR
(x11, 
	`U8TO32_LITTLE
(
m
 + 44));

217 
x12
 = 
	`XOR
(x12, 
	`U8TO32_LITTLE
(
m
 + 48));

218 
x13
 = 
	`XOR
(x13, 
	`U8TO32_LITTLE
(
m
 + 52));

219 
x14
 = 
	`XOR
(x14, 
	`U8TO32_LITTLE
(
m
 + 56));

220 
x15
 = 
	`XOR
(x15, 
	`U8TO32_LITTLE
(
m
 + 60));

222 
j12
 = 
	`PLUSONE
(j12);

223 ià(!
j12
) {

224 
j13
 = 
	`PLUSONE
(j13);

228 
	`U32TO8_LITTLE
(
c
 + 0, 
x0
);

229 
	`U32TO8_LITTLE
(
c
 + 4, 
x1
);

230 
	`U32TO8_LITTLE
(
c
 + 8, 
x2
);

231 
	`U32TO8_LITTLE
(
c
 + 12, 
x3
);

232 
	`U32TO8_LITTLE
(
c
 + 16, 
x4
);

233 
	`U32TO8_LITTLE
(
c
 + 20, 
x5
);

234 
	`U32TO8_LITTLE
(
c
 + 24, 
x6
);

235 
	`U32TO8_LITTLE
(
c
 + 28, 
x7
);

236 
	`U32TO8_LITTLE
(
c
 + 32, 
x8
);

237 
	`U32TO8_LITTLE
(
c
 + 36, 
x9
);

238 
	`U32TO8_LITTLE
(
c
 + 40, 
x10
);

239 
	`U32TO8_LITTLE
(
c
 + 44, 
x11
);

240 
	`U32TO8_LITTLE
(
c
 + 48, 
x12
);

241 
	`U32TO8_LITTLE
(
c
 + 52, 
x13
);

242 
	`U32TO8_LITTLE
(
c
 + 56, 
x14
);

243 
	`U32TO8_LITTLE
(
c
 + 60, 
x15
);

245 ià(
by‹s
 <= 64) {

246 ià(
by‹s
 < 64) {

247 
i
 = 0; i < 
by‹s
; ++i)

248 
ù¬g‘
[
i
] = 
c
[i];

250 
x
->
šput
[12] = 
j12
;

251 
x
->
šput
[13] = 
j13
;

254 
by‹s
 -= 64;

255 
c
 += 64;

256 
m
 += 64;

258 
	}
}

260 
	$ECRYPT_key¡»am_by‹s
(
ECRYPT_ùx
* 
x
, 
u8
* 
¡»am
, 
u32
 
by‹s
)

262 
u32
 
i
;

263 
i
 = 0; i < 
by‹s
; ++i)

264 
¡»am
[
i
] = 0;

265 
	`ECRYPT_’üy±_by‹s
(
x
, 
¡»am
, sŒ—m, 
by‹s
);

266 
	}
}

268 
	$FUZZ_TARGET
(
üy±o_diff_fuzz_chacha20
)

270 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

272 
ChaCha20
 
chacha20
;

273 
ECRYPT_ùx
 
ùx
;

275 
i
 = 0; i < 16; i++) {

276 
ùx
.
šput
[
i
] = 0;

279 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

280 cÚ¡ 
¡d
::
veùÜ
<> 
key
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿lInRªge
<
size_t
>(16, 32));

281 
chacha20
 = 
ChaCha20
{
key
.
	`d©a
(), key.
	`size
()};

282 
	`ECRYPT_key£tup
(&
ùx
, 
key
.
	`d©a
(), key.
	`size
() * 8, 0);

284 
ušt8_t
 
iv
[8] = {0, 0, 0, 0, 0, 0, 0, 0};

285 
	`ECRYPT_iv£tup
(&
ùx
, 
iv
);

288 
	`LIMITED_WHILE
 (
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 3000) {

289 
	`C®lOÃOf
(

290 
fuzzed_d©a_´ovid”
,

292 cÚ¡ 
¡d
::
veùÜ
<> 
key
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿lInRªge
<
size_t
>(16, 32));

293 
chacha20
.
	`S‘Key
(
key
.
	`d©a
(), key.
	`size
());

294 
	`ECRYPT_key£tup
(&
ùx
, 
key
.
	`d©a
(), key.
	`size
() * 8, 0);

296 
ušt8_t
 
iv
[8] = {0, 0, 0, 0, 0, 0, 0, 0};

297 
	`ECRYPT_iv£tup
(&
ùx
, 
iv
);

300 
ušt64_t
 
iv
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint64_t>();

301 
chacha20
.
	`S‘IV
(
iv
);

302 
ùx
.
šput
[14] = 
iv
;

303 
ùx
.
šput
[15] = 
iv
 >> 32;

306 
ušt64_t
 
couÁ”
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint64_t>();

307 
chacha20
.
	`S“k
(
couÁ”
);

308 
ùx
.
šput
[12] = 
couÁ”
;

309 
ùx
.
šput
[13] = 
couÁ”
 >> 32;

312 
ušt32_t
 
š‹g¿lInRªge
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 4096);

313 
¡d
::
veùÜ
<
ušt8_t
> 
	`ouut
(
š‹g¿lInRªge
);

314 
chacha20
.
	`Key¡»am
(
ouut
.
	`d©a
(), ouut.
	`size
());

315 
¡d
::
veùÜ
<
ušt8_t
> 
	`djb_ouut
(
š‹g¿lInRªge
);

316 
	`ECRYPT_key¡»am_by‹s
(&
ùx
, 
djb_ouut
.
	`d©a
(), djb_ouut.
	`size
());

317 
	`as£¹
(
ouut
 =ğ
djb_ouut
);

320 
ušt32_t
 
š‹g¿lInRªge
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 4096);

321 
¡d
::
veùÜ
<
ušt8_t
> 
	`ouut
(
š‹g¿lInRªge
);

322 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
šput
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
ouut
.
	`size
());

323 
chacha20
.
	`Cry±
(
šput
.
	`d©a
(), 
ouut
.d©a(), iÅut.
	`size
());

324 
¡d
::
veùÜ
<
ušt8_t
> 
	`djb_ouut
(
š‹g¿lInRªge
);

325 
	`ECRYPT_’üy±_by‹s
(&
ùx
, 
šput
.
	`d©a
(), 
djb_ouut
.d©a(), iÅut.
	`size
());

326 
	`as£¹
(
ouut
 =ğ
djb_ouut
);

329 
	}
}

	@crypto_hkdf_hmac_sha256_l32.cpp

5 
	~<üy±o/hkdf_sha256_32.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<c¡dšt
>

11 
	~<¡ršg
>

12 
	~<veùÜ
>

14 
	$FUZZ_TARGET
(
üy±o_hkdf_hmac_sha256_l32
)

16 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

18 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
š™Ÿl_key_m©”Ÿl
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

20 
CHKDF_HMAC_SHA256_L32
 
	`hkdf_hmac_sha256_l32
(
š™Ÿl_key_m©”Ÿl
.
	`d©a
(), in™Ÿl_key_m©”Ÿl.
	`size
(), 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(1024));

21 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

22 
¡d
::
veùÜ
<
ušt8_t
> 
	`out
(32);

23 
hkdf_hmac_sha256_l32
.
	`Ex·nd32
(
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(128), 
out
.
	`d©a
());

25 
	}
}

	@crypto_poly1305.cpp

5 
	~<üy±o/pŞy1305.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<c¡dšt
>

11 
	~<veùÜ
>

13 
	$FUZZ_TARGET
(
üy±o_pŞy1305
)

15 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

17 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
key
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
POLY1305_KEYLEN
);

18 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
š
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

20 
¡d
::
veùÜ
<
ušt8_t
> 
	`g_out
(
POLY1305_TAGLEN
);

21 
	`pŞy1305_auth
(
g_out
.
	`d©a
(), 
š
.d©a(), in.
	`size
(), 
key
.data());

22 
	}
}

	@cuckoocache.cpp

5 
	~<cuckooÿche.h
>

6 
	~<süt/sigÿche.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<‹¡/ut/£tup_commÚ.h
>

12 
	~<c¡dšt
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

16 
	gÇme¥aû
 {

17 
FuzzedD©aProvid”
* 
	gfuzzed_d©a_´ovid”_±r
 = 
nuÎ±r
;

19 
	sRªdomHash”
 {

20 
	g‹m¶©e
 <
	gušt8_t
>

21 
ušt32_t
 
İ”©Ü
()(cÚ¡ 
	gboŞ
& ) const

23 
as£¹
(
fuzzed_d©a_´ovid”_±r
 !ğ
nuÎ±r
);

24  
	gfuzzed_d©a_´ovid”_±r
->
	gCÚsumeIÁeg¿l
<
	gušt32_t
>();

29 
	$FUZZ_TARGET
(
cuckooÿche
)

31 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

32 
fuzzed_d©a_´ovid”_±r
 = &
fuzzed_d©a_´ovid”
;

33 
CuckooCache
::
ÿche
<, 
RªdomHash”
> 
cuckoo_ÿche
{};

34 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

35 cÚ¡ 
size_t
 
megaby‹s
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 16);

36 
cuckoo_ÿche
.
	`£tup_by‹s
(
megaby‹s
 << 20);

38 
cuckoo_ÿche
.
	`£tup
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
ušt32_t
>(0, 4096));

40 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

41 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

42 
cuckoo_ÿche
.
	`š£¹
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

44 
cuckoo_ÿche
.
	`cÚšs
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), fuzzed_data_provider.ConsumeBool());

47 
fuzzed_d©a_´ovid”_±r
 = 
nuÎ±r
;

48 
	}
}

	@decode_tx.cpp

5 
	~<cÜe_io.h
>

6 
	~<´im™ives/Œª§ùiÚ.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<ut/¡»ncodšgs.h
>

10 
	~<ÿs£¹
>

11 
	~<c¡dšt
>

12 
	~<¡ršg
>

13 
	~<veùÜ
>

15 
	$FUZZ_TARGET
(
decode_tx
)

17 cÚ¡ 
¡d
::
¡ršg
 
tx_hex
 = 
	`HexSŒ
(
bufãr
);

18 
CMubËT¿n§ùiÚ
 
mtx
;

19 cÚ¡ 
boŞ
 
»suÉ_nÚe
 = 
	`DecodeHexTx
(
mtx
, 
tx_hex
, 
çl£
, false);

20 cÚ¡ 
boŞ
 
»suÉ_Œy_w™Ãss
 = 
	`DecodeHexTx
(
mtx
, 
tx_hex
, 
çl£
, 
Œue
);

21 cÚ¡ 
boŞ
 
»suÉ_Œy_w™Ãss_ªd_maybe_no_w™Ãss
 = 
	`DecodeHexTx
(
mtx
, 
tx_hex
, 
Œue
,rue);

22 
CMubËT¿n§ùiÚ
 
no_w™Ãss_mtx
;

23 cÚ¡ 
boŞ
 
»suÉ_Œy_no_w™Ãss
 = 
	`DecodeHexTx
(
no_w™Ãss_mtx
, 
tx_hex
, 
Œue
, 
çl£
);

24 
	`as£¹
(!
»suÉ_nÚe
);

25 ià(
»suÉ_Œy_w™Ãss_ªd_maybe_no_w™Ãss
) {

26 
	`as£¹
(
»suÉ_Œy_no_w™Ãss
 || 
»suÉ_Œy_w™Ãss
);

28 ià(
»suÉ_Œy_no_w™Ãss
) {

29 
	`as£¹
(!
no_w™Ãss_mtx
.
	`HasW™Ãss
());

30 
	`as£¹
(
»suÉ_Œy_w™Ãss_ªd_maybe_no_w™Ãss
);

32 
	}
}

	@descriptor_parse.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<pubkey.h
>

7 
	~<süt/desütÜ.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

10 
	$š™Ÿlize_desütÜ_·r£
()

12 cÚ¡ 
ECCV”ifyHªdË
 
v”ify_hªdË
;

13 
	`ECC_S¹
();

14 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
MAIN
);

15 
	}
}

17 
	$FUZZ_TARGET_INIT
(
desütÜ_·r£
, 
š™Ÿlize_desütÜ_·r£
)

19 cÚ¡ 
¡d
::
¡ršg
 
	`desütÜ
(
bufãr
.
	`begš
(), bufãr.
	`’d
());

20 
FÏtSignšgProvid”
 
signšg_´ovid”
;

21 
¡d
::
¡ršg
 
”rÜ
;

22 cÚ¡ 
boŞ
 
»quœe_checksum
 : {
Œue
, 
çl£
}) {

23 cÚ¡‡utØ
desc
 = 
	`P¬£
(
desütÜ
, 
signšg_´ovid”
, 
”rÜ
, 
»quœe_checksum
);

24 ià(
desc
) {

25 ()
desc
->
	`ToSŒšg
();

26 ()
desc
->
	`IsRªge
();

27 ()
desc
->
	`IsSŞvabË
();

30 
	}
}

	@deserialize.cpp

5 
	~<addrdb.h
>

6 
	~<addrmª.h
>

7 
	~<addrmª_im¶.h
>

8 
	~<block’codšgs.h
>

9 
	~<blockf‹r.h
>

10 
	~<chaš.h
>

11 
	~<cošs.h
>

12 
	~<com´essÜ.h
>

13 
	~<cÚ£nsus/m”kË.h
>

14 
	~<key.h
>

15 
	~<m”kËblock.h
>

16 
	~<Ãt.h
>

17 
	~<Ãtba£.h
>

18 
	~<Ãtgroup.h
>

19 
	~<node/utxo_¢­shÙ.h
>

20 
	~<´im™ives/block.h
>

21 
	~<´ÙocŞ.h
>

22 
	~<psbt.h
>

23 
	~<pubkey.h
>

24 
	~<süt/keyÜigš.h
>

25 
	~<¡»ams.h
>

26 
	~<‹¡/ut/£tup_commÚ.h
>

27 
	~<undo.h
>

28 
	~<ut/sy¡em.h
>

29 
	~<v”siÚ.h
>

31 
	~<exû±iÚ
>

32 
	~<İtiÚ®
>

33 
	~<¡dexû±
>

34 
	~<¡dšt.h
>

35 
	~<uni¡d.h
>

37 
	~<‹¡/fuzz/fuzz.h
>

39 
usšg
 
	gnode
::
SÇpshÙM‘ad©a
;

41 
	gÇme¥aû
 {

42 cÚ¡ 
BasicTe¡šgS‘up
* 
	gg_£tup
;

45 
	$š™Ÿlize_de£rŸlize
()

47 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>();

48 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

51 cÚ¡ 
ECCV”ifyHªdË
 
v”ify_hªdË
;

52 
	}
}

54 
	#FUZZ_TARGET_DESERIALIZE
(
Çme
, 
code
) \

55 
	`FUZZ_TARGET_INIT
(
Çme
, 
š™Ÿlize_de£rŸlize
) \

57 
Œy
 { \

58 
code
 \

59 } 
	`ÿtch
 (cÚ¡ 
šv®id_fuzzšg_šput_exû±iÚ
&) { \

61 }

	)

63 
	gÇme¥aû
 {

65 
	gšv®id_fuzzšg_šput_exû±iÚ
 : 
public
 
¡d
::
exû±iÚ
 {

68 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

69 
CD©aSŒ—m
 
S”Ÿlize
(cÚ¡ 
T
& 
obj
, cÚ¡ 
v”siÚ
 = 
INIT_PROTO_VERSION
, cÚ¡ 
£r_ty³
 = 
SER_NETWORK
)

71 
CD©aSŒ—m
 
ds
(
£r_ty³
, 
v”siÚ
);

72 
	gds
 << 
	gobj
;

73  
	gds
;

76 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

77 
T
 
De£rŸlize
(
CD©aSŒ—m
 
ds
)

79 
T
 
	gobj
;

80 
	gds
 >> 
	gobj
;

81  
	gobj
;

84 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

85 
De£rŸlizeFromFuzzšgIÅut
(
FuzzBufãrTy³
 
bufãr
, 
T
& 
obj
, cÚ¡ 
¡d
::
İtiÚ®
<> 
´ÙocŞ_v”siÚ
 = std::
nuÎİt
, cÚ¡ 
£r_ty³
 = 
SER_NETWORK
)

87 
CD©aSŒ—m
 
ds
(
bufãr
, 
£r_ty³
, 
INIT_PROTO_VERSION
);

88 ià(
	g´ÙocŞ_v”siÚ
) {

89 
	gds
.
S‘V”siÚ
(*
´ÙocŞ_v”siÚ
);

91 
	gŒy
 {

92 
	gv”siÚ
;

93 
	gds
 >> 
	gv”siÚ
;

94 
	gds
.
S‘V”siÚ
(
v”siÚ
);

95 } 
ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

96 
throw
 
šv®id_fuzzšg_šput_exû±iÚ
();

99 
	gŒy
 {

100 
	gds
 >> 
	gobj
;

101 } 
ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

102 
throw
 
šv®id_fuzzšg_šput_exû±iÚ
();

104 
as£¹
(
bufãr
.
em±y
(è|| !
S”Ÿlize
(
obj
).empty());

107 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

108 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(cÚ¡ 
T
& 
obj
, cÚ¡ 
v”siÚ
 = 
INIT_PROTO_VERSION
, cÚ¡ 
£r_ty³
 = 
SER_NETWORK
)

110 
as£¹
(
De£rŸlize
<
T
>(
S”Ÿlize
(
obj
, 
v”siÚ
, 
£r_ty³
)) == obj);

115 
FUZZ_TARGET_DESERIALIZE
(
block_f‹r_de£rŸlize
, {

116 
BlockF‹r
 
block_f‹r
;

117 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
block_f‹r
);

119 
FUZZ_TARGET_DESERIALIZE
(
addr_šfo_de£rŸlize
, {

120 
AddrInfo
 
addr_šfo
;

121 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
addr_šfo
);

123 
FUZZ_TARGET_DESERIALIZE
(
block_fe_šfo_de£rŸlize
, {

124 
CBlockFeInfo
 
block_fe_šfo
;

125 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
block_fe_šfo
);

127 
FUZZ_TARGET_DESERIALIZE
(
block_h—d”_ªd_shÜt_txids_de£rŸlize
, {

128 
CBlockH—d”AndShÜtTxIDs
 
block_h—d”_ªd_shÜt_txids
;

129 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
block_h—d”_ªd_shÜt_txids
);

131 
FUZZ_TARGET_DESERIALIZE
(
ãe_¿‹_de£rŸlize
, {

132 
CF“R©e
 
ãe_¿‹
;

133 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
ãe_¿‹
);

134 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
ãe_¿‹
);

136 
FUZZ_TARGET_DESERIALIZE
(
m”kË_block_de£rŸlize
, {

137 
CM”kËBlock
 
m”kË_block
;

138 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
m”kË_block
);

140 
FUZZ_TARGET_DESERIALIZE
(
out_pošt_de£rŸlize
, {

141 
COutPošt
 
out_pošt
;

142 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
out_pošt
);

143 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
out_pošt
);

145 
FUZZ_TARGET_DESERIALIZE
(
·¹Ÿl_m”kË_Œ“_de£rŸlize
, {

146 
CP¬tŸlM”kËT»e
 
·¹Ÿl_m”kË_Œ“
;

147 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
·¹Ÿl_m”kË_Œ“
);

149 
FUZZ_TARGET_DESERIALIZE
(
pub_key_de£rŸlize
, {

150 
CPubKey
 
pub_key
;

151 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
pub_key
);

152 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
pub_key
);

154 
FUZZ_TARGET_DESERIALIZE
(
süt_de£rŸlize
, {

155 
CSüt
 
süt
;

156 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
süt
);

158 
FUZZ_TARGET_DESERIALIZE
(
tx_š_de£rŸlize
, {

159 
CTxIn
 
tx_š
;

160 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
tx_š
);

161 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
tx_š
);

163 
FUZZ_TARGET_DESERIALIZE
(
æ©_fe_pos_de£rŸlize
, {

164 
FÏtFePos
 
æ©_fe_pos
;

165 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
æ©_fe_pos
);

166 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
æ©_fe_pos
);

168 
FUZZ_TARGET_DESERIALIZE
(
key_Üigš_šfo_de£rŸlize
, {

169 
KeyOrigšInfo
 
key_Üigš_šfo
;

170 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
key_Üigš_šfo
);

171 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
key_Üigš_šfo
);

173 
FUZZ_TARGET_DESERIALIZE
(
·¹ŸÎy_sigÃd_Œª§ùiÚ_de£rŸlize
, {

174 
P¬tŸÎySigÃdT¿n§ùiÚ
 
·¹ŸÎy_sigÃd_Œª§ùiÚ
;

175 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
·¹ŸÎy_sigÃd_Œª§ùiÚ
);

177 
FUZZ_TARGET_DESERIALIZE
(
´efËd_Œª§ùiÚ_de£rŸlize
, {

178 
P»fËdT¿n§ùiÚ
 
´efËd_Œª§ùiÚ
;

179 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
´efËd_Œª§ùiÚ
);

181 
FUZZ_TARGET_DESERIALIZE
(
psbt_šput_de£rŸlize
, {

182 
PSBTIÅut
 
psbt_šput
;

183 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
psbt_šput
);

185 
FUZZ_TARGET_DESERIALIZE
(
psbt_ouut_de£rŸlize
, {

186 
PSBTOuut
 
psbt_ouut
;

187 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
psbt_ouut
);

189 
FUZZ_TARGET_DESERIALIZE
(
block_de£rŸlize
, {

190 
CBlock
 
block
;

191 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
block
);

193 
FUZZ_TARGET_DESERIALIZE
(
blockloÿtÜ_de£rŸlize
, {

194 
CBlockLoÿtÜ
 
bl
;

195 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
bl
);

197 
FUZZ_TARGET_DESERIALIZE
(
blockm”kËroÙ
, {

198 
CBlock
 
block
;

199 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
block
);

200 
boŞ
 
mu‹d
;

201 
BlockM”kËRoÙ
(
block
, &
mu‹d
);

203 
FUZZ_TARGET_DESERIALIZE
(
addrmª_de£rŸlize
, {

204 
N‘GroupMªag”
 
Ãtgroupmª
{
¡d
::
veùÜ
<
boŞ
>()};

205 
AddrMª
 
am
(
Ãtgroupmª
,

206  
çl£
,

207 
g_£tup
->
m_node
.
¬gs
->
G‘IÁArg
("-checkaddrman", 0));

208 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
am
);

210 
FUZZ_TARGET_DESERIALIZE
(
blockh—d”_de£rŸlize
, {

211 
CBlockH—d”
 
bh
;

212 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
bh
);

214 
FUZZ_TARGET_DESERIALIZE
(
txundo_de£rŸlize
, {

215 
CTxUndo
 
tu
;

216 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
tu
);

218 
FUZZ_TARGET_DESERIALIZE
(
blockundo_de£rŸlize
, {

219 
CBlockUndo
 
bu
;

220 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
bu
);

222 
FUZZ_TARGET_DESERIALIZE
(
cošs_de£rŸlize
, {

223 
Coš
 
coš
;

224 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
coš
);

226 
FUZZ_TARGET_DESERIALIZE
(
Ãddr_de£rŸlize
, {

227 
CN‘Addr
 
Ç
;

228 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
Ç
);

229 ià(
Ç
.
IsAddrV1Com·tibË
()) {

230 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
Ç
);

232 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
Ç
, 
INIT_PROTO_VERSION
 | 
ADDRV2_FORMAT
);

234 
FUZZ_TARGET_DESERIALIZE
(
£rviû_de£rŸlize
, {

235 
CS”viû
 
s
;

236 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
s
);

237 ià(
s
.
IsAddrV1Com·tibË
()) {

238 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
s
);

240 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
s
, 
INIT_PROTO_VERSION
 | 
ADDRV2_FORMAT
);

241 
CS”viû
 
s1
;

242 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
s1
, 
INIT_PROTO_VERSION
);

243 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
s1
, 
INIT_PROTO_VERSION
);

244 
as£¹
(
s1
.
IsAddrV1Com·tibË
());

245 
CS”viû
 
s2
;

246 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
s2
, 
INIT_PROTO_VERSION
 | 
ADDRV2_FORMAT
);

247 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
s2
, 
INIT_PROTO_VERSION
 | 
ADDRV2_FORMAT
);

249 
FUZZ_TARGET_DESERIALIZE
(
mes§geh—d”_de£rŸlize
, {

250 
CMes§geH—d”
 
mh
;

251 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
mh
);

252 ()
mh
.
IsCommªdV®id
();

254 
FUZZ_TARGET_DESERIALIZE
(
add»ss_de£rŸlize_v1_nÙime
, {

255 
CAdd»ss
 
a
;

256 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
a
, 
INIT_PROTO_VERSION
);

259 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 
INIT_PROTO_VERSION
);

260 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 
PROTOCOL_VERSION
);

261 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 0, 
SER_DISK
);

262 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 
PROTOCOL_VERSION
 | 
ADDRV2_FORMAT
);

263 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 
ADDRV2_FORMAT
, 
SER_DISK
);

265 
FUZZ_TARGET_DESERIALIZE
(
add»ss_de£rŸlize_v1_w™htime
, {

266 
CAdd»ss
 
a
;

267 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
a
, 
PROTOCOL_VERSION
);

269 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 
PROTOCOL_VERSION
);

270 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 0, 
SER_DISK
);

271 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 
PROTOCOL_VERSION
 | 
ADDRV2_FORMAT
);

272 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 
ADDRV2_FORMAT
, 
SER_DISK
);

274 
FUZZ_TARGET_DESERIALIZE
(
add»ss_de£rŸlize_v2
, {

275 
CAdd»ss
 
a
;

276 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
a
, 
PROTOCOL_VERSION
 | 
ADDRV2_FORMAT
);

279 ià(
a
.
IsAddrV1Com·tibË
()) {

280 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 
PROTOCOL_VERSION
);

281 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 0, 
SER_DISK
);

283 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 
PROTOCOL_VERSION
 | 
ADDRV2_FORMAT
);

284 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
a
, 
ADDRV2_FORMAT
, 
SER_DISK
);

286 
FUZZ_TARGET_DESERIALIZE
(
šv_de£rŸlize
, {

287 
CInv
 
i
;

288 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
i
);

290 
FUZZ_TARGET_DESERIALIZE
(
bloomf‹r_de£rŸlize
, {

291 
CBloomF‹r
 
bf
;

292 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
bf
);

294 
FUZZ_TARGET_DESERIALIZE
(
diskblockšdex_de£rŸlize
, {

295 
CDiskBlockIndex
 
dbi
;

296 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
dbi
);

298 
FUZZ_TARGET_DESERIALIZE
(
txoutcom´essÜ_de£rŸlize
, {

299 
CTxOut
 
to
;

300 autØ
toc
 = 
Usšg
<
TxOutCom´essiÚ
>(
to
);

301 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
toc
);

303 
FUZZ_TARGET_DESERIALIZE
(
blockŒª§ùiÚs_de£rŸlize
, {

304 
BlockT¿n§ùiÚs
 
bt
;

305 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
bt
);

307 
FUZZ_TARGET_DESERIALIZE
(
blockŒª§ùiÚ¤eque¡_de£rŸlize
, {

308 
BlockT¿n§ùiÚsReque¡
 
bŒ
;

309 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
bŒ
);

311 
FUZZ_TARGET_DESERIALIZE
(
¢­shÙm‘ad©a_de£rŸlize
, {

312 
SÇpshÙM‘ad©a
 
¢­shÙ_m‘ad©a
;

313 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
¢­shÙ_m‘ad©a
);

315 
FUZZ_TARGET_DESERIALIZE
(
ušt160_de£rŸlize
, {

316 
ušt160
 
u160
;

317 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
u160
);

318 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
u160
);

320 
FUZZ_TARGET_DESERIALIZE
(
ušt256_de£rŸlize
, {

321 
ušt256
 
u256
;

322 
De£rŸlizeFromFuzzšgIÅut
(
bufãr
, 
u256
);

323 
As£¹Equ®Aá”S”ŸlizeDe£rŸlize
(
u256
);

	@eval_script.cpp

5 
	~<pubkey.h
>

6 
	~<süt/š‹½»‹r.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

10 
	~<lim™s
>

12 
	$š™Ÿlize_ev®_süt
()

14 cÚ¡ 
ECCV”ifyHªdË
 
v”ify_hªdË
;

15 
	}
}

17 
	$FUZZ_TARGET_INIT
(
ev®_süt
, 
š™Ÿlize_ev®_süt
)

19 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

20 cÚ¡ 
æags
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

21 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
süt_by‹s
 = [&] {

22 ià(
fuzzed_d©a_´ovid”
.
	`»maššg_by‹s
() != 0) {

23  
fuzzed_d©a_´ovid”
.
CÚsumeRemaššgBy‹s
<
ušt8_t
>();

28  
¡d
::
veùÜ
<
ušt8_t
>();

31 cÚ¡ 
CSüt
 
	`süt
(
süt_by‹s
.
	`begš
(), süt_by‹s.
	`’d
());

32 cÚ¡‡utØ
sig_v”siÚ
 : {
SigV”siÚ
::
BASE
, SigV”siÚ::
WITNESS_V0
}) {

33 
¡d
::
veùÜ
<¡d::veùÜ<>> 
¡ack
;

34 ()
	`Ev®Süt
(
¡ack
, 
süt
, 
æags
, 
	`Ba£SigÇtu»Check”
(), 
sig_v”siÚ
, 
nuÎ±r
);

36 
	}
}

	@fee_rate.cpp

5 
	~<cÚ£nsus/amouÁ.h
>

6 
	~<pŞicy/ã”©e.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

11 
	~<c¡dšt
>

12 
	~<lim™s
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

16 
	$FUZZ_TARGET
(
ãe_¿‹
)

18 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

19 cÚ¡ 
CAmouÁ
 
§toshis_³r_k
 = 
	`CÚsumeMÚey
(
fuzzed_d©a_´ovid”
);

20 cÚ¡ 
CF“R©e
 
ãe_¿‹
{
§toshis_³r_k
};

22 ()
ãe_¿‹
.
	`G‘F“P”K
();

23 cÚ¡‡utØ
by‹s
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt32_t
>();

24 ià(!
	`MuÉliÿtiÚOv”æow
(
št64_t
{
by‹s
}, 
§toshis_³r_k
)) {

25 ()
ãe_¿‹
.
	`G‘F“
(
by‹s
);

27 ()
ãe_¿‹
.
	`ToSŒšg
();

29 cÚ¡ 
CAmouÁ
 
ªÙh”_§toshis_³r_k
 = 
	`CÚsumeMÚey
(
fuzzed_d©a_´ovid”
);

30 
CF“R©e
 
Ïrg”_ãe_¿‹
{
ªÙh”_§toshis_³r_k
};

31 
Ïrg”_ãe_¿‹
 +ğ
ãe_¿‹
;

32 ià(
§toshis_³r_k
 !ğ0 && 
ªÙh”_§toshis_³r_k
 != 0) {

33 
	`as£¹
(
ãe_¿‹
 < 
Ïrg”_ãe_¿‹
);

34 
	`as£¹
(!(
ãe_¿‹
 > 
Ïrg”_ãe_¿‹
));

35 
	`as£¹
(!(
ãe_¿‹
 =ğ
Ïrg”_ãe_¿‹
));

36 
	`as£¹
(
ãe_¿‹
 <ğ
Ïrg”_ãe_¿‹
);

37 
	`as£¹
(!(
ãe_¿‹
 >ğ
Ïrg”_ãe_¿‹
));

38 
	`as£¹
(
ãe_¿‹
 !ğ
Ïrg”_ãe_¿‹
);

40 
	}
}

	@fees.cpp

5 
	~<cÚ£nsus/amouÁ.h
>

6 
	~<pŞicy/ães.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<ut/ães.h
>

12 
	~<c¡dšt
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

16 
	$FUZZ_TARGET
(
ães
)

18 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

19 cÚ¡ 
CF“R©e
 
mšim®_šüem’l_ãe
{
	`CÚsumeMÚey
(
fuzzed_d©a_´ovid”
)};

20 
F“F‹rRound”
 
ãe_f‹r_round”
{
mšim®_šüem’l_ãe
};

21 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

22 cÚ¡ 
CAmouÁ
 
cu¼’t_mšimum_ãe
 = 
	`CÚsumeMÚey
(
fuzzed_d©a_´ovid”
);

23 cÚ¡ 
CAmouÁ
 
rounded_ãe
 = 
ãe_f‹r_round”
.
	`round
(
cu¼’t_mšimum_ãe
);

24 
	`as£¹
(
	`MÚeyRªge
(
rounded_ãe
));

26 cÚ¡ 
F“R—sÚ
 
ãe_»asÚ
 = 
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
({F“R—sÚ::
NONE
, F“R—sÚ::
HALF_ESTIMATE
, F“R—sÚ::
FULL_ESTIMATE
, F“R—sÚ::
DOUBLE_ESTIMATE
, F“R—sÚ::
CONSERVATIVE
, F“R—sÚ::
MEMPOOL_MIN
, F“R—sÚ::
PAYTXFEE
, F“R—sÚ::
FALLBACK
, F“R—sÚ::
REQUIRED
});

27 ()
	`SŒšgFÜF“R—sÚ
(
ãe_»asÚ
);

28 
	}
}

	@flatfile.cpp

5 
	~<æ©fe.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<ÿs£¹
>

11 
	~<c¡dšt
>

12 
	~<İtiÚ®
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

16 
	$FUZZ_TARGET
(
æ©fe
)

18 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

19 
¡d
::
İtiÚ®
<
FÏtFePos
> 
æ©_fe_pos
 = 
CÚsumeDe£rŸlizabË
<FÏtFePos>(
fuzzed_d©a_´ovid”
);

20 ià(!
æ©_fe_pos
) {

23 
¡d
::
İtiÚ®
<
FÏtFePos
> 
ªÙh”_æ©_fe_pos
 = 
CÚsumeDe£rŸlizabË
<FÏtFePos>(
fuzzed_d©a_´ovid”
);

24 ià(
ªÙh”_æ©_fe_pos
) {

25 
	`as£¹
((*
æ©_fe_pos
 =ğ*
ªÙh”_æ©_fe_pos
) != (*flat_file_pos != *another_flat_file_pos));

27 ()
æ©_fe_pos
->
	`ToSŒšg
();

28 
æ©_fe_pos
->
	`S‘NuÎ
();

29 
	`as£¹
(
æ©_fe_pos
->
	`IsNuÎ
());

30 
	}
}

	@float.cpp

5 
	~<memu§ge.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

9 
	~<ut/£ræßt.h
>

10 
	~<v”siÚ.h
>

12 
	~<ÿs£¹
>

13 
	~<cm©h
>

14 
	~<lim™s
>

16 
	$FUZZ_TARGET
()

18 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

21 cÚ¡ 
d
{[&] {

22 
tmp
;

23 
	`C®lOÃOf
(

24 
fuzzed_d©a_´ovid”
,

26 [&] { 
tmp
 = 
fuzzed_d©a_´ovid”
.
CÚsumeFlßtšgPošt
<>(); },

28 [&] { 
tmp
 = 
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
({

29 
¡d
::
num”ic_lim™s
<>::
	`šfš™y
(),

30 -
¡d
::
num”ic_lim™s
<>::
	`šfš™y
(),

31 
¡d
::
num”ic_lim™s
<>::
	`mš
(),

32 -
¡d
::
num”ic_lim™s
<>::
	`mš
(),

33 
¡d
::
num”ic_lim™s
<>::
	`max
(),

34 -
¡d
::
num”ic_lim™s
<>::
	`max
(),

35 
¡d
::
num”ic_lim™s
<>::
	`lowe¡
(),

36 -
¡d
::
num”ic_lim™s
<>::
	`lowe¡
(),

37 
¡d
::
num”ic_lim™s
<>::
	`qu›t_NaN
(),

38 -
¡d
::
num”ic_lim™s
<>::
	`qu›t_NaN
(),

39 
¡d
::
num”ic_lim™s
<>::
	`sigÇlšg_NaN
(),

40 -
¡d
::
num”ic_lim™s
<>::
	`sigÇlšg_NaN
(),

41 
¡d
::
num”ic_lim™s
<>::
	`d’Üm_mš
(),

42 -
¡d
::
num”ic_lim™s
<>::
	`d’Üm_mš
(),

45 [&] { 
tmp
 = 
	`DecodeDoubË
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>()); });

46  
tmp
;

48 ()
memu§ge
::
	`DyÇmicU§ge
(
d
);

50 
ušt64_t
 
’coded
 = 
	`EncodeDoubË
(
d
);

51 
	`cÚ¡ex´
 (
¡d
::
num”ic_lim™s
<>::
is_›c559
) {

52 ià(!
¡d
::
	`i¢ª
(
d
)) {

53 
ušt64_t
 
’coded_š_memÜy
;

54 
¡d
::
	`cİy
((cÚ¡ *)&
d
, (cÚ¡ *)(&d + 1), (*)&
’coded_š_memÜy
);

55 
	`as£¹
(
’coded_š_memÜy
 =ğ
’coded
);

58 
d_de£rŸlized
 = 
	`DecodeDoubË
(
’coded
);

59 
	`as£¹
(
¡d
::
	`i¢ª
(
d
è=ğ¡d::i¢ª(
d_de£rŸlized
));

60 
	`as£¹
(
¡d
::
	`i¢ª
(
d
è|| d =ğ
d_de£rŸlized
);

62 
	}
}

	@fuzz.cpp

5 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<fs.h
>

8 
	~<Ãdd»ss.h
>

9 
	~<Ãtba£.h
>

10 
	~<‹¡/ut/£tup_commÚ.h
>

11 
	~<ut/check.h
>

12 
	~<ut/sock.h
>

13 
	~<ut/time.h
>

15 
	~<csigÇl
>

16 
	~<c¡dšt
>

17 
	~<exû±iÚ
>

18 
	~<f¡»am
>

19 
	~<funùiÚ®
>

20 
	~<m­
>

21 
	~<memÜy
>

22 
	~<¡ršg
>

23 
	~<tu¶e
>

24 
	~<uni¡d.h
>

25 
	~<veùÜ
>

27 cÚ¡ 
	g¡d
::
funùiÚ
<(cÚ¡ 
¡d
::
¡ršg
&)> 
G_TEST_LOG_FUN
{};

36 
	g¡d
::
veùÜ
<cÚ¡ *> 
g_¬gs
;

38 
	$S‘Args
(
¬gc
, ** 
¬gv
) {

39 
i
 = 1; i < 
¬gc
; ++i) {

42 ià(
	`¡¾’
(
¬gv
[
i
]) > 2 &&‡rgv[i][0] == '-' &&‡rgv[i][1] == '-') {

43 
g_¬gs
.
	`push_back
(
¬gv
[
i
]);

46 
	}
}

48 cÚ¡ 
	g¡d
::
funùiÚ
<
¡d
::
veùÜ
<cÚ¡ *>()> 
G_TEST_COMMAND_LINE_ARGUMENTS
 = []() {

49  
g_¬gs
;

52 
	g¡d
::
m­
<
¡d
::
¡ršg_v›w
, std::
tu¶e
<
Ty³Te¡OÃIÅut
, 
	gTy³In™Ÿlize
, 
	gTy³Hidd’
>>& 
	$FuzzT¬g‘s
()

54 
¡d
::
m­
<¡d::
¡ršg_v›w
, std::
tu¶e
<
Ty³Te¡OÃIÅut
, 
Ty³In™Ÿlize
, 
Ty³Hidd’
>> 
g_fuzz_rg‘s
;

55  
g_fuzz_rg‘s
;

56 
	}
}

58 
	$FuzzF¿mewÜkRegi¡”T¬g‘
(
¡d
::
¡ršg_v›w
 
Çme
, 
Ty³Te¡OÃIÅut
 
rg‘
, 
Ty³In™Ÿlize
 
š™
, 
Ty³Hidd’
 
hidd’
)

60 cÚ¡‡utØ
™_šs
 = 
	`FuzzT¬g‘s
().
	`Œy_em¶aû
(
Çme
, 
¡d
::
	`move
(
rg‘
), std::move(
š™
), 
hidd’
);

61 
	`As£¹
(
™_šs
.
£cÚd
);

62 
	}
}

64 
	g¡d
::
¡ršg_v›w
 
g_fuzz_rg‘
;

65 
Ty³Te¡OÃIÅut
* 
	gg_‹¡_Úe_šput
{
	gnuÎ±r
};

67 
	$š™Ÿlize
()

70 
C»©eSock
 = [](cÚ¡ 
CS”viû
&è-> 
¡d
::
unique_±r
<
Sock
> { std::
	`‹rmš©e
(); };

73 
g_dns_lookup
 = [](cÚ¡ 
¡d
::
¡ršg
& 
Çme
, 
boŞ
 
®low_lookup
) {

74 ià(
®low_lookup
) {

75 
¡d
::
	`‹rmš©e
();

77  
	`W¿µedG‘AddrInfo
(
Çme
, 
çl£
);

80 
boŞ
 
should_abÜt
{
çl£
};

81 ià(
¡d
::
	`g‘’v
("PRINT_ALL_FUZZ_TARGETS_AND_ABORT")) {

82 cÚ¡‡uto& 
t
 : 
	`FuzzT¬g‘s
()) {

83 ià(
¡d
::
g‘
<2>(
t
.
£cÚd
)) ;

84 
¡d
::
cout
 << 
t
.
fœ¡
 << std::
’dl
;

86 
should_abÜt
 = 
Œue
;

88 ià(cÚ¡ * 
out_·th
 = 
¡d
::
	`g‘’v
("WRITE_ALL_FUZZ_TARGETS_AND_ABORT")) {

89 
¡d
::
cout
 << "Wr™šg‡Î fuzz¬g‘‚ame tØ'" << 
out_·th
 << "'." << std::
’dl
;

90 
¡d
::
of¡»am
 
out_¡»am
{
out_·th
, std::
ios
::
bš¬y
};

91 cÚ¡‡uto& 
t
 : 
	`FuzzT¬g‘s
()) {

92 ià(
¡d
::
g‘
<2>(
t
.
£cÚd
)) ;

93 
out_¡»am
 << 
t
.
fœ¡
 << 
¡d
::
’dl
;

95 
should_abÜt
 = 
Œue
;

97 
	`As£¹
(!
should_abÜt
);

98 
g_fuzz_rg‘
 = 
	`As£¹
(
¡d
::
	`g‘’v
("FUZZ"));

99 cÚ¡‡utØ
™
 = 
	`FuzzT¬g‘s
().
	`fšd
(
g_fuzz_rg‘
);

100 ià(
™
 =ğ
	`FuzzT¬g‘s
().
	`’d
()) {

101 
¡d
::
û¼
 << "NØfuzz” fÜ " << 
g_fuzz_rg‘
 << "." << std::
’dl
;

102 
¡d
::
	`ex™
(
EXIT_FAILURE
);

104 
	`As£¹
(!
g_‹¡_Úe_šput
);

105 
g_‹¡_Úe_šput
 = &
¡d
::
g‘
<0>(
™
->
£cÚd
);

106 
¡d
::
g‘
<1>(
™
->
£cÚd
)();

107 
	}
}

109 #ià
defšed
(
PROVIDE_FUZZ_MAIN_FUNCTION
)

110 
boŞ
 
»ad_¡dš
(
¡d
::
veùÜ
<
ušt8_t
>& 
d©a
)

112 
ušt8_t
 
bufãr
[1024];

113 
ssize_t
 
	gËngth
 = 0;

114 (
	gËngth
 = 
»ad
(
STDIN_FILENO
, 
bufãr
, 1024)) > 0) {

115 
	gd©a
.
š£¹
(
d©a
.
’d
(), 
bufãr
, bufã¸+ 
Ëngth
);

117  
	gËngth
 == 0;

121 #ià
defšed
(
PROVIDE_FUZZ_MAIN_FUNCTION
è&& !defšed(
__AFL_LOOP
)

122 
boŞ
 
»ad_fe
(
fs
::
·th
 
p
, 
¡d
::
veùÜ
<
ušt8_t
>& 
d©a
)

124 
ušt8_t
 
bufãr
[1024];

125 
FILE
* 
	gf
 = 
fsbridge
::
fİ’
(
p
, "rb");

126 ià(
	gf
 =ğ
nuÎ±r
è 
çl£
;

128 cÚ¡ 
size_t
 
	gËngth
 = 
ä—d
(
bufãr
, (
ušt8_t
), (bufãr), 
f
);

129 ià(
ã¼Ü
(
f
)è 
	gçl£
;

130 
	gd©a
.
š£¹
(
d©a
.
’d
(), 
bufãr
, bufã¸+ 
Ëngth
);

131 } !
ãof
(
f
));

132 
fşo£
(
f
);

133  
	gŒue
;

137 #ià
defšed
(
PROVIDE_FUZZ_MAIN_FUNCTION
è&& !defšed(
__AFL_LOOP
)

138 
	gfs
::
·th
 
g_šput_·th
;

139 
	$sigÇl_hªdËr
(
sigÇl
)

141 ià(
sigÇl
 =ğ
SIGABRT
) {

142 
¡d
::
û¼
 << "E¼Ü…roûssšg iÅuˆ" << 
g_šput_·th
 << std::
’dl
;

144 
¡d
::
û¼
 << "UÃx³ùed sigÇÈ" << 
sigÇl
 << "„eceived\n";

146 
¡d
::
	`_Ex™
(
EXIT_FAILURE
);

147 
	}
}

151 "C" 
	$LLVMFuzz”Te¡OÃIÅut
(cÚ¡ 
ušt8_t
* 
d©a
, 
size_t
 
size
)

153 cÚ¡‡uto& 
‹¡_Úe_šput
 = *
	`As£¹
(
g_‹¡_Úe_šput
);

154 
	`‹¡_Úe_šput
({
d©a
, 
size
});

156 
	}
}

159 "C" 
	$LLVMFuzz”In™Ÿlize
(* 
¬gc
, *** 
¬gv
)

161 
	`S‘Args
(*
¬gc
, *
¬gv
);

162 
	`š™Ÿlize
();

164 
	}
}

166 #ià
defšed
(
PROVIDE_FUZZ_MAIN_FUNCTION
)

167 
	$maš
(
¬gc
, ** 
¬gv
)

169 
	`š™Ÿlize
();

170 cÚ¡‡uto& 
‹¡_Úe_šput
 = *
	`As£¹
(
g_‹¡_Úe_šput
);

171 #ifdeà
__AFL_INIT


174 
	`__AFL_INIT
();

177 #ifdeà
__AFL_LOOP


180 
	`__AFL_LOOP
(1000)) {

181 
¡d
::
veùÜ
<
ušt8_t
> 
bufãr
;

182 ià(!
	`»ad_¡dš
(
bufãr
)) {

185 
	`‹¡_Úe_šput
(
bufãr
);

188 
¡d
::
veùÜ
<
ušt8_t
> 
bufãr
;

189 ià(
¬gc
 <= 1) {

190 ià(!
	`»ad_¡dš
(
bufãr
)) {

193 
	`‹¡_Úe_šput
(
bufãr
);

196 
¡d
::
	`sigÇl
(
SIGABRT
, 
sigÇl_hªdËr
);

197 cÚ¡‡utØ
¡¬t_time
{
Now
<
S‹adySecÚds
>()};

198 
‹¡ed
 = 0;

199 
i
 = 1; i < 
¬gc
; ++i) {

200 
fs
::
·th
 
	`šput_·th
(*(
¬gv
 + 
i
));

201 ià(
fs
::
	`is_dœeùÜy
(
šput_·th
)) {

202 
fs
::
dœeùÜy_™”©Ü
 
	`™
(
šput_·th
); 
™
 !ğfs::
	`dœeùÜy_™”©Ü
(); ++it) {

203 ià(!
fs
::
	`is_»guÏr_fe
(
™
->
	`·th
())) ;

204 
g_šput_·th
 = 
™
->
	`·th
();

205 
	`As£¹
(
	`»ad_fe
(
™
->
	`·th
(), 
bufãr
));

206 
	`‹¡_Úe_šput
(
bufãr
);

207 ++
‹¡ed
;

208 
bufãr
.
	`ş—r
();

211 
g_šput_·th
 = 
šput_·th
;

212 
	`As£¹
(
	`»ad_fe
(
šput_·th
, 
bufãr
));

213 
	`‹¡_Úe_šput
(
bufãr
);

214 ++
‹¡ed
;

215 
bufãr
.
	`ş—r
();

218 cÚ¡‡utØ
’d_time
{
Now
<
S‹adySecÚds
>()};

219 
¡d
::
cout
 << 
g_fuzz_rg‘
 << ": sucûeded‡gaš¡ " << 
‹¡ed
 << " fe š " << 
	`couÁ_£cÚds
(
’d_time
 - 
¡¬t_time
è<< "s." << std::
’dl
;

222 
	}
}

	@fuzz.h

5 #iâdeà
BITCOIN_TEST_FUZZ_FUZZ_H


6 
	#BITCOIN_TEST_FUZZ_FUZZ_H


	)

8 
	~<¥ª.h
>

10 
	~<c¡dšt
>

11 
	~<funùiÚ®
>

12 
	~<¡ršg_v›w
>

18 
	#LIMITED_WHILE
(
cÚd™iÚ
, 
lim™
) \

19 
_couÁ
{
lim™
}; (
cÚd™iÚ
è&& _couÁ; --_couÁ)

	)

21 
usšg
 
	gFuzzBufãrTy³
 = 
S·n
<cÚ¡ 
ušt8_t
>;

23 
usšg
 
	gTy³Te¡OÃIÅut
 = 
¡d
::
funùiÚ
<(
FuzzBufãrTy³
)>;

24 
usšg
 
	gTy³In™Ÿlize
 = 
¡d
::
funùiÚ
<()>;

25 
usšg
 
	gTy³Hidd’
 = 
boŞ
;

27 
FuzzF¿mewÜkRegi¡”T¬g‘
(
¡d
::
¡ršg_v›w
 
Çme
, 
Ty³Te¡OÃIÅut
 
rg‘
, 
Ty³In™Ÿlize
 
š™
, 
Ty³Hidd’
 
hidd’
);

29 
šlše
 
	$FuzzF¿mewÜkEm±yIn™Fun
(è{
	}
}

31 
	#FUZZ_TARGET
(
Çme
) \

32 
	`FUZZ_TARGET_INIT
(
Çme
, 
FuzzF¿mewÜkEm±yIn™Fun
)

	)

34 
	#FUZZ_TARGET_INIT
(
Çme
, 
š™_fun
) \

35 
	`FUZZ_TARGET_INIT_HIDDEN
(
Çme
, 
š™_fun
, 
çl£
)

	)

37 
	#FUZZ_TARGET_INIT_HIDDEN
(
Çme
, 
š™_fun
, 
hidd’
) \

38 
Çme
##
	`_fuzz_rg‘
(
FuzzBufãrTy³
); \

39 
Çme
##
_BefÜe_Maš
 { \

40 
Çme
##
	`_BefÜe_Maš
() \

42 
	`FuzzF¿mewÜkRegi¡”T¬g‘
(#Çme, 
Çme
##
_fuzz_rg‘
, 
š™_fun
, 
hidd’
); \

44 } cÚ¡ 
g_
##
Çme
##
_befÜe_maš
; \

45 
Çme
##
	`_fuzz_rg‘
(
FuzzBufãrTy³
 
bufãr
)

	)

	@golomb_rice.cpp

5 
	~<blockf‹r.h
>

6 
	~<£rŸlize.h
>

7 
	~<¡»ams.h
>

8 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

9 
	~<‹¡/fuzz/fuzz.h
>

10 
	~<‹¡/fuzz/ut.h
>

11 
	~<ut/by‹veùÜhash.h
>

12 
	~<ut/gŞombriû.h
>

14 
	~<®gÜ™hm
>

15 
	~<ÿs£¹
>

16 
	~<c¡dšt
>

17 
	~<iosfwd
>

18 
	~<unÜd”ed_£t
>

19 
	~<veùÜ
>

21 
	gÇme¥aû
 {

23 
ušt64_t
 
HashToRªge
(cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
>& 
–em’t
, cÚ¡ ušt64_ˆ
f
)

25 cÚ¡ 
ušt64_t
 
	ghash
 = 
CSHash”
(0x0706050403020100ULL, 0x0F0E0D0C0B0A0908ULL)

26 .
Wr™e
(
–em’t
.
d©a
(),ƒËm’t.
size
())

27 .
Fš®ize
();

28  
Fa¡Rªge64
(
hash
, 
f
);

31 
	g¡d
::
veùÜ
<
ušt64_t
> 
BudHashedS‘
(cÚ¡ 
¡d
::
unÜd”ed_£t
<¡d::veùÜ<
ušt8_t
>, 
By‹VeùÜHash
>& 
–em’ts
, cÚ¡ ušt64_ˆ
f
)

33 
	g¡d
::
veùÜ
<
ušt64_t
> 
hashed_–em’ts
;

34 
	ghashed_–em’ts
.
»£rve
(
–em’ts
.
size
());

35 cÚ¡ 
	g¡d
::
veùÜ
<
ušt8_t
>& 
–em’t
 : 
–em’ts
) {

36 
hashed_–em’ts
.
push_back
(
HashToRªge
(
–em’t
, 
f
));

38 
	g¡d
::
sÜt
(
hashed_–em’ts
.
begš
(), hashed_–em’ts.
’d
());

39  
	ghashed_–em’ts
;

43 
	$FUZZ_TARGET
(
gŞomb_riû
)

45 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

46 
¡d
::
veùÜ
<
ušt8_t
> 
gŞomb_riû_d©a
;

47 
¡d
::
veùÜ
<
ušt64_t
> 
’coded_d–s
;

49 
¡d
::
unÜd”ed_£t
<¡d::
veùÜ
<
ušt8_t
>, 
By‹VeùÜHash
> 
–em’ts
;

50 cÚ¡ 
n
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 512);

51 
i
 = 0; i < 
n
; ++i) {

52 
–em’ts
.
	`š£¹
(
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 16));

54 
CVeùÜWr™”
 
	`¡»am
(
SER_NETWORK
, 0, 
gŞomb_riû_d©a
, 0);

55 
	`Wr™eCom·ùSize
(
¡»am
, 
¡©ic_ÿ¡
<
ušt32_t
>(
–em’ts
.
	`size
()));

56 
B™SŒ—mWr™”
<
CVeùÜWr™”
> 
	`b™wr™”
(
¡»am
);

57 ià(!
–em’ts
.
	`em±y
()) {

58 
ušt64_t
 
Ï¡_v®ue
 = 0;

59 cÚ¡ 
ušt64_t
 
v®ue
 : 
	`BudHashedS‘
(
–em’ts
, 
¡©ic_ÿ¡
<ušt64_t>ÓËm’ts.
	`size
()è* stic_ÿ¡<ušt64_t>(
BASIC_FILTER_M
))) {

60 cÚ¡ 
ušt64_t
 
d–
 = 
v®ue
 - 
Ï¡_v®ue
;

61 
’coded_d–s
.
	`push_back
(
d–
);

62 
	`GŞombRiûEncode
(
b™wr™”
, 
BASIC_FILTER_P
, 
d–
);

63 
Ï¡_v®ue
 = 
v®ue
;

66 
b™wr™”
.
	`Flush
();

69 
¡d
::
veùÜ
<
ušt64_t
> 
decoded_d–s
;

71 
S·nR—d”
 
¡»am
{
SER_NETWORK
, 0, 
gŞomb_riû_d©a
};

72 
B™SŒ—mR—d”
<
S·nR—d”
> 
b™»ad”
{
¡»am
};

73 cÚ¡ 
ušt32_t
 
n
 = 
¡©ic_ÿ¡
<ušt32_t>(
	`R—dCom·ùSize
(
¡»am
));

74 
ušt32_t
 
i
 = 0; i < 
n
; ++i) {

75 
decoded_d–s
.
	`push_back
(
	`GŞombRiûDecode
(
b™»ad”
, 
BASIC_FILTER_P
));

79 
	`as£¹
(
’coded_d–s
 =ğ
decoded_d–s
);

82 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 1024);

83 
S·nR—d”
 
¡»am
{
SER_NETWORK
, 0, 
¿ndom_by‹s
};

84 
ušt32_t
 
n
;

85 
Œy
 {

86 
n
 = 
¡©ic_ÿ¡
<
ušt32_t
>(
	`R—dCom·ùSize
(
¡»am
));

87 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

90 
B™SŒ—mR—d”
<
S·nR—d”
> 
b™»ad”
{
¡»am
};

91 
ušt32_t
 
i
 = 0; i < 
¡d
::
mš
<ušt32_t>(
n
, 1024); ++i) {

92 
Œy
 {

93 ()
	`GŞombRiûDecode
(
b™»ad”
, 
BASIC_FILTER_P
);

94 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

98 
	}
}

	@hex.cpp

5 
	~<cÜe_io.h
>

6 
	~<´im™ives/block.h
>

7 
	~<pubkey.h
>

8 
	~<½c/ut.h
>

9 
	~<‹¡/fuzz/fuzz.h
>

10 
	~<ušt256.h
>

11 
	~<univ®ue.h
>

12 
	~<ut/¡»ncodšgs.h
>

14 
	~<ÿs£¹
>

15 
	~<c¡dšt
>

16 
	~<¡ršg
>

17 
	~<veùÜ
>

19 
	$š™Ÿlize_hex
()

21 cÚ¡ 
ECCV”ifyHªdË
 
v”ify_hªdË
;

22 
	}
}

24 
	$FUZZ_TARGET_INIT
(
hex
, 
š™Ÿlize_hex
)

26 cÚ¡ 
¡d
::
¡ršg
 
	`¿ndom_hex_¡ršg
(
bufãr
.
	`begš
(), bufãr.
	`’d
());

27 cÚ¡ 
¡d
::
veùÜ
<> 
d©a
 = 
	`P¬£Hex
(
¿ndom_hex_¡ršg
);

28 cÚ¡ 
¡d
::
veùÜ
<¡d::
by‹
> 
by‹s
{
P¬£Hex
<¡d::by‹>(
¿ndom_hex_¡ršg
)};

29 
	`as£¹
(
	`AsBy‹s
(
S·n
{
d©a
}è=ğS·n{
by‹s
});

30 cÚ¡ 
¡d
::
¡ršg
 
hex_d©a
 = 
	`HexSŒ
(
d©a
);

31 ià(
	`IsHex
(
¿ndom_hex_¡ršg
)) {

32 
	`as£¹
(
	`ToLow”
(
¿ndom_hex_¡ršg
è=ğ
hex_d©a
);

34 ()
	`IsHexNumb”
(
¿ndom_hex_¡ršg
);

35 
ušt256
 
»suÉ
;

36 ()
	`P¬£HashSŒ
(
¿ndom_hex_¡ršg
, 
»suÉ
);

37 ()
	`ušt256S
(
¿ndom_hex_¡ršg
);

38 
Œy
 {

39 ()
	`HexToPubKey
(
¿ndom_hex_¡ršg
);

40 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

42 
CBlockH—d”
 
block_h—d”
;

43 ()
	`DecodeHexBlockH—d”
(
block_h—d”
, 
¿ndom_hex_¡ršg
);

44 
CBlock
 
block
;

45 ()
	`DecodeHexBlk
(
block
, 
¿ndom_hex_¡ršg
);

46 
	}
}

	@http_request.cpp

5 
	~<h‰p£rv”.h
>

6 
	~<Ãdd»ss.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<ut/¡»ncodšgs.h
>

12 
	~<ev’t2/bufãr.h
>

13 
	~<ev’t2/ev’t.h
>

14 
	~<ev’t2/h‰p.h
>

15 
	~<ev’t2/h‰p_¡ruù.h
>

17 
	~<ÿs£¹
>

18 
	~<c¡dšt
>

19 
	~<¡ršg
>

20 
	~<veùÜ
>

22 "C" 
evh‰p_·r£_fœ¡lše_
(
evh‰p_»que¡
*, 
evbufãr
*);

23 "C" 
evh‰p_·r£_h—d”s_
(
evh‰p_»que¡
*, 
evbufãr
*);

25 
	g¡d
::
¡ršg
 
Reque¡M‘hodSŒšg
(
HTTPReque¡
::
Reque¡M‘hod
 
m
);

27 
	$FUZZ_TARGET
(
h‰p_»que¡
)

29 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

30 
evh‰p_»que¡
* 
ev»q
 = 
	`evh‰p_»que¡_Ãw
(
nuÎ±r
,‚ullptr);

31 
	`as£¹
(
ev»q
 !ğ
nuÎ±r
);

32 
ev»q
->
kšd
 = 
EVHTTP_REQUEST
;

33 
evbufãr
* 
evbuf
 = 
	`evbufãr_Ãw
();

34 
	`as£¹
(
evbuf
 !ğ
nuÎ±r
);

35 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
h‰p_bufãr
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 4096);

36 
	`evbufãr_add
(
evbuf
, 
h‰p_bufãr
.
	`d©a
(), h‰p_bufãr.
	`size
());

42 cÚ¡ 
¡d
::
¡ršg
 
h‰p_bufãr_¡r
 = 
	`ToLow”
(¡d::¡ršg{
h‰p_bufãr
.
	`begš
(), h‰p_bufãr.
	`’d
()});

43 ià(
h‰p_bufãr_¡r
.
	`fšd
(" h‰p://"è!ğ
¡d
::
¡ršg
::
Åos
 || http_buffer_str.find(" https://") != std::string::npos ||

44 
	`evh‰p_·r£_fœ¡lše_
(
ev»q
, 
evbuf
è!ğ1 || 
	`evh‰p_·r£_h—d”s_
(evreq,ƒvbuf) != 1) {

45 
	`evbufãr_ä“
(
evbuf
);

46 
	`evh‰p_»que¡_ä“
(
ev»q
);

50 
HTTPReque¡
 
h‰p_»que¡
{
ev»q
, 
Œue
};

51 cÚ¡ 
HTTPReque¡
::
Reque¡M‘hod
 
»que¡_m‘hod
 = 
h‰p_»que¡
.
	`G‘Reque¡M‘hod
();

52 ()
	`Reque¡M‘hodSŒšg
(
»que¡_m‘hod
);

53 ()
h‰p_»que¡
.
	`G‘URI
();

54 ()
h‰p_»que¡
.
	`G‘H—d”
("Host");

55 cÚ¡ 
¡d
::
¡ršg
 
h—d”
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(16);

56 ()
h‰p_»que¡
.
	`G‘H—d”
(
h—d”
);

57 ()
h‰p_»que¡
.
	`Wr™eH—d”
(
h—d”
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(16));

58 ()
h‰p_»que¡
.
	`G‘H—d”
(
h—d”
);

59 cÚ¡ 
¡d
::
¡ršg
 
body
 = 
h‰p_»que¡
.
	`R—dBody
();

60 
	`as£¹
(
body
.
	`em±y
());

61 cÚ¡ 
CS”viû
 
£rviû
 = 
h‰p_»que¡
.
	`G‘P“r
();

62 
	`as£¹
(
£rviû
.
	`ToSŒšg
() == "[::]:0");

64 
	`evbufãr_ä“
(
evbuf
);

65 
	`evh‰p_»que¡_ä“
(
ev»q
);

66 
	}
}

	@i2p.cpp

5 
	~<i2p.h
>

6 
	~<Ãdd»ss.h
>

7 
	~<Ãtba£.h
>

8 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

9 
	~<‹¡/fuzz/fuzz.h
>

10 
	~<‹¡/fuzz/ut.h
>

11 
	~<‹¡/ut/£tup_commÚ.h
>

12 
	~<th»adš‹¼u±.h
>

13 
	~<ut/sy¡em.h
>

15 
	$š™Ÿlize_i2p
()

17 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>();

18 
	}
}

20 
	$FUZZ_TARGET_INIT
(
i2p
, 
š™Ÿlize_i2p
)

22 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

25 autØ
C»©eSockOrig
 = 
C»©eSock
;

26 
C»©eSock
 = [&
fuzzed_d©a_´ovid”
](cÚ¡ 
CS”viû
&) {

27  
¡d
::
make_unique
<
FuzzedSock
>(
fuzzed_d©a_´ovid”
);

30 cÚ¡ 
CS”viû
 
§m_´oxy
;

31 
CTh»adIÁ”ru±
 
š‹¼u±
;

33 
i2p
::
§m
::
SessiÚ
 
£ss
{
gArgs
.
	`G‘D©aDœN‘
(è/ "fuzzed_i2p_´iv©e_key", 
§m_´oxy
, &
š‹¼u±
};

35 
i2p
::
CÚÃùiÚ
 
cÚn
;

37 ià(
£ss
.
	`Li¡’
(
cÚn
)) {

38 ià(
£ss
.
	`Acû±
(
cÚn
)) {

39 
Œy
 {

40 ()
cÚn
.
sock
->
	`RecvUÁT”mš©Ü
('\n', 10
ms
, 
š‹¼u±
, 
i2p
::
§m
::
MAX_MSG_SIZE
);

41 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

46 cÚ¡ 
CS”viû
 
to
;

47 
boŞ
 
´oxy_”rÜ
;

49 ià(
£ss
.
	`CÚÃù
(
to
, 
cÚn
, 
´oxy_”rÜ
)) {

50 
Œy
 {

51 
cÚn
.
sock
->
	`S’dCom¶‘e
("v”ack\n", 10
ms
, 
š‹¼u±
);

52 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

56 
C»©eSock
 = 
C»©eSockOrig
;

57 
	}
}

	@integer.cpp

5 
	~<¬™h_ušt256.h
>

6 
	~<com´essÜ.h
>

7 
	~<cÚ£nsus/amouÁ.h
>

8 
	~<cÚ£nsus/m”kË.h
>

9 
	~<cÜe_io.h
>

10 
	~<üy±o/commÚ.h
>

11 
	~<üy±o/shash.h
>

12 
	~<key_io.h
>

13 
	~<memu§ge.h
>

14 
	~<Ãtba£.h
>

15 
	~<pŞicy/pŞicy.h
>

16 
	~<pŞicy/£‰šgs.h
>

17 
	~<pow.h
>

18 
	~<´ÙocŞ.h
>

19 
	~<pubkey.h
>

20 
	~<süt/¡ªd¬d.h
>

21 
	~<£rŸlize.h
>

22 
	~<¡»ams.h
>

23 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

24 
	~<‹¡/fuzz/fuzz.h
>

25 
	~<‹¡/fuzz/ut.h
>

26 
	~<ušt256.h
>

27 
	~<univ®ue.h
>

28 
	~<ut/check.h
>

29 
	~<ut/mÚey¡r.h
>

30 
	~<ut/ov”æow.h
>

31 
	~<ut/¡»ncodšgs.h
>

32 
	~<ut/¡ršg.h
>

33 
	~<ut/sy¡em.h
>

34 
	~<v”siÚ.h
>

36 
	~<ÿs£¹
>

37 
	~<chrÚo
>

38 
	~<lim™s
>

39 
	~<£t
>

40 
	~<veùÜ
>

42 
	$š™Ÿlize_š‹g”
()

44 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
REGTEST
);

45 
	}
}

47 
	$FUZZ_TARGET_INIT
(
š‹g”
, 
š™Ÿlize_š‹g”
)

49 ià(
bufãr
.
	`size
(è< (
ušt256
è+ (
ušt160
)) {

52 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

53 cÚ¡ 
ušt256
 
	`u256
(
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<>((uint256)));

54 cÚ¡ 
ušt160
 
	`u160
(
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<>((uint160)));

55 cÚ¡ 
ušt64_t
 
u64
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint64_t>();

56 cÚ¡ 
št64_t
 
i64
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int64_t>();

57 cÚ¡ 
ušt32_t
 
u32
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>();

58 cÚ¡ 
št32_t
 
i32
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int32_t>();

59 cÚ¡ 
ušt16_t
 
u16
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint16_t>();

60 cÚ¡ 
št16_t
 
i16
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int16_t>();

61 cÚ¡ 
ušt8_t
 
u8
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint8_t>();

62 cÚ¡ 
št8_t
 
i8
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int8_t>();

65 cÚ¡ 
ch
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

66 cÚ¡ 
boŞ
 
b
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

68 cÚ¡ 
CÚ£nsus
::
P¬ams
& 
cÚ£nsus_·¿ms
 = 
	`P¬ams
().
	`G‘CÚ£nsus
();

69 ()
	`CheckProofOfWÜk
(
u256
, 
u32
, 
cÚ£nsus_·¿ms
);

70 ià(
u64
 <ğ
MAX_MONEY
) {

71 cÚ¡ 
ušt64_t
 
com´es£d_mÚey_amouÁ
 = 
	`Com´essAmouÁ
(
u64
);

72 
	`as£¹
(
u64
 =ğ
	`Decom´essAmouÁ
(
com´es£d_mÚey_amouÁ
));

73 cÚ¡ 
ušt64_t
 
com´es£d_mÚey_amouÁ_max
 = 
	`Com´essAmouÁ
(
MAX_MONEY
 - 1);

74 
	`as£¹
(
com´es£d_mÚey_amouÁ
 <ğ
com´es£d_mÚey_amouÁ_max
);

76 ()
	`Com´essAmouÁ
(
u64
);

78 cÚ¡ 
ušt256
 
	`u256_mš
(
	`ušt256S
("0000000000000000000000000000000000000000000000000000000000000000"));

79 cÚ¡ 
ušt256
 
	`u256_max
(
	`ušt256S
("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"));

80 cÚ¡ 
¡d
::
veùÜ
<
ušt256
> 
v256
{
u256
, 
u256_mš
, 
u256_max
};

81 ()
	`Compu‹M”kËRoÙ
(
v256
);

82 ()
	`CouÁB™s
(
u64
);

83 ()
	`Decom´essAmouÁ
(
u64
);

85 ià(
¡d
::
İtiÚ®
<
CAmouÁ
> 
·r£d
 = 
	`P¬£MÚey
(
	`FÜm©MÚey
(
i64
))) {

86 
	`as£¹
(
·r£d
.
	`v®ue
(è=ğ
i64
);

89 ()
	`G‘SizeOfCom·ùSize
(
u64
);

90 ()
	`G‘S³cŸlSütSize
(
u32
);

91 ià(!
	`MuÉliÿtiÚOv”æow
(
i64
, 
¡©ic_ÿ¡
<
št64_t
>(
u32
)è&& !
	`Add™iÚOv”æow
(i64, static_cast<int64_t>(4)) && !AdditionOverflow(i64 * u32, static_cast<int64_t>(4))) {

92 ()
	`G‘Vœtu®T¿n§ùiÚSize
(
i64
, i64, 
u32
);

94 ()
	`HexDig™
(
ch
);

95 ()
	`MÚeyRªge
(
i64
);

96 ()
	`ToSŒšg
(
i64
);

97 ()
	`IsDig™
(
ch
);

98 ()
	`IsS·û
(
ch
);

99 ()
	`IsSw™chCh¬
(
ch
);

100 ()
memu§ge
::
	`DyÇmicU§ge
(
ch
);

101 ()
memu§ge
::
	`DyÇmicU§ge
(
i16
);

102 ()
memu§ge
::
	`DyÇmicU§ge
(
i32
);

103 ()
memu§ge
::
	`DyÇmicU§ge
(
i64
);

104 ()
memu§ge
::
	`DyÇmicU§ge
(
i8
);

105 ()
memu§ge
::
	`DyÇmicU§ge
(
u16
);

106 ()
memu§ge
::
	`DyÇmicU§ge
(
u32
);

107 ()
memu§ge
::
	`DyÇmicU§ge
(
u64
);

108 ()
memu§ge
::
	`DyÇmicU§ge
(
u8
);

109 cÚ¡ 
uch
 = 
¡©ic_ÿ¡
<>(
u8
);

110 ()
memu§ge
::
	`DyÇmicU§ge
(
uch
);

112 cÚ¡ 
¡d
::
£t
<
št64_t
> 
i64s
{
i64
, 
¡©ic_ÿ¡
<št64_t>(
u64
)};

113 cÚ¡ 
size_t
 
dyÇmic_u§ge
 = 
memu§ge
::
	`DyÇmicU§ge
(
i64s
);

114 cÚ¡ 
size_t
 
šüem’l_dyÇmic_u§ge
 = 
memu§ge
::
	`Inüem’lDyÇmicU§ge
(
i64s
);

115 
	`as£¹
(
dyÇmic_u§ge
 =ğ
šüem’l_dyÇmic_u§ge
 * 
i64s
.
	`size
());

117 ()
	`MlisToTimev®
(
i64
);

118 ()
	`SighashToSŒ
(
uch
);

119 ()
	`SHashUšt256
(
u64
, u64, 
u256
);

120 ()
	`SHashUšt256ExŒa
(
u64
, u64, 
u256
, 
u32
);

121 ()
	`ToLow”
(
ch
);

122 ()
	`ToUµ”
(
ch
);

124 ià(
¡d
::
İtiÚ®
<
CAmouÁ
> 
·r£d
 = 
	`P¬£MÚey
(
	`V®ueFromAmouÁ
(
i64
).
	`g‘V®SŒ
())) {

125 
	`as£¹
(
·r£d
.
	`v®ue
(è=ğ
i64
);

128 ià(
i32
 >= 0 && i32 <= 16) {

129 
	`as£¹
(
i32
 =ğ
CSüt
::
	`DecodeOP_N
(CSüt::
	`EncodeOP_N
(i32)));

132 cÚ¡ 
¡d
::
chrÚo
::
£cÚds
 secÚds{
i64
};

133 
	`as£¹
(
	`couÁ_£cÚds
(
£cÚds
è=ğ
i64
);

135 cÚ¡ 
CSütNum
 
süt_num
{
i64
};

136 ()
süt_num
.
	`g‘št
();

137 ()
süt_num
.
	`g‘vch
();

139 cÚ¡ 
¬™h_ušt256
 
au256
 = 
	`UštToAr™h256
(
u256
);

140 
	`as£¹
(
	`Ar™hToUšt256
(
au256
è=ğ
u256
);

141 
	`as£¹
(
	`ušt256S
(
au256
.
	`G‘Hex
()è=ğ
u256
);

142 ()
au256
.
	`b™s
();

143 ()
au256
.
	`G‘Com·ù
Ğ
çl£
);

144 ()
au256
.
	`G‘Com·ù
Ğ
Œue
);

145 ()
au256
.
	`g‘doubË
();

146 ()
au256
.
	`G‘Hex
();

147 ()
au256
.
	`G‘Low64
();

148 ()
au256
.
	`size
();

149 ()
au256
.
	`ToSŒšg
();

151 cÚ¡ 
CKeyID
 
key_id
{
u160
};

152 cÚ¡ 
CSütID
 
süt_id
{
u160
};

155 
CD©aSŒ—m
 
	`¡»am
(
SER_NETWORK
, 
INIT_PROTO_VERSION
);

157 
ušt256
 
de£rŸlized_u256
;

158 
¡»am
 << 
u256
;

159 
¡»am
 >> 
de£rŸlized_u256
;

160 
	`as£¹
(
u256
 =ğ
de£rŸlized_u256
 && 
¡»am
.
	`em±y
());

162 
ušt160
 
de£rŸlized_u160
;

163 
¡»am
 << 
u160
;

164 
¡»am
 >> 
de£rŸlized_u160
;

165 
	`as£¹
(
u160
 =ğ
de£rŸlized_u160
 && 
¡»am
.
	`em±y
());

167 
ušt64_t
 
de£rŸlized_u64
;

168 
¡»am
 << 
u64
;

169 
¡»am
 >> 
de£rŸlized_u64
;

170 
	`as£¹
(
u64
 =ğ
de£rŸlized_u64
 && 
¡»am
.
	`em±y
());

172 
št64_t
 
de£rŸlized_i64
;

173 
¡»am
 << 
i64
;

174 
¡»am
 >> 
de£rŸlized_i64
;

175 
	`as£¹
(
i64
 =ğ
de£rŸlized_i64
 && 
¡»am
.
	`em±y
());

177 
ušt32_t
 
de£rŸlized_u32
;

178 
¡»am
 << 
u32
;

179 
¡»am
 >> 
de£rŸlized_u32
;

180 
	`as£¹
(
u32
 =ğ
de£rŸlized_u32
 && 
¡»am
.
	`em±y
());

182 
št32_t
 
de£rŸlized_i32
;

183 
¡»am
 << 
i32
;

184 
¡»am
 >> 
de£rŸlized_i32
;

185 
	`as£¹
(
i32
 =ğ
de£rŸlized_i32
 && 
¡»am
.
	`em±y
());

187 
ušt16_t
 
de£rŸlized_u16
;

188 
¡»am
 << 
u16
;

189 
¡»am
 >> 
de£rŸlized_u16
;

190 
	`as£¹
(
u16
 =ğ
de£rŸlized_u16
 && 
¡»am
.
	`em±y
());

192 
št16_t
 
de£rŸlized_i16
;

193 
¡»am
 << 
i16
;

194 
¡»am
 >> 
de£rŸlized_i16
;

195 
	`as£¹
(
i16
 =ğ
de£rŸlized_i16
 && 
¡»am
.
	`em±y
());

197 
ušt8_t
 
de£rŸlized_u8
;

198 
¡»am
 << 
u8
;

199 
¡»am
 >> 
de£rŸlized_u8
;

200 
	`as£¹
(
u8
 =ğ
de£rŸlized_u8
 && 
¡»am
.
	`em±y
());

202 
št8_t
 
de£rŸlized_i8
;

203 
¡»am
 << 
i8
;

204 
¡»am
 >> 
de£rŸlized_i8
;

205 
	`as£¹
(
i8
 =ğ
de£rŸlized_i8
 && 
¡»am
.
	`em±y
());

207 
boŞ
 
de£rŸlized_b
;

208 
¡»am
 << 
b
;

209 
¡»am
 >> 
de£rŸlized_b
;

210 
	`as£¹
(
b
 =ğ
de£rŸlized_b
 && 
¡»am
.
	`em±y
());

214 cÚ¡ 
S”viûFÏgs
 
£rviû_æags
 = (S”viûFÏgs)
u64
;

215 ()
	`HasAÎDesœabËS”viûFÏgs
(
£rviû_æags
);

216 ()
	`MayHaveU£fulAdd»ssDB
(
£rviû_æags
);

220 
CD©aSŒ—m
 
	`¡»am
(
SER_NETWORK
, 
INIT_PROTO_VERSION
);

222 
	`£r_wr™ed©a64
(
¡»am
, 
u64
);

223 cÚ¡ 
ušt64_t
 
de£rŸlized_u64
 = 
	`£r_»add©a64
(
¡»am
);

224 
	`as£¹
(
u64
 =ğ
de£rŸlized_u64
 && 
¡»am
.
	`em±y
());

226 
	`£r_wr™ed©a32
(
¡»am
, 
u32
);

227 cÚ¡ 
ušt32_t
 
de£rŸlized_u32
 = 
	`£r_»add©a32
(
¡»am
);

228 
	`as£¹
(
u32
 =ğ
de£rŸlized_u32
 && 
¡»am
.
	`em±y
());

230 
	`£r_wr™ed©a32be
(
¡»am
, 
u32
);

231 cÚ¡ 
ušt32_t
 
de£rŸlized_u32be
 = 
	`£r_»add©a32be
(
¡»am
);

232 
	`as£¹
(
u32
 =ğ
de£rŸlized_u32be
 && 
¡»am
.
	`em±y
());

234 
	`£r_wr™ed©a16
(
¡»am
, 
u16
);

235 cÚ¡ 
ušt16_t
 
de£rŸlized_u16
 = 
	`£r_»add©a16
(
¡»am
);

236 
	`as£¹
(
u16
 =ğ
de£rŸlized_u16
 && 
¡»am
.
	`em±y
());

238 
	`£r_wr™ed©a16be
(
¡»am
, 
u16
);

239 cÚ¡ 
ušt16_t
 
de£rŸlized_u16be
 = 
	`£r_»add©a16be
(
¡»am
);

240 
	`as£¹
(
u16
 =ğ
de£rŸlized_u16be
 && 
¡»am
.
	`em±y
());

242 
	`£r_wr™ed©a8
(
¡»am
, 
u8
);

243 cÚ¡ 
ušt8_t
 
de£rŸlized_u8
 = 
	`£r_»add©a8
(
¡»am
);

244 
	`as£¹
(
u8
 =ğ
de£rŸlized_u8
 && 
¡»am
.
	`em±y
());

248 
CD©aSŒ—m
 
	`¡»am
(
SER_NETWORK
, 
INIT_PROTO_VERSION
);

250 
	`Wr™eCom·ùSize
(
¡»am
, 
u64
);

251 
Œy
 {

252 cÚ¡ 
ušt64_t
 
de£rŸlized_u64
 = 
	`R—dCom·ùSize
(
¡»am
);

253 
	`as£¹
(
u64
 =ğ
de£rŸlized_u64
 && 
¡»am
.
	`em±y
());

254 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

258 
Œy
 {

259 
	`CHECK_NONFATAL
(
b
);

260 } 
	`ÿtch
 (cÚ¡ 
NÚF©®CheckE¼Ü
&) {

262 
	}
}

	@key.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<chaš·¿msba£.h
>

7 
	~<key.h
>

8 
	~<key_io.h
>

9 
	~<ouu‰y³.h
>

10 
	~<pŞicy/pŞicy.h
>

11 
	~<pubkey.h
>

12 
	~<½c/ut.h
>

13 
	~<süt/keyÜigš.h
>

14 
	~<süt/süt.h
>

15 
	~<süt/sign.h
>

16 
	~<süt/signšg´ovid”.h
>

17 
	~<süt/¡ªd¬d.h
>

18 
	~<¡»ams.h
>

19 
	~<‹¡/fuzz/fuzz.h
>

20 
	~<ut/¡»ncodšgs.h
>

22 
	~<ÿs£¹
>

23 
	~<c¡dšt
>

24 
	~<num”ic
>

25 
	~<¡ršg
>

26 
	~<veùÜ
>

28 
	$š™Ÿlize_key
()

30 cÚ¡ 
ECCV”ifyHªdË
 
ecc_v”ify_hªdË
;

31 
	`ECC_S¹
();

32 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
REGTEST
);

33 
	}
}

35 
	$FUZZ_TARGET_INIT
(
key
, 
š™Ÿlize_key
)

37 cÚ¡ 
CKey
 
key
 = [&] {

38 
CKey
 
k
;

39 
k
.
	`S‘
(
bufãr
.
	`begš
(), bufãr.
	`’d
(), 
Œue
);

40  
k
;

42 ià(!
key
.
	`IsV®id
()) {

47 
	`as£¹
(
key
.
	`begš
(è+ key.
	`size
(è=ğkey.
	`’d
());

48 
	`as£¹
(
key
.
	`IsCom´es£d
());

49 
	`as£¹
(
key
.
	`size
() == 32);

50 
	`as£¹
(
	`DecodeSeü‘
(
	`EncodeSeü‘
(
key
)) == key);

54 
CKey
 
šv®id_key
;

55 
	`as£¹
(!(
šv®id_key
 =ğ
key
));

56 
	`as£¹
(!
šv®id_key
.
	`IsCom´es£d
());

57 
	`as£¹
(!
šv®id_key
.
	`IsV®id
());

58 
	`as£¹
(
šv®id_key
.
	`size
() == 0);

62 
CKey
 
uncom´es£d_key
;

63 
uncom´es£d_key
.
	`S‘
(
bufãr
.
	`begš
(), bufãr.
	`’d
(), 
çl£
);

64 
	`as£¹
(!(
uncom´es£d_key
 =ğ
key
));

65 
	`as£¹
(!
uncom´es£d_key
.
	`IsCom´es£d
());

66 
	`as£¹
(
key
.
	`size
() == 32);

67 
	`as£¹
(
uncom´es£d_key
.
	`begš
(è+ uncom´es£d_key.
	`size
(è=ğuncom´es£d_key.
	`’d
());

68 
	`as£¹
(
uncom´es£d_key
.
	`IsV®id
());

72 
CKey
 
cİ›d_key
;

73 
cİ›d_key
.
	`S‘
(
key
.
	`begš
(), key.
	`’d
(), key.
	`IsCom´es£d
());

74 
	`as£¹
(
cİ›d_key
 =ğ
key
);

78 
CKey
 
Ãg©ed_key
 = 
key
;

79 
Ãg©ed_key
.
	`Neg©e
();

80 
	`as£¹
(
Ãg©ed_key
.
	`IsV®id
());

81 
	`as£¹
(!(
Ãg©ed_key
 =ğ
key
));

83 
Ãg©ed_key
.
	`Neg©e
();

84 
	`as£¹
(
Ãg©ed_key
 =ğ
key
);

87 cÚ¡ 
ušt256
 
¿ndom_ušt256
 = 
	`Hash
(
bufãr
);

90 
CKey
 
chd_key
;

91 
ChašCode
 
chd_chašcode
;

92 cÚ¡ 
boŞ
 
ok
 = 
key
.
	`D”ive
(
chd_key
, 
chd_chašcode
, 0, 
¿ndom_ušt256
);

93 
	`as£¹
(
ok
);

94 
	`as£¹
(
chd_key
.
	`IsV®id
());

95 
	`as£¹
(!(
chd_key
 =ğ
key
));

96 
	`as£¹
(
chd_chašcode
 !ğ
¿ndom_ušt256
);

99 cÚ¡ 
CPubKey
 
pubkey
 = 
key
.
	`G‘PubKey
();

102 
	`as£¹
(
pubkey
.
	`size
() == 33);

103 
	`as£¹
(
key
.
	`V”ifyPubKey
(
pubkey
));

104 
	`as£¹
(
pubkey
.
	`G‘Hash
(è!ğ
¿ndom_ušt256
);

105 
	`as£¹
(
pubkey
.
	`begš
(è+…ubkey.
	`size
(è=ğpubkey.
	`’d
());

106 
	`as£¹
(
pubkey
.
	`d©a
(è=ğpubkey.
	`begš
());

107 
	`as£¹
(
pubkey
.
	`IsCom´es£d
());

108 
	`as£¹
(
pubkey
.
	`IsV®id
());

109 
	`as£¹
(
pubkey
.
	`IsFuÎyV®id
());

110 
	`as£¹
(
	`HexToPubKey
(
	`HexSŒ
(
pubkey
)) ==…ubkey);

111 
	`as£¹
(
	`G‘AÎDe¡š©iÚsFÜKey
(
pubkey
).
	`size
() == 3);

115 
CD©aSŒ—m
 
d©a_¡»am
{
SER_NETWORK
, 
INIT_PROTO_VERSION
};

116 
pubkey
.
	`S”Ÿlize
(
d©a_¡»am
);

118 
CPubKey
 
pubkey_de£rŸlized
;

119 
pubkey_de£rŸlized
.
	`Un£rŸlize
(
d©a_¡»am
);

120 
	`as£¹
(
pubkey_de£rŸlized
 =ğ
pubkey
);

124 cÚ¡ 
CSüt
 
tx_pubkey_süt
 = 
	`G‘SütFÜRawPubKey
(
pubkey
);

125 
	`as£¹
(!
tx_pubkey_süt
.
	`IsPayToSütHash
());

126 
	`as£¹
(!
tx_pubkey_süt
.
	`IsPayToW™ÃssSütHash
());

127 
	`as£¹
(!
tx_pubkey_süt
.
	`IsPushOÆy
());

128 
	`as£¹
(!
tx_pubkey_süt
.
	`IsUn¥’dabË
());

129 
	`as£¹
(
tx_pubkey_süt
.
	`HasV®idOps
());

130 
	`as£¹
(
tx_pubkey_süt
.
	`size
() == 35);

132 cÚ¡ 
CSüt
 
tx_muÉisig_süt
 = 
	`G‘SütFÜMuÉisig
(1, {
pubkey
});

133 
	`as£¹
(!
tx_muÉisig_süt
.
	`IsPayToSütHash
());

134 
	`as£¹
(!
tx_muÉisig_süt
.
	`IsPayToW™ÃssSütHash
());

135 
	`as£¹
(!
tx_muÉisig_süt
.
	`IsPushOÆy
());

136 
	`as£¹
(!
tx_muÉisig_süt
.
	`IsUn¥’dabË
());

137 
	`as£¹
(
tx_muÉisig_süt
.
	`HasV®idOps
());

138 
	`as£¹
(
tx_muÉisig_süt
.
	`size
() == 37);

140 
FÏbËSignšgProvid”
 
fÏbË_signšg_´ovid”
;

141 
	`as£¹
(!
	`IsSegW™Ouut
(
fÏbË_signšg_´ovid”
, 
tx_pubkey_süt
));

142 
	`as£¹
(!
	`IsSegW™Ouut
(
fÏbË_signšg_´ovid”
, 
tx_muÉisig_süt
));

143 
	`as£¹
(
fÏbË_signšg_´ovid”
.
	`G‘Keys
().
	`size
() == 0);

144 
	`as£¹
(!
fÏbË_signšg_´ovid”
.
	`HaveKey
(
pubkey
.
	`G‘ID
()));

146 cÚ¡ 
boŞ
 
ok_add_key
 = 
fÏbË_signšg_´ovid”
.
	`AddKey
(
key
);

147 
	`as£¹
(
ok_add_key
);

148 
	`as£¹
(
fÏbË_signšg_´ovid”
.
	`HaveKey
(
pubkey
.
	`G‘ID
()));

150 
FÏbËSignšgProvid”
 
fÏbË_signšg_´ovid”_pub
;

151 
	`as£¹
(!
fÏbË_signšg_´ovid”_pub
.
	`HaveKey
(
pubkey
.
	`G‘ID
()));

153 cÚ¡ 
boŞ
 
ok_add_key_pubkey
 = 
fÏbË_signšg_´ovid”_pub
.
	`AddKeyPubKey
(
key
, 
pubkey
);

154 
	`as£¹
(
ok_add_key_pubkey
);

155 
	`as£¹
(
fÏbË_signšg_´ovid”_pub
.
	`HaveKey
(
pubkey
.
	`G‘ID
()));

157 
TxoutTy³
 
which_ty³_tx_pubkey
;

158 cÚ¡ 
boŞ
 
is_¡ªd¬d_tx_pubkey
 = 
	`IsSnd¬d
(
tx_pubkey_süt
, 
¡d
::
nuÎİt
, 
which_ty³_tx_pubkey
);

159 
	`as£¹
(
is_¡ªd¬d_tx_pubkey
);

160 
	`as£¹
(
which_ty³_tx_pubkey
 =ğ
TxoutTy³
::
PUBKEY
);

162 
TxoutTy³
 
which_ty³_tx_muÉisig
;

163 cÚ¡ 
boŞ
 
is_¡ªd¬d_tx_muÉisig
 = 
	`IsSnd¬d
(
tx_muÉisig_süt
, 
¡d
::
nuÎİt
, 
which_ty³_tx_muÉisig
);

164 
	`as£¹
(
is_¡ªd¬d_tx_muÉisig
);

165 
	`as£¹
(
which_ty³_tx_muÉisig
 =ğ
TxoutTy³
::
MULTISIG
);

167 
¡d
::
veùÜ
<¡d::veùÜ<>> 
v_sŞutiÚs_»t_tx_pubkey
;

168 cÚ¡ 
TxoutTy³
 
ou‰y³_tx_pubkey
 = 
	`SŞv”
(
tx_pubkey_süt
, 
v_sŞutiÚs_»t_tx_pubkey
);

169 
	`as£¹
(
ou‰y³_tx_pubkey
 =ğ
TxoutTy³
::
PUBKEY
);

170 
	`as£¹
(
v_sŞutiÚs_»t_tx_pubkey
.
	`size
() == 1);

171 
	`as£¹
(
v_sŞutiÚs_»t_tx_pubkey
[0].
	`size
() == 33);

173 
¡d
::
veùÜ
<¡d::veùÜ<>> 
v_sŞutiÚs_»t_tx_muÉisig
;

174 cÚ¡ 
TxoutTy³
 
ou‰y³_tx_muÉisig
 = 
	`SŞv”
(
tx_muÉisig_süt
, 
v_sŞutiÚs_»t_tx_muÉisig
);

175 
	`as£¹
(
ou‰y³_tx_muÉisig
 =ğ
TxoutTy³
::
MULTISIG
);

176 
	`as£¹
(
v_sŞutiÚs_»t_tx_muÉisig
.
	`size
() == 3);

177 
	`as£¹
(
v_sŞutiÚs_»t_tx_muÉisig
[0].
	`size
() == 1);

178 
	`as£¹
(
v_sŞutiÚs_»t_tx_muÉisig
[1].
	`size
() == 33);

179 
	`as£¹
(
v_sŞutiÚs_»t_tx_muÉisig
[2].
	`size
() == 1);

181 
OuutTy³
 
ouut_ty³
{};

182 cÚ¡ 
CTxDe¡š©iÚ
 
tx_de¡š©iÚ
 = 
	`G‘De¡š©iÚFÜKey
(
pubkey
, 
ouut_ty³
);

183 
	`as£¹
(
ouut_ty³
 =ğ
OuutTy³
::
LEGACY
);

184 
	`as£¹
(
	`IsV®idDe¡š©iÚ
(
tx_de¡š©iÚ
));

185 
	`as£¹
(
CTxDe¡š©iÚ
{
PKHash
{
pubkey
}} =ğ
tx_de¡š©iÚ
);

187 cÚ¡ 
CSüt
 
süt_fÜ_de¡š©iÚ
 = 
	`G‘SütFÜDe¡š©iÚ
(
tx_de¡š©iÚ
);

188 
	`as£¹
(
süt_fÜ_de¡š©iÚ
.
	`size
() == 25);

190 cÚ¡ 
¡d
::
¡ršg
 
de¡š©iÚ_add»ss
 = 
	`EncodeDe¡š©iÚ
(
tx_de¡š©iÚ
);

191 
	`as£¹
(
	`DecodeDe¡š©iÚ
(
de¡š©iÚ_add»ss
è=ğ
tx_de¡š©iÚ
);

193 cÚ¡ 
CPubKey
 
pubkey_äom_add»ss_¡ršg
 = 
	`AddrToPubKey
(
fÏbË_signšg_´ovid”
, 
de¡š©iÚ_add»ss
);

194 
	`as£¹
(
pubkey_äom_add»ss_¡ršg
 =ğ
pubkey
);

196 
CKeyID
 
key_id
 = 
pubkey
.
	`G‘ID
();

197 
	`as£¹
(!
key_id
.
	`IsNuÎ
());

198 
	`as£¹
(
key_id
 =ğ
CKeyID
{key_id});

199 
	`as£¹
(
key_id
 =ğ
	`G‘KeyFÜDe¡š©iÚ
(
fÏbË_signšg_´ovid”
, 
tx_de¡š©iÚ
));

201 
CPubKey
 
pubkey_out
;

202 cÚ¡ 
boŞ
 
ok_g‘_pubkey
 = 
fÏbË_signšg_´ovid”
.
	`G‘PubKey
(
key_id
, 
pubkey_out
);

203 
	`as£¹
(
ok_g‘_pubkey
);

205 
CKey
 
key_out
;

206 cÚ¡ 
boŞ
 
ok_g‘_key
 = 
fÏbË_signšg_´ovid”
.
	`G‘Key
(
key_id
, 
key_out
);

207 
	`as£¹
(
ok_g‘_key
);

208 
	`as£¹
(
fÏbË_signšg_´ovid”
.
	`G‘Keys
().
	`size
() == 1);

209 
	`as£¹
(
fÏbË_signšg_´ovid”
.
	`HaveKey
(
key_id
));

211 
KeyOrigšInfo
 
key_Üigš_šfo
;

212 cÚ¡ 
boŞ
 
ok_g‘_key_Üigš
 = 
fÏbË_signšg_´ovid”
.
	`G‘KeyOrigš
(
key_id
, 
key_Üigš_šfo
);

213 
	`as£¹
(!
ok_g‘_key_Üigš
);

217 cÚ¡ 
¡d
::
veùÜ
<> 
vch_pubkey
{
pubkey
.
	`begš
(),…ubkey.
	`’d
()};

218 
	`as£¹
(
CPubKey
::
	`V®idSize
(
vch_pubkey
));

219 
	`as£¹
(!
CPubKey
::
	`V®idSize
({
pubkey
.
	`begš
(),…ubkey.begš(è+…ubkey.
	`size
() - 1}));

221 cÚ¡ 
CPubKey
 
pubkey_ùÜ_1
{
vch_pubkey
};

222 
	`as£¹
(
pubkey
 =ğ
pubkey_ùÜ_1
);

224 cÚ¡ 
CPubKey
 
pubkey_ùÜ_2
{
vch_pubkey
.
	`begš
(), vch_pubkey.
	`’d
()};

225 
	`as£¹
(
pubkey
 =ğ
pubkey_ùÜ_2
);

227 
CPubKey
 
pubkey_£t
;

228 
pubkey_£t
.
	`S‘
(
vch_pubkey
.
	`begš
(), vch_pubkey.
	`’d
());

229 
	`as£¹
(
pubkey
 =ğ
pubkey_£t
);

233 cÚ¡ 
CPubKey
 
šv®id_pubkey
{};

234 
	`as£¹
(!
šv®id_pubkey
.
	`IsV®id
());

235 
	`as£¹
(!
šv®id_pubkey
.
	`IsFuÎyV®id
());

236 
	`as£¹
(!(
pubkey
 =ğ
šv®id_pubkey
));

237 
	`as£¹
(
pubkey
 !ğ
šv®id_pubkey
);

238 
	`as£¹
(
pubkey
 < 
šv®id_pubkey
);

243 
sum
 = 0;

244 
size_t
 
i
 = 0; i < 
pubkey
.
	`size
(); ++i) {

245 
sum
 +ğ
pubkey
[
i
];

247 
	`as£¹
(
¡d
::
	`accumuÏ‹
(
pubkey
.
	`begš
(),…ubkey.
	`’d
(), 0Uè=ğ
sum
);

251 
CPubKey
 
decom´es£d_pubkey
 = 
pubkey
;

252 
	`as£¹
(
decom´es£d_pubkey
.
	`IsCom´es£d
());

254 cÚ¡ 
boŞ
 
ok
 = 
decom´es£d_pubkey
.
	`Decom´ess
();

255 
	`as£¹
(
ok
);

256 
	`as£¹
(!
decom´es£d_pubkey
.
	`IsCom´es£d
());

257 
	`as£¹
(
decom´es£d_pubkey
.
	`size
() == 65);

261 
¡d
::
veùÜ
<> 
vch_sig
;

262 cÚ¡ 
boŞ
 
ok
 = 
key
.
	`Sign
(
¿ndom_ušt256
, 
vch_sig
, 
çl£
);

263 
	`as£¹
(
ok
);

264 
	`as£¹
(
pubkey
.
	`V”ify
(
¿ndom_ušt256
, 
vch_sig
));

265 
	`as£¹
(
CPubKey
::
	`CheckLowS
(
vch_sig
));

267 cÚ¡ 
¡d
::
veùÜ
<> 
vch_šv®id_sig
{
vch_sig
.
	`begš
(), vch_sig.begš(è+ vch_sig.
	`size
() - 1};

268 
	`as£¹
(!
pubkey
.
	`V”ify
(
¿ndom_ušt256
, 
vch_šv®id_sig
));

269 
	`as£¹
(!
CPubKey
::
	`CheckLowS
(
vch_šv®id_sig
));

273 
¡d
::
veùÜ
<> 
vch_com·ù_sig
;

274 cÚ¡ 
boŞ
 
ok_sign_com·ù
 = 
key
.
	`SignCom·ù
(
¿ndom_ušt256
, 
vch_com·ù_sig
);

275 
	`as£¹
(
ok_sign_com·ù
);

277 
CPubKey
 
»cov”_pubkey
;

278 cÚ¡ 
boŞ
 
ok_»cov”_com·ù
 = 
»cov”_pubkey
.
	`Recov”Com·ù
(
¿ndom_ušt256
, 
vch_com·ù_sig
);

279 
	`as£¹
(
ok_»cov”_com·ù
);

280 
	`as£¹
(
»cov”_pubkey
 =ğ
pubkey
);

284 
CPubKey
 
chd_pubkey
;

285 
ChašCode
 
chd_chašcode
;

286 cÚ¡ 
boŞ
 
ok
 = 
pubkey
.
	`D”ive
(
chd_pubkey
, 
chd_chašcode
, 0, 
¿ndom_ušt256
);

287 
	`as£¹
(
ok
);

288 
	`as£¹
(
chd_pubkey
 !ğ
pubkey
);

289 
	`as£¹
(
chd_pubkey
.
	`IsCom´es£d
());

290 
	`as£¹
(
chd_pubkey
.
	`IsFuÎyV®id
());

291 
	`as£¹
(
chd_pubkey
.
	`IsV®id
());

292 
	`as£¹
(
chd_pubkey
.
	`size
() == 33);

293 
	`as£¹
(
chd_chašcode
 !ğ
¿ndom_ušt256
);

296 cÚ¡ 
CPrivKey
 
´iv_key
 = 
key
.
	`G‘PrivKey
();

299 cÚ¡ 
boŞ
 
sk_check
 : {
Œue
, 
çl£
}) {

300 
CKey
 
lßded_key
;

301 cÚ¡ 
boŞ
 
ok
 = 
lßded_key
.
	`Lßd
(
´iv_key
, 
pubkey
, 
sk_check
);

302 
	`as£¹
(
ok
);

303 
	`as£¹
(
key
 =ğ
lßded_key
);

306 
	}
}

	@key_io.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<key_io.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<ÿs£¹
>

10 
	~<c¡dšt
>

11 
	~<¡ršg
>

12 
	~<veùÜ
>

14 
	$š™Ÿlize_key_io
()

16 cÚ¡ 
ECCV”ifyHªdË
 
v”ify_hªdË
;

17 
	`ECC_S¹
();

18 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
MAIN
);

19 
	}
}

21 
	$FUZZ_TARGET_INIT
(
key_io
, 
š™Ÿlize_key_io
)

23 cÚ¡ 
¡d
::
¡ršg
 
	`¿ndom_¡ršg
(
bufãr
.
	`begš
(), bufãr.
	`’d
());

25 cÚ¡ 
CKey
 
key
 = 
	`DecodeSeü‘
(
¿ndom_¡ršg
);

26 ià(
key
.
	`IsV®id
()) {

27 
	`as£¹
(
key
 =ğ
	`DecodeSeü‘
(
	`EncodeSeü‘
(key)));

30 cÚ¡ 
CExtKey
 
ext_key
 = 
	`DecodeExtKey
(
¿ndom_¡ršg
);

31 ià(
ext_key
.
key
.
	`size
() == 32) {

32 
	`as£¹
(
ext_key
 =ğ
	`DecodeExtKey
(
	`EncodeExtKey
(ext_key)));

35 cÚ¡ 
CExtPubKey
 
ext_pub_key
 = 
	`DecodeExtPubKey
(
¿ndom_¡ršg
);

36 ià(
ext_pub_key
.
pubkey
.
	`size
(è=ğ
CPubKey
::
COMPRESSED_SIZE
) {

37 
	`as£¹
(
ext_pub_key
 =ğ
	`DecodeExtPubKey
(
	`EncodeExtPubKey
(ext_pub_key)));

39 
	}
}

	@kitchen_sink.cpp

5 
	~<m”kËblock.h
>

6 
	~<pŞicy/ães.h
>

7 
	~<½c/ut.h
>

8 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

9 
	~<‹¡/fuzz/fuzz.h
>

10 
	~<‹¡/fuzz/ut.h
>

11 
	~<ut/”rÜ.h
>

12 
	~<ut/Œª¦©iÚ.h
>

14 
	~<¬¿y
>

15 
	~<c¡dšt
>

16 
	~<İtiÚ®
>

17 
	~<veùÜ
>

19 
	gÇme¥aû
 {

20 
cÚ¡ex´
 
T¿n§ùiÚE¼Ü
 
	gALL_TRANSACTION_ERROR
[] = {

21 
T¿n§ùiÚE¼Ü
::
OK
,

22 
T¿n§ùiÚE¼Ü
::
MISSING_INPUTS
,

23 
T¿n§ùiÚE¼Ü
::
ALREADY_IN_CHAIN
,

24 
T¿n§ùiÚE¼Ü
::
P2P_DISABLED
,

25 
T¿n§ùiÚE¼Ü
::
MEMPOOL_REJECTED
,

26 
T¿n§ùiÚE¼Ü
::
MEMPOOL_ERROR
,

27 
T¿n§ùiÚE¼Ü
::
INVALID_PSBT
,

28 
T¿n§ùiÚE¼Ü
::
PSBT_MISMATCH
,

29 
T¿n§ùiÚE¼Ü
::
SIGHASH_MISMATCH
,

30 
T¿n§ùiÚE¼Ü
::
MAX_FEE_EXCEEDED
,

37 
	$FUZZ_TARGET
(
k™ch’_sšk
)

39 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

41 cÚ¡ 
T¿n§ùiÚE¼Ü
 
Œª§ùiÚ_”rÜ
 = 
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
(
ALL_TRANSACTION_ERROR
);

42 ()
	`JSONRPCT¿n§ùiÚE¼Ü
(
Œª§ùiÚ_”rÜ
);

43 ()
	`RPCE¼ÜFromT¿n§ùiÚE¼Ü
(
Œª§ùiÚ_”rÜ
);

44 ()
	`T¿n§ùiÚE¼ÜSŒšg
(
Œª§ùiÚ_”rÜ
);

46 ()
	`SŒšgFÜF“E¡im©eHÜizÚ
(
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
(
ALL_FEE_ESTIMATE_HORIZONS
));

48 cÚ¡ 
OuutTy³
 
ouut_ty³
 = 
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
(
OUTPUT_TYPES
);

49 cÚ¡ 
¡d
::
¡ršg
& 
ouut_ty³_¡ršg
 = 
	`FÜm©OuutTy³
(
ouut_ty³
);

50 cÚ¡ 
¡d
::
İtiÚ®
<
OuutTy³
> 
·r£d
 = 
	`P¬£OuutTy³
(
ouut_ty³_¡ršg
);

51 
	`as£¹
(
·r£d
);

52 
	`as£¹
(
ouut_ty³
 =ğ
·r£d
.
	`v®ue
());

53 ()
	`P¬£OuutTy³
(
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(64));

55 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
by‹s
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

56 cÚ¡ 
¡d
::
veùÜ
<
boŞ
> 
b™s
 = 
	`By‹sToB™s
(
by‹s
);

57 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
by‹s_decoded
 = 
	`B™sToBy‹s
(
b™s
);

58 
	`as£¹
(
by‹s
 =ğ
by‹s_decoded
);

59 
	}
}

	@load_external_block_file.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<æ©fe.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<‹¡/ut/£tup_commÚ.h
>

11 
	~<v®id©iÚ.h
>

13 
	~<c¡dšt
>

14 
	~<veùÜ
>

16 
	gÇme¥aû
 {

17 cÚ¡ 
Te¡šgS‘up
* 
	gg_£tup
;

20 
	$š™Ÿlize_lßd_ex‹º®_block_fe
()

22 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<cÚ¡ 
Te¡šgS‘up
>();

23 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

24 
	}
}

26 
	$FUZZ_TARGET_INIT
(
lßd_ex‹º®_block_fe
, 
š™Ÿlize_lßd_ex‹º®_block_fe
)

28 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

29 
FuzzedFeProvid”
 
fuzzed_fe_´ovid”
 = 
	`CÚsumeFe
(
fuzzed_d©a_´ovid”
);

30 
FILE
* 
fuzzed_block_fe
 = 
fuzzed_fe_´ovid”
.
	`İ’
();

31 ià(
fuzzed_block_fe
 =ğ
nuÎ±r
) {

34 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

36 
FÏtFePos
 
æ©_fe_pos
;

37 
¡d
::
muÉim­
<
ušt256
, 
FÏtFePos
> 
blocks_w™h_unknown_·»Á
;

38 
g_£tup
->
m_node
.
chašmª
->
	`AùiveChaš¡©e
().
	`LßdEx‹º®BlockFe
(
fuzzed_block_fe
, &
æ©_fe_pos
, &
blocks_w™h_unknown_·»Á
);

41 
g_£tup
->
m_node
.
chašmª
->
	`AùiveChaš¡©e
().
	`LßdEx‹º®BlockFe
(
fuzzed_block_fe
);

43 
	}
}

	@locale.cpp

5 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

6 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<tšyfÜm©.h
>

8 
	~<ut/¡»ncodšgs.h
>

9 
	~<ut/¡ršg.h
>

11 
	~<ÿs£¹
>

12 
	~<şoÿË
>

13 
	~<c¡dšt
>

14 
	~<loÿË
>

15 
	~<¡ršg
>

16 
	~<veùÜ
>

18 
	gÇme¥aû
 {

19 cÚ¡ 
	g¡d
::
¡ršg
 
loÿË_id’tif›rs
[] = {

22 
	g¡d
::
¡ršg
 
CÚsumeLoÿËId’tif›r
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
)

24  
fuzzed_d©a_´ovid”
.
PickV®ueInA¼ay
<
¡d
::
¡ršg
>(
loÿË_id’tif›rs
);

27 
boŞ
 
IsAvaabËLoÿË
(cÚ¡ 
¡d
::
¡ršg
& 
loÿË_id’tif›r
)

29 
Œy
 {

30 ()
¡d
::
loÿË
(
loÿË_id’tif›r
);

31 } 
ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

32  
çl£
;

34  
	gŒue
;

38 
	$FUZZ_TARGET
(
loÿË
)

40 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

41 cÚ¡ 
¡d
::
¡ršg
 
loÿË_id’tif›r
 = 
	`CÚsumeLoÿËId’tif›r
(
fuzzed_d©a_´ovid”
);

42 ià(!
	`IsAvaabËLoÿË
(
loÿË_id’tif›r
)) {

45 cÚ¡ * 
c_loÿË
 = 
¡d
::
	`£oÿË
(
LC_ALL
, "C");

46 
	`as£¹
(
c_loÿË
 !ğ
nuÎ±r
);

48 cÚ¡ 
¡d
::
¡ršg
 
¿ndom_¡ršg
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(5);

49 
št32_t
 
·r£št32_out_w™hout_loÿË
;

50 cÚ¡ 
boŞ
 
·r£št32_w™hout_loÿË
 = 
	`P¬£IÁ32
(
¿ndom_¡ršg
, &
·r£št32_out_w™hout_loÿË
);

51 
št64_t
 
·r£št64_out_w™hout_loÿË
;

52 cÚ¡ 
boŞ
 
·r£št64_w™hout_loÿË
 = 
	`P¬£IÁ64
(
¿ndom_¡ršg
, &
·r£št64_out_w™hout_loÿË
);

53 cÚ¡ 
št64_t
 
¿ndom_št64
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int64_t>();

54 cÚ¡ 
¡d
::
¡ršg
 
to¡ršg_w™hout_loÿË
 = 
	`ToSŒšg
(
¿ndom_št64
);

57 cÚ¡ 
št32_t
 
¿ndom_št32
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int32_t>();

58 ()
¿ndom_št32
;

59 cÚ¡ 
¡d
::
¡ršg
 
¡½rštf_št_w™hout_loÿË
 = 
	`¡½rštf
("%d", 
¿ndom_št64
);

60 cÚ¡ 
¿ndom_doubË
 = 
fuzzed_d©a_´ovid”
.
CÚsumeFlßtšgPošt
<>();

61 cÚ¡ 
¡d
::
¡ršg
 
¡½rštf_doubË_w™hout_loÿË
 = 
	`¡½rštf
("%f", 
¿ndom_doubË
);

63 cÚ¡ * 
Ãw_loÿË
 = 
¡d
::
	`£oÿË
(
LC_ALL
, 
loÿË_id’tif›r
.
	`c_¡r
());

64 
	`as£¹
(
Ãw_loÿË
 !ğ
nuÎ±r
);

66 
št32_t
 
·r£št32_out_w™h_loÿË
;

67 cÚ¡ 
boŞ
 
·r£št32_w™h_loÿË
 = 
	`P¬£IÁ32
(
¿ndom_¡ršg
, &
·r£št32_out_w™h_loÿË
);

68 
	`as£¹
(
·r£št32_w™hout_loÿË
 =ğ
·r£št32_w™h_loÿË
);

69 ià(
·r£št32_w™hout_loÿË
) {

70 
	`as£¹
(
·r£št32_out_w™hout_loÿË
 =ğ
·r£št32_out_w™h_loÿË
);

72 
št64_t
 
·r£št64_out_w™h_loÿË
;

73 cÚ¡ 
boŞ
 
·r£št64_w™h_loÿË
 = 
	`P¬£IÁ64
(
¿ndom_¡ršg
, &
·r£št64_out_w™h_loÿË
);

74 
	`as£¹
(
·r£št64_w™hout_loÿË
 =ğ
·r£št64_w™h_loÿË
);

75 ià(
·r£št64_w™hout_loÿË
) {

76 
	`as£¹
(
·r£št64_out_w™hout_loÿË
 =ğ
·r£št64_out_w™h_loÿË
);

78 cÚ¡ 
¡d
::
¡ršg
 
to¡ršg_w™h_loÿË
 = 
	`ToSŒšg
(
¿ndom_št64
);

79 
	`as£¹
(
to¡ršg_w™hout_loÿË
 =ğ
to¡ršg_w™h_loÿË
);

80 cÚ¡ 
¡d
::
¡ršg
 
¡½rštf_št_w™h_loÿË
 = 
	`¡½rštf
("%d", 
¿ndom_št64
);

81 
	`as£¹
(
¡½rštf_št_w™hout_loÿË
 =ğ
¡½rštf_št_w™h_loÿË
);

82 cÚ¡ 
¡d
::
¡ršg
 
¡½rštf_doubË_w™h_loÿË
 = 
	`¡½rštf
("%f", 
¿ndom_doubË
);

83 
	`as£¹
(
¡½rštf_doubË_w™hout_loÿË
 =ğ
¡½rštf_doubË_w™h_loÿË
);

85 cÚ¡ 
¡d
::
loÿË
 
cu¼’t_ıp_loÿË
;

86 
	`as£¹
(
cu¼’t_ıp_loÿË
 =ğ
¡d
::
loÿË
::
	`şassic
());

87 
	}
}

	@merkleblock.cpp

5 
	~<m”kËblock.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

9 
	~<ušt256.h
>

11 
	~<c¡dšt
>

12 
	~<İtiÚ®
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

16 
	$FUZZ_TARGET
(
m”kËblock
)

18 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

19 
CP¬tŸlM”kËT»e
 
·¹Ÿl_m”kË_Œ“
;

20 
	`C®lOÃOf
(

21 
fuzzed_d©a_´ovid”
,

23 cÚ¡ 
¡d
::
İtiÚ®
<
CP¬tŸlM”kËT»e
> 
İt_·¹Ÿl_m”kË_Œ“
 = 
CÚsumeDe£rŸlizabË
<CP¬tŸlM”kËT»e>(
fuzzed_d©a_´ovid”
);

24 ià(
İt_·¹Ÿl_m”kË_Œ“
) {

25 
·¹Ÿl_m”kË_Œ“
 = *
İt_·¹Ÿl_m”kË_Œ“
;

29 
CM”kËBlock
 
m”kË_block
;

30 cÚ¡ 
¡d
::
İtiÚ®
<
CBlock
> 
İt_block
 = 
CÚsumeDe£rŸlizabË
<CBlock>(
fuzzed_d©a_´ovid”
);

31 
CBloomF‹r
 
bloom_f‹r
;

32 
¡d
::
£t
<
ušt256
> 
txids
;

33 ià(
İt_block
 && !İt_block->
vtx
.
	`em±y
()) {

34 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

35 
m”kË_block
 = 
CM”kËBlock
{*
İt_block
, 
bloom_f‹r
};

36 } ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

37 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

38 
txids
.
	`š£¹
(
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
));

40 
m”kË_block
 = 
CM”kËBlock
{*
İt_block
, 
txids
};

43 
·¹Ÿl_m”kË_Œ“
 = 
m”kË_block
.
txn
;

45 ()
·¹Ÿl_m”kË_Œ“
.
	`G‘NumT¿n§ùiÚs
();

46 
¡d
::
veùÜ
<
ušt256
> 
m©ches
;

47 
¡d
::
veùÜ
<> 
šdiûs
;

48 ()
·¹Ÿl_m”kË_Œ“
.
	`ExŒaùM©ches
(
m©ches
, 
šdiûs
);

49 
	}
}

	@message.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<key_io.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<ut/mes§ge.h
>

11 
	~<ut/¡»ncodšgs.h
>

13 
	~<ÿs£¹
>

14 
	~<c¡dšt
>

15 
	~<io¡»am
>

16 
	~<¡ršg
>

17 
	~<veùÜ
>

19 
	$š™Ÿlize_mes§ge
()

21 cÚ¡ 
ECCV”ifyHªdË
 
ecc_v”ify_hªdË
;

22 
	`ECC_S¹
();

23 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
REGTEST
);

24 
	}
}

26 
	$FUZZ_TARGET_INIT
(
mes§ge
, 
š™Ÿlize_mes§ge
)

28 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

29 cÚ¡ 
¡d
::
¡ršg
 
¿ndom_mes§ge
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(1024);

31 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

32 
CKey
 
´iv©e_key
;

33 
´iv©e_key
.
	`S‘
(
¿ndom_by‹s
.
	`begš
(),„ªdom_by‹s.
	`’d
(), 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

34 
¡d
::
¡ršg
 
sigÇtu»
;

35 cÚ¡ 
boŞ
 
mes§ge_sigÃd
 = 
	`Mes§geSign
(
´iv©e_key
, 
¿ndom_mes§ge
, 
sigÇtu»
);

36 ià(
´iv©e_key
.
	`IsV®id
()) {

37 
	`as£¹
(
mes§ge_sigÃd
);

38 cÚ¡ 
Mes§geV”ifiÿtiÚResuÉ
 
v”ifiÿtiÚ_»suÉ
 = 
	`Mes§geV”ify
(
	`EncodeDe¡š©iÚ
(
	`PKHash
(
´iv©e_key
.
	`G‘PubKey
().
	`G‘ID
())), 
sigÇtu»
, 
¿ndom_mes§ge
);

39 
	`as£¹
(
v”ifiÿtiÚ_»suÉ
 =ğ
Mes§geV”ifiÿtiÚResuÉ
::
OK
);

43 ()
	`Mes§geHash
(
¿ndom_mes§ge
);

44 ()
	`Mes§geV”ify
(
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(1024), fuzzed_d©a_´ovid”.CÚsumeRªdomL’gthSŒšg(1024), 
¿ndom_mes§ge
);

45 ()
	`SignšgResuÉSŒšg
(
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
({
SignšgResuÉ
::
OK
, SignšgResuÉ::
PRIVATE_KEY_NOT_AVAILABLE
, SignšgResuÉ::
SIGNING_FAILED
}));

47 
	}
}

	@miniscript.cpp

5 
	~<cÜe_io.h
>

6 
	~<hash.h
>

7 
	~<key.h
>

8 
	~<süt/mšisüt.h
>

9 
	~<süt/süt.h
>

10 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

11 
	~<‹¡/fuzz/fuzz.h
>

12 
	~<‹¡/fuzz/ut.h
>

13 
	~<ut/¡»ncodšgs.h
>

15 
	gÇme¥aû
 {

18 
	sTe¡D©a
 {

19 
CPubKey
 
	tKey
;

22 
	g¡d
::
veùÜ
<
Key
> 
dummy_keys
;

23 
	g¡d
::
m­
<
Key
, > 
	gdummy_key_idx_m­
;

24 
	g¡d
::
m­
<
CKeyID
, 
	gKey
> 
	gdummy_keys_m­
;

27 
In™
() {

28 
	gkeyd©a
[32] = {1};

29 
size_t
 
	gi
 = 0; i < 256; i++) {

30 
	gkeyd©a
[31] = 
i
;

31 
CKey
 
	g´ivkey
;

32 
	g´ivkey
.
S‘
(
keyd©a
, keyd©¨+ 32, 
Œue
);

33 cÚ¡ 
Key
 
	gpubkey
 = 
´ivkey
.
G‘PubKey
();

35 
	gdummy_keys
.
push_back
(
pubkey
);

36 
	gdummy_key_idx_m­
.
em¶aû
(
pubkey
, 
i
);

37 
	gdummy_keys_m­
.
š£¹
({
pubkey
.
G‘ID
(),…ubkey});

40 } 
	gTEST_DATA
;

47 
	sP¬£rCÚ‹xt
 {

48 
CPubKey
 
	tKey
;

50 
boŞ
 
KeyCom·»
(cÚ¡ 
Key
& 
a
, cÚ¡ Key& 
b
) const {

51  
	ga
 < 
	gb
;

54 
	g¡d
::
İtiÚ®
<
¡d
::
¡ršg
> 
ToSŒšg
(cÚ¡ 
Key
& 
key
) const

56 autØ
™
 = 
TEST_DATA
.
dummy_key_idx_m­
.
fšd
(
key
);

57 ià(
	g™
 =ğ
TEST_DATA
.
dummy_key_idx_m­
.
’d
())  {};

58 
ušt8_t
 
	gidx
 = 
™
->
£cÚd
;

59  
HexSŒ
(
S·n
{&
idx
, 1});

62 
	g‹m¶©e
<
ty³Çme
 
	gI
>

63 
	g¡d
::
İtiÚ®
<
Key
> 
FromSŒšg
(
I
 
fœ¡
, I 
Ï¡
) const {

64 ià(
	gÏ¡
 - 
	gfœ¡
 != 2)  {};

65 autØ
	gidx
 = 
P¬£Hex
(
¡d
::
¡ršg
(
fœ¡
, 
Ï¡
));

66 ià(
	gidx
.
size
() != 1)  {};

67  
	gTEST_DATA
.
	gdummy_keys
[
idx
[0]];

70 
	g‹m¶©e
<
ty³Çme
 
	gI
>

71 
	g¡d
::
İtiÚ®
<
Key
> 
FromPKBy‹s
(
I
 
fœ¡
, I 
Ï¡
) const {

72 
Key
 
	gkey
;

73 
	gkey
.
S‘
(
fœ¡
, 
Ï¡
);

74 ià(!
	gkey
.
IsV®id
())  {};

75  
	gkey
;

78 
	g‹m¶©e
<
ty³Çme
 
	gI
>

79 
	g¡d
::
İtiÚ®
<
Key
> 
FromPKHBy‹s
(
I
 
fœ¡
, I 
Ï¡
) const {

80 
as£¹
(
Ï¡
 - 
fœ¡
 == 20);

81 
CKeyID
 
	gkeyid
;

82 
	g¡d
::
cİy
(
fœ¡
, 
Ï¡
, 
keyid
.
begš
());

83 cÚ¡‡utØ
	g™
 = 
TEST_DATA
.
dummy_keys_m­
.
fšd
(
keyid
);

84 ià(
	g™
 =ğ
TEST_DATA
.
dummy_keys_m­
.
’d
())  {};

85  
	g™
->
	g£cÚd
;

87 } 
	gPARSER_CTX
;

90 
	sSütP¬£rCÚ‹xt
 {

92 
	sKey
 {

93 
boŞ
 
	gis_hash
;

94 
	g¡d
::
veùÜ
<> 
d©a
;

97 
boŞ
 
KeyCom·»
(cÚ¡ 
Key
& 
a
, cÚ¡ Key& 
b
) const {

98  
	ga
.
	gd©a
 < 
	gb
.data;

101 cÚ¡ 
	g¡d
::
veùÜ
<>& 
ToPKBy‹s
(cÚ¡ 
Key
& 
key
) const

103 
as£¹
(!
key
.
is_hash
);

104  
	gkey
.
	gd©a
;

107 cÚ¡ 
	g¡d
::
veùÜ
<> 
ToPKHBy‹s
(cÚ¡ 
Key
& 
key
) const

109 ià(
key
.
is_hash
è key.
d©a
;

110 cÚ¡‡utØ
	gh
 = 
Hash160
(
key
.
d©a
);

111  {
	gh
.
begš
(), h.
’d
()};

114 
	g‹m¶©e
<
ty³Çme
 
	gI
>

115 
	g¡d
::
İtiÚ®
<
Key
> 
FromPKBy‹s
(
I
 
fœ¡
, I 
Ï¡
) const

117 
Key
 
	gkey
;

118 
	gkey
.
	gd©a
.
assign
(
fœ¡
, 
Ï¡
);

119 
	gkey
.
	gis_hash
 = 
çl£
;

120  
	gkey
;

123 
	g‹m¶©e
<
ty³Çme
 
	gI
>

124 
	g¡d
::
İtiÚ®
<
Key
> 
FromPKHBy‹s
(
I
 
fœ¡
, I 
Ï¡
) const

126 
Key
 
	gkey
;

127 
	gkey
.
	gd©a
.
assign
(
fœ¡
, 
Ï¡
);

128 
	gkey
.
	gis_hash
 = 
Œue
;

129  
	gkey
;

131 } 
	gSCRIPT_PARSER_CONTEXT
;

135 
	$FuzzIn™
()

137 
	`ECC_S¹
();

138 
TEST_DATA
.
	`In™
();

139 
	}
}

142 
	$FUZZ_TARGET_INIT
(
mšisüt_¡ršg
, 
FuzzIn™
)

144 
FuzzedD©aProvid”
 
	`´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

145 autØ
¡r
 = 
´ovid”
.
	`CÚsumeRemaššgBy‹sAsSŒšg
();

146 autØ
·r£d
 = 
mšisüt
::
	`FromSŒšg
(
¡r
, 
PARSER_CTX
);

147 ià(!
·r£d
) ;

149 cÚ¡‡utØ
¡r2
 = 
·r£d
->
	`ToSŒšg
(
PARSER_CTX
);

150 
	`as£¹
(
¡r2
);

151 autØ
·r£d2
 = 
mšisüt
::
	`FromSŒšg
(*
¡r2
, 
PARSER_CTX
);

152 
	`as£¹
(
·r£d2
);

153 
	`as£¹
(*
·r£d
 =ğ*
·r£d2
);

154 
	}
}

157 
	$FUZZ_TARGET
(
mšisüt_süt
)

159 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

160 cÚ¡ 
¡d
::
İtiÚ®
<
CSüt
> 
süt
 = 
CÚsumeDe£rŸlizabË
<CSüt>(
fuzzed_d©a_´ovid”
);

161 ià(!
süt
) ;

163 cÚ¡‡utØ
ms
 = 
mšisüt
::
	`FromSüt
(*
süt
, 
SCRIPT_PARSER_CONTEXT
);

164 ià(!
ms
) ;

166 
	`as£¹
(
ms
->
	`ToSüt
(
SCRIPT_PARSER_CONTEXT
è=ğ*
süt
);

167 
	}
}

	@minisketch.cpp

5 
	~<mšisk‘ch.h
>

6 
	~<node/mšisk‘chw¿µ”.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<ut/check.h
>

12 
	~<m­
>

13 
	~<num”ic
>

15 
usšg
 
	gnode
::
MakeMšisk‘ch32
;

17 
	$FUZZ_TARGET
(
mšisk‘ch
)

19 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

20 cÚ¡‡utØ
ÿ·c™y
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(1, 200)};

21 
Mšisk‘ch
 
sk‘ch_a
{
	`As£¹
(
	`MakeMšisk‘ch32
(
ÿ·c™y
))};

22 
Mšisk‘ch
 
sk‘ch_b
{
	`As£¹
(
	`MakeMšisk‘ch32
(
ÿ·c™y
))};

25 
¡d
::
m­
<
ušt32_t
, 
boŞ
> 
diff
;

26 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000)

28 cÚ¡‡utØ
’Œy
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
ušt32_t
>(1, 
¡d
::
num”ic_lim™s
<ušt32_t>::
	`max
() - 1)};

29 cÚ¡‡utØ
K“pDiff
{[&] {

30 
boŞ
& 
mut
{
diff
[
’Œy
]};

31 
mut
 = !mut;

33 
	`C®lOÃOf
(

34 
fuzzed_d©a_´ovid”
,

36 
sk‘ch_a
.
	`Add
(
’Œy
);

37 
	`K“pDiff
();

40 
sk‘ch_b
.
	`Add
(
’Œy
);

41 
	`K“pDiff
();

44 
sk‘ch_a
.
	`Add
(
’Œy
);

45 
sk‘ch_b
.
	`Add
(
’Œy
);

48 cÚ¡‡utØ
num_diff
{
¡d
::
	`accumuÏ‹
(
diff
.
	`begš
(), diff.
	`’d
(), 
size_t
{0}, []×utØ
n
, cÚ¡‡uto& 
e
è{ ‚ +ƒ.
£cÚd
; })};

50 
Mšisk‘ch
 
sk‘ch_¬
{
	`MakeMšisk‘ch32
(
ÿ·c™y
)};

51 
Mšisk‘ch
 
sk‘ch_br
{
	`MakeMšisk‘ch32
(
ÿ·c™y
)};

52 
sk‘ch_¬
.
	`De£rŸlize
(
sk‘ch_a
.
	`S”Ÿlize
());

53 
sk‘ch_br
.
	`De£rŸlize
(
sk‘ch_b
.
	`S”Ÿlize
());

55 
Mšisk‘ch
 
sk‘ch_diff
{
¡d
::
	`move
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è? 
sk‘ch_a
 : 
sk‘ch_¬
)};

56 
sk‘ch_diff
.
	`M”ge
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è? 
sk‘ch_b
 : 
sk‘ch_br
);

58 ià(
ÿ·c™y
 >ğ
num_diff
) {

59 cÚ¡‡utØ
max_–em’ts
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(
num_diff
, 
ÿ·c™y
)};

60 cÚ¡‡utØ
dec
{*
	`As£¹
(
sk‘ch_diff
.
	`Decode
(
max_–em’ts
))};

61 
	`As£¹
(
dec
.
	`size
(è=ğ
num_diff
);

62 autØ
d
 : 
dec
) {

63 
	`As£¹
(
diff
.
	`©
(
d
));

66 
	}
}

	@muhash.cpp

5 
	~<üy±o/muhash.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<veùÜ
>

12 
	$FUZZ_TARGET
(
muhash
)

14 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

15 
¡d
::
veùÜ
<
ušt8_t
> 
d©a
{
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
)};

16 
¡d
::
veùÜ
<
ušt8_t
> 
d©a2
{
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
)};

18 
MuHash3072
 
muhash
;

20 
muhash
.
	`In£¹
(
d©a
);

21 
muhash
.
	`In£¹
(
d©a2
);

23 cÚ¡ 
¡d
::
¡ršg
 
š™Ÿl_¡©e_hash
{"dd5ad2a105c2d29495f577245c357409002329b9f4d6182c0af3dc2f462555c8"};

24 
ušt256
 
out
;

25 
ušt256
 
out2
;

26 
	`C®lOÃOf
(

27 
fuzzed_d©a_´ovid”
,

30 
muhash
.
	`Fš®ize
(
out
);

32 
muhash
 = 
	`MuHash3072
();

33 
muhash
.
	`In£¹
(
d©a2
);

34 
muhash
.
	`In£¹
(
d©a
);

35 
muhash
.
	`Fš®ize
(
out2
);

39 
muhash
.
	`Fš®ize
(
out
);

40 
MuHash3072
 
muhash3
;

41 
muhash3
 *ğ
muhash
;

42 
muhash3
.
	`Fš®ize
(
out2
);

46 
muhash
 /= muhash;

47 
muhash
.
	`Fš®ize
(
out
);

48 
out2
 = 
	`ušt256S
(
š™Ÿl_¡©e_hash
);

52 
muhash
.
	`Remove
(
d©a
);

53 
muhash
.
	`Remove
(
d©a2
);

54 
muhash
.
	`Fš®ize
(
out
);

55 
out2
 = 
	`ušt256S
(
š™Ÿl_¡©e_hash
);

57 
	`as£¹
(
out
 =ğ
out2
);

58 
	}
}

	@multiplication_overflow.cpp

5 #ià
defšed
(
HAVE_CONFIG_H
)

6 
	~<cÚfig/b™coš-cÚfig.h
>

9 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

10 
	~<‹¡/fuzz/fuzz.h
>

11 
	~<‹¡/fuzz/ut.h
>

13 
	~<c¡dšt
>

14 
	~<¡ršg
>

15 
	~<veùÜ
>

17 
	gÇme¥aû
 {

18 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

19 
Te¡MuÉliÿtiÚOv”æow
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
)

21 cÚ¡ 
T
 
	gi
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<T>();

22 cÚ¡ 
T
 
	gj
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<T>();

23 cÚ¡ 
boŞ
 
	gis_muÉliÿtiÚ_ov”æow_cu¡om
 = 
MuÉliÿtiÚOv”æow
(
i
, 
j
);

24 #ià
defšed
(
HAVE_BUILTIN_MUL_OVERFLOW
)

25 
T
 
	g»suÉ_butš
;

26 cÚ¡ 
boŞ
 
	gis_muÉliÿtiÚ_ov”æow_butš
 = 
__butš_mul_ov”æow
(
i
, 
j
, &
»suÉ_butš
);

27 
as£¹
(
is_muÉliÿtiÚ_ov”æow_cu¡om
 =ğ
is_muÉliÿtiÚ_ov”æow_butš
);

28 ià(!
	gis_muÉliÿtiÚ_ov”æow_cu¡om
) {

29 
as£¹
(
i
 * 
j
 =ğ
»suÉ_butš
);

32 ià(!
	gis_muÉliÿtiÚ_ov”æow_cu¡om
) {

33 ()(
i
 * 
	gj
);

39 
	$FUZZ_TARGET
(
muÉliÿtiÚ_ov”æow
)

41 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

42 
Te¡MuÉliÿtiÚOv”æow
<
št64_t
>(
fuzzed_d©a_´ovid”
);

43 
Te¡MuÉliÿtiÚOv”æow
<
ušt64_t
>(
fuzzed_d©a_´ovid”
);

44 
Te¡MuÉliÿtiÚOv”æow
<
št32_t
>(
fuzzed_d©a_´ovid”
);

45 
Te¡MuÉliÿtiÚOv”æow
<
ušt32_t
>(
fuzzed_d©a_´ovid”
);

46 
Te¡MuÉliÿtiÚOv”æow
<
št16_t
>(
fuzzed_d©a_´ovid”
);

47 
Te¡MuÉliÿtiÚOv”æow
<
ušt16_t
>(
fuzzed_d©a_´ovid”
);

48 
Te¡MuÉliÿtiÚOv”æow
<>(
fuzzed_d©a_´ovid”
);

49 
Te¡MuÉliÿtiÚOv”æow
<>(
fuzzed_d©a_´ovid”
);

50 
Te¡MuÉliÿtiÚOv”æow
<sigÃd >(
fuzzed_d©a_´ovid”
);

51 
	}
}

	@net.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<chaš·¿msba£.h
>

7 
	~<Ãt.h
>

8 
	~<Ãt_³rmissiÚs.h
>

9 
	~<Ãdd»ss.h
>

10 
	~<´ÙocŞ.h
>

11 
	~<¿ndom.h
>

12 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

13 
	~<‹¡/fuzz/fuzz.h
>

14 
	~<‹¡/fuzz/ut.h
>

15 
	~<‹¡/ut/Ãt.h
>

16 
	~<‹¡/ut/£tup_commÚ.h
>

17 
	~<ut/asm­.h
>

19 
	~<c¡dšt
>

20 
	~<İtiÚ®
>

21 
	~<¡ršg
>

22 
	~<veùÜ
>

24 
	$š™Ÿlize_Ãt
()

26 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>(
CBa£ChašP¬ams
::
MAIN
);

27 
	}
}

29 
	$FUZZ_TARGET_INIT
(
Ãt
, 
š™Ÿlize_Ãt
)

31 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

32 
	`S‘MockTime
(
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
));

33 
CNode
 
node
{
	`CÚsumeNode
(
fuzzed_d©a_´ovid”
)};

34 
node
.
	`S‘CommÚV”siÚ
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>());

35 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

36 
	`C®lOÃOf
(

37 
fuzzed_d©a_´ovid”
,

39 
node
.
	`Clo£Sock‘DiscÚÃù
();

42 
CNodeSts
 
¡©s
;

43 
node
.
	`CİySts
(
¡©s
);

46 cÚ¡ 
CNode
* 
add_»f_node
 = 
node
.
	`AddRef
();

47 
	`as£¹
(
add_»f_node
 =ğ&
node
);

50 ià(
node
.
	`G‘RefCouÁ
() > 0) {

51 
node
.
	`R–—£
();

55 cÚ¡ 
¡d
::
İtiÚ®
<
CS”viû
> 
£rviû_İt
 = 
CÚsumeDe£rŸlizabË
<CS”viû>(
fuzzed_d©a_´ovid”
);

56 ià(!
£rviû_İt
) {

59 
node
.
	`S‘AddrLoÿl
(*
£rviû_İt
);

62 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
b
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

63 
boŞ
 
com¶‘e
;

64 
node
.
	`ReûiveMsgBy‹s
(
b
, 
com¶‘e
);

68 ()
node
.
	`G‘AddrLoÿl
();

69 ()
node
.
	`G‘Id
();

70 ()
node
.
	`G‘LoÿlNÚû
();

71 cÚ¡ 
»f_couÁ
 = 
node
.
	`G‘RefCouÁ
();

72 
	`as£¹
(
»f_couÁ
 >= 0);

73 ()
node
.
	`G‘CommÚV”siÚ
();

75 cÚ¡ 
N‘P”missiÚFÏgs
 
Ãt_³rmissiÚ_æags
 = 
	`CÚsumeW—kEnum
(
fuzzed_d©a_´ovid”
, 
ALL_NET_PERMISSION_FLAGS
);

76 ()
node
.
	`HasP”missiÚ
(
Ãt_³rmissiÚ_æags
);

77 ()
node
.
	`CÚÃùedThroughN‘wÜk
();

78 
	}
}

	@net_permissions.cpp

5 
	~<Ãt_³rmissiÚs.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

9 
	~<ut/Œª¦©iÚ.h
>

11 
	~<ÿs£¹
>

12 
	~<c¡dšt
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

16 
	$FUZZ_TARGET
(
Ãt_³rmissiÚs
)

18 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

19 cÚ¡ 
¡d
::
¡ršg
 
s
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(32);

20 cÚ¡ 
N‘P”missiÚFÏgs
 
Ãt_³rmissiÚ_æags
 = 
	`CÚsumeW—kEnum
(
fuzzed_d©a_´ovid”
, 
ALL_NET_PERMISSION_FLAGS
);

22 
N‘Wh™ebšdP”missiÚs
 
Ãt_wh™ebšd_³rmissiÚs
;

23 
bšgu®_¡r
 
”rÜ_Ãt_wh™ebšd_³rmissiÚs
;

24 ià(
N‘Wh™ebšdP”missiÚs
::
	`TryP¬£
(
s
, 
Ãt_wh™ebšd_³rmissiÚs
, 
”rÜ_Ãt_wh™ebšd_³rmissiÚs
)) {

25 ()
N‘P”missiÚs
::
	`ToSŒšgs
(
Ãt_wh™ebšd_³rmissiÚs
.
m_æags
);

26 ()
N‘P”missiÚs
::
	`AddFÏg
(
Ãt_wh™ebšd_³rmissiÚs
.
m_æags
, 
Ãt_³rmissiÚ_æags
);

27 
	`as£¹
(
N‘P”missiÚs
::
	`HasFÏg
(
Ãt_wh™ebšd_³rmissiÚs
.
m_æags
, 
Ãt_³rmissiÚ_æags
));

28 ()
N‘P”missiÚs
::
	`CË¬FÏg
(
Ãt_wh™ebšd_³rmissiÚs
.
m_æags
, 
N‘P”missiÚFÏgs
::
Im¶ic™
);

29 ()
N‘P”missiÚs
::
	`ToSŒšgs
(
Ãt_wh™ebšd_³rmissiÚs
.
m_æags
);

32 
N‘Wh™–i¡P”missiÚs
 
Ãt_wh™–i¡_³rmissiÚs
;

33 
bšgu®_¡r
 
”rÜ_Ãt_wh™–i¡_³rmissiÚs
;

34 ià(
N‘Wh™–i¡P”missiÚs
::
	`TryP¬£
(
s
, 
Ãt_wh™–i¡_³rmissiÚs
, 
”rÜ_Ãt_wh™–i¡_³rmissiÚs
)) {

35 ()
N‘P”missiÚs
::
	`ToSŒšgs
(
Ãt_wh™–i¡_³rmissiÚs
.
m_æags
);

36 ()
N‘P”missiÚs
::
	`AddFÏg
(
Ãt_wh™–i¡_³rmissiÚs
.
m_æags
, 
Ãt_³rmissiÚ_æags
);

37 
	`as£¹
(
N‘P”missiÚs
::
	`HasFÏg
(
Ãt_wh™–i¡_³rmissiÚs
.
m_æags
, 
Ãt_³rmissiÚ_æags
));

38 ()
N‘P”missiÚs
::
	`CË¬FÏg
(
Ãt_wh™–i¡_³rmissiÚs
.
m_æags
, 
N‘P”missiÚFÏgs
::
Im¶ic™
);

39 ()
N‘P”missiÚs
::
	`ToSŒšgs
(
Ãt_wh™–i¡_³rmissiÚs
.
m_æags
);

41 
	}
}

	@netaddress.cpp

5 
	~<Ãdd»ss.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<ÿs£¹
>

11 
	~<c¡dšt
>

12 
	~<veùÜ
>

14 
	$FUZZ_TARGET
(
Ãdd»ss
)

16 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

18 cÚ¡ 
CN‘Addr
 
Ãt_addr
 = 
	`CÚsumeN‘Addr
(
fuzzed_d©a_´ovid”
);

19 ()
Ãt_addr
.
	`G‘N‘CÏss
();

20 ià(
Ãt_addr
.
	`G‘N‘wÜk
(è=ğ
N‘wÜk
::
NET_IPV4
) {

21 
	`as£¹
(
Ãt_addr
.
	`IsIPv4
());

23 ià(
Ãt_addr
.
	`G‘N‘wÜk
(è=ğ
N‘wÜk
::
NET_IPV6
) {

24 
	`as£¹
(
Ãt_addr
.
	`IsIPv6
());

26 ià(
Ãt_addr
.
	`G‘N‘wÜk
(è=ğ
N‘wÜk
::
NET_ONION
) {

27 
	`as£¹
(
Ãt_addr
.
	`IsTÜ
());

29 ià(
Ãt_addr
.
	`G‘N‘wÜk
(è=ğ
N‘wÜk
::
NET_INTERNAL
) {

30 
	`as£¹
(
Ãt_addr
.
	`IsIÁ”Çl
());

32 ià(
Ãt_addr
.
	`G‘N‘wÜk
(è=ğ
N‘wÜk
::
NET_UNROUTABLE
) {

33 
	`as£¹
(!
Ãt_addr
.
	`IsRoubË
());

35 ()
Ãt_addr
.
	`IsBšdAny
();

36 ià(
Ãt_addr
.
	`IsIÁ”Çl
()) {

37 
	`as£¹
(
Ãt_addr
.
	`G‘N‘wÜk
(è=ğ
N‘wÜk
::
NET_INTERNAL
);

39 ià(
Ãt_addr
.
	`IsIPv4
()) {

40 
	`as£¹
(
Ãt_addr
.
	`G‘N‘wÜk
(è=ğ
N‘wÜk
::
NET_IPV4
 ||‚‘_addr.G‘N‘wÜk(è=ğN‘wÜk::
NET_UNROUTABLE
);

42 ià(
Ãt_addr
.
	`IsIPv6
()) {

43 
	`as£¹
(
Ãt_addr
.
	`G‘N‘wÜk
(è=ğ
N‘wÜk
::
NET_IPV6
 ||‚‘_addr.G‘N‘wÜk(è=ğN‘wÜk::
NET_UNROUTABLE
);

45 ()
Ãt_addr
.
	`IsLoÿl
();

46 ià(
Ãt_addr
.
	`IsRFC1918
(è||‚‘_addr.
	`IsRFC2544
(è||‚‘_addr.
	`IsRFC6598
(è||‚‘_addr.
	`IsRFC5737
(è||‚‘_addr.
	`IsRFC3927
()) {

47 
	`as£¹
(
Ãt_addr
.
	`IsIPv4
());

49 ()
Ãt_addr
.
	`IsRFC2544
();

50 ià(
Ãt_addr
.
	`IsRFC3849
(è||‚‘_addr.
	`IsRFC3964
(è||‚‘_addr.
	`IsRFC4380
(è||‚‘_addr.
	`IsRFC4843
(è||‚‘_addr.
	`IsRFC7343
(è||‚‘_addr.
	`IsRFC4862
(è||‚‘_addr.
	`IsRFC6052
(è||‚‘_addr.
	`IsRFC6145
()) {

51 
	`as£¹
(
Ãt_addr
.
	`IsIPv6
());

53 ()
Ãt_addr
.
	`IsRFC3927
();

54 ()
Ãt_addr
.
	`IsRFC3964
();

55 ià(
Ãt_addr
.
	`IsRFC4193
()) {

56 
	`as£¹
(
Ãt_addr
.
	`G‘N‘wÜk
(è=ğ
N‘wÜk
::
NET_INTERNAL
 ||‚‘_addr.G‘N‘wÜk(è=ğN‘wÜk::
NET_UNROUTABLE
);

58 ()
Ãt_addr
.
	`IsRFC4380
();

59 ()
Ãt_addr
.
	`IsRFC4843
();

60 ()
Ãt_addr
.
	`IsRFC4862
();

61 ()
Ãt_addr
.
	`IsRFC5737
();

62 ()
Ãt_addr
.
	`IsRFC6052
();

63 ()
Ãt_addr
.
	`IsRFC6145
();

64 ()
Ãt_addr
.
	`IsRFC6598
();

65 ()
Ãt_addr
.
	`IsRFC7343
();

66 ià(!
Ãt_addr
.
	`IsRoubË
()) {

67 
	`as£¹
(
Ãt_addr
.
	`G‘N‘wÜk
(è=ğ
N‘wÜk
::
NET_UNROUTABLE
 ||‚‘_addr.G‘N‘wÜk(è=ğN‘wÜk::
NET_INTERNAL
);

69 ià(
Ãt_addr
.
	`IsTÜ
()) {

70 
	`as£¹
(
Ãt_addr
.
	`G‘N‘wÜk
(è=ğ
N‘wÜk
::
NET_ONION
);

72 ()
Ãt_addr
.
	`IsV®id
();

73 ()
Ãt_addr
.
	`ToSŒšg
();

74 ()
Ãt_addr
.
	`ToSŒšgIP
();

76 cÚ¡ 
CSubN‘
 
sub_Ãt
{
Ãt_addr
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt8_t
>()};

77 ()
sub_Ãt
.
	`IsV®id
();

78 ()
sub_Ãt
.
	`ToSŒšg
();

80 cÚ¡ 
CS”viû
 
£rviû
{
Ãt_addr
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt16_t
>()};

81 ()
£rviû
.
	`G‘Key
();

82 ()
£rviû
.
	`G‘PÜt
();

83 ()
£rviû
.
	`ToSŒšg
();

84 ()
£rviû
.
	`ToSŒšgIPPÜt
();

85 ()
£rviû
.
	`ToSŒšgPÜt
();

86 ()
	`CS”viûHash
()(
£rviû
);

87 ()
	`CS”viûHash
(0, 0)(
£rviû
);

89 cÚ¡ 
CN‘Addr
 
Ùh”_Ãt_addr
 = 
	`CÚsumeN‘Addr
(
fuzzed_d©a_´ovid”
);

90 ()
Ãt_addr
.
	`G‘R—chab™yFrom
(&
Ùh”_Ãt_addr
);

91 ()
sub_Ãt
.
	`M©ch
(
Ùh”_Ãt_addr
);

93 cÚ¡ 
CS”viû
 
Ùh”_£rviû
{
Ãt_addr
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt16_t
>()};

94 
	`as£¹
((
£rviû
 =ğ
Ùh”_£rviû
) != (service != other_service));

95 ()(
£rviû
 < 
Ùh”_£rviû
);

97 cÚ¡ 
CSubN‘
 
sub_Ãt_cİy_1
{
Ãt_addr
, 
Ùh”_Ãt_addr
};

98 cÚ¡ 
CSubN‘
 
sub_Ãt_cİy_2
{
Ãt_addr
};

100 
CN‘Addr
 
mubË_Ãt_addr
;

101 
mubË_Ãt_addr
.
	`S‘IP
(
Ãt_addr
);

102 
	`as£¹
(
Ãt_addr
 =ğ
mubË_Ãt_addr
);

103 
	}
}

	@netbase_dns_lookup.cpp

5 
	~<Ãdd»ss.h
>

6 
	~<Ãtba£.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

11 
	~<c¡dšt
>

12 
	~<¡ršg
>

13 
	~<veùÜ
>

15 
	$FUZZ_TARGET
(
Ãtba£_dns_lookup
)

17 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

18 cÚ¡ 
¡d
::
¡ršg
 
Çme
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(512);

19 cÚ¡ 
max_»suÉs
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

20 cÚ¡ 
boŞ
 
®low_lookup
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

21 cÚ¡ 
ušt16_t
 
deçuÉ_pÜt
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint16_t>();

23 autØ
fuzzed_dns_lookup_funùiÚ
 = [&](cÚ¡ 
¡d
::
¡ršg
&, 
boŞ
) {

24 
¡d
::
veùÜ
<
CN‘Addr
> 
»sŞved_add»s£s
;

25 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

26 
»sŞved_add»s£s
.
	`push_back
(
	`CÚsumeN‘Addr
(
fuzzed_d©a_´ovid”
));

28  
»sŞved_add»s£s
;

32 
¡d
::
veùÜ
<
CN‘Addr
> 
»sŞved_add»s£s
;

33 ià(
	`LookupHo¡
(
Çme
, 
»sŞved_add»s£s
, 
max_»suÉs
, 
®low_lookup
, 
fuzzed_dns_lookup_funùiÚ
)) {

34 cÚ¡ 
CN‘Addr
& 
»sŞved_add»ss
 : 
»sŞved_add»s£s
) {

35 
	`as£¹
(!
»sŞved_add»ss
.
	`IsIÁ”Çl
());

38 
	`as£¹
(
»sŞved_add»s£s
.
	`size
(è<ğ
max_»suÉs
 || max_results == 0);

41 
CN‘Addr
 
»sŞved_add»ss
;

42 ià(
	`LookupHo¡
(
Çme
, 
»sŞved_add»ss
, 
®low_lookup
, 
fuzzed_dns_lookup_funùiÚ
)) {

43 
	`as£¹
(!
»sŞved_add»ss
.
	`IsIÁ”Çl
());

47 
¡d
::
veùÜ
<
CS”viû
> 
»sŞved_£rviûs
;

48 ià(
	`Lookup
(
Çme
, 
»sŞved_£rviûs
, 
deçuÉ_pÜt
, 
®low_lookup
, 
max_»suÉs
, 
fuzzed_dns_lookup_funùiÚ
)) {

49 cÚ¡ 
CN‘Addr
& 
»sŞved_£rviû
 : 
»sŞved_£rviûs
) {

50 
	`as£¹
(!
»sŞved_£rviû
.
	`IsIÁ”Çl
());

53 
	`as£¹
(
»sŞved_£rviûs
.
	`size
(è<ğ
max_»suÉs
 || max_results == 0);

56 
CS”viû
 
»sŞved_£rviû
;

57 ià(
	`Lookup
(
Çme
, 
»sŞved_£rviû
, 
deçuÉ_pÜt
, 
®low_lookup
, 
fuzzed_dns_lookup_funùiÚ
)) {

58 
	`as£¹
(!
»sŞved_£rviû
.
	`IsIÁ”Çl
());

62 
CS”viû
 
»sŞved_£rviû
 = 
	`LookupNum”ic
(
Çme
, 
deçuÉ_pÜt
, 
fuzzed_dns_lookup_funùiÚ
);

63 
	`as£¹
(!
»sŞved_£rviû
.
	`IsIÁ”Çl
());

66 
CSubN‘
 
»sŞved_subÃt
;

67 ià(
	`LookupSubN‘
(
Çme
, 
»sŞved_subÃt
)) {

68 
	`as£¹
(
»sŞved_subÃt
.
	`IsV®id
());

71 
	}
}

	@node_eviction.cpp

5 
	~<Ãt.h
>

6 
	~<´ÙocŞ.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

11 
	~<®gÜ™hm
>

12 
	~<ÿs£¹
>

13 
	~<c¡dšt
>

14 
	~<İtiÚ®
>

15 
	~<veùÜ
>

17 
	$FUZZ_TARGET
(
node_eviùiÚ
)

19 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

20 
¡d
::
veùÜ
<
NodeEviùiÚCªdid©e
> 
eviùiÚ_ÿndid©es
;

21 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

22 
eviùiÚ_ÿndid©es
.
	`push_back
({

23  
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
NodeId
>(),

24  
¡d
::
chrÚo
::
£cÚds
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>()},

25  
¡d
::
chrÚo
::
miüo£cÚds
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>()},

26  
¡d
::
chrÚo
::
£cÚds
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>()},

27  
¡d
::
chrÚo
::
£cÚds
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>()},

28  
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(),

29  
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(),

30  
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(),

31  
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>(),

32  
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(),

33  
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(),

34  
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
(
ALL_NETWORKS
),

35  
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(),

36  
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
(
ALL_CONNECTION_TYPES
),

41 cÚ¡ 
¡d
::
veùÜ
<
NodeEviùiÚCªdid©e
> 
eviùiÚ_ÿndid©es_cİy
 = 
eviùiÚ_ÿndid©es
;

42 cÚ¡ 
¡d
::
İtiÚ®
<
NodeId
> 
node_to_eviù
 = 
	`S–eùNodeToEviù
(¡d::
	`move
(
eviùiÚ_ÿndid©es
));

43 ià(
node_to_eviù
) {

44 
	`as£¹
(
¡d
::
	`ªy_of
(
eviùiÚ_ÿndid©es_cİy
.
	`begš
(),ƒviùiÚ_ÿndid©es_cİy.
	`’d
(), [&
node_to_eviù
](cÚ¡ 
NodeEviùiÚCªdid©e
& 
eviùiÚ_ÿndid©e
è{  *node_to_eviù =ğeviùiÚ_ÿndid©e.
id
; }));

46 
	}
}

	@p2p_transport_serialization.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<hash.h
>

7 
	~<Ãt.h
>

8 
	~<Ãtmes§gemak”.h
>

9 
	~<´ÙocŞ.h
>

10 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

11 
	~<‹¡/fuzz/fuzz.h
>

13 
	~<ÿs£¹
>

14 
	~<c¡dšt
>

15 
	~<lim™s
>

16 
	~<İtiÚ®
>

17 
	~<veùÜ
>

19 
	$š™Ÿlize_p2p_Œª¥Üt_£rŸliz©iÚ
()

21 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
REGTEST
);

22 
	}
}

24 
	$FUZZ_TARGET_INIT
(
p2p_Œª¥Üt_£rŸliz©iÚ
, 
š™Ÿlize_p2p_Œª¥Üt_£rŸliz©iÚ
)

27 
V1T¿n¥ÜtDe£rŸliz”
 
de£rŸliz”
{
	`P¬ams
(), (
NodeId
)0, 
SER_NETWORK
, 
INIT_PROTO_VERSION
};

28 
V1T¿n¥ÜtS”Ÿliz”
 
£rŸliz”
{};

29 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

31 autØ
checksum_assi¡
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

32 autØ
magic_by‹s_assi¡
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

33 
¡d
::
veùÜ
<
ušt8_t
> 
mubË_msg_by‹s
;

35 autØ
h—d”_by‹s_»maššg
 = 
CMes§geH—d”
::
HEADER_SIZE
;

36 ià(
magic_by‹s_assi¡
) {

37 autØ
msg_¡¬t
 = 
	`P¬ams
().
	`Mes§geS¹
();

38 
size_t
 
i
 = 0; i < 
CMes§geH—d”
::
MESSAGE_SIZE_SIZE
; ++i) {

39 
mubË_msg_by‹s
.
	`push_back
(
msg_¡¬t
[
i
]);

41 
h—d”_by‹s_»maššg
 -ğ
CMes§geH—d”
::
MESSAGE_SIZE_SIZE
;

44 ià(
checksum_assi¡
) {

45 
h—d”_by‹s_»maššg
 -ğ
CMes§geH—d”
::
CHECKSUM_SIZE
;

48 autØ
h—d”_¿ndom_by‹s
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<
ušt8_t
>(
h—d”_by‹s_»maššg
);

49 
mubË_msg_by‹s
.
	`š£¹
(mubË_msg_by‹s.
	`’d
(), 
h—d”_¿ndom_by‹s
.
	`begš
(), header_random_bytes.end());

50 autØ
·ylßd_by‹s
 = 
fuzzed_d©a_´ovid”
.
CÚsumeRemaššgBy‹s
<
ušt8_t
>();

52 ià(
checksum_assi¡
 && 
mubË_msg_by‹s
.
	`size
(è=ğ
CMes§geH—d”
::
CHECKSUM_OFFSET
) {

53 
CHash256
 
hash”
;

54 
hsh
[32];

55 
hash”
.
	`Wr™e
(
·ylßd_by‹s
);

56 
hash”
.
	`Fš®ize
(
hsh
);

57 
size_t
 
i
 = 0; i < 
CMes§geH—d”
::
CHECKSUM_SIZE
; ++i) {

58 
mubË_msg_by‹s
.
	`push_back
(
hsh
[
i
]);

62 
mubË_msg_by‹s
.
	`š£¹
(mubË_msg_by‹s.
	`’d
(), 
·ylßd_by‹s
.
	`begš
(),…ayload_bytes.end());

63 
S·n
<cÚ¡ 
ušt8_t
> 
msg_by‹s
{
mubË_msg_by‹s
};

64 
msg_by‹s
.
	`size
() > 0) {

65 cÚ¡ 
hªdËd
 = 
de£rŸliz”
.
	`R—d
(
msg_by‹s
);

66 ià(
hªdËd
 < 0) {

69 ià(
de£rŸliz”
.
	`Com¶‘e
()) {

70 cÚ¡ 
¡d
::
chrÚo
::
miüo£cÚds
 
m_time
{¡d::
num”ic_lim™s
<
št64_t
>::
	`max
()};

71 
boŞ
 
»jeù_mes§ge
{
çl£
};

72 
CN‘Mes§ge
 
msg
 = 
de£rŸliz”
.
	`G‘Mes§ge
(
m_time
, 
»jeù_mes§ge
);

73 
	`as£¹
(
msg
.
m_ty³
.
	`size
(è<ğ
CMes§geH—d”
::
COMMAND_SIZE
);

74 
	`as£¹
(
msg
.
m_¿w_mes§ge_size
 <ğ
mubË_msg_by‹s
.
	`size
());

75 
	`as£¹
(
msg
.
m_¿w_mes§ge_size
 =ğ
CMes§geH—d”
::
HEADER_SIZE
 + msg.
m_mes§ge_size
);

76 
	`as£¹
(
msg
.
m_time
 == m_time);

78 
¡d
::
veùÜ
<> 
h—d”
;

79 autØ
msg2
 = 
CN‘MsgMak”
{
msg
.
m_»cv
.
	`G‘V”siÚ
()}.
	`Make
(msg.
m_ty³
, 
	`MakeUCh¬S·n
(msg.m_recv));

80 
£rŸliz”
.
	`´•¬eFÜT¿n¥Üt
(
msg2
, 
h—d”
);

83 
	}
}

	@parse_hd_keypath.cpp

5 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

6 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<‹¡/fuzz/ut.h
>

8 
	~<ut/b32.h
>

10 
	~<c¡dšt
>

11 
	~<veùÜ
>

13 
	$FUZZ_TARGET
(
·r£_hd_key·th
)

15 cÚ¡ 
¡d
::
¡ršg
 
	`key·th_¡r
(
bufãr
.
	`begš
(), bufãr.
	`’d
());

16 
¡d
::
veùÜ
<
ušt32_t
> 
key·th
;

17 ()
	`P¬£HDKey·th
(
key·th_¡r
, 
key·th
);

19 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

20 cÚ¡ 
¡d
::
veùÜ
<
ušt32_t
> 
¿ndom_key·th
 = 
CÚsumeRªdomL’gthIÁeg¿lVeùÜ
<ušt32_t>(
fuzzed_d©a_´ovid”
);

21 ()
	`FÜm©HDKey·th
(
¿ndom_key·th
);

22 ()
	`Wr™eHDKey·th
(
¿ndom_key·th
);

23 
	}
}

	@parse_numbers.cpp

5 
	~<‹¡/fuzz/fuzz.h
>

6 
	~<ut/mÚey¡r.h
>

7 
	~<ut/¡»ncodšgs.h
>

9 
	~<¡ršg
>

11 
	$FUZZ_TARGET
(
·r£_numb”s
)

13 cÚ¡ 
¡d
::
¡ršg
 
	`¿ndom_¡ršg
(
bufãr
.
	`begš
(), bufãr.
	`’d
());

15 ()
	`P¬£MÚey
(
¿ndom_¡ršg
);

17 
ušt8_t
 
u8
;

18 ()
	`P¬£UIÁ8
(
¿ndom_¡ršg
, &
u8
);

20 
ušt16_t
 
u16
;

21 ()
	`P¬£UIÁ16
(
¿ndom_¡ršg
, &
u16
);

23 
št32_t
 
i32
;

24 ()
	`P¬£IÁ32
(
¿ndom_¡ršg
, &
i32
);

25 ()
LoÿËInd•’d’tAtoi
<>(
¿ndom_¡ršg
);

27 
ušt32_t
 
u32
;

28 ()
	`P¬£UIÁ32
(
¿ndom_¡ršg
, &
u32
);

30 
št64_t
 
i64
;

31 ()
LoÿËInd•’d’tAtoi
<
št64_t
>(
¿ndom_¡ršg
);

32 ()
	`P¬£FixedPošt
(
¿ndom_¡ršg
, 3, &
i64
);

33 ()
	`P¬£IÁ64
(
¿ndom_¡ršg
, &
i64
);

35 
ušt64_t
 
u64
;

36 ()
	`P¬£UIÁ64
(
¿ndom_¡ršg
, &
u64
);

37 
	}
}

	@parse_script.cpp

5 
	~<cÜe_io.h
>

6 
	~<süt/süt.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

9 
	$FUZZ_TARGET
(
·r£_süt
)

11 cÚ¡ 
¡d
::
¡ršg
 
	`süt_¡ršg
(
bufãr
.
	`begš
(), bufãr.
	`’d
());

12 
Œy
 {

13 ()
	`P¬£Süt
(
süt_¡ršg
);

14 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

16 
	}
}

	@parse_univalue.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<cÜe_io.h
>

7 
	~<½c/ş›Á.h
>

8 
	~<½c/ut.h
>

9 
	~<‹¡/fuzz/fuzz.h
>

11 
	~<lim™s
>

12 
	~<¡ršg
>

14 
	$š™Ÿlize_·r£_univ®ue
()

16 cÚ¡ 
ECCV”ifyHªdË
 
v”ify_hªdË
;

17 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
REGTEST
);

18 
	}
}

20 
	$FUZZ_TARGET_INIT
(
·r£_univ®ue
, 
š™Ÿlize_·r£_univ®ue
)

22 cÚ¡ 
¡d
::
¡ršg
 
	`¿ndom_¡ršg
(
bufãr
.
	`begš
(), bufãr.
	`’d
());

23 
boŞ
 
v®id
 = 
Œue
;

24 cÚ¡ 
UniV®ue
 
univ®ue
 = [&] {

25 
Œy
 {

26  
	`P¬£NÚRFCJSONV®ue
(
¿ndom_¡ršg
);

27 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

28 
v®id
 = 
çl£
;

29  
UniV®ue
{};

32 ià(!
v®id
) {

35 
Œy
 {

36 ()
	`P¬£HashO
(
univ®ue
, "A");

37 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

38 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

40 
Œy
 {

41 ()
	`P¬£HashO
(
univ®ue
, 
¿ndom_¡ršg
);

42 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

43 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

45 
Œy
 {

46 ()
	`P¬£HashV
(
univ®ue
, "A");

47 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

48 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

50 
Œy
 {

51 ()
	`P¬£HashV
(
univ®ue
, 
¿ndom_¡ršg
);

52 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

53 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

55 
Œy
 {

56 ()
	`P¬£HexO
(
univ®ue
, "A");

57 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

59 
Œy
 {

60 ()
	`P¬£HexO
(
univ®ue
, 
¿ndom_¡ršg
);

61 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

63 
Œy
 {

64 ()
	`P¬£HexUV
(
univ®ue
, "A");

65 ()
	`P¬£HexUV
(
univ®ue
, 
¿ndom_¡ršg
);

66 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

67 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

69 
Œy
 {

70 ()
	`P¬£HexV
(
univ®ue
, "A");

71 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

72 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

74 
Œy
 {

75 ()
	`P¬£HexV
(
univ®ue
, 
¿ndom_¡ršg
);

76 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

77 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

79 
Œy
 {

80 ()
	`P¬£SighashSŒšg
(
univ®ue
);

81 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

83 
Œy
 {

84 ()
	`AmouÁFromV®ue
(
univ®ue
);

85 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

86 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

88 
Œy
 {

89 
FÏtSignšgProvid”
 
´ovid”
;

90 ()
	`Ev®DesütÜSŒšgOrObjeù
(
univ®ue
, 
´ovid”
);

91 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

92 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

94 
Œy
 {

95 ()
	`P¬£CÚfœmT¬g‘
(
univ®ue
, 
¡d
::
num”ic_lim™s
<>::
	`max
());

96 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

97 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

99 
Œy
 {

100 ()
	`P¬£DesütÜRªge
(
univ®ue
);

101 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
&) {

102 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

104 
	}
}

	@policy_estimator.cpp

5 
	~<pŞicy/ães.h
>

6 
	~<pŞicy/ães_¬gs.h
>

7 
	~<´im™ives/Œª§ùiÚ.h
>

8 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

9 
	~<‹¡/fuzz/fuzz.h
>

10 
	~<‹¡/fuzz/ut.h
>

11 
	~<‹¡/fuzz/ut/mempoŞ.h
>

12 
	~<‹¡/ut/£tup_commÚ.h
>

13 
	~<txmempoŞ.h
>

15 
	~<c¡dšt
>

16 
	~<İtiÚ®
>

17 
	~<¡ršg
>

18 
	~<veùÜ
>

20 
	gÇme¥aû
 {

21 cÚ¡ 
BasicTe¡šgS‘up
* 
	gg_£tup
;

24 
	$š™Ÿlize_pŞicy_e¡im©Ü
()

26 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>();

27 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

28 
	}
}

30 
	$FUZZ_TARGET_INIT
(
pŞicy_e¡im©Ü
, 
š™Ÿlize_pŞicy_e¡im©Ü
)

32 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

33 
CBlockPŞicyE¡im©Ü
 
block_pŞicy_e¡im©Ü
{
	`F“e¡P©h
(*
g_£tup
->
m_node
.
¬gs
)};

34 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

35 
	`C®lOÃOf
(

36 
fuzzed_d©a_´ovid”
,

38 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
mtx
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

39 ià(!
mtx
) {

42 cÚ¡ 
CT¿n§ùiÚ
 
tx
{*
mtx
};

43 
block_pŞicy_e¡im©Ü
.
	`´oûssT¿n§ùiÚ
(
	`CÚsumeTxMemPoŞEÁry
(
fuzzed_d©a_´ovid”
, 
tx
), fuzzed_d©a_´ovid”.
	`CÚsumeBoŞ
());

44 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

45 ()
block_pŞicy_e¡im©Ü
.
	`»moveTx
(
tx
.
	`G‘Hash
(), 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

49 
¡d
::
veùÜ
<
CTxMemPoŞEÁry
> 
mempoŞ_’Œ›s
;

50 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

51 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
mtx
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

52 ià(!
mtx
) {

55 cÚ¡ 
CT¿n§ùiÚ
 
tx
{*
mtx
};

56 
mempoŞ_’Œ›s
.
	`push_back
(
	`CÚsumeTxMemPoŞEÁry
(
fuzzed_d©a_´ovid”
, 
tx
));

58 
¡d
::
veùÜ
<cÚ¡ 
CTxMemPoŞEÁry
*> 
±rs
;

59 
±rs
.
	`»£rve
(
mempoŞ_’Œ›s
.
	`size
());

60 cÚ¡ 
CTxMemPoŞEÁry
& 
mempoŞ_’Œy
 : 
mempoŞ_’Œ›s
) {

61 
±rs
.
	`push_back
(&
mempoŞ_’Œy
);

63 
block_pŞicy_e¡im©Ü
.
	`´oûssBlock
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>(), 
±rs
);

66 ()
block_pŞicy_e¡im©Ü
.
	`»moveTx
(
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
), fuzzed_d©a_´ovid”.
	`CÚsumeBoŞ
());

69 
block_pŞicy_e¡im©Ü
.
	`FlushUncÚfœmed
();

71 ()
block_pŞicy_e¡im©Ü
.
	`e¡im©eF“
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>());

72 
E¡im©iÚResuÉ
 
»suÉ
;

73 ()
block_pŞicy_e¡im©Ü
.
	`e¡im©eRawF“
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>(), fuzzed_d©a_´ovid”.
CÚsumeFlßtšgPošt
<>(), fuzzed_d©a_´ovid”.
	`PickV®ueInA¼ay
(
ALL_FEE_ESTIMATE_HORIZONS
), fuzzed_d©a_´ovid”.
	`CÚsumeBoŞ
(è? &
»suÉ
 : 
nuÎ±r
);

74 
F“C®cuÏtiÚ
 
ãe_ÿlcuÏtiÚ
;

75 ()
block_pŞicy_e¡im©Ü
.
	`e¡im©eSm¬tF“
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>(), fuzzed_d©a_´ovid”.
	`CÚsumeBoŞ
(è? &
ãe_ÿlcuÏtiÚ
 : 
nuÎ±r
, fuzzed_data_provider.ConsumeBool());

76 ()
block_pŞicy_e¡im©Ü
.
	`Highe¡T¬g‘T¿cked
(
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
(
ALL_FEE_ESTIMATE_HORIZONS
));

79 
FuzzedAutoFeProvid”
 
fuzzed_auto_fe_´ovid”
 = 
	`CÚsumeAutoFe
(
fuzzed_d©a_´ovid”
);

80 
AutoFe
 
fuzzed_auto_fe
{
fuzzed_auto_fe_´ovid”
.
	`İ’
()};

81 
block_pŞicy_e¡im©Ü
.
	`Wr™e
(
fuzzed_auto_fe
);

82 
block_pŞicy_e¡im©Ü
.
	`R—d
(
fuzzed_auto_fe
);

84 
	}
}

	@policy_estimator_io.cpp

5 
	~<pŞicy/ães.h
>

6 
	~<pŞicy/ães_¬gs.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<‹¡/ut/£tup_commÚ.h
>

12 
	~<c¡dšt
>

13 
	~<veùÜ
>

15 
	gÇme¥aû
 {

16 cÚ¡ 
BasicTe¡šgS‘up
* 
	gg_£tup
;

19 
	$š™Ÿlize_pŞicy_e¡im©Ü_io
()

21 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>();

22 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

23 
	}
}

25 
	$FUZZ_TARGET_INIT
(
pŞicy_e¡im©Ü_io
, 
š™Ÿlize_pŞicy_e¡im©Ü_io
)

27 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

28 
FuzzedAutoFeProvid”
 
fuzzed_auto_fe_´ovid”
 = 
	`CÚsumeAutoFe
(
fuzzed_d©a_´ovid”
);

29 
AutoFe
 
fuzzed_auto_fe
{
fuzzed_auto_fe_´ovid”
.
	`İ’
()};

31 
CBlockPŞicyE¡im©Ü
 
block_pŞicy_e¡im©Ü
{
	`F“e¡P©h
(*
g_£tup
->
m_node
.
¬gs
)};

32 ià(
block_pŞicy_e¡im©Ü
.
	`R—d
(
fuzzed_auto_fe
)) {

33 
block_pŞicy_e¡im©Ü
.
	`Wr™e
(
fuzzed_auto_fe
);

35 
	}
}

	@pow.cpp

5 
	~<chaš.h
>

6 
	~<chaš·¿ms.h
>

7 
	~<pow.h
>

8 
	~<´im™ives/block.h
>

9 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

10 
	~<‹¡/fuzz/fuzz.h
>

11 
	~<‹¡/fuzz/ut.h
>

12 
	~<ut/ov”æow.h
>

14 
	~<c¡dšt
>

15 
	~<İtiÚ®
>

16 
	~<¡ršg
>

17 
	~<veùÜ
>

19 
	$š™Ÿlize_pow
()

21 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
MAIN
);

22 
	}
}

24 
	$FUZZ_TARGET_INIT
(
pow
, 
š™Ÿlize_pow
)

26 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

27 cÚ¡ 
CÚ£nsus
::
P¬ams
& 
cÚ£nsus_·¿ms
 = 
	`P¬ams
().
	`G‘CÚ£nsus
();

28 
¡d
::
veùÜ
<
CBlockIndex
> 
blocks
;

29 cÚ¡ 
ušt32_t
 
fixed_time
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>();

30 cÚ¡ 
ušt32_t
 
fixed_b™s
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>();

31 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`»maššg_by‹s
() > 0, 10000) {

32 cÚ¡ 
¡d
::
İtiÚ®
<
CBlockH—d”
> 
block_h—d”
 = 
CÚsumeDe£rŸlizabË
<CBlockH—d”>(
fuzzed_d©a_´ovid”
);

33 ià(!
block_h—d”
) {

36 
CBlockIndex
 
cu¼’t_block
{*
block_h—d”
};

38 
CBlockIndex
* 
´evious_block
 = 
blocks
.
	`em±y
(è? 
nuÎ±r
 : &
	`PickV®ue
(
fuzzed_d©a_´ovid”
, blocks);

39 cÚ¡ 
cu¼’t_height
 = (
´evious_block
 !ğ
nuÎ±r
 &&…»vious_block->
nHeight
 !ğ
¡d
::
num”ic_lim™s
<>::
	`max
()) ?…revious_block->nHeight + 1 : 0;

40 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

41 
cu¼’t_block
.
µ»v
 = 
´evious_block
;

43 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

44 
cu¼’t_block
.
nHeight
 = 
cu¼’t_height
;

46 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

47 cÚ¡ 
ušt32_t
 
£cÚds
 = 
cu¼’t_height
 * 
cÚ£nsus_·¿ms
.
nPowT¬g‘S·cšg
;

48 ià(!
	`Add™iÚOv”æow
(
fixed_time
, 
£cÚds
)) {

49 
cu¼’t_block
.
nTime
 = 
fixed_time
 + 
£cÚds
;

52 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

53 
cu¼’t_block
.
nB™s
 = 
fixed_b™s
;

55 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

56 
cu¼’t_block
.
nChašWÜk
 = 
´evious_block
 !ğ
nuÎ±r
 ?…»vious_block->nChašWÜk + 
	`G‘BlockProof
(*´evious_blockè: 
¬™h_ušt256
{0};

58 
cu¼’t_block
.
nChašWÜk
 = 
	`CÚsumeAr™hUIÁ256
(
fuzzed_d©a_´ovid”
);

60 
blocks
.
	`push_back
(
cu¼’t_block
);

63 ()
	`G‘BlockProof
(
cu¼’t_block
);

64 ()
	`C®cuÏ‹NextWÜkRequœed
(&
cu¼’t_block
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
št64_t
>(0, 
¡d
::
num”ic_lim™s
<št64_t>::
	`max
()), 
cÚ£nsus_·¿ms
);

65 ià(
cu¼’t_block
.
nHeight
 !ğ
¡d
::
num”ic_lim™s
<>::
	`max
(è&& cu¼’t_block.nHeighˆ- (
cÚ£nsus_·¿ms
.
	`DifficuÉyAdju¡m’tIÁ”v®
() - 1) >= 0) {

66 ()
	`G‘NextWÜkRequœed
(&
cu¼’t_block
, &(*
block_h—d”
), 
cÚ£nsus_·¿ms
);

70 cÚ¡ 
CBlockIndex
* 
to
 = &
	`PickV®ue
(
fuzzed_d©a_´ovid”
, 
blocks
);

71 cÚ¡ 
CBlockIndex
* 
äom
 = &
	`PickV®ue
(
fuzzed_d©a_´ovid”
, 
blocks
);

72 cÚ¡ 
CBlockIndex
* 
t
 = &
	`PickV®ue
(
fuzzed_d©a_´ovid”
, 
blocks
);

73 
Œy
 {

74 ()
	`G‘BlockProofEquiv®’tTime
(*
to
, *
äom
, *
t
, 
cÚ£nsus_·¿ms
);

75 } 
	`ÿtch
 (cÚ¡ 
ušt_”rÜ
&) {

79 cÚ¡ 
¡d
::
İtiÚ®
<
ušt256
> 
hash
 = 
CÚsumeDe£rŸlizabË
<ušt256>(
fuzzed_d©a_´ovid”
);

80 ià(
hash
) {

81 ()
	`CheckProofOfWÜk
(*
hash
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>(), 
cÚ£nsus_·¿ms
);

85 
	}
}

88 
	$FUZZ_TARGET_INIT
(
pow_Œªs™iÚ
, 
š™Ÿlize_pow
)

90 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

91 cÚ¡ 
CÚ£nsus
::
P¬ams
& 
cÚ£nsus_·¿ms
{
	`P¬ams
().
	`G‘CÚ£nsus
()};

92 
¡d
::
veùÜ
<¡d::
unique_±r
<
CBlockIndex
>> 
blocks
;

94 cÚ¡ 
ušt32_t
 
Şd_time
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>()};

95 cÚ¡ 
ušt32_t
 
Ãw_time
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>()};

96 cÚ¡ 
št32_t
 
v”siÚ
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int32_t>()};

97 
ušt32_t
 
nb™s
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>()};

99 cÚ¡ 
¬™h_ušt256
 
pow_lim™
 = 
	`UštToAr™h256
(
cÚ£nsus_·¿ms
.
powLim™
);

100 
¬™h_ušt256
 
Şd_rg‘
;

101 
Şd_rg‘
.
	`S‘Com·ù
(
nb™s
);

102 ià(
Şd_rg‘
 > 
pow_lim™
) {

103 
nb™s
 = 
pow_lim™
.
	`G‘Com·ù
();

106 
height
 = 0; heighˆ< 
cÚ£nsus_·¿ms
.
	`DifficuÉyAdju¡m’tIÁ”v®
(); ++height) {

107 
CBlockH—d”
 
h—d”
;

108 
h—d”
.
nV”siÚ
 = 
v”siÚ
;

109 
h—d”
.
nTime
 = 
Şd_time
;

110 
h—d”
.
nB™s
 = 
nb™s
;

111 ià(
height
 =ğ
cÚ£nsus_·¿ms
.
	`DifficuÉyAdju¡m’tIÁ”v®
() - 1) {

112 
h—d”
.
nTime
 = 
Ãw_time
;

114 autØ
cu¼’t_block
{
¡d
::
make_unique
<
CBlockIndex
>(
h—d”
)};

115 
cu¼’t_block
->
µ»v
 = 
blocks
.
	`em±y
(è? 
nuÎ±r
 : blocks.
	`back
().
	`g‘
();

116 
cu¼’t_block
->
nHeight
 = 
height
;

117 
blocks
.
	`em¶aû_back
(
¡d
::
	`move
(
cu¼’t_block
));

119 autØ
Ï¡_block
{
blocks
.
	`back
().
	`g‘
()};

120 
Ãw_nb™s
{
	`G‘NextWÜkRequœed
(
Ï¡_block
, 
nuÎ±r
, 
cÚ£nsus_·¿ms
)};

121 
	`As£¹
(
	`P”m™‹dDifficuÉyT¿ns™iÚ
(
cÚ£nsus_·¿ms
, 
Ï¡_block
->
nHeight
 + 1,†a¡_block->
nB™s
, 
Ãw_nb™s
));

122 
	}
}

	@prevector.cpp

5 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

6 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<´eveùÜ.h
>

9 
	~<veùÜ
>

11 
	~<»v”£_™”©Ü.h
>

12 
	~<£rŸlize.h
>

13 
	~<¡»ams.h
>

15 
	gÇme¥aû
 {

17 
	g‹m¶©e
 <
	gN
, 
ty³Çme
 
	gT
>

18 şas 
	c´eveùÜ_‹¡”


20 
	g¡d
::
	tveùÜ
<
	tT
> 
	t»®ty³
;

21 
»®ty³
 
	g»®_veùÜ
;

22 
»®ty³
 
	g»®_veùÜ_®t
;

24 
	g´eveùÜ
<
	tN
, 
	tT
> 
	t´‘y³
;

25 
´‘y³
 
	g´e_veùÜ
;

26 
´‘y³
 
	g´e_veùÜ_®t
;

28 
ty³Çme
 
	t´‘y³
::
	tsize_ty³
 
	tSize
;

30 
	gpublic
:

31 
‹¡
() const

33 cÚ¡ 
´‘y³
& 
cÚ¡_´e_veùÜ
 = 
´e_veùÜ
;

34 
as£¹
(
»®_veùÜ
.
size
(è=ğ
´e_veùÜ
.size());

35 
as£¹
(
»®_veùÜ
.
em±y
(è=ğ
´e_veùÜ
.empty());

36 
Size
 
	gs
 = 0; s < 
	g»®_veùÜ
.
size
(); s++) {

37 
as£¹
(
»®_veùÜ
[
s
] =ğ
´e_veùÜ
[s]);

38 
as£¹
(&(
´e_veùÜ
[
s
]è=ğ&Õ»_veùÜ.
begš
()[s]));

39 
as£¹
(&(
´e_veùÜ
[
s
]è=ğ&*Õ»_veùÜ.
begš
() + s));

40 
as£¹
(&(
´e_veùÜ
[
s
]è=ğ&*(Õ»_veùÜ.
’d
(è+ sè- 
»®_veùÜ
.
size
()));

43 
as£¹
(
´‘y³
(
»®_veùÜ
.
begš
(),„—l_veùÜ.
’d
()è=ğ
´e_veùÜ
);

44 
as£¹
(
´‘y³
(
´e_veùÜ
.
begš
(),…»_veùÜ.
’d
()) ==…re_vector);

45 
size_t
 
	gpos
 = 0;

46 cÚ¡ 
	gT
& 
	gv
 : 
´e_veùÜ
) {

47 
as£¹
(
v
 =ğ
»®_veùÜ
[
pos
]);

48 ++
	gpos
;

50 cÚ¡ 
	gT
& 
	gv
 : 
»v”£_™”©e
(
´e_veùÜ
)) {

51 --
pos
;

52 
as£¹
(
v
 =ğ
»®_veùÜ
[
pos
]);

54 cÚ¡ 
	gT
& 
	gv
 : 
cÚ¡_´e_veùÜ
) {

55 
as£¹
(
v
 =ğ
»®_veùÜ
[
pos
]);

56 ++
	gpos
;

58 cÚ¡ 
	gT
& 
	gv
 : 
»v”£_™”©e
(
cÚ¡_´e_veùÜ
)) {

59 --
pos
;

60 
as£¹
(
v
 =ğ
»®_veùÜ
[
pos
]);

62 
CD©aSŒ—m
 
ss1
(
SER_DISK
, 0);

63 
CD©aSŒ—m
 
ss2
(
SER_DISK
, 0);

64 
	gss1
 << 
	g»®_veùÜ
;

65 
	gss2
 << 
	g´e_veùÜ
;

66 
as£¹
(
ss1
.
size
(è=ğ
ss2
.size());

67 
Size
 
	gs
 = 0; s < 
	gss1
.
size
(); s++) {

68 
as£¹
(
ss1
[
s
] =ğ
ss2
[s]);

72 
»size
(
Size
 
s
)

74 
	g»®_veùÜ
.
»size
(
s
);

75 
as£¹
(
»®_veùÜ
.
size
(è=ğ
s
);

76 
	g´e_veùÜ
.
»size
(
s
);

77 
as£¹
(
´e_veùÜ
.
size
(è=ğ
s
);

80 
»£rve
(
Size
 
s
)

82 
	g»®_veùÜ
.
»£rve
(
s
);

83 
as£¹
(
»®_veùÜ
.
ÿ·c™y
(è>ğ
s
);

84 
	g´e_veùÜ
.
»£rve
(
s
);

85 
as£¹
(
´e_veùÜ
.
ÿ·c™y
(è>ğ
s
);

88 
š£¹
(
Size
 
pos™iÚ
, cÚ¡ 
T
& 
v®ue
)

90 
	g»®_veùÜ
.
š£¹
(
»®_veùÜ
.
begš
(è+ 
pos™iÚ
, 
v®ue
);

91 
	g´e_veùÜ
.
š£¹
(
´e_veùÜ
.
begš
(è+ 
pos™iÚ
, 
v®ue
);

94 
š£¹
(
Size
 
pos™iÚ
, Siz
couÁ
, cÚ¡ 
T
& 
v®ue
)

96 
	g»®_veùÜ
.
š£¹
(
»®_veùÜ
.
begš
(è+ 
pos™iÚ
, 
couÁ
, 
v®ue
);

97 
	g´e_veùÜ
.
š£¹
(
´e_veùÜ
.
begš
(è+ 
pos™iÚ
, 
couÁ
, 
v®ue
);

100 
	g‹m¶©e
 <
ty³Çme
 
	gI
>

101 
š£¹_¿nge
(
Size
 
pos™iÚ
, 
I
 
fœ¡
, I 
Ï¡
)

103 
	g»®_veùÜ
.
š£¹
(
»®_veùÜ
.
begš
(è+ 
pos™iÚ
, 
fœ¡
, 
Ï¡
);

104 
	g´e_veùÜ
.
š£¹
(
´e_veùÜ
.
begš
(è+ 
pos™iÚ
, 
fœ¡
, 
Ï¡
);

107 
”a£
(
Size
 
pos™iÚ
)

109 
	g»®_veùÜ
.
”a£
(
»®_veùÜ
.
begš
(è+ 
pos™iÚ
);

110 
	g´e_veùÜ
.
”a£
(
´e_veùÜ
.
begš
(è+ 
pos™iÚ
);

113 
”a£
(
Size
 
fœ¡
, Siz
Ï¡
)

115 
	g»®_veùÜ
.
”a£
(
»®_veùÜ
.
begš
(è+ 
fœ¡
,„—l_veùÜ.begš(è+ 
Ï¡
);

116 
	g´e_veùÜ
.
”a£
(
´e_veùÜ
.
begš
(è+ 
fœ¡
,…»_veùÜ.begš(è+ 
Ï¡
);

119 
upd©e
(
Size
 
pos
, cÚ¡ 
T
& 
v®ue
)

121 
	g»®_veùÜ
[
pos
] = 
v®ue
;

122 
	g´e_veùÜ
[
pos
] = 
v®ue
;

125 
push_back
(cÚ¡ 
T
& 
v®ue
)

127 
	g»®_veùÜ
.
push_back
(
v®ue
);

128 
	g´e_veùÜ
.
push_back
(
v®ue
);

131 
pİ_back
()

133 
	g»®_veùÜ
.
pİ_back
();

134 
	g´e_veùÜ
.
pİ_back
();

137 
ş—r
()

139 
	g»®_veùÜ
.
ş—r
();

140 
	g´e_veùÜ
.
ş—r
();

143 
assign
(
Size
 
n
, cÚ¡ 
T
& 
v®ue
)

145 
	g»®_veùÜ
.
assign
(
n
, 
v®ue
);

146 
	g´e_veùÜ
.
assign
(
n
, 
v®ue
);

149 
Size
 
size
() const

151  
	g»®_veùÜ
.
size
();

154 
Size
 
ÿ·c™y
() const

156  
	g´e_veùÜ
.
ÿ·c™y
();

159 
shršk_to_f™
()

161 
	g´e_veùÜ
.
shršk_to_f™
();

164 
sw­
(è
	gnÛxû±


166 
	g»®_veùÜ
.
sw­
(
»®_veùÜ_®t
);

167 
	g´e_veùÜ
.
sw­
(
´e_veùÜ_®t
);

170 
move
()

172 
	g»®_veùÜ
 = 
¡d
::
move
(
»®_veùÜ_®t
);

173 
	g»®_veùÜ_®t
.
ş—r
();

174 
	g´e_veùÜ
 = 
¡d
::
move
(
´e_veùÜ_®t
);

175 
	g´e_veùÜ_®t
.
ş—r
();

178 
cİy
()

180 
	g»®_veùÜ
 = 
»®_veùÜ_®t
;

181 
	g´e_veùÜ
 = 
´e_veùÜ_®t
;

184 
»size_unš™Ÿlized
(
»®ty³
 
v®ues
)

186 
size_t
 
	gr
 = 
v®ues
.
size
();

187 
size_t
 
	gs
 = 
»®_veùÜ
.
size
() / 2;

188 ià(
	g»®_veùÜ
.
ÿ·c™y
(è< 
	gs
 + 
	gr
) {

189 
	g»®_veùÜ
.
»£rve
(
s
 + 
r
);

191 
	g»®_veùÜ
.
»size
(
s
);

192 
	g´e_veùÜ
.
»size_unš™Ÿlized
(
s
);

193 autØ
	gv
 : 
v®ues
) {

194 
»®_veùÜ
.
push_back
(
v
);

196 autØ
	gp
 = 
´e_veùÜ
.
size
();

197 
	g´e_veùÜ
.
»size_unš™Ÿlized
(
p
 + 
r
);

198 autØ
	gv
 : 
v®ues
) {

199 
´e_veùÜ
[
p
] = 
v
;

200 ++
	gp
;

207 
	$FUZZ_TARGET
(
´eveùÜ
)

209 
FuzzedD©aProvid”
 
	`´ov
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

210 
´eveùÜ_‹¡”
<8, > 
‹¡
;

212 
	`LIMITED_WHILE
(
´ov
.
	`»maššg_by‹s
(), 3000)

214 
´ov
.
CÚsumeIÁeg¿lInRªge
<>(0, 13 + 3 * (
‹¡
.
	`size
() > 0))) {

216 
‹¡
.
	`š£¹
(
´ov
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0,e¡.
	`size
()),…rov.
CÚsumeIÁeg¿l
<>());

219 
‹¡
.
	`»size
(
¡d
::
	`max
(0, std::
	`mš
(30, (ée¡.
	`size
(è+ 
´ov
.
CÚsumeIÁeg¿lInRªge
<>(0, 4) - 2)));

222 
‹¡
.
	`š£¹
(
´ov
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0,e¡.
	`size
()), 1 +…rov.
	`CÚsumeBoŞ
(),…rov.
CÚsumeIÁeg¿l
<>());

225 
d–
 = 
´ov
.
CÚsumeIÁeg¿lInRªge
<>(0, 
‹¡
.
	`size
());

226 
beg
 = 
´ov
.
CÚsumeIÁeg¿lInRªge
<>(0, 
‹¡
.
	`size
(è- 
d–
);

227 
‹¡
.
	`”a£
(
beg
, beg + 
d–
);

231 
‹¡
.
	`push_back
(
´ov
.
CÚsumeIÁeg¿l
<>());

234 
v®ues
[4];

235 
num
 = 1 + 
´ov
.
CÚsumeIÁeg¿lInRªge
<>(0, 3);

236 
k
 = 0; k < 
num
; ++k) {

237 
v®ues
[
k
] = 
´ov
.
CÚsumeIÁeg¿l
<>();

239 
‹¡
.
	`š£¹_¿nge
(
´ov
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0,e¡.
	`size
()), 
v®ues
, v®ue + 
num
);

243 
num
 = 1 + 
´ov
.
CÚsumeIÁeg¿lInRªge
<>(0, 15);

244 
¡d
::
veùÜ
<> 
	`v®ues
(
num
);

245 auto& 
v
 : 
v®ues
) {

246 
v
 = 
´ov
.
CÚsumeIÁeg¿l
<>();

248 
‹¡
.
	`»size_unš™Ÿlized
(
v®ues
);

252 
‹¡
.
	`»£rve
(
´ov
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 32767));

255 
‹¡
.
	`shršk_to_f™
();

258 
‹¡
.
	`ş—r
();

261 
‹¡
.
	`assign
(
´ov
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 32767),…rov.
CÚsumeIÁeg¿l
<>());

264 
‹¡
.
	`sw­
();

267 
‹¡
.
	`cİy
();

270 
‹¡
.
	`move
();

273 
‹¡
.
	`upd©e
(
´ov
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0,e¡.
	`size
(è- 1),…rov.
CÚsumeIÁeg¿l
<>());

276 
‹¡
.
	`”a£
(
´ov
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0,e¡.
	`size
() - 1));

279 
‹¡
.
	`pİ_back
();

284 
‹¡
.
	`‹¡
();

285 
	}
}

	@primitives_transaction.cpp

5 
	~<´im™ives/Œª§ùiÚ.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<c¡dšt
>

11 
	~<İtiÚ®
>

12 
	~<¡ršg
>

13 
	~<veùÜ
>

15 
	$FUZZ_TARGET
(
´im™ives_Œª§ùiÚ
)

17 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

18 cÚ¡ 
CSüt
 
süt
 = 
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
);

19 cÚ¡ 
¡d
::
İtiÚ®
<
COutPošt
> 
out_pošt
 = 
CÚsumeDe£rŸlizabË
<COutPošt>(
fuzzed_d©a_´ovid”
);

20 ià(
out_pošt
) {

21 cÚ¡ 
CTxIn
 
tx_š
{*
out_pošt
, 
süt
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt32_t
>()};

22 ()
tx_š
;

24 cÚ¡ 
CTxOut
 
tx_out_1
{
	`CÚsumeMÚey
(
fuzzed_d©a_´ovid”
), 
süt
};

25 cÚ¡ 
CTxOut
 
tx_out_2
{
	`CÚsumeMÚey
(
fuzzed_d©a_´ovid”
), 
	`CÚsumeSüt
(fuzzed_data_provider)};

26 
	`as£¹
((
tx_out_1
 =ğ
tx_out_2
) != (tx_out_1 !=x_out_2));

27 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
mubË_tx_1
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

28 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
mubË_tx_2
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

29 ià(
mubË_tx_1
 && 
mubË_tx_2
) {

30 cÚ¡ 
CT¿n§ùiÚ
 
tx_1
{*
mubË_tx_1
};

31 cÚ¡ 
CT¿n§ùiÚ
 
tx_2
{*
mubË_tx_2
};

32 
	`as£¹
((
tx_1
 =ğ
tx_2
) != (tx_1 !=x_2));

34 
	}
}

	@process_message.cpp

5 
	~<bªmª.h
>

6 
	~<chaš·¿ms.h
>

7 
	~<cÚ£nsus/cÚ£nsus.h
>

8 
	~<Ãt.h
>

9 
	~<Ãt_´oûssšg.h
>

10 
	~<´ÙocŞ.h
>

11 
	~<scheduËr.h
>

12 
	~<süt/süt.h
>

13 
	~<¡»ams.h
>

14 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

15 
	~<‹¡/fuzz/fuzz.h
>

16 
	~<‹¡/fuzz/ut.h
>

17 
	~<‹¡/ut/mššg.h
>

18 
	~<‹¡/ut/Ãt.h
>

19 
	~<‹¡/ut/£tup_commÚ.h
>

20 
	~<‹¡/ut/v®id©iÚ.h
>

21 
	~<txÜphªage.h
>

22 
	~<v®id©iÚš‹rçû.h
>

23 
	~<v”siÚ.h
>

25 
	~<©omic
>

26 
	~<ÿs£¹
>

27 
	~<chrÚo
>

28 
	~<c¡dšt
>

29 
	~<iosfwd
>

30 
	~<io¡»am
>

31 
	~<memÜy
>

32 
	~<¡ršg
>

34 
	gÇme¥aû
 {

35 cÚ¡ 
Te¡šgS‘up
* 
	gg_£tup
;

38 
	gsize_t
& 
	$G‘NumMsgTy³s
()

40 
size_t
 
g_num_msg_ty³s
{0};

41  
g_num_msg_ty³s
;

42 
	}
}

43 
	#FUZZ_TARGET_MSG
(
msg_ty³
) \

44 
msg_ty³
##
_CouÁ_BefÜe_Maš
 { \

45 
msg_ty³
##
	`_CouÁ_BefÜe_Maš
() \

47 ++
	`G‘NumMsgTy³s
(); \

49 } cÚ¡ 
g_
##
msg_ty³
##
_couÁ_befÜe_maš
; \

50 
	`FUZZ_TARGET_INIT
(
´oûss_mes§ge_
##
msg_ty³
, 
š™Ÿlize_´oûss_mes§ge
) \

52 
	`fuzz_rg‘
(
bufãr
, #msg_type); \

53 }

	)

55 
	$š™Ÿlize_´oûss_mes§ge
()

57 
	`As£¹
(
	`G‘NumMsgTy³s
(è=ğ
	`g‘AÎN‘Mes§geTy³s
().
	`size
());

59 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<cÚ¡ 
Te¡šgS‘up
>();

60 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

61 
i
 = 0; i < 2 * 
COINBASE_MATURITY
; i++) {

62 
	`MšeBlock
(
g_£tup
->
m_node
, 
	`CSüt
(è<< 
OP_TRUE
);

64 
	`SyncW™hV®id©iÚIÁ”çûQueue
();

65 
	}
}

67 
	$fuzz_rg‘
(
FuzzBufãrTy³
 
bufãr
, cÚ¡ 
¡d
::
¡ršg
& 
LIMIT_TO_MESSAGE_TYPE
)

69 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

71 
CÚnmªTe¡Msg
& 
cÚnmª
 = *
¡©ic_ÿ¡
<CÚnmªTe¡Msg*>(
g_£tup
->
m_node
.cÚnmª.
	`g‘
());

72 
Te¡ChašS‹
& 
chaš¡©e
 = *
¡©ic_ÿ¡
<Te¡ChašS‹*>(&
g_£tup
->
m_node
.
chašmª
->
	`AùiveChaš¡©e
());

73 
	`S‘MockTime
(1610000000);

74 
chaš¡©e
.
	`Re£tIbd
();

76 
	`LOCK
(
N‘Ev’tsIÁ”çû
::
g_msg´oc_mu‹x
);

78 cÚ¡ 
¡d
::
¡ršg
 
¿ndom_mes§ge_ty³
{
fuzzed_d©a_´ovid”
.
	`CÚsumeBy‹sAsSŒšg
(
CMes§geH—d”
::
COMMAND_SIZE
).
	`c_¡r
()};

79 ià(!
LIMIT_TO_MESSAGE_TYPE
.
	`em±y
(è&& 
¿ndom_mes§ge_ty³
 != LIMIT_TO_MESSAGE_TYPE) {

82 
CNode
& 
p2p_node
 = *
	`CÚsumeNodeAsUniquePŒ
(
fuzzed_d©a_´ovid”
).
	`»Ëa£
();

84 
cÚnmª
.
	`AddTe¡Node
(
p2p_node
);

85 
	`FlNode
(
fuzzed_d©a_´ovid”
, 
cÚnmª
, 
p2p_node
);

87 cÚ¡‡utØ
mock_time
 = 
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
);

88 
	`S‘MockTime
(
mock_time
);

91 
CD©aSŒ—m
 
¿ndom_by‹s_d©a_¡»am
{
fuzzed_d©a_´ovid”
.
CÚsumeRemaššgBy‹s
<>(), 
SER_NETWORK
, 
PROTOCOL_VERSION
};

92 
Œy
 {

93 
g_£tup
->
m_node
.
³”mª
->
	`ProûssMes§ge
(
p2p_node
, 
¿ndom_mes§ge_ty³
, 
¿ndom_by‹s_d©a_¡»am
,

94 
G‘Time
<
¡d
::
chrÚo
::
miüo£cÚds
>(), std::
©omic
<
boŞ
>{
çl£
});

95 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

97 
g_£tup
->
m_node
.
³”mª
->
	`S’dMes§ges
(&
p2p_node
);

98 
	`SyncW™hV®id©iÚIÁ”çûQueue
();

99 
g_£tup
->
m_node
.
cÚnmª
->
	`StİNodes
();

100 
	}
}

102 
	$FUZZ_TARGET_INIT
(
´oûss_mes§ge
, 
š™Ÿlize_´oûss_mes§ge
è{ 
	`fuzz_rg‘
(
bufãr
, ""); 
	}
}

103 
FUZZ_TARGET_MSG
(
addr
);

104 
FUZZ_TARGET_MSG
(
addrv2
);

105 
FUZZ_TARGET_MSG
(
block
);

106 
FUZZ_TARGET_MSG
(
blocktxn
);

107 
FUZZ_TARGET_MSG
(
cfcheck±
);

108 
FUZZ_TARGET_MSG
(
cfh—d”s
);

109 
FUZZ_TARGET_MSG
(
cf‹r
);

110 
FUZZ_TARGET_MSG
(
cmpùblock
);

111 
FUZZ_TARGET_MSG
(
ãef‹r
);

112 
FUZZ_TARGET_MSG
(
f‹¿dd
);

113 
FUZZ_TARGET_MSG
(
f‹rş—r
);

114 
FUZZ_TARGET_MSG
(
f‹¾ßd
);

115 
FUZZ_TARGET_MSG
(
g‘addr
);

116 
FUZZ_TARGET_MSG
(
g‘blocks
);

117 
FUZZ_TARGET_MSG
(
g‘blocktxn
);

118 
FUZZ_TARGET_MSG
(
g‘cfcheck±
);

119 
FUZZ_TARGET_MSG
(
g‘cfh—d”s
);

120 
FUZZ_TARGET_MSG
(
g‘cf‹rs
);

121 
FUZZ_TARGET_MSG
(
g‘d©a
);

122 
FUZZ_TARGET_MSG
(
g‘h—d”s
);

123 
FUZZ_TARGET_MSG
(
h—d”s
);

124 
FUZZ_TARGET_MSG
(
šv
);

125 
FUZZ_TARGET_MSG
(
mempoŞ
);

126 
FUZZ_TARGET_MSG
(
m”kËblock
);

127 
FUZZ_TARGET_MSG
(
nÙfound
);

128 
FUZZ_TARGET_MSG
(
pšg
);

129 
FUZZ_TARGET_MSG
(
pÚg
);

130 
FUZZ_TARGET_MSG
(
£ndaddrv2
);

131 
FUZZ_TARGET_MSG
(
£ndcmpù
);

132 
FUZZ_TARGET_MSG
(
£ndh—d”s
);

133 
FUZZ_TARGET_MSG
(
£ndtxrúş
);

134 
FUZZ_TARGET_MSG
(
tx
);

135 
FUZZ_TARGET_MSG
(
v”ack
);

136 
FUZZ_TARGET_MSG
(
v”siÚ
);

137 
FUZZ_TARGET_MSG
(
wtxid»Ïy
);

	@process_messages.cpp

5 
	~<cÚ£nsus/cÚ£nsus.h
>

6 
	~<Ãt.h
>

7 
	~<Ãt_´oûssšg.h
>

8 
	~<´ÙocŞ.h
>

9 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

10 
	~<‹¡/fuzz/fuzz.h
>

11 
	~<‹¡/fuzz/ut.h
>

12 
	~<‹¡/ut/mššg.h
>

13 
	~<‹¡/ut/Ãt.h
>

14 
	~<‹¡/ut/£tup_commÚ.h
>

15 
	~<‹¡/ut/v®id©iÚ.h
>

16 
	~<txÜphªage.h
>

17 
	~<v®id©iÚ.h
>

18 
	~<v®id©iÚš‹rçû.h
>

20 
	gÇme¥aû
 {

21 cÚ¡ 
Te¡šgS‘up
* 
	gg_£tup
;

24 
	$š™Ÿlize_´oûss_mes§ges
()

26 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<cÚ¡ 
Te¡šgS‘up
>();

27 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

28 
i
 = 0; i < 2 * 
COINBASE_MATURITY
; i++) {

29 
	`MšeBlock
(
g_£tup
->
m_node
, 
	`CSüt
(è<< 
OP_TRUE
);

31 
	`SyncW™hV®id©iÚIÁ”çûQueue
();

32 
	}
}

34 
	$FUZZ_TARGET_INIT
(
´oûss_mes§ges
, 
š™Ÿlize_´oûss_mes§ges
)

36 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

38 
CÚnmªTe¡Msg
& 
cÚnmª
 = *
¡©ic_ÿ¡
<CÚnmªTe¡Msg*>(
g_£tup
->
m_node
.cÚnmª.
	`g‘
());

39 
Te¡ChašS‹
& 
chaš¡©e
 = *
¡©ic_ÿ¡
<Te¡ChašS‹*>(&
g_£tup
->
m_node
.
chašmª
->
	`AùiveChaš¡©e
());

40 
	`S‘MockTime
(1610000000);

41 
chaš¡©e
.
	`Re£tIbd
();

43 
	`LOCK
(
N‘Ev’tsIÁ”çû
::
g_msg´oc_mu‹x
);

45 
¡d
::
veùÜ
<
CNode
*> 
³”s
;

46 cÚ¡‡utØ
num_³”s_to_add
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeIÁeg¿lInRªge
(1, 3);

47 
i
 = 0; i < 
num_³”s_to_add
; ++i) {

48 
³”s
.
	`push_back
(
	`CÚsumeNodeAsUniquePŒ
(
fuzzed_d©a_´ovid”
, 
i
).
	`»Ëa£
());

49 
CNode
& 
p2p_node
 = *
³”s
.
	`back
();

51 
	`FlNode
(
fuzzed_d©a_´ovid”
, 
cÚnmª
, 
p2p_node
);

53 
cÚnmª
.
	`AddTe¡Node
(
p2p_node
);

56 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

57 cÚ¡ 
¡d
::
¡ršg
 
¿ndom_mes§ge_ty³
{
fuzzed_d©a_´ovid”
.
	`CÚsumeBy‹sAsSŒšg
(
CMes§geH—d”
::
COMMAND_SIZE
).
	`c_¡r
()};

59 cÚ¡‡utØ
mock_time
 = 
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
);

60 
	`S‘MockTime
(
mock_time
);

62 
CS”ŸlizedN‘Msg
 
Ãt_msg
;

63 
Ãt_msg
.
m_ty³
 = 
¿ndom_mes§ge_ty³
;

64 
Ãt_msg
.
d©a
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

66 
CNode
& 
¿ndom_node
 = *
	`PickV®ue
(
fuzzed_d©a_´ovid”
, 
³”s
);

68 ()
cÚnmª
.
	`ReûiveMsgFrom
(
¿ndom_node
, 
Ãt_msg
);

69 
¿ndom_node
.
fPau£S’d
 = 
çl£
;

71 
Œy
 {

72 
cÚnmª
.
	`ProûssMes§gesOnû
(
¿ndom_node
);

73 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

75 
g_£tup
->
m_node
.
³”mª
->
	`S’dMes§ges
(&
¿ndom_node
);

77 
	`SyncW™hV®id©iÚIÁ”çûQueue
();

78 
g_£tup
->
m_node
.
cÚnmª
->
	`StİNodes
();

79 
	}
}

	@protocol.cpp

5 
	~<´ÙocŞ.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<c¡dšt
>

11 
	~<İtiÚ®
>

12 
	~<¡dexû±
>

13 
	~<veùÜ
>

15 
	$FUZZ_TARGET
(
´ÙocŞ
)

17 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

18 cÚ¡ 
¡d
::
İtiÚ®
<
CInv
> 
šv
 = 
CÚsumeDe£rŸlizabË
<CInv>(
fuzzed_d©a_´ovid”
);

19 ià(!
šv
) {

22 
Œy
 {

23 ()
šv
->
	`G‘Commªd
();

24 } 
	`ÿtch
 (cÚ¡ 
¡d
::
out_of_¿nge
&) {

26 ()
šv
->
	`ToSŒšg
();

27 cÚ¡ 
¡d
::
İtiÚ®
<
CInv
> 
ªÙh”_šv
 = 
CÚsumeDe£rŸlizabË
<CInv>(
fuzzed_d©a_´ovid”
);

28 ià(!
ªÙh”_šv
) {

31 ()(*
šv
 < *
ªÙh”_šv
);

32 
	}
}

	@psbt.cpp

5 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

6 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<node/psbt.h
>

9 
	~<psbt.h
>

10 
	~<pubkey.h
>

11 
	~<süt/süt.h
>

12 
	~<¡»ams.h
>

13 
	~<ut/check.h
>

14 
	~<v”siÚ.h
>

16 
	~<c¡dšt
>

17 
	~<İtiÚ®
>

18 
	~<¡ršg
>

19 
	~<veùÜ
>

21 
usšg
 
	gnode
::
AÇlyzePSBT
;

22 
usšg
 
	gnode
::
PSBTAÇlysis
;

23 
usšg
 
	gnode
::
PSBTIÅutAÇlysis
;

25 
	$š™Ÿlize_psbt
()

27 cÚ¡ 
ECCV”ifyHªdË
 
v”ify_hªdË
;

28 
	}
}

30 
	$FUZZ_TARGET_INIT
(
psbt
, 
š™Ÿlize_psbt
)

32 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

33 
P¬tŸÎySigÃdT¿n§ùiÚ
 
psbt_mut
;

34 
¡d
::
¡ršg
 
”rÜ
;

35 autØ
¡r
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
();

36 ià(!
	`DecodeRawPSBT
(
psbt_mut
, 
	`MakeBy‹S·n
(
¡r
), 
”rÜ
)) {

39 cÚ¡ 
P¬tŸÎySigÃdT¿n§ùiÚ
 
psbt
 = 
psbt_mut
;

41 cÚ¡ 
PSBTAÇlysis
 
ª®ysis
 = 
	`AÇlyzePSBT
(
psbt
);

42 ()
	`PSBTRŞeName
(
ª®ysis
.
Ãxt
);

43 cÚ¡ 
PSBTIÅutAÇlysis
& 
šput_ª®ysis
 : 
ª®ysis
.
šputs
) {

44 ()
	`PSBTRŞeName
(
šput_ª®ysis
.
Ãxt
);

47 ()
psbt
.
	`IsNuÎ
();

49 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
tx
 = 
psbt
.tx;

50 ià(
tx
) {

51 cÚ¡ 
CMubËT¿n§ùiÚ
& 
mtx
 = *
tx
;

52 cÚ¡ 
P¬tŸÎySigÃdT¿n§ùiÚ
 
psbt_äom_tx
{
mtx
};

55 cÚ¡ 
PSBTIÅut
& 
šput
 : 
psbt
.
šputs
) {

56 ()
	`PSBTIÅutSigÃd
(
šput
);

57 ()
šput
.
	`IsNuÎ
();

59 ()
	`CouÁPSBTUnsigÃdIÅuts
(
psbt
);

61 cÚ¡ 
PSBTOuut
& 
ouut
 : 
psbt
.
ouuts
) {

62 ()
ouut
.
	`IsNuÎ
();

65 
size_t
 
i
 = 0; i < 
psbt
.
tx
->
vš
.
	`size
(); ++i) {

66 
CTxOut
 
tx_out
;

67 ià(
psbt
.
	`G‘IÅutUTXO
(
tx_out
, 
i
)) {

68 ()
tx_out
.
	`IsNuÎ
();

69 ()
tx_out
.
	`ToSŒšg
();

73 
psbt_mut
 = 
psbt
;

74 ()
	`Fš®izePSBT
(
psbt_mut
);

76 
psbt_mut
 = 
psbt
;

77 
CMubËT¿n§ùiÚ
 
»suÉ
;

78 ià(
	`Fš®izeAndExŒaùPSBT
(
psbt_mut
, 
»suÉ
)) {

79 cÚ¡ 
P¬tŸÎySigÃdT¿n§ùiÚ
 
psbt_äom_tx
{
»suÉ
};

82 
P¬tŸÎySigÃdT¿n§ùiÚ
 
psbt_m”ge
;

83 
¡r
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
();

84 ià(!
	`DecodeRawPSBT
(
psbt_m”ge
, 
	`MakeBy‹S·n
(
¡r
), 
”rÜ
)) {

85 
psbt_m”ge
 = 
psbt
;

87 
psbt_mut
 = 
psbt
;

88 ()
psbt_mut
.
	`M”ge
(
psbt_m”ge
);

89 
psbt_mut
 = 
psbt
;

90 ()
	`CombšePSBTs
(
psbt_mut
, {psbt_mut, 
psbt_m”ge
});

91 
psbt_mut
 = 
psbt
;

92 
i
 = 0; i < 
psbt_m”ge
.
tx
->
vš
.
	`size
(); ++i) {

93 ()
psbt_mut
.
	`AddIÅut
(
psbt_m”ge
.
tx
->
vš
[
i
],…sbt_m”ge.
šputs
[i]);

95 
i
 = 0; i < 
psbt_m”ge
.
tx
->
vout
.
	`size
(); ++i) {

96 
	`As£¹
(
psbt_mut
.
	`AddOuut
(
psbt_m”ge
.
tx
->
vout
[
i
],…sbt_m”ge.
ouuts
[i]));

98 
psbt_mut
.
unknown
.
	`š£¹
(
psbt_m”ge
.unknown.
	`begš
(),…sbt_m”ge.unknown.
	`’d
());

99 
	}
}

	@random.cpp

5 
	~<¿ndom.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<®gÜ™hm
>

11 
	~<c¡dšt
>

12 
	~<¡ršg
>

13 
	~<veùÜ
>

15 
	$FUZZ_TARGET
(
¿ndom
)

17 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

18 
Fa¡RªdomCÚ‹xt
 
ç¡_¿ndom_cÚ‹xt
{
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
)};

19 ()
ç¡_¿ndom_cÚ‹xt
.
	`¿nd64
();

20 ()
ç¡_¿ndom_cÚ‹xt
.
	`¿ndb™s
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 64));

21 ()
ç¡_¿ndom_cÚ‹xt
.
	`¿nd¿nge
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
ušt64_t
>(
Fa¡RªdomCÚ‹xt
::
	`mš
(è+ 1, Fa¡RªdomCÚ‹xt::
	`max
()));

22 ()
ç¡_¿ndom_cÚ‹xt
.
	`¿ndby‹s
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 1024));

23 ()
ç¡_¿ndom_cÚ‹xt
.
	`¿nd32
();

24 ()
ç¡_¿ndom_cÚ‹xt
.
	`¿nd256
();

25 ()
ç¡_¿ndom_cÚ‹xt
.
	`¿ndboŞ
();

26 ()
	`ç¡_¿ndom_cÚ‹xt
();

28 
¡d
::
veùÜ
<
št64_t
> 
š‹g¿ls
 = 
CÚsumeRªdomL’gthIÁeg¿lVeùÜ
<št64_t>(
fuzzed_d©a_´ovid”
);

29 
	`Shufæe
(
š‹g¿ls
.
	`begš
(), iÁeg¿ls.
	`’d
(), 
ç¡_¿ndom_cÚ‹xt
);

30 
¡d
::
	`shufæe
(
š‹g¿ls
.
	`begš
(), iÁeg¿ls.
	`’d
(), 
ç¡_¿ndom_cÚ‹xt
);

31 
	}
}

	@rbf.cpp

5 
	~<node/mempoŞ_¬gs.h
>

6 
	~<pŞicy/rbf.h
>

7 
	~<´im™ives/Œª§ùiÚ.h
>

8 
	~<sync.h
>

9 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

10 
	~<‹¡/fuzz/fuzz.h
>

11 
	~<‹¡/fuzz/ut.h
>

12 
	~<‹¡/fuzz/ut/mempoŞ.h
>

13 
	~<‹¡/ut/£tup_commÚ.h
>

14 
	~<‹¡/ut/txmempoŞ.h
>

15 
	~<txmempoŞ.h
>

17 
	~<c¡dšt
>

18 
	~<İtiÚ®
>

19 
	~<¡ršg
>

20 
	~<veùÜ
>

22 
	gÇme¥aû
 {

23 cÚ¡ 
BasicTe¡šgS‘up
* 
	gg_£tup
;

26 
	$š™Ÿlize_rbf
()

28 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>();

29 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

30 
	}
}

32 
	$FUZZ_TARGET_INIT
(
rbf
, 
š™Ÿlize_rbf
)

34 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

35 
	`S‘MockTime
(
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
));

36 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
mtx
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

37 ià(!
mtx
) {

41 
CTxMemPoŞ
 
poŞ
{
	`MemPoŞO±iÚsFÜTe¡
(
g_£tup
->
m_node
)};

43 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000)

45 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
ªÙh”_mtx
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

46 ià(!
ªÙh”_mtx
) {

49 cÚ¡ 
CT¿n§ùiÚ
 
ªÙh”_tx
{*
ªÙh”_mtx
};

50 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è&& !
mtx
->
vš
.
	`em±y
()) {

51 
mtx
->
vš
[0].
´evout
 = 
COutPošt
{
ªÙh”_tx
.
	`G‘Hash
(), 0};

53 
	`LOCK2
(
cs_maš
, 
poŞ
.
cs
);

54 
poŞ
.
	`addUnchecked
(
	`CÚsumeTxMemPoŞEÁry
(
fuzzed_d©a_´ovid”
, 
ªÙh”_tx
));

56 cÚ¡ 
CT¿n§ùiÚ
 
tx
{*
mtx
};

57 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

58 
	`LOCK2
(
cs_maš
, 
poŞ
.
cs
);

59 
poŞ
.
	`addUnchecked
(
	`CÚsumeTxMemPoŞEÁry
(
fuzzed_d©a_´ovid”
, 
tx
));

62 
	`LOCK
(
poŞ
.
cs
);

63 ()
	`IsRBFO±In
(
tx
, 
poŞ
);

65 
	}
}

	@rolling_bloom_filter.cpp

5 
	~<commÚ/bloom.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

9 
	~<ušt256.h
>

11 
	~<ÿs£¹
>

12 
	~<c¡dšt
>

13 
	~<İtiÚ®
>

14 
	~<¡ršg
>

15 
	~<veùÜ
>

17 
	$FUZZ_TARGET
(
rŞlšg_bloom_f‹r
)

19 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

21 
CRŞlšgBloomF‹r
 
rŞlšg_bloom_f‹r
{

22 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(1, 1000),

23 0.999 / 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(1, 
¡d
::
num”ic_lim™s
<>::
	`max
())};

24 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`»maššg_by‹s
() > 0, 3000)

26 
	`C®lOÃOf
(

27 
fuzzed_d©a_´ovid”
,

29 cÚ¡ 
¡d
::
veùÜ
<> 
b
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

30 ()
rŞlšg_bloom_f‹r
.
	`cÚšs
(
b
);

31 
rŞlšg_bloom_f‹r
.
	`š£¹
(
b
);

32 cÚ¡ 
boŞ
 
´e£Á
 = 
rŞlšg_bloom_f‹r
.
	`cÚšs
(
b
);

33 
	`as£¹
(
´e£Á
);

36 cÚ¡ 
ušt256
 
u256
{
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
)};

37 ()
rŞlšg_bloom_f‹r
.
	`cÚšs
(
u256
);

38 
rŞlšg_bloom_f‹r
.
	`š£¹
(
u256
);

39 cÚ¡ 
boŞ
 
´e£Á
 = 
rŞlšg_bloom_f‹r
.
	`cÚšs
(
u256
);

40 
	`as£¹
(
´e£Á
);

43 
rŞlšg_bloom_f‹r
.
	`»£t
();

46 
	}
}

	@rpc.cpp

5 
	~<ba£58.h
>

6 
	~<cÜe_io.h
>

7 
	~<key.h
>

8 
	~<key_io.h
>

9 
	~<node/cÚ‹xt.h
>

10 
	~<´im™ives/block.h
>

11 
	~<´im™ives/Œª§ùiÚ.h
>

12 
	~<psbt.h
>

13 
	~<½c/blockchaš.h
>

14 
	~<½c/ş›Á.h
>

15 
	~<½c/»que¡.h
>

16 
	~<½c/£rv”.h
>

17 
	~<½c/ut.h
>

18 
	~<¥ª.h
>

19 
	~<¡»ams.h
>

20 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

21 
	~<‹¡/fuzz/fuzz.h
>

22 
	~<‹¡/fuzz/ut.h
>

23 
	~<‹¡/ut/£tup_commÚ.h
>

24 
	~<tšyfÜm©.h
>

25 
	~<univ®ue.h
>

26 
	~<ut/¡»ncodšgs.h
>

27 
	~<ut/¡ršg.h
>

28 
	~<ut/time.h
>

30 
	~<c¡dšt
>

31 
	~<io¡»am
>

32 
	~<memÜy
>

33 
	~<İtiÚ®
>

34 
	~<¡dexû±
>

35 
	~<¡ršg
>

36 
	~<veùÜ
>

38 
	gÇme¥aû
 {

39 
	gRPCFuzzTe¡šgS‘up
 : 
public
 
Te¡šgS‘up
 {

40 
RPCFuzzTe¡šgS‘up
(cÚ¡ 
¡d
::
¡ršg
& 
chaš_Çme
, cÚ¡ std::
veùÜ
<cÚ¡ *>& 
exŒa_¬gs
è: 
Te¡šgS‘up
{chaš_Çme, 
	gexŒa_¬gs
}

44 
C®lRPC
(cÚ¡ 
¡d
::
¡ršg
& 
½c_m‘hod
, cÚ¡ std::
veùÜ
<¡d::¡ršg>& 
¬gum’ts
)

46 
JSONRPCReque¡
 
»que¡
;

47 
	g»que¡
.
	gcÚ‹xt
 = &
m_node
;

48 
	g»que¡
.
	g¡rM‘hod
 = 
½c_m‘hod
;

49 
	gŒy
 {

50 
	g»que¡
.
	g·¿ms
 = 
RPCCÚv”tV®ues
(
½c_m‘hod
, 
¬gum’ts
);

51 } 
ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

54 
	gbËRPC
.
execu‹
(
»que¡
);

57 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
G‘RPCCommªds
() const

59  
bËRPC
.
li¡Commªds
();

63 
RPCFuzzTe¡šgS‘up
* 
	g½c_‹¡šg_£tup
 = 
nuÎ±r
;

64 
	g¡d
::
¡ršg
 
g_lim™_to_½c_commªd
;

69 cÚ¡ 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
RPC_COMMANDS_NOT_SAFE_FOR_FUZZING
{

89 cÚ¡ 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
RPC_COMMANDS_SAFE_FOR_FUZZING
{

177 
	g¡d
::
¡ršg
 
CÚsumeSÿÏrRPCArgum’t
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
)

179 cÚ¡ 
size_t
 
max_¡ršg_Ëngth
 = 4096;

180 cÚ¡ 
size_t
 
	gmax_ba£58_by‹s_Ëngth
{64};

181 
	g¡d
::
¡ršg
 
r
;

182 
C®lOÃOf
(

183 
fuzzed_d©a_´ovid”
,

186 
r
 = 
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(
max_¡ršg_Ëngth
);

190 
r
 = 
EncodeBa£64
(
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(
max_¡ršg_Ëngth
));

194 
r
 = 
HexSŒ
(
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(
max_¡ršg_Ëngth
));

198 
r
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
() ? "true" : "false";

202 
r
 = "[" + 
ToSŒšg
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>()) + "," + ToString(fuzzed_data_provider.ConsumeIntegral<int64_t>()) + "]";

206 
r
 = 
ToSŒšg
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>());

210 
r
 = 
ToSŒšg
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>());

214 
r
 = 
¡½rštf
("%f", 
fuzzed_d©a_´ovid”
.
CÚsumeFlßtšgPošt
<>());

218 
r
 = 
EncodeDe¡š©iÚ
(
CÚsumeTxDe¡š©iÚ
(
fuzzed_d©a_´ovid”
));

222 
r
 = 
CÚsumeUIÁ160
(
fuzzed_d©a_´ovid”
).
ToSŒšg
();

226 
r
 = 
CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
).
ToSŒšg
();

230 
r
 = 
EncodeBa£32
(
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(
max_¡ršg_Ëngth
));

234 
r
 = 
EncodeBa£58
(
MakeUCh¬S·n
(
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(
max_ba£58_by‹s_Ëngth
)));

238 
r
 = 
EncodeBa£58Check
(
MakeUCh¬S·n
(
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(
max_ba£58_by‹s_Ëngth
)));

242 
¡d
::
İtiÚ®
<
CBlock
> 
İt_block
 = 
CÚsumeDe£rŸlizabË
<CBlock>(
fuzzed_d©a_´ovid”
);

243 ià(!
İt_block
) {

246 
CD©aSŒ—m
 
d©a_¡»am
{
SER_NETWORK
, 
PROTOCOL_VERSION
};

247 
d©a_¡»am
 << *
İt_block
;

248 
r
 = 
HexSŒ
(
d©a_¡»am
);

252 
¡d
::
İtiÚ®
<
CBlockH—d”
> 
İt_block_h—d”
 = 
CÚsumeDe£rŸlizabË
<CBlockH—d”>(
fuzzed_d©a_´ovid”
);

253 ià(!
İt_block_h—d”
) {

256 
CD©aSŒ—m
 
d©a_¡»am
{
SER_NETWORK
, 
PROTOCOL_VERSION
};

257 
d©a_¡»am
 << *
İt_block_h—d”
;

258 
r
 = 
HexSŒ
(
d©a_¡»am
);

262 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
İt_tx
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

263 ià(!
İt_tx
) {

266 
CD©aSŒ—m
 
d©a_¡»am
{
SER_NETWORK
, 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
(è? 
PROTOCOL_VERSION
 : (PROTOCOL_VERSION | 
SERIALIZE_TRANSACTION_NO_WITNESS
)};

267 
d©a_¡»am
 << *
İt_tx
;

268 
r
 = 
HexSŒ
(
d©a_¡»am
);

272 
¡d
::
İtiÚ®
<
P¬tŸÎySigÃdT¿n§ùiÚ
> 
İt_psbt
 = 
CÚsumeDe£rŸlizabË
<P¬tŸÎySigÃdT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

273 ià(!
İt_psbt
) {

276 
CD©aSŒ—m
 
d©a_¡»am
{
SER_NETWORK
, 
PROTOCOL_VERSION
};

277 
d©a_¡»am
 << *
İt_psbt
;

278 
r
 = 
EncodeBa£64
(
d©a_¡»am
);

282 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<uint8_t>(32);

283 
CKey
 
key
;

284 
key
.
S‘
(
¿ndom_by‹s
.
begš
(),„ªdom_by‹s.
’d
(), 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
());

285 ià(!
key
.
IsV®id
()) {

288 
r
 = 
EncodeSeü‘
(
key
);

292 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<uint8_t>(32);

293 
CKey
 
key
;

294 
key
.
S‘
(
¿ndom_by‹s
.
begš
(),„ªdom_by‹s.
’d
(), 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
());

295 ià(!
key
.
IsV®id
()) {

298 
r
 = 
HexSŒ
(
key
.
G‘PubKey
());

300  
	gr
;

303 
	g¡d
::
¡ršg
 
CÚsumeA¼ayRPCArgum’t
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
)

305 
¡d
::
veùÜ
<¡d::
¡ršg
> 
sÿÏr_¬gum’ts
;

306 
LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
(), 100) {

307 
	gsÿÏr_¬gum’ts
.
push_back
(
CÚsumeSÿÏrRPCArgum’t
(
fuzzed_d©a_´ovid”
));

309  "[\"" + 
Još
(
sÿÏr_¬gum’ts
, "\",\"") + "\"]";

312 
	g¡d
::
¡ršg
 
CÚsumeRPCArgum’t
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
)

314  
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
(è? 
CÚsumeSÿÏrRPCArgum’t
(fuzzed_d©a_´ovid”è: 
CÚsumeA¼ayRPCArgum’t
(fuzzed_data_provider);

317 
RPCFuzzTe¡šgS‘up
* 
In™ŸlizeRPCFuzzTe¡šgS‘up
()

319 cÚ¡‡utØ
	g£tup
 = 
MakeNoLogFeCÚ‹xt
<
RPCFuzzTe¡šgS‘up
>();

320 
S‘RPCW¬mupFšished
();

321  
	g£tup
.
g‘
();

325 
	$š™Ÿlize_½c
()

327 
½c_‹¡šg_£tup
 = 
	`In™ŸlizeRPCFuzzTe¡šgS‘up
();

328 cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> 
suµÜ‹d_½c_commªds
 = 
½c_‹¡šg_£tup
->
	`G‘RPCCommªds
();

329 cÚ¡ 
¡d
::
¡ršg
& 
½c_commªd
 : 
suµÜ‹d_½c_commªds
) {

330 cÚ¡ 
boŞ
 
§ã_fÜ_fuzzšg
 = 
¡d
::
	`fšd
(
RPC_COMMANDS_SAFE_FOR_FUZZING
.
	`begš
(), RPC_COMMANDS_SAFE_FOR_FUZZING.
	`’d
(), 
½c_commªd
) != RPC_COMMANDS_SAFE_FOR_FUZZING.end();

331 cÚ¡ 
boŞ
 
nÙ_§ã_fÜ_fuzzšg
 = 
¡d
::
	`fšd
(
RPC_COMMANDS_NOT_SAFE_FOR_FUZZING
.
	`begš
(), RPC_COMMANDS_NOT_SAFE_FOR_FUZZING.
	`’d
(), 
½c_commªd
) != RPC_COMMANDS_NOT_SAFE_FOR_FUZZING.end();

332 ià(!(
§ã_fÜ_fuzzšg
 || 
nÙ_§ã_fÜ_fuzzšg
)) {

333 
¡d
::
û¼
 << "E¼Ü: RPC commªd \"" << 
½c_commªd
 << "\"‚Ù found iÀRPC_COMMANDS_SAFE_FOR_FUZZING o¸RPC_COMMANDS_NOT_SAFE_FOR_FUZZING. PËa£ upd©" << 
__FILE__
 << ".\n";

334 
¡d
::
	`‹rmš©e
();

336 ià(
§ã_fÜ_fuzzšg
 && 
nÙ_§ã_fÜ_fuzzšg
) {

337 
¡d
::
û¼
 << "E¼Ü: RPC commªd \"" << 
½c_commªd
 << "\" found iÀ*bÙh* RPC_COMMANDS_SAFE_FOR_FUZZING‡nd RPC_COMMANDS_NOT_SAFE_FOR_FUZZING. PËa£ upd©" << 
__FILE__
 << ".\n";

338 
¡d
::
	`‹rmš©e
();

341 cÚ¡ * 
lim™_to_½c_commªd_’v
 = 
¡d
::
	`g‘’v
("LIMIT_TO_RPC_COMMAND");

342 ià(
lim™_to_½c_commªd_’v
 !ğ
nuÎ±r
) {

343 
g_lim™_to_½c_commªd
 = 
¡d
::
¡ršg
{
lim™_to_½c_commªd_’v
};

345 
	}
}

347 
	$FUZZ_TARGET_INIT
(
½c
, 
š™Ÿlize_½c
)

349 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

350 
	`S‘MockTime
(
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
));

351 cÚ¡ 
¡d
::
¡ršg
 
½c_commªd
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(64);

352 ià(!
g_lim™_to_½c_commªd
.
	`em±y
(è&& 
½c_commªd
 != g_limit_to_rpc_command) {

355 cÚ¡ 
boŞ
 
§ã_fÜ_fuzzšg
 = 
¡d
::
	`fšd
(
RPC_COMMANDS_SAFE_FOR_FUZZING
.
	`begš
(), RPC_COMMANDS_SAFE_FOR_FUZZING.
	`’d
(), 
½c_commªd
) != RPC_COMMANDS_SAFE_FOR_FUZZING.end();

356 ià(!
§ã_fÜ_fuzzšg
) {

359 
¡d
::
veùÜ
<¡d::
¡ršg
> 
¬gum’ts
;

360 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 100) {

361 
¬gum’ts
.
	`push_back
(
	`CÚsumeRPCArgum’t
(
fuzzed_d©a_´ovid”
));

363 
Œy
 {

364 
½c_‹¡šg_£tup
->
	`C®lRPC
(
½c_commªd
, 
¬gum’ts
);

365 } 
	`ÿtch
 (cÚ¡ 
UniV®ue
& 
jsÚ_½c_”rÜ
) {

366 cÚ¡ 
¡d
::
¡ršg
 
”rÜ_msg
{
	`fšd_v®ue
(
jsÚ_½c_”rÜ
, "mes§ge").
	`g‘_¡r
()};

369 ià(0 =ğ
”rÜ_msg
.
	`rfšd
("Internal bug detected", 0)) {

371 
	`as£¹
(
”rÜ_msg
.
	`fšd
("Œigg”_š‹º®_bug"è!ğ
¡d
::
¡ršg
::
Åos
);

374 
	}
}

	@script.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<com´essÜ.h
>

7 
	~<cÜe_io.h
>

8 
	~<cÜe_memu§ge.h
>

9 
	~<key_io.h
>

10 
	~<pŞicy/pŞicy.h
>

11 
	~<pubkey.h
>

12 
	~<½c/ut.h
>

13 
	~<süt/desütÜ.h
>

14 
	~<süt/š‹½»‹r.h
>

15 
	~<süt/süt.h
>

16 
	~<süt/süt_”rÜ.h
>

17 
	~<süt/sign.h
>

18 
	~<süt/signšg´ovid”.h
>

19 
	~<süt/¡ªd¬d.h
>

20 
	~<¡»ams.h
>

21 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

22 
	~<‹¡/fuzz/fuzz.h
>

23 
	~<‹¡/fuzz/ut.h
>

24 
	~<univ®ue.h
>

26 
	~<®gÜ™hm
>

27 
	~<ÿs£¹
>

28 
	~<c¡dšt
>

29 
	~<İtiÚ®
>

30 
	~<¡ršg
>

31 
	~<veùÜ
>

33 
	~<ùy³.h
>

34 
	~<¡dio.h
>

36 
	g¡d
::
	tbasic_¡ršg
 <> 
	tu¡ršg
;

38 
	g¡d
::
veùÜ
<> 
	$CheckedP¬£Hex
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
)

40 ià(
¡r
.
	`size
(è&& !
	`IsHex
(¡r)è
throw
 
¡d
::
	`ruÁime_”rÜ
("Non-hex input '" + str + "'");

41  
	`P¬£Hex
(
¡r
);

42 
	}
}

44 
CSüt
 
	$SütFromHex
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
)

46 
¡d
::
veùÜ
<> 
d©a
 = 
	`CheckedP¬£Hex
(
¡r
);

47  
	`CSüt
(
d©a
.
	`begš
(), d©a.
	`’d
());

48 
	}
}

50 
	$hexdump
(cÚ¡ *
±r
, 
buæ’
)

52 *
buf
 = (*è
±r
;

53 
i
, 
j
;

55 
i
 = 0; i < 
buæ’
; i += 16) {

56 
	`´štf
("%06x: ", 
i
);

57 
j
 = 0; j < 16; j++)

58 ià(
i
 + 
j
 < 
buæ’
)

59 
	`´štf
("%02x ", 
buf
[
i
+
j
]);

61 
	`´štf
(" ");

62 
	`´štf
(" ");

63 
j
 = 0; j < 16; j++)

64 ià(
i
 + 
j
 < 
buæ’
)

65 
	`´štf
("%c", 
	`i¥ršt
(
buf
[
i
 + 
j
]) ? buf[i + j] : '.');

66 
	`´štf
("\n");

68 
	}
}

71 
	$š™Ÿlize_süt
()

74 cÚ¡ 
ECCV”ifyHªdË
 
v”ify_hªdË
;

76 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
REGTEST
);

77 
	}
}

79 
	$check_ty³
(
TxoutTy³
 
which_ty³
)

81 ià(
which_ty³
 =ğ
TxoutTy³
::
NONSTANDARD
)

82 
¡d
::
cout
 << " Type :: NONSTANDARD" << "\n";

83 ià(
which_ty³
 =ğ
TxoutTy³
::
NULL_DATA
)

84 
¡d
::
cout
 << " Type :: NULL_DATA" << "\n";

85 ià(
which_ty³
 =ğ
TxoutTy³
::
MULTISIG
)

86 
¡d
::
cout
 << " Type :: MULTISIG" << "\n";

87 ià(
which_ty³
 =ğ
TxoutTy³
::
PUBKEY
)

88 
¡d
::
cout
 << " Type :: PUBKEY" << "\n";

89 ià(
which_ty³
 =ğ
TxoutTy³
::
PUBKEYHASH
)

90 
¡d
::
cout
 << " Type :: PUBKEYHASH" << "\n";

91 ià(
which_ty³
 =ğ
TxoutTy³
::
SCRIPTHASH
)

92 
¡d
::
cout
 << " Type :: SCRIPTHASH" << "\n";

93 ià(
which_ty³
 =ğ
TxoutTy³
::
WITNESS_V0_SCRIPTHASH
)

94 
¡d
::
cout
 << " Type :: WITNESS_V0_SCRIPTHASH" << "\n";

95 ià(
which_ty³
 =ğ
TxoutTy³
::
WITNESS_V0_KEYHASH
)

96 
¡d
::
cout
 << " Type :: WITNESS_V0_KEYHASH" << "\n";

97 ià(
which_ty³
 =ğ
TxoutTy³
::
WITNESS_V1_TAPROOT
)

98 
¡d
::
cout
 << " Type :: WITNESS_V1_TAPROOT" << "\n";

99 ià(
which_ty³
 =ğ
TxoutTy³
::
WITNESS_UNKNOWN
)

100 
¡d
::
cout
 << " Type :: WITNESS_UNKNOWN" << "\n";

101 
	}
}

104 
	$FUZZ_TARGET_INIT
(
süt
, 
š™Ÿlize_süt
)

107 
¡d
::
cout
 << "\n\n";

108 
	`´štf
("IÅuˆ:: %u", (è
bufãr
.
	`size
());

109 
¡d
::
cout
 << "\n";

110 
	`hexdump
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

113 
¡d
::
¡ršg
 
lockSütTok’
 = "lockScript";

114 
¡d
::
¡ršg
 
uÆockSütTok’
 = "unlockScript";

116 
¡d
::
¡ršg
 
šput
 = std::
	`¡ršg
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
bufãr
.
	`d©a
()), bufãr.
	`size
());

118 
¡d
::
cout
 << 
šput
;

120 
¡d
::
size_t
 
foundLockSüt
 = 
šput
.
	`fšd
(
lockSütTok’
);

121 
¡d
::
size_t
 
foundUÆockSüt
 = 
šput
.
	`fšd
(
uÆockSütTok’
);

123 ià(
foundLockSüt
 !ğ
¡d
::
¡ršg
::
Åos
)

124 
¡d
::
cout
 << "\nfœ¡ 'Lock Süt' found‡t: " << 
foundLockSüt
 << '\n';

125 ià(
foundUÆockSüt
 !ğ
¡d
::
¡ršg
::
Åos
)

126 
¡d
::
cout
 << "fœ¡ 'UÆock Süt' found‡t: " << 
foundUÆockSüt
 << '\n';

128 
foundLockSüt
 = 
šput
.
	`fšd
(
lockSütTok’
, foundLockSüˆ+†ockSütTok’.
	`Ëngth
());

129 
foundUÆockSüt
 = 
šput
.
	`fšd
(
uÆockSütTok’
, foundUÆockSüˆ+ uÆockSütTok’.
	`Ëngth
());

131 ià(
foundLockSüt
 !ğ
¡d
::
¡ršg
::
Åos
)

132 
¡d
::
cout
 << "£cÚd 'Lock Süt' found‡t: " << 
foundLockSüt
 << '\n';

133 ià(
foundUÆockSüt
 !ğ
¡d
::
¡ršg
::
Åos
)

134 
¡d
::
cout
 << "£cÚd 'UÆock Süt' found‡t: " << 
foundUÆockSüt
 << '\n';

137 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

138 cÚ¡ 
CSüt
 
süt
{
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
)};

139 
Com´es£dSüt
 
com´es£d
;

141 cÚ¡ 
CSüt
 
sütPubKey_§m¶eP2PK
 = 
	`SütFromHex
("4104ae1a62fe09c5f51b13905f07f06b99a2f7159b2225f374cd378d71302fa28414e7aab37397f554a7df5f142c21c1b7303b8a0626f1baded5c72a704f7e6cd84cac");

142 cÚ¡ 
CSüt
 
sütPubKey_§m¶eP2PKH
 = 
	`SütFromHex
("76a91412ab8dc588ca9d5787dde7eb29569da63c3a238c88ac");

143 cÚ¡ 
CSüt
 
sütPubKey_§m¶eP2SH
 = 
	`SütFromHex
("a914748284390f9e263a4b766a75d0633c50426eb87587");

144 cÚ¡ 
CSüt
 
sütPubKey_d•»ÿ‹ERP
 = 
	`SütFromHex
("a9145938886a96ffa30ba7f3a7a55350adb0b069b97787");

145 cÚ¡ 
CSüt
 
sütPubKey_ÃwERP
 = 
	`SütFromHex
("a914bf78f42f55944803b78752ab66063e685ab53f2287");

147 cÚ¡ 
CSüt
 
sütSig_§m¶eP2PK
 = 
	`SütFromHex
("4730440220576497b7e6f9b553c0aba0d8929432550e092db9c130aae37b84b545e7f4a36c022066cb982ed80608372c139d7bb9af335423d5280350fe3e06bd510e695480914f01");

148 cÚ¡ 
CSüt
 
sütSig_§m¶eP2PKH
 = 
	`SütFromHex
("48304502203f004eeed0cef2715643e2f25a27a28f3c578e94c7f0f6a4df104e7d163f7f8f022100b8b248c1cfd8f77a0365107a9511d759b7544d979dd152a955c867afac0ef7860141044d05240cfbd8a2786eda9dadd520c1609b8593ff8641018d57703d02ba687cf2f187f0cee2221c3afb1b5ff7888caced2423916b61444666ca1216f26181398c");

149 cÚ¡ 
CSüt
 
sütSig_§m¶eP2SH
 = 
	`SütFromHex
("00493046022100a07b2821f96658c938fa9c68950af0e69f3b2ce5f8258b3a6ad254d4bc73e11e022100e82fab8df3f7e7a28e91b3609f91e8ebf663af3a4dc2fd2abd954301a5da67e701475121022afc20bf379bc96a2f4e9e63ffceb8652b2b6a097f63fbee6ecec2a49a48010e2103a767c7221e9f15f870f1ad9311f5ab937d79fcaeee15bb2c722bca515581b4c052ae");

150 cÚ¡ 
CSüt
 
sütSig_d•»ÿ‹ERP
 = 
	`SütFromHex
("00473045022100d7912c828f4fe5aa1194762b9cc4ce7164ec78f43e724e0d29a24ea883530fcc02203a80f8d843011b8ab0c9462dc46970c17ada4aae39d1e4fc0dc01b59522677bc473045022100d7912c828f4fe5aa1194762b9cc4ce7164ec78f43e724e0d29a24ea883530fcc02203a80f8d843011b8ab0c9462dc46970c17ada4aae39d1e4fc0dc01b59522677bc4c95645221020a6011786c4f54cb3cebde468bccd518573154897c48bd69fcf9f392a9aa56bd21024ff8ca686fd9f125489d4a56e967b467af6dee9bd944062d8e2bd4ad377934512103e99bd5148fc9bee81ca86e5c8933bee659f909fdf482126cc9b6f037fead50255367020001b275512102199fa8ade567942c1c07a44ac4e449f0bda515d41809a1e5d5997f39fcdb255c5168ae");

151 cÚ¡ 
CSüt
 
sütSig_ÃwERP
 = 
	`SütFromHex
("00473045022100d7912c828f4fe5aa1194762b9cc4ce7164ec78f43e724e0d29a24ea883530fcc02203a80f8d843011b8ab0c9462dc46970c17ada4aae39d1e4fc0dc01b59522677bc473045022100d7912c828f4fe5aa1194762b9cc4ce7164ec78f43e724e0d29a24ea883530fcc02203a80f8d843011b8ab0c9462dc46970c17ada4aae39d1e4fc0dc01b59522677bc4c96645221020a6011786c4f54cb3cebde468bccd518573154897c48bd69fcf9f392a9aa56bd21024ff8ca686fd9f125489d4a56e967b467af6dee9bd944062d8e2bd4ad377934512103e99bd5148fc9bee81ca86e5c8933bee659f909fdf482126cc9b6f037fead502553ae67020001b275512102199fa8ade567942c1c07a44ac4e449f0bda515d41809a1e5d5997f39fcdb255c51ae68");

153 
TxoutTy³
 
which_ty³
;

156 
¡d
::
cout
 << "\n\n";

157 
¡d
::
cout
 << "Sample P2PK\n";

158 
¡d
::
cout
 << " sütPuKey :: " << (
sütPubKey_§m¶eP2PK
.
	`size
()) << "\n";

159 
¡d
::
cout
 << " IsSnd¬d :: " << 
	`IsSnd¬d
(
sütPubKey_§m¶eP2PK
, std::
nuÎİt
, 
which_ty³
) << "\n";

160 
¡d
::
cout
 << " IsPayToSütHash :: " << 
sütPubKey_§m¶eP2PK
.
	`IsPayToSütHash
() << "\n";

161 
	`check_ty³
(
which_ty³
);

162 
¡d
::
cout
 << "\n";

163 
¡d
::
cout
 << " sütSig :: " << (
sütSig_§m¶eP2PK
.
	`size
()) << "\n";

164 
¡d
::
cout
 << " G‘SigOpCouÁ :: " << 
sütSig_§m¶eP2PK
.
	`G‘SigOpCouÁ
(scriptSig_sampleP2PK) << "\n";

165 
	`IsSnd¬d
(
sütSig_§m¶eP2PK
, 
¡d
::
nuÎİt
, 
which_ty³
);

166 
	`check_ty³
(
which_ty³
);

168 
¡d
::
cout
 << "\n";

169 
¡d
::
cout
 << "Sample P2PKH\n";

170 
¡d
::
cout
 << " sütPuKey :: " << (
sütPubKey_§m¶eP2PKH
.
	`size
()) << "\n";

171 
¡d
::
cout
 << " IsSnd¬d :: " << 
	`IsSnd¬d
(
sütPubKey_§m¶eP2PKH
, std::
nuÎİt
, 
which_ty³
) << "\n";

172 
¡d
::
cout
 << " IsPayToSütHash :: " << 
sütPubKey_§m¶eP2PKH
.
	`IsPayToSütHash
() << "\n";

173 
	`check_ty³
(
which_ty³
);

174 
¡d
::
cout
 << "\n";

175 
¡d
::
cout
 << " sütSig :: " << (
sütSig_§m¶eP2PKH
.
	`size
()) << "\n";

176 
¡d
::
cout
 << " G‘SigOpCouÁ :: " << 
sütPubKey_§m¶eP2PKH
.
	`G‘SigOpCouÁ
(
sütSig_§m¶eP2PKH
) << "\n";

177 
	`IsSnd¬d
(
sütSig_§m¶eP2PKH
, 
¡d
::
nuÎİt
, 
which_ty³
);

178 
	`check_ty³
(
which_ty³
);

180 
¡d
::
cout
 << "\n";

181 
¡d
::
cout
 << "Sample P2SH\n";

182 
¡d
::
cout
 << " sütPuKey :: " << (
sütPubKey_§m¶eP2SH
.
	`size
()) << "\n";

183 
¡d
::
cout
 << " IsSnd¬d :: " << 
	`IsSnd¬d
(
sütPubKey_§m¶eP2SH
, std::
nuÎİt
, 
which_ty³
) << "\n";

184 
¡d
::
cout
 << " IsPayToSütHash :: " << 
sütPubKey_§m¶eP2SH
.
	`IsPayToSütHash
() << "\n";

185 
	`check_ty³
(
which_ty³
);

186 
¡d
::
cout
 << "\n";

187 
¡d
::
cout
 << " sütSig :: " << (
sütSig_§m¶eP2SH
.
	`size
()) << "\n";

188 
¡d
::
cout
 << " G‘SigOpCouÁ :: " << 
sütPubKey_§m¶eP2SH
.
	`G‘SigOpCouÁ
(
sütSig_§m¶eP2SH
) << "\n";

189 
	`IsSnd¬d
(
sütSig_§m¶eP2SH
, 
¡d
::
nuÎİt
, 
which_ty³
);

190 
	`check_ty³
(
which_ty³
);

194 
¡d
::
cout
 << "\n";

195 
¡d
::
cout
 << "Deprecate ERP\n";

196 
¡d
::
cout
 << " sütPuKey :: " << (
sütPubKey_d•»ÿ‹ERP
.
	`size
()) << "\n";

197 
¡d
::
cout
 << " IsSnd¬d :: " << 
	`IsSnd¬d
(
sütPubKey_d•»ÿ‹ERP
, std::
nuÎİt
, 
which_ty³
) << "\n";

198 
¡d
::
cout
 << " IsPayToSütHash :: " << 
sütPubKey_d•»ÿ‹ERP
.
	`IsPayToSütHash
() << "\n";

199 
	`check_ty³
(
which_ty³
);

200 
¡d
::
cout
 << "\n";

201 
¡d
::
cout
 << " sütSig :: " << (
sütSig_d•»ÿ‹ERP
.
	`size
()) << "\n";

202 
¡d
::
cout
 << " G‘SigOpCouÁ :: " << 
sütPubKey_d•»ÿ‹ERP
.
	`G‘SigOpCouÁ
(
sütSig_d•»ÿ‹ERP
) << "\n";

203 
	`IsSnd¬d
(
sütSig_d•»ÿ‹ERP
, 
¡d
::
nuÎİt
, 
which_ty³
);

204 
	`check_ty³
(
which_ty³
);

206 
¡d
::
cout
 << "\n";

207 
¡d
::
cout
 << "New ERP\n";

208 
¡d
::
cout
 << " sütPuKey :: " << (
sütPubKey_ÃwERP
.
	`size
()) << "\n";

209 
¡d
::
cout
 << " IsSnd¬d :: " << 
	`IsSnd¬d
(
sütPubKey_ÃwERP
, std::
nuÎİt
, 
which_ty³
) << "\n";

210 
¡d
::
cout
 << " IsPayToSütHash :: " << 
sütPubKey_ÃwERP
.
	`IsPayToSütHash
() << "\n";

211 
	`check_ty³
(
which_ty³
);

212 
¡d
::
cout
 << "\n";

213 
¡d
::
cout
 << " sütSig :: " << (
sütSig_ÃwERP
.
	`size
()) << "\n";

214 
¡d
::
cout
 << " G‘SigOpCouÁ :: " << 
sütPubKey_ÃwERP
.
	`G‘SigOpCouÁ
(
sütSig_ÃwERP
) << "\n";

215 
¡d
::
cout
 << "\n\n";

216 
	`IsSnd¬d
(
sütSig_ÃwERP
, 
¡d
::
nuÎİt
, 
which_ty³
);

217 
	`check_ty³
(
which_ty³
);

219 ià(
	`Com´essSüt
(
süt
, 
com´es£d
)) {

220 cÚ¡ 
size
 = 
com´es£d
[0];

221 
com´es£d
.
	`”a£
(com´es£d.
	`begš
());

222 
	`as£¹
(
size
 <= 5);

223 
CSüt
 
decom´es£d_süt
;

224 cÚ¡ 
boŞ
 
ok
 = 
	`Decom´essSüt
(
decom´es£d_süt
, 
size
, 
com´es£d
);

225 
	`as£¹
(
ok
);

226 
	`as£¹
(
süt
 =ğ
decom´es£d_süt
);

230 
boŞ
 
is_¡ªd¬d_»t
 = 
	`IsSnd¬d
(
süt
, 
¡d
::
nuÎİt
, 
which_ty³
);

232 ià(!
is_¡ªd¬d_»t
) {

233 
	`as£¹
(
which_ty³
 =ğ
TxoutTy³
::
NONSTANDARD
 ||

234 
which_ty³
 =ğ
TxoutTy³
::
NULL_DATA
 ||

235 
which_ty³
 =ğ
TxoutTy³
::
MULTISIG
);

237 ià(
which_ty³
 =ğ
TxoutTy³
::
NONSTANDARD
) {

238 
	`as£¹
(!
is_¡ªd¬d_»t
);

240 ià(
which_ty³
 =ğ
TxoutTy³
::
NULL_DATA
) {

241 
	`as£¹
(
süt
.
	`IsUn¥’dabË
());

243 ià(
süt
.
	`IsUn¥’dabË
()) {

244 
	`as£¹
(
which_ty³
 =ğ
TxoutTy³
::
NULL_DATA
 ||

245 
which_ty³
 =ğ
TxoutTy³
::
NONSTANDARD
);

248 
CTxDe¡š©iÚ
 
add»ss
;

249 
boŞ
 
exŒaù_de¡š©iÚ_»t
 = 
	`ExŒaùDe¡š©iÚ
(
süt
, 
add»ss
);

250 ià(!
exŒaù_de¡š©iÚ_»t
) {

251 
	`as£¹
(
which_ty³
 =ğ
TxoutTy³
::
PUBKEY
 ||

252 
which_ty³
 =ğ
TxoutTy³
::
NONSTANDARD
 ||

253 
which_ty³
 =ğ
TxoutTy³
::
NULL_DATA
 ||

254 
which_ty³
 =ğ
TxoutTy³
::
MULTISIG
);

256 ià(
which_ty³
 =ğ
TxoutTy³
::
NONSTANDARD
 ||

257 
which_ty³
 =ğ
TxoutTy³
::
NULL_DATA
 ||

258 
which_ty³
 =ğ
TxoutTy³
::
MULTISIG
) {

259 
	`as£¹
(!
exŒaù_de¡š©iÚ_»t
);

262 cÚ¡ 
FÏtSignšgProvid”
 
signšg_´ovid”
;

263 ()
	`InãrDesütÜ
(
süt
, 
signšg_´ovid”
);

264 ()
	`IsSegW™Ouut
(
signšg_´ovid”
, 
süt
);

266 ()
	`RecursiveDyÇmicU§ge
(
süt
);

268 
¡d
::
veùÜ
<¡d::veùÜ<>> 
sŞutiÚs
;

269 ()
	`SŞv”
(
süt
, 
sŞutiÚs
);

271 ()
süt
.
	`HasV®idOps
();

272 ()
süt
.
	`IsPayToSütHash
();

273 ()
süt
.
	`IsPayToW™ÃssSütHash
();

274 ()
süt
.
	`IsPushOÆy
();

275 ()
süt
.
	`G‘SigOpCouÁ
Ğ
çl£
);

278 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
by‹s
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

279 
Com´es£dSüt
 
com´es£d_süt
;

280 
com´es£d_süt
.
	`assign
(
by‹s
.
	`begš
(), by‹s.
	`’d
());

282 ià(
com´es£d_süt
.
	`size
() >= 32) {

283 
CSüt
 
decom´es£d_süt
;

284 
	`Decom´essSüt
(
decom´es£d_süt
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>(), 
com´es£d_süt
);

288 cÚ¡ 
¡d
::
İtiÚ®
<
CSüt
> 
Ùh”_süt
 = 
CÚsumeDe£rŸlizabË
<CSüt>(
fuzzed_d©a_´ovid”
);

289 ià(
Ùh”_süt
) {

291 
CSüt
 
süt_mut
{
süt
};

292 ()
	`FšdAndD–‘e
(
süt_mut
, *
Ùh”_süt
);

294 cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> 
¿ndom_¡ršg_veùÜ
 = 
	`CÚsumeRªdomL’gthSŒšgVeùÜ
(
fuzzed_d©a_´ovid”
);

295 cÚ¡ 
ušt32_t
 
u32
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>()};

296 cÚ¡ 
ušt32_t
 
æags
{
u32
 | 
SCRIPT_VERIFY_P2SH
};

298 
CSütW™Ãss
 
w™
;

299 cÚ¡‡uto& 
s
 : 
¿ndom_¡ršg_veùÜ
) {

300 
w™
.
¡ack
.
	`em¶aû_back
(
s
.
	`begš
(), s.
	`’d
());

302 ()
	`CouÁW™ÃssSigOps
(
süt
, *
Ùh”_süt
, &
w™
, 
æags
);

303 
w™
.
	`S‘NuÎ
();

307 ()
	`G‘OpName
(
	`CÚsumeOpcodeTy³
(
fuzzed_d©a_´ovid”
));

308 ()
	`SütE¼ÜSŒšg
(
¡©ic_ÿ¡
<
SütE¼Ü
>(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 
SCRIPT_ERR_ERROR_COUNT
)));

311 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
by‹s
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

312 
CSüt
 
­³nd_süt
{
by‹s
.
	`begš
(), by‹s.
	`’d
()};

313 
­³nd_süt
 << 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>();

314 
­³nd_süt
 << 
	`CÚsumeOpcodeTy³
(
fuzzed_d©a_´ovid”
);

315 
­³nd_süt
 << 
CSütNum
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>()};

316 
­³nd_süt
 << 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

320 cÚ¡ 
CTxDe¡š©iÚ
 
tx_de¡š©iÚ_1
{

321 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
() ?

322 
	`DecodeDe¡š©iÚ
(
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
()) :

323 
	`CÚsumeTxDe¡š©iÚ
(
fuzzed_d©a_´ovid”
)};

324 cÚ¡ 
CTxDe¡š©iÚ
 
tx_de¡š©iÚ_2
{
	`CÚsumeTxDe¡š©iÚ
(
fuzzed_d©a_´ovid”
)};

325 cÚ¡ 
¡d
::
¡ršg
 
’coded_de¡
{
	`EncodeDe¡š©iÚ
(
tx_de¡š©iÚ_1
)};

326 cÚ¡ 
UniV®ue
 
jsÚ_de¡
{
	`DesüibeAdd»ss
(
tx_de¡š©iÚ_1
)};

327 
	`As£¹
(
tx_de¡š©iÚ_1
 =ğ
	`DecodeDe¡š©iÚ
(
’coded_de¡
));

328 ()
	`G‘KeyFÜDe¡š©iÚ
Ğ{}, 
tx_de¡š©iÚ_1
);

329 cÚ¡ 
CSüt
 
de¡
{
	`G‘SütFÜDe¡š©iÚ
(
tx_de¡š©iÚ_1
)};

330 cÚ¡ 
boŞ
 
v®id
{
	`IsV®idDe¡š©iÚ
(
tx_de¡š©iÚ_1
)};

331 
	`As£¹
(
de¡
.
	`em±y
(è!ğ
v®id
);

333 
	`As£¹
(
v®id
 =ğ
	`IsV®idDe¡š©iÚSŒšg
(
’coded_de¡
));

335 ()(
tx_de¡š©iÚ_1
 < 
tx_de¡š©iÚ_2
);

336 ià(
tx_de¡š©iÚ_1
 =ğ
tx_de¡š©iÚ_2
) {

337 
	`As£¹
(
’coded_de¡
 =ğ
	`EncodeDe¡š©iÚ
(
tx_de¡š©iÚ_2
));

338 
	`As£¹
(
jsÚ_de¡
.
	`wr™e
(è=ğ
	`DesüibeAdd»ss
(
tx_de¡š©iÚ_2
).write());

339 
	`As£¹
(
de¡
 =ğ
	`G‘SütFÜDe¡š©iÚ
(
tx_de¡š©iÚ_2
));

342 
	}
}

	@script_assets_test_minimizer.cpp

5 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<´im™ives/Œª§ùiÚ.h
>

8 
	~<pubkey.h
>

9 
	~<süt/š‹½»‹r.h
>

10 
	~<£rŸlize.h
>

11 
	~<¡»ams.h
>

12 
	~<univ®ue.h
>

13 
	~<ut/¡»ncodšgs.h
>

14 
	~<ut/¡ršg.h
>

16 
	~<c¡dšt
>

17 
	~<¡ršg
>

18 
	~<veùÜ
>

39 
	gÇme¥aû
 {

41 
	g¡d
::
veùÜ
<> 
CheckedP¬£Hex
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
)

43 ià(
¡r
.
size
(è&& !
IsHex
(¡r)è
throw
 
¡d
::
ruÁime_”rÜ
("Non-hex input '" + str + "'");

44  
P¬£Hex
(
¡r
);

47 
CSüt
 
SütFromHex
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
)

49 
¡d
::
veùÜ
<> 
d©a
 = 
CheckedP¬£Hex
(
¡r
);

50  
CSüt
(
d©a
.
begš
(), d©a.
’d
());

53 
CMubËT¿n§ùiÚ
 
TxFromHex
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
)

55 
CMubËT¿n§ùiÚ
 
tx
;

56 
	gŒy
 {

57 
	gS·nR—d”
{
	gSER_DISK
, 
	gSERIALIZE_TRANSACTION_NO_WITNESS
, 
CheckedP¬£Hex
(
¡r
)} >> 
	gtx
;

58 } 
ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

59 
throw
 
¡d
::
ruÁime_”rÜ
("Tx deserialization failure");

61  
	gtx
;

64 
	g¡d
::
veùÜ
<
CTxOut
> 
TxOutsFromJSON
(cÚ¡ 
UniV®ue
& 
univ®ue
)

66 ià(!
univ®ue
.
isA¼ay
()è
throw
 
¡d
::
ruÁime_”rÜ
("Prevouts must be‡rray");

67 
	g¡d
::
veùÜ
<
CTxOut
> 
´evouts
;

68 
size_t
 
	gi
 = 0; i < 
	guniv®ue
.
size
(); ++i) {

69 
CTxOut
 
	gtxout
;

70 
	gŒy
 {

71 
	gS·nR—d”
{
	gSER_DISK
, 0, 
CheckedP¬£Hex
(
univ®ue
[
i
].
g‘_¡r
())} >> 
	gtxout
;

72 } 
ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

73 
throw
 
¡d
::
ruÁime_”rÜ
("Prevout invalid format");

75 
	g´evouts
.
push_back
(
¡d
::
move
(
txout
));

77  
	g´evouts
;

80 
CSütW™Ãss
 
SütW™ÃssFromJSON
(cÚ¡ 
UniV®ue
& 
univ®ue
)

82 ià(!
	guniv®ue
.
isA¼ay
()è
throw
 
	g¡d
::
ruÁime_”rÜ
("Script witness is‚ot‡rray");

83 
CSütW™Ãss
 
	gsütw™Ãss
;

84 
size_t
 
	gi
 = 0; i < 
	guniv®ue
.
size
(); ++i) {

85 autØ
	gby‹s
 = 
CheckedP¬£Hex
(
univ®ue
[
i
].
g‘_¡r
());

86 
	gsütw™Ãss
.
	g¡ack
.
push_back
(
¡d
::
move
(
by‹s
));

88  
	gsütw™Ãss
;

91 cÚ¡ 
	g¡d
::
m­
<
¡d
::
¡ršg
, > 
	gFLAG_NAMES
 = {

92 {
¡d
::
¡ršg
("P2SH"), ()
SCRIPT_VERIFY_P2SH
},

93 {
¡d
::
¡ršg
("DERSIG"), ()
SCRIPT_VERIFY_DERSIG
},

94 {
¡d
::
¡ršg
("NULLDUMMY"), ()
SCRIPT_VERIFY_NULLDUMMY
},

95 {
¡d
::
¡ršg
("CHECKLOCKTIMEVERIFY"), ()
SCRIPT_VERIFY_CHECKLOCKTIMEVERIFY
},

96 {
¡d
::
¡ršg
("CHECKSEQUENCEVERIFY"), ()
SCRIPT_VERIFY_CHECKSEQUENCEVERIFY
},

97 {
¡d
::
¡ršg
("WITNESS"), ()
SCRIPT_VERIFY_WITNESS
},

98 {
¡d
::
¡ršg
("TAPROOT"), ()
SCRIPT_VERIFY_TAPROOT
},

101 
	g¡d
::
veùÜ
<> 
AÎFÏgs
()

103 
¡d
::
veùÜ
<> 
»t
;

105 
	gi
 = 0; i < 128; ++i) {

106 
	gæag
 = 0;

107 ià(
	gi
 & 1è
	gæag
 |ğ
SCRIPT_VERIFY_P2SH
;

108 ià(
	gi
 & 2è
	gæag
 |ğ
SCRIPT_VERIFY_DERSIG
;

109 ià(
	gi
 & 4è
	gæag
 |ğ
SCRIPT_VERIFY_NULLDUMMY
;

110 ià(
	gi
 & 8è
	gæag
 |ğ
SCRIPT_VERIFY_CHECKLOCKTIMEVERIFY
;

111 ià(
	gi
 & 16è
	gæag
 |ğ
SCRIPT_VERIFY_CHECKSEQUENCEVERIFY
;

112 ià(
	gi
 & 32è
	gæag
 |ğ
SCRIPT_VERIFY_WITNESS
;

113 ià(
	gi
 & 64è
	gæag
 |ğ
SCRIPT_VERIFY_TAPROOT
;

116 ià(
	gæag
 & 
	gSCRIPT_VERIFY_WITNESS
 && !(æag & 
	gSCRIPT_VERIFY_P2SH
)) ;

118 ià(
	gæag
 & 
	gSCRIPT_VERIFY_TAPROOT
 && !(æag & 
	gSCRIPT_VERIFY_WITNESS
)) ;

120 
	g»t
.
push_back
(
æag
);

123  
	g»t
;

126 cÚ¡ 
	g¡d
::
veùÜ
<> 
ALL_FLAGS
 = 
AÎFÏgs
();

128 
P¬£SütFÏgs
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
)

130 ià(
¡r
.
em±y
())  0;

132 
	gæags
 = 0;

133 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
wÜds
 = 
S¶™SŒšg
(
¡r
, ',');

135 cÚ¡ 
	g¡d
::
¡ršg
& 
wÜd
 : 
wÜds
) {

136 autØ
™
 = 
FLAG_NAMES
.
fšd
(
wÜd
);

137 ià(
	g™
 =ğ
FLAG_NAMES
.
’d
()è
throw
 
¡d
::
ruÁime_”rÜ
("UnknowÀv”ifiÿtiÚ fÏg " + 
wÜd
);

138 
	gæags
 |ğ
™
->
£cÚd
;

141  
	gæags
;

144 
Te¡
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
)

146 
UniV®ue
 
‹¡
;

147 ià(!
	g‹¡
.
»ad
(
¡r
è|| !‹¡.
isObjeù
()è
throw
 
	g¡d
::
ruÁime_”rÜ
("Non-objectest input");

149 
CMubËT¿n§ùiÚ
 
	gtx
 = 
TxFromHex
(
‹¡
["tx"].
g‘_¡r
());

150 cÚ¡ 
	g¡d
::
veùÜ
<
CTxOut
> 
´evouts
 = 
TxOutsFromJSON
(
‹¡
["prevouts"]);

151 ià(
	g´evouts
.
size
(è!ğ
tx
.
vš
.size()è
throw
 
¡d
::
ruÁime_”rÜ
("Incorrect‚umber of…revouts");

152 
size_t
 
	gidx
 = 
‹¡
["šdex"].
g‘IÁ
<
št64_t
>();

153 ià(
	gidx
 >ğ
tx
.
vš
.
size
()è
throw
 
¡d
::
ruÁime_”rÜ
("Invalid index");

154 
	g‹¡_æags
 = 
P¬£SütFÏgs
(
‹¡
["æags"].
g‘_¡r
());

155 
boŞ
 
	gfš®
 = 
‹¡
.
exi¡s
("fš®"è&&e¡["fš®"].
g‘_boŞ
();

157 ià(
	g‹¡
.
exi¡s
("success")) {

158 
	gtx
.
	gvš
[
idx
].
	gsütSig
 = 
SütFromHex
(
‹¡
["sucûss"]["sütSig"].
g‘_¡r
());

159 
	gtx
.
	gvš
[
idx
].
	gsütW™Ãss
 = 
SütW™ÃssFromJSON
(
‹¡
["success"]["witness"]);

160 
P»compu‹dT¿n§ùiÚD©a
 
	gtxd©a
;

161 
	gtxd©a
.
In™
(
tx
, 
¡d
::
veùÜ
<
CTxOut
>(
´evouts
));

162 
MubËT¿n§ùiÚSigÇtu»Check”
 
txcheck
(&
tx
, 
idx
, 
´evouts
[idx].
nV®ue
, 
txd©a
, 
MissšgD©aBehaviÜ
::
ASSERT_FAIL
);

163 cÚ¡‡utØ
	gæags
 : 
ALL_FLAGS
) {

166 ià(
fš®
 || ((
æags
 & 
‹¡_æags
) == flags)) {

167 ()
V”ifySüt
(
tx
.
vš
[
idx
].
sütSig
, 
´evouts
[idx].
sütPubKey
, &tx.vš[idx].
sütW™Ãss
, 
æags
, 
txcheck
, 
nuÎ±r
);

172 ià(
	g‹¡
.
exi¡s
("failure")) {

173 
	gtx
.
	gvš
[
idx
].
	gsütSig
 = 
SütFromHex
(
‹¡
["çu»"]["sütSig"].
g‘_¡r
());

174 
	gtx
.
	gvš
[
idx
].
	gsütW™Ãss
 = 
SütW™ÃssFromJSON
(
‹¡
["failure"]["witness"]);

175 
P»compu‹dT¿n§ùiÚD©a
 
	gtxd©a
;

176 
	gtxd©a
.
In™
(
tx
, 
¡d
::
veùÜ
<
CTxOut
>(
´evouts
));

177 
MubËT¿n§ùiÚSigÇtu»Check”
 
txcheck
(&
tx
, 
idx
, 
´evouts
[idx].
nV®ue
, 
txd©a
, 
MissšgD©aBehaviÜ
::
ASSERT_FAIL
);

178 cÚ¡‡utØ
	gæags
 : 
ALL_FLAGS
) {

180 ià((
æags
 & 
‹¡_æags
) ==est_flags) {

181 ()
V”ifySüt
(
tx
.
vš
[
idx
].
sütSig
, 
´evouts
[idx].
sütPubKey
, &tx.vš[idx].
sütW™Ãss
, 
æags
, 
txcheck
, 
nuÎ±r
);

187 
‹¡_š™
()

189 
ECCV”ifyHªdË
 
	ghªdË
;

192 
FUZZ_TARGET_INIT_HIDDEN
(
süt_as£ts_‹¡_mšimiz”
, 
‹¡_š™
, 
Œue
)

194 ià(
	gbufãr
.
size
(è< 2 || bufãr.
back
(è!ğ'\n' || 
bufãr
[buffer.size() - 2] != ',') ;

195 cÚ¡ 
	g¡d
::
¡ršg
 
¡r
((cÚ¡ *)
bufãr
.
d©a
(), bufãr.
size
() - 2);

196 
	gŒy
 {

197 
Te¡
(
¡r
);

198 } 
ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

	@script_bitcoin_consensus.cpp

5 
	~<süt/b™cošcÚ£nsus.h
>

6 
	~<süt/š‹½»‹r.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

11 
	~<c¡dšt
>

12 
	~<¡ršg
>

13 
	~<veùÜ
>

15 
	$FUZZ_TARGET
(
süt_b™coš_cÚ£nsus
)

17 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

18 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s_1
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

19 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s_2
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

20 cÚ¡ 
CAmouÁ
 
mÚey
 = 
	`CÚsumeMÚey
(
fuzzed_d©a_´ovid”
);

21 
b™cošcÚ£nsus_”rÜ
 
”r
;

22 
b™cošcÚ£nsus_”rÜ
* 
”r_p
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è? &
”r
 : 
nuÎ±r
;

23 cÚ¡ 
n_š
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

24 cÚ¡ 
æags
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

25 
	`as£¹
(
	`b™cošcÚ£nsus_v”siÚ
(è=ğ
BITCOINCONSENSUS_API_VER
);

26 ià((
æags
 & 
SCRIPT_VERIFY_WITNESS
è!ğ0 && (æag & 
SCRIPT_VERIFY_P2SH
) == 0) {

29 ()
	`b™cošcÚ£nsus_v”ify_süt
(
¿ndom_by‹s_1
.
	`d©a
(),„ªdom_by‹s_1.
	`size
(), 
¿ndom_by‹s_2
.d©a(),„ªdom_by‹s_2.size(), 
n_š
, 
æags
, 
”r_p
);

30 ()
	`b™cošcÚ£nsus_v”ify_süt_w™h_amouÁ
(
¿ndom_by‹s_1
.
	`d©a
(),„ªdom_by‹s_1.
	`size
(), 
mÚey
, 
¿ndom_by‹s_2
.d©a(),„ªdom_by‹s_2.size(), 
n_š
, 
æags
, 
”r_p
);

31 
	}
}

	@script_descriptor_cache.cpp

5 
	~<pubkey.h
>

6 
	~<süt/desütÜ.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

11 
	~<c¡dšt
>

12 
	~<İtiÚ®
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

16 
	$FUZZ_TARGET
(
süt_desütÜ_ÿche
)

18 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

19 
DesütÜCache
 
desütÜ_ÿche
;

20 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

21 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
code
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<ušt8_t>(
BIP32_EXTKEY_SIZE
);

22 ià(
code
.
	`size
(è=ğ
BIP32_EXTKEY_SIZE
) {

23 
CExtPubKey
 
xpub
;

24 
xpub
.
	`Decode
(
code
.
	`d©a
());

25 cÚ¡ 
ušt32_t
 
key_exp_pos
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>();

26 
CExtPubKey
 
xpub_ãtched
;

27 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

28 ()
desütÜ_ÿche
.
	`G‘CachedP¬’tExtPubKey
(
key_exp_pos
, 
xpub_ãtched
);

29 
desütÜ_ÿche
.
	`CacheP¬’tExtPubKey
(
key_exp_pos
, 
xpub
);

30 
	`as£¹
(
desütÜ_ÿche
.
	`G‘CachedP¬’tExtPubKey
(
key_exp_pos
, 
xpub_ãtched
));

32 cÚ¡ 
ušt32_t
 
d”_šdex
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>();

33 ()
desütÜ_ÿche
.
	`G‘CachedD”ivedExtPubKey
(
key_exp_pos
, 
d”_šdex
, 
xpub_ãtched
);

34 
desütÜ_ÿche
.
	`CacheD”ivedExtPubKey
(
key_exp_pos
, 
d”_šdex
, 
xpub
);

35 
	`as£¹
(
desütÜ_ÿche
.
	`G‘CachedD”ivedExtPubKey
(
key_exp_pos
, 
d”_šdex
, 
xpub_ãtched
));

37 
	`as£¹
(
xpub
 =ğ
xpub_ãtched
);

39 ()
desütÜ_ÿche
.
	`G‘CachedP¬’tExtPubKeys
();

40 ()
desütÜ_ÿche
.
	`G‘CachedD”ivedExtPubKeys
();

42 
	}
}

	@script_flags.cpp

5 
	~<cÚ£nsus/amouÁ.h
>

6 
	~<pubkey.h
>

7 
	~<süt/š‹½»‹r.h
>

8 
	~<¡»ams.h
>

9 
	~<‹¡/ut/süt.h
>

10 
	~<v”siÚ.h
>

12 
	~<‹¡/fuzz/fuzz.h
>

14 
	$š™Ÿlize_süt_æags
()

16 cÚ¡ 
ECCV”ifyHªdË
 
v”ify_hªdË
;

17 
	}
}

19 
	$FUZZ_TARGET_INIT
(
süt_æags
, 
š™Ÿlize_süt_æags
)

21 
CD©aSŒ—m
 
	`ds
(
bufãr
, 
SER_NETWORK
, 
INIT_PROTO_VERSION
);

22 
Œy
 {

23 
nV”siÚ
;

24 
ds
 >> 
nV”siÚ
;

25 
ds
.
	`S‘V”siÚ
(
nV”siÚ
);

26 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

30 
Œy
 {

31 cÚ¡ 
CT¿n§ùiÚ
 
	`tx
(
de£rŸlize
, 
ds
);

33 
v”ify_æags
;

34 
ds
 >> 
v”ify_æags
;

36 ià(!
	`IsV®idFÏgCombš©iÚ
(
v”ify_æags
)) ;

38 
fuzzed_æags
;

39 
ds
 >> 
fuzzed_æags
;

41 
¡d
::
veùÜ
<
CTxOut
> 
¥’t_ouuts
;

42 
i
 = 0; i < 
tx
.
vš
.
	`size
(); ++i) {

43 
CTxOut
 
´evout
;

44 
ds
 >> 
´evout
;

45 ià(!
	`MÚeyRªge
(
´evout
.
nV®ue
)) {

47 
´evout
.
nV®ue
 = 1;

49 
¥’t_ouuts
.
	`push_back
(
´evout
);

51 
P»compu‹dT¿n§ùiÚD©a
 
txd©a
;

52 
txd©a
.
	`In™
(
tx
, 
¡d
::
	`move
(
¥’t_ouuts
));

54 
i
 = 0; i < 
tx
.
vš
.
	`size
(); ++i) {

55 cÚ¡ 
CTxOut
& 
´evout
 = 
txd©a
.
m_¥’t_ouuts
.
	`©
(
i
);

56 cÚ¡ 
T¿n§ùiÚSigÇtu»Check”
 
check”
{&
tx
, 
i
, 
´evout
.
nV®ue
, 
txd©a
, 
MissšgD©aBehaviÜ
::
ASSERT_FAIL
};

58 
SütE¼Ü
 
£¼Ü
;

59 cÚ¡ 
boŞ
 
»t
 = 
	`V”ifySüt
(
tx
.
vš
.
	`©
(
i
).
sütSig
, 
´evout
.
sütPubKey
, &tx.vš.©(i).
sütW™Ãss
, 
v”ify_æags
, 
check”
, &
£¼Ü
);

60 
	`as£¹
(
»t
 =ğ(
£¼Ü
 =ğ
SCRIPT_ERR_OK
));

63 ià(
»t
) {

64 
v”ify_æags
 &ğ~
fuzzed_æags
;

66 
v”ify_æags
 |ğ
fuzzed_æags
;

68 ià(!
	`IsV®idFÏgCombš©iÚ
(
v”ify_æags
)) ;

70 
SütE¼Ü
 
£¼Ü_fuzzed
;

71 cÚ¡ 
boŞ
 
»t_fuzzed
 = 
	`V”ifySüt
(
tx
.
vš
.
	`©
(
i
).
sütSig
, 
´evout
.
sütPubKey
, &tx.vš.©(i).
sütW™Ãss
, 
v”ify_æags
, 
check”
, &
£¼Ü_fuzzed
);

72 
	`as£¹
(
»t_fuzzed
 =ğ(
£¼Ü_fuzzed
 =ğ
SCRIPT_ERR_OK
));

74 
	`as£¹
(
»t_fuzzed
 =ğ
»t
);

76 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

79 
	}
}

	@script_format.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<cÚ£nsus/cÚ£nsus.h
>

7 
	~<cÜe_io.h
>

8 
	~<pŞicy/pŞicy.h
>

9 
	~<süt/süt.h
>

10 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

11 
	~<‹¡/fuzz/fuzz.h
>

12 
	~<‹¡/fuzz/ut.h
>

13 
	~<univ®ue.h
>

15 
	$š™Ÿlize_süt_fÜm©
()

17 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
REGTEST
);

18 
	}
}

20 
	$FUZZ_TARGET_INIT
(
süt_fÜm©
, 
š™Ÿlize_süt_fÜm©
)

22 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

23 cÚ¡ 
CSüt
 
süt
{
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
)};

24 ià(
süt
.
	`size
(è> 
MAX_STANDARD_TX_WEIGHT
 / 
WITNESS_SCALE_FACTOR
) {

28 ()
	`FÜm©Süt
(
süt
);

29 ()
	`SütToAsmSŒ
(
süt
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

31 
UniV®ue
 
	`o1
(UniV®ue::
VOBJ
);

32 
	`SütToUniv
(
süt
, 
o1
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), fuzzed_data_provider.ConsumeBool());

33 
	}
}

	@script_interpreter.cpp

5 
	~<´im™ives/Œª§ùiÚ.h
>

6 
	~<süt/š‹½»‹r.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

11 
	~<c¡dšt
>

12 
	~<İtiÚ®
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

16 
boŞ
 
Ca¡ToBoŞ
(cÚ¡ 
¡d
::
veùÜ
<>& 
vch
);

18 
	$FUZZ_TARGET
(
süt_š‹½»‹r
)

20 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

22 cÚ¡ 
CSüt
 
süt_code
 = 
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
);

23 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
mtx
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

24 ià(
mtx
) {

25 cÚ¡ 
CT¿n§ùiÚ
 
tx_to
{*
mtx
};

26 cÚ¡ 
š
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

27 ià(
š
 < 
tx_to
.
vš
.
	`size
()) {

28 ()
	`SigÇtu»Hash
(
süt_code
, 
tx_to
, 
š
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>(), 
	`CÚsumeMÚey
(fuzzed_d©a_´ovid”), fuzzed_d©a_´ovid”.
	`PickV®ueInA¼ay
({
SigV”siÚ
::
BASE
, SigV”siÚ::
WITNESS_V0
}), 
nuÎ±r
);

29 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
mtx_´ecompu‹d
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

30 ià(
mtx_´ecompu‹d
) {

31 cÚ¡ 
CT¿n§ùiÚ
 
tx_´ecompu‹d
{*
mtx_´ecompu‹d
};

32 cÚ¡ 
P»compu‹dT¿n§ùiÚD©a
 
´ecompu‹d_Œª§ùiÚ_d©a
{
tx_´ecompu‹d
};

33 ()
	`SigÇtu»Hash
(
süt_code
, 
tx_to
, 
š
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>(), 
	`CÚsumeMÚey
(fuzzed_d©a_´ovid”), fuzzed_d©a_´ovid”.
	`PickV®ueInA¼ay
({
SigV”siÚ
::
BASE
, SigV”siÚ::
WITNESS_V0
}), &
´ecompu‹d_Œª§ùiÚ_d©a
);

39 ()
	`Ca¡ToBoŞ
(
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
));

41 
	}
}

	@script_ops.cpp

5 
	~<süt/süt.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<c¡dšt
>

11 
	~<¡ršg
>

12 
	~<veùÜ
>

14 
	$FUZZ_TARGET
(
süt_İs
)

16 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

17 
CSüt
 
süt_mut
 = 
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
);

18 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`»maššg_by‹s
() > 0, 1000000) {

19 
	`C®lOÃOf
(

20 
fuzzed_d©a_´ovid”
,

22 
CSüt
 
s
 = 
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
);

23 
süt_mut
 = 
¡d
::
	`move
(
s
);

26 cÚ¡ 
CSüt
& 
s
 = 
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
);

27 
süt_mut
 = 
s
;

30 
süt_mut
 << 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>();

33 
süt_mut
 << 
	`CÚsumeOpcodeTy³
(
fuzzed_d©a_´ovid”
);

36 
süt_mut
 << 
	`CÚsumeSütNum
(
fuzzed_d©a_´ovid”
);

39 
süt_mut
 << 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

42 
süt_mut
.
	`ş—r
();

45 cÚ¡ 
CSüt
& 
süt
 = 
süt_mut
;

46 ()
süt
.
	`G‘SigOpCouÁ
(
çl£
);

47 ()
süt
.
	`G‘SigOpCouÁ
(
Œue
);

48 ()
süt
.
	`G‘SigOpCouÁ
(script);

49 ()
süt
.
	`HasV®idOps
();

50 ()
süt
.
	`IsPayToSütHash
();

51 ()
süt
.
	`IsPayToW™ÃssSütHash
();

52 ()
süt
.
	`IsPushOÆy
();

53 ()
süt
.
	`IsUn¥’dabË
();

55 
CSüt
::
cÚ¡_™”©Ü
 
pc
 = 
süt
.
	`begš
();

56 
İcod‘y³
 
İcode
;

57 ()
süt
.
	`G‘Op
(
pc
, 
İcode
);

58 
¡d
::
veùÜ
<
ušt8_t
> 
d©a
;

59 ()
süt
.
	`G‘Op
(
pc
, 
İcode
, 
d©a
);

60 ()
süt
.
	`IsPushOÆy
(
pc
);

63 
v”siÚ
;

64 
¡d
::
veùÜ
<
ušt8_t
> 
´og¿m
;

65 ()
süt
.
	`IsW™ÃssProg¿m
(
v”siÚ
, 
´og¿m
);

67 
	}
}

	@script_sigcache.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<chaš·¿msba£.h
>

7 
	~<key.h
>

8 
	~<pubkey.h
>

9 
	~<süt/sigÿche.h
>

10 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

11 
	~<‹¡/fuzz/fuzz.h
>

12 
	~<‹¡/fuzz/ut.h
>

13 
	~<‹¡/ut/£tup_commÚ.h
>

15 
	~<c¡dšt
>

16 
	~<İtiÚ®
>

17 
	~<¡ršg
>

18 
	~<veùÜ
>

20 
	gÇme¥aû
 {

21 cÚ¡ 
BasicTe¡šgS‘up
* 
	gg_£tup
;

24 
	$š™Ÿlize_süt_sigÿche
()

26 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>();

27 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

28 
	}
}

30 
	$FUZZ_TARGET_INIT
(
süt_sigÿche
, 
š™Ÿlize_süt_sigÿche
)

32 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

34 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
mubË_Œª§ùiÚ
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

35 cÚ¡ 
CT¿n§ùiÚ
 
tx
{
mubË_Œª§ùiÚ
 ? *mubË_Œª§ùiÚ : 
CMubËT¿n§ùiÚ
{}};

36 cÚ¡ 
n_š
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

37 cÚ¡ 
CAmouÁ
 
amouÁ
 = 
	`CÚsumeMÚey
(
fuzzed_d©a_´ovid”
);

38 cÚ¡ 
boŞ
 
¡Üe
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

39 
P»compu‹dT¿n§ùiÚD©a
 
tx_d©a
;

40 
CachšgT¿n§ùiÚSigÇtu»Check”
 
ÿchšg_Œª§ùiÚ_sigÇtu»_check”
{
mubË_Œª§ùiÚ
 ? &
tx
 : 
nuÎ±r
, 
n_š
, 
amouÁ
, 
¡Üe
, 
tx_d©a
};

41 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

42 cÚ¡‡utØ
¿ndom_by‹s
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<>(64);

43 cÚ¡ 
XOÆyPubKey
 
	`pub_key
(
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
));

44 ià(
¿ndom_by‹s
.
	`size
() == 64) {

45 ()
ÿchšg_Œª§ùiÚ_sigÇtu»_check”
.
	`V”ifySchnÜrSigÇtu»
(
¿ndom_by‹s
, 
pub_key
, 
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
));

48 cÚ¡‡utØ
¿ndom_by‹s
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

49 cÚ¡‡utØ
pub_key
 = 
CÚsumeDe£rŸlizabË
<
CPubKey
>(
fuzzed_d©a_´ovid”
);

50 ià(
pub_key
) {

51 ià(!
¿ndom_by‹s
.
	`em±y
()) {

52 ()
ÿchšg_Œª§ùiÚ_sigÇtu»_check”
.
	`V”ifyECDSASigÇtu»
(
¿ndom_by‹s
, *
pub_key
, 
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
));

56 
	}
}

	@script_sign.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<chaš·¿msba£.h
>

7 
	~<key.h
>

8 
	~<psbt.h
>

9 
	~<pubkey.h
>

10 
	~<süt/keyÜigš.h
>

11 
	~<süt/sign.h
>

12 
	~<süt/signšg´ovid”.h
>

13 
	~<¡»ams.h
>

14 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

15 
	~<‹¡/fuzz/fuzz.h
>

16 
	~<‹¡/fuzz/ut.h
>

17 
	~<ut/Œª¦©iÚ.h
>

19 
	~<ÿs£¹
>

20 
	~<c¡dšt
>

21 
	~<io¡»am
>

22 
	~<m­
>

23 
	~<İtiÚ®
>

24 
	~<¡ršg
>

25 
	~<veùÜ
>

27 
	$š™Ÿlize_süt_sign
()

29 cÚ¡ 
ECCV”ifyHªdË
 
ecc_v”ify_hªdË
;

30 
	`ECC_S¹
();

31 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
REGTEST
);

32 
	}
}

34 
	$FUZZ_TARGET_INIT
(
süt_sign
, 
š™Ÿlize_süt_sign
)

36 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

37 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
key
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 128);

40 
CD©aSŒ—m
 
¿ndom_d©a_¡»am
 = 
	`CÚsumeD©aSŒ—m
(
fuzzed_d©a_´ovid”
);

41 
¡d
::
m­
<
CPubKey
, 
KeyOrigšInfo
> 
hd_key·ths
;

42 
Œy
 {

43 
	`De£rŸlizeHDKey·ths
(
¿ndom_d©a_¡»am
, 
key
, 
hd_key·ths
);

44 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

46 
CD©aSŒ—m
 
£rŸlized
{
SER_NETWORK
, 
PROTOCOL_VERSION
};

47 
	`S”ŸlizeHDKey·ths
(
£rŸlized
, 
hd_key·ths
, 
	`Com·ùSizeWr™”
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt8_t
>()));

51 
¡d
::
m­
<
CPubKey
, 
KeyOrigšInfo
> 
hd_key·ths
;

52 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

53 cÚ¡ 
¡d
::
İtiÚ®
<
CPubKey
> 
pub_key
 = 
CÚsumeDe£rŸlizabË
<CPubKey>(
fuzzed_d©a_´ovid”
);

54 ià(!
pub_key
) {

57 cÚ¡ 
¡d
::
İtiÚ®
<
KeyOrigšInfo
> 
key_Üigš_šfo
 = 
CÚsumeDe£rŸlizabË
<KeyOrigšInfo>(
fuzzed_d©a_´ovid”
);

58 ià(!
key_Üigš_šfo
) {

61 
hd_key·ths
[*
pub_key
] = *
key_Üigš_šfo
;

63 
CD©aSŒ—m
 
£rŸlized
{
SER_NETWORK
, 
PROTOCOL_VERSION
};

64 
Œy
 {

65 
	`S”ŸlizeHDKey·ths
(
£rŸlized
, 
hd_key·ths
, 
	`Com·ùSizeWr™”
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt8_t
>()));

66 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

68 
¡d
::
m­
<
CPubKey
, 
KeyOrigšInfo
> 
de£rŸlized_hd_key·ths
;

69 
Œy
 {

70 
	`De£rŸlizeHDKey·ths
(
£rŸlized
, 
key
, 
hd_key·ths
);

71 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

73 
	`as£¹
(
hd_key·ths
.
	`size
(è>ğ
de£rŸlized_hd_key·ths
.size());

77 
SigÇtu»D©a
 
sigÇtu»_d©a_1
{
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
)};

78 
SigÇtu»D©a
 
sigÇtu»_d©a_2
{
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
)};

79 
sigÇtu»_d©a_1
.
	`M”geSigÇtu»D©a
(
sigÇtu»_d©a_2
);

82 
FÏbËSignšgProvid”
 
´ovid”
;

83 
CKey
 
k
;

84 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
key_d©a
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

85 
k
.
	`S‘
(
key_d©a
.
	`begš
(), key_d©a.
	`’d
(), 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

86 ià(
k
.
	`IsV®id
()) {

87 
´ovid”
.
	`AddKey
(
k
);

91 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
mubË_Œª§ùiÚ
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

92 cÚ¡ 
¡d
::
İtiÚ®
<
CTxOut
> 
tx_out
 = 
CÚsumeDe£rŸlizabË
<CTxOut>(
fuzzed_d©a_´ovid”
);

93 cÚ¡ 
n_š
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

94 ià(
mubË_Œª§ùiÚ
 && 
tx_out
 && mubË_Œª§ùiÚ->
vš
.
	`size
(è> 
n_š
) {

95 
SigÇtu»D©a
 
sigÇtu»_d©a_1
 = 
	`D©aFromT¿n§ùiÚ
(*
mubË_Œª§ùiÚ
, 
n_š
, *
tx_out
);

96 
CTxIn
 
šput
;

97 
	`Upd©eIÅut
(
šput
, 
sigÇtu»_d©a_1
);

98 cÚ¡ 
CSüt
 
süt
 = 
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
);

99 
SigÇtu»D©a
 
sigÇtu»_d©a_2
{
süt
};

100 
sigÇtu»_d©a_1
.
	`M”geSigÇtu»D©a
(
sigÇtu»_d©a_2
);

102 ià(
mubË_Œª§ùiÚ
) {

103 
CT¿n§ùiÚ
 
tx_äom
{*
mubË_Œª§ùiÚ
};

104 
CMubËT¿n§ùiÚ
 
tx_to
;

105 cÚ¡ 
¡d
::
İtiÚ®
<
CMubËT¿n§ùiÚ
> 
İt_tx_to
 = 
CÚsumeDe£rŸlizabË
<CMubËT¿n§ùiÚ>(
fuzzed_d©a_´ovid”
);

106 ià(
İt_tx_to
) {

107 
tx_to
 = *
İt_tx_to
;

109 
CMubËT¿n§ùiÚ
 
süt_tx_to
 = 
tx_to
;

110 
CMubËT¿n§ùiÚ
 
sign_Œª§ùiÚ_tx_to
 = 
tx_to
;

111 ià(
n_š
 < 
tx_to
.
vš
.
	`size
(è&&x_to.vš[n_š].
´evout
.
n
 < 
tx_äom
.
vout
.size()) {

112 ()
	`SignSigÇtu»
(
´ovid”
, 
tx_äom
, 
tx_to
, 
n_š
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>());

114 ià(
n_š
 < 
süt_tx_to
.
vš
.
	`size
()) {

115 ()
	`SignSigÇtu»
(
´ovid”
, 
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
), 
süt_tx_to
, 
n_š
, 
	`CÚsumeMÚey
(fuzzed_d©a_´ovid”), fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿l
<>());

116 
MubËT¿n§ùiÚSigÇtu»C»©Ü
 
sigÇtu»_ü—tÜ
{
tx_to
, 
n_š
, 
	`CÚsumeMÚey
(
fuzzed_d©a_´ovid”
), fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿l
<>()};

117 
¡d
::
veùÜ
<> 
vch_sig
;

118 
CKeyID
 
add»ss
;

119 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

120 ià(
k
.
	`IsV®id
()) {

121 
add»ss
 = 
k
.
	`G‘PubKey
().
	`G‘ID
();

124 
add»ss
 = 
CKeyID
{
	`CÚsumeUIÁ160
(
fuzzed_d©a_´ovid”
)};

126 ()
sigÇtu»_ü—tÜ
.
	`C»©eSig
(
´ovid”
, 
vch_sig
, 
add»ss
, 
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
), fuzzed_d©a_´ovid”.
	`PickV®ueInA¼ay
({
SigV”siÚ
::
BASE
, SigV”siÚ::
WITNESS_V0
}));

128 
¡d
::
m­
<
COutPošt
, 
Coš
> 
cošs
;

129 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

130 cÚ¡ 
¡d
::
İtiÚ®
<
COutPošt
> 
ouošt
 = 
CÚsumeDe£rŸlizabË
<COutPošt>(
fuzzed_d©a_´ovid”
);

131 ià(!
ouošt
) {

134 cÚ¡ 
¡d
::
İtiÚ®
<
Coš
> 
coš
 = 
CÚsumeDe£rŸlizabË
<Coš>(
fuzzed_d©a_´ovid”
);

135 ià(!
coš
) {

138 
cošs
[*
ouošt
] = *
coš
;

140 
¡d
::
m­
<, 
bšgu®_¡r
> 
šput_”rÜs
;

141 ()
	`SignT¿n§ùiÚ
(
sign_Œª§ùiÚ_tx_to
, &
´ovid”
, 
cošs
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>(), 
šput_”rÜs
);

146 
SigÇtu»D©a
 
sigÇtu»_d©a_1
;

147 ()
	`ProduûSigÇtu»
(
´ovid”
, 
DUMMY_SIGNATURE_CREATOR
, 
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
), 
sigÇtu»_d©a_1
);

148 
SigÇtu»D©a
 
sigÇtu»_d©a_2
;

149 ()
	`ProduûSigÇtu»
(
´ovid”
, 
DUMMY_MAXIMUM_SIGNATURE_CREATOR
, 
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
), 
sigÇtu»_d©a_2
);

151 
	}
}

	@scriptnum_ops.cpp

5 
	~<süt/süt.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<ÿs£¹
>

11 
	~<c¡dšt
>

12 
	~<lim™s
>

13 
	~<veùÜ
>

15 
	gÇme¥aû
 {

16 
boŞ
 
IsV®idAdd™iÚ
(cÚ¡ 
CSütNum
& 
lhs
, cÚ¡ CSütNum& 
rhs
)

18  
	grhs
 =ğ0 || (
rhs
 > 0 && 
lhs
 <ğ
CSütNum
{
¡d
::
num”ic_lim™s
<
št64_t
>::
max
()} -„hsè|| (rh < 0 &&†h >ğCSütNum{¡d::num”ic_lim™s<št64_t>::
mš
()} -„hs);

21 
boŞ
 
IsV®idSubŒaùiÚ
(cÚ¡ 
CSütNum
& 
lhs
, cÚ¡ CSütNum& 
rhs
)

23  
	grhs
 =ğ0 || (
rhs
 > 0 && 
lhs
 >ğ
CSütNum
{
¡d
::
num”ic_lim™s
<
št64_t
>::
mš
()} +„hsè|| (rh < 0 &&†h <ğCSütNum{¡d::num”ic_lim™s<št64_t>::
max
()} +„hs);

27 
	$FUZZ_TARGET
(
süŠum_İs
)

29 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

30 
CSütNum
 
süt_num
 = 
	`CÚsumeSütNum
(
fuzzed_d©a_´ovid”
);

31 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`»maššg_by‹s
() > 0, 1000000) {

32 
	`C®lOÃOf
(

33 
fuzzed_d©a_´ovid”
,

35 cÚ¡ 
št64_t
 
i
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int64_t>();

36 
	`as£¹
((
süt_num
 =ğ
i
) != (script_num != i));

37 
	`as£¹
((
süt_num
 <ğ
i
) != (script_num > i));

38 
	`as£¹
((
süt_num
 >ğ
i
) != (script_num < i));

41 ià(
	`IsV®idAdd™iÚ
(
süt_num
, 
CSütNum
{
i
})) {

42 
	`as£¹
((
süt_num
 + 
i
) - i == script_num);

46 ià(
	`IsV®idSubŒaùiÚ
(
süt_num
, 
CSütNum
{
i
})) {

47 
	`as£¹
((
süt_num
 - 
i
) + i == script_num);

51 cÚ¡ 
CSütNum
 
¿ndom_süt_num
 = 
	`CÚsumeSütNum
(
fuzzed_d©a_´ovid”
);

52 
	`as£¹
((
süt_num
 =ğ
¿ndom_süt_num
) != (script_num !=„andom_script_num));

53 
	`as£¹
((
süt_num
 <ğ
¿ndom_süt_num
) != (script_num >„andom_script_num));

54 
	`as£¹
((
süt_num
 >ğ
¿ndom_süt_num
) != (script_num <„andom_script_num));

57 ià(
	`IsV®idAdd™iÚ
(
süt_num
, 
¿ndom_süt_num
)) {

58 
	`as£¹
((
süt_num
 + 
¿ndom_süt_num
) -„andom_script_num == script_num);

62 ià(
	`IsV®idSubŒaùiÚ
(
süt_num
, 
¿ndom_süt_num
)) {

63 
	`as£¹
((
süt_num
 - 
¿ndom_süt_num
) +„andom_script_num == script_num);

67 cÚ¡ 
CSütNum
 
¿ndom_süt_num
 = 
	`CÚsumeSütNum
(
fuzzed_d©a_´ovid”
);

68 ià(!
	`IsV®idAdd™iÚ
(
süt_num
, 
¿ndom_süt_num
)) {

73 
süt_num
 +ğ
¿ndom_süt_num
;

76 cÚ¡ 
CSütNum
 
¿ndom_süt_num
 = 
	`CÚsumeSütNum
(
fuzzed_d©a_´ovid”
);

77 ià(!
	`IsV®idSubŒaùiÚ
(
süt_num
, 
¿ndom_süt_num
)) {

82 
süt_num
 -ğ
¿ndom_süt_num
;

85 
süt_num
 = süt_num & 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>();

88 
süt_num
 = süt_num & 
	`CÚsumeSütNum
(
fuzzed_d©a_´ovid”
);

91 
süt_num
 &ğ
	`CÚsumeSütNum
(
fuzzed_d©a_´ovid”
);

94 ià(
süt_num
 =ğ
CSütNum
{
¡d
::
num”ic_lim™s
<
št64_t
>::
	`mš
()}) {

99 
süt_num
 = -script_num;

102 
süt_num
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>();

105 cÚ¡ 
št64_t
 
¿ndom_š‹g”
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int64_t>();

106 ià(!
	`IsV®idAdd™iÚ
(
süt_num
, 
CSütNum
{
¿ndom_š‹g”
})) {

111 
süt_num
 +ğ
¿ndom_š‹g”
;

114 cÚ¡ 
št64_t
 
¿ndom_š‹g”
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int64_t>();

115 ià(!
	`IsV®idSubŒaùiÚ
(
süt_num
, 
CSütNum
{
¿ndom_š‹g”
})) {

120 
süt_num
 -ğ
¿ndom_š‹g”
;

123 
süt_num
 &ğ
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>();

125 ()
süt_num
.
	`g‘št
();

126 ()
süt_num
.
	`g‘vch
();

128 
	}
}

	@secp256k1_ec_seckey_import_export_der.cpp

5 
	~<key.h
>

6 
	~<£ı256k1.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

11 
	~<c¡dšt
>

12 
	~<veùÜ
>

14 
ec_£ckey_impÜt_d”
(cÚ¡ 
£ı256k1_cÚ‹xt
* 
ùx
, * 
out32
, cÚ¡ * 
£ckey
, 
size_t
 
£ckeyËn
);

15 
ec_£ckey_expÜt_d”
(cÚ¡ 
£ı256k1_cÚ‹xt
* 
ùx
, * 
£ckey
, 
size_t
* 
£ckeyËn
, cÚ¡ * 
key32
, 
boŞ
 
com´es£d
);

17 
	$FUZZ_TARGET
(
£ı256k1_ec_£ckey_impÜt_expÜt_d”
)

19 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

20 
£ı256k1_cÚ‹xt
* 
£ı256k1_cÚ‹xt_sign
 = 
	`£ı256k1_cÚ‹xt_ü—‹
(
SECP256K1_CONTEXT_SIGN
);

22 
¡d
::
veùÜ
<
ušt8_t
> 
	`out32
(32);

23 ()
	`ec_£ckey_impÜt_d”
(
£ı256k1_cÚ‹xt_sign
, 
out32
.
	`d©a
(), 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
CKey
::
SIZE
).data(), CKey::SIZE);

26 
¡d
::
veùÜ
<
ušt8_t
> 
	`£ckey
(
CKey
::
SIZE
);

27 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
key32
 = 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 32);

28 
size_t
 
£ckeyËn
 = 
CKey
::
SIZE
;

29 cÚ¡ 
boŞ
 
com´es£d
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

30 cÚ¡ 
boŞ
 
expÜ‹d
 = 
	`ec_£ckey_expÜt_d”
(
£ı256k1_cÚ‹xt_sign
, 
£ckey
.
	`d©a
(), &
£ckeyËn
, 
key32
.d©a(), 
com´es£d
);

31 ià(
expÜ‹d
) {

32 
¡d
::
veùÜ
<
ušt8_t
> 
	`out32
(32);

33 cÚ¡ 
boŞ
 
impÜ‹d
 = 
	`ec_£ckey_impÜt_d”
(
£ı256k1_cÚ‹xt_sign
, 
out32
.
	`d©a
(), 
£ckey
.d©a(), seckey.
	`size
()) == 1;

34 
	`as£¹
(
impÜ‹d
 && 
key32
 =ğ
out32
);

37 
	`£ı256k1_cÚ‹xt_de¡roy
(
£ı256k1_cÚ‹xt_sign
);

38 
	}
}

	@secp256k1_ecdsa_signature_parse_der_lax.cpp

5 
	~<key.h
>

6 
	~<£ı256k1.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

11 
	~<c¡dšt
>

12 
	~<veùÜ
>

14 
boŞ
 
SigHasLowR
(cÚ¡ 
£ı256k1_ecd§_sigÇtu»
* 
sig
);

15 
ecd§_sigÇtu»_·r£_d”_Ïx
(cÚ¡ 
£ı256k1_cÚ‹xt
* 
ùx
, 
£ı256k1_ecd§_sigÇtu»
* 
sig
, cÚ¡ * 
šput
, 
size_t
 
špu’
);

17 
	$FUZZ_TARGET
(
£ı256k1_ecd§_sigÇtu»_·r£_d”_Ïx
)

19 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

20 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
sigÇtu»_by‹s
 = 
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
);

21 ià(
sigÇtu»_by‹s
.
	`d©a
(è=ğ
nuÎ±r
) {

24 
£ı256k1_cÚ‹xt
* 
£ı256k1_cÚ‹xt_v”ify
 = 
	`£ı256k1_cÚ‹xt_ü—‹
(
SECP256K1_CONTEXT_VERIFY
);

25 
£ı256k1_ecd§_sigÇtu»
 
sig_d”_Ïx
;

26 cÚ¡ 
boŞ
 
·r£d_d”_Ïx
 = 
	`ecd§_sigÇtu»_·r£_d”_Ïx
(
£ı256k1_cÚ‹xt_v”ify
, &
sig_d”_Ïx
, 
sigÇtu»_by‹s
.
	`d©a
(), sigÇtu»_by‹s.
	`size
()) == 1;

27 ià(
·r£d_d”_Ïx
) {

28 
	`ECC_S¹
();

29 ()
	`SigHasLowR
(&
sig_d”_Ïx
);

30 
	`ECC_Stİ
();

32 
	`£ı256k1_cÚ‹xt_de¡roy
(
£ı256k1_cÚ‹xt_v”ify
);

33 
	}
}

	@signature_checker.cpp

5 
	~<pubkey.h
>

6 
	~<süt/š‹½»‹r.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<‹¡/ut/süt.h
>

12 
	~<c¡dšt
>

13 
	~<lim™s
>

14 
	~<¡ršg
>

15 
	~<veùÜ
>

17 
	$š™Ÿlize_sigÇtu»_check”
()

19 cÚ¡‡utØ
v”ify_hªdË
 = 
¡d
::
make_unique
<
ECCV”ifyHªdË
>();

20 
	}
}

22 
	gÇme¥aû
 {

23 şas 
	cFuzzedSigÇtu»Check”
 : 
public
 
Ba£SigÇtu»Check”


25 
FuzzedD©aProvid”
& 
m_fuzzed_d©a_´ovid”
;

27 
	gpublic
:

28 
ex¶ic™
 
FuzzedSigÇtu»Check”
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è: 
m_fuzzed_d©a_´ovid”
(fuzzed_data_provider)

32 
boŞ
 
CheckECDSASigÇtu»
(cÚ¡ 
¡d
::
veùÜ
<>& 
sütSig
, cÚ¡ std::veùÜ<>& 
vchPubKey
, cÚ¡ 
CSüt
& 
sütCode
, 
SigV”siÚ
 
sigv”siÚ
ècÚ¡ 
	gov”ride


34  
	gm_fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
();

37 
boŞ
 
CheckSchnÜrSigÇtu»
(
S·n
<cÚ¡ > 
sig
, S·n<cÚ¡ > 
pubkey
, 
SigV”siÚ
 
sigv”siÚ
, 
SütExecutiÚD©a
& 
execd©a
, 
SütE¼Ü
* 
£¼Ü
 = 
nuÎ±r
ècÚ¡ 
ov”ride


39  
m_fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
();

42 
boŞ
 
CheckLockTime
(cÚ¡ 
CSütNum
& 
nLockTime
ècÚ¡ 
	gov”ride


44  
	gm_fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
();

47 
boŞ
 
CheckSequ’û
(cÚ¡ 
CSütNum
& 
nSequ’û
ècÚ¡ 
	gov”ride


49  
	gm_fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
();

52 
	gvœtu®
 ~
FuzzedSigÇtu»Check”
() = ;

56 
	$FUZZ_TARGET_INIT
(
sigÇtu»_check”
, 
š™Ÿlize_sigÇtu»_check”
)

58 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

59 cÚ¡ 
æags
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

60 cÚ¡ 
SigV”siÚ
 
sig_v”siÚ
 = 
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
({SigV”siÚ::
BASE
, SigV”siÚ::
WITNESS_V0
});

61 cÚ¡‡utØ
süt_1
{
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
)};

62 cÚ¡‡utØ
süt_2
{
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
)};

63 
¡d
::
veùÜ
<¡d::veùÜ<>> 
¡ack
;

64 ()
	`Ev®Süt
(
¡ack
, 
süt_1
, 
æags
, 
	`FuzzedSigÇtu»Check”
(
fuzzed_d©a_´ovid”
), 
sig_v”siÚ
, 
nuÎ±r
);

65 ià(!
	`IsV®idFÏgCombš©iÚ
(
æags
)) {

68 ()
	`V”ifySüt
(
süt_1
, 
süt_2
, 
nuÎ±r
, 
æags
, 
	`FuzzedSigÇtu»Check”
(
fuzzed_d©a_´ovid”
),‚ullptr);

69 
	}
}

	@signet.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<cÚ£nsus/v®id©iÚ.h
>

7 
	~<´im™ives/block.h
>

8 
	~<sigÃt.h
>

9 
	~<¡»ams.h
>

10 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

11 
	~<‹¡/fuzz/fuzz.h
>

12 
	~<‹¡/fuzz/ut.h
>

13 
	~<‹¡/ut/£tup_commÚ.h
>

15 
	~<c¡dšt
>

16 
	~<İtiÚ®
>

17 
	~<veùÜ
>

19 
	$š™Ÿlize_sigÃt
()

21 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>(
CBa£ChašP¬ams
::
SIGNET
);

22 
	}
}

24 
	$FUZZ_TARGET_INIT
(
sigÃt
, 
š™Ÿlize_sigÃt
)

26 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

27 cÚ¡ 
¡d
::
İtiÚ®
<
CBlock
> 
block
 = 
CÚsumeDe£rŸlizabË
<CBlock>(
fuzzed_d©a_´ovid”
);

28 ià(!
block
) {

31 ()
	`CheckSigÃtBlockSŞutiÚ
(*
block
, 
	`P¬ams
().
	`G‘CÚ£nsus
());

32 ()
SigÃtTxs
::
	`C»©e
(*
block
, 
	`CÚsumeSüt
(
fuzzed_d©a_´ovid”
));

33 
	}
}

	@socks5.cpp

5 
	~<Ãdd»ss.h
>

6 
	~<Ãtba£.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/fuzz.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<‹¡/ut/£tup_commÚ.h
>

12 
	~<c¡dšt
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

16 
	gÇme¥aû
 {

17 
	gdeçuÉ_socks5_»cv_timeout
;

20 
g_socks5_»cv_timeout
;

22 
	$š™Ÿlize_socks5
()

24 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<cÚ¡ 
BasicTe¡šgS‘up
>();

25 
deçuÉ_socks5_»cv_timeout
 = 
g_socks5_»cv_timeout
;

26 
	}
}

28 
	$FUZZ_TARGET_INIT
(
socks5
, 
š™Ÿlize_socks5
)

30 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

31 
ProxyC»d’tŸls
 
´oxy_üed’tŸls
;

32 
´oxy_üed’tŸls
.
u£ºame
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(512);

33 
´oxy_üed’tŸls
.
·sswÜd
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(512);

34 
	`IÁ”ru±Socks5
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

37 
g_socks5_»cv_timeout
 = (
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è&& 
¡d
::
	`g‘’v
("FUZZED_SOCKET_FAKE_LATENCY"è!ğ
nuÎ±r
è? 1 : 
deçuÉ_socks5_»cv_timeout
;

38 
FuzzedSock
 
fuzzed_sock
 = 
	`CÚsumeSock
(
fuzzed_d©a_´ovid”
);

41 ()
	`Socks5
(
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(512),

42 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt16_t
>(),

43 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è? &
´oxy_üed’tŸls
 : 
nuÎ±r
,

44 
fuzzed_sock
);

45 
	}
}

	@span.cpp

5 
	~<¥ª.h
>

6 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

7 
	~<‹¡/fuzz/fuzz.h
>

8 
	~<‹¡/fuzz/ut.h
>

10 
	~<ÿs£¹
>

11 
	~<c¡ddef
>

12 
	~<c¡dšt
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

16 
	$FUZZ_TARGET
(
¥ª
)

18 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

20 
¡d
::
¡ršg
 
¡r
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBy‹sAsSŒšg
(32);

21 cÚ¡ 
S·n
<cÚ¡ > 
¥ª
{
¡r
};

22 ()
¥ª
.
	`d©a
();

23 ()
¥ª
.
	`begš
();

24 ()
¥ª
.
	`’d
();

25 ià(
¥ª
.
	`size
() > 0) {

26 cÚ¡ 
¡d
::
±rdiff_t
 
idx
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<¡d::±rdiff_t>(0U, 
¥ª
.
	`size
() - 1U);

27 ()
¥ª
.
	`fœ¡
(
idx
);

28 ()
¥ª
.
	`Ï¡
(
idx
);

29 ()
¥ª
.
	`sub¥ª
(
idx
);

30 ()
¥ª
.
	`sub¥ª
(
idx
, s·n.
	`size
() - idx);

31 ()
¥ª
[
idx
];

34 
¡d
::
¡ršg
 
ªÙh”_¡r
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBy‹sAsSŒšg
(32);

35 cÚ¡ 
S·n
<cÚ¡ > 
ªÙh”_¥ª
{
ªÙh”_¡r
};

36 
	`as£¹
((
¥ª
 <ğ
ªÙh”_¥ª
) != (span >‡nother_span));

37 
	`as£¹
((
¥ª
 =ğ
ªÙh”_¥ª
) != (span !=‡nother_span));

38 
	`as£¹
((
¥ª
 >ğ
ªÙh”_¥ª
) != (span <‡nother_span));

39 
	}
}

	@spanparsing.cpp

5 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

6 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<ut/¥ª·rsšg.h
>

9 
	$FUZZ_TARGET
(
¥ª·rsšg
)

11 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

12 cÚ¡ 
size_t
 
qu”y_size
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<size_t>();

13 cÚ¡ 
¡d
::
¡ršg
 
qu”y
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBy‹sAsSŒšg
(¡d::
mš
<
size_t
>(
qu”y_size
, 1024 * 1024));

14 cÚ¡ 
¡d
::
¡ršg
 
¥ª_¡r
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRemaššgBy‹sAsSŒšg
();

15 cÚ¡ 
S·n
<cÚ¡ > 
cÚ¡_¥ª
{
¥ª_¡r
};

17 
S·n
<cÚ¡ > 
mut_¥ª
 = 
cÚ¡_¥ª
;

18 ()
¥ª·rsšg
::
	`CÚ¡
(
qu”y
, 
mut_¥ª
);

20 
mut_¥ª
 = 
cÚ¡_¥ª
;

21 ()
¥ª·rsšg
::
	`Func
(
qu”y
, 
mut_¥ª
);

23 
mut_¥ª
 = 
cÚ¡_¥ª
;

24 ()
¥ª·rsšg
::
	`Ex´
(
mut_¥ª
);

26 ià(!
qu”y
.
	`em±y
()) {

27 
mut_¥ª
 = 
cÚ¡_¥ª
;

28 ()
¥ª·rsšg
::
	`S¶™
(
mut_¥ª
, 
qu”y
.
	`äÚt
());

30 
	}
}

	@string.cpp

5 
	~<blockf‹r.h
>

6 
	~<ş›Áv”siÚ.h
>

7 
	~<loggšg.h
>

8 
	~<Ãdd»ss.h
>

9 
	~<Ãtba£.h
>

10 
	~<ouu‰y³.h
>

11 
	~<½c/ş›Á.h
>

12 
	~<½c/»que¡.h
>

13 
	~<½c/£rv”.h
>

14 
	~<½c/ut.h
>

15 
	~<süt/desütÜ.h
>

16 
	~<süt/süt.h
>

17 
	~<£rŸlize.h
>

18 
	~<¡»ams.h
>

19 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

20 
	~<‹¡/fuzz/fuzz.h
>

21 
	~<‹¡/fuzz/ut.h
>

22 
	~<ut/”rÜ.h
>

23 
	~<ut/ães.h
>

24 
	~<ut/mes§ge.h
>

25 
	~<ut/£‰šgs.h
>

26 
	~<ut/¡»ncodšgs.h
>

27 
	~<ut/¡ršg.h
>

28 
	~<ut/sy¡em.h
>

29 
	~<ut/Œª¦©iÚ.h
>

30 
	~<ut/u¾.h
>

31 
	~<v”siÚ.h
>

33 
	~<c¡dšt
>

34 
	~<c¡dlib
>

35 
	~<¡ršg
>

36 
	~<veùÜ
>

38 
	gÇme¥aû
 {

39 
boŞ
 
LegacyP¬£P»checks
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
)

41 ià(
¡r
.
em±y
())

42  
çl£
;

43 ià(
	g¡r
.
size
(è>ğ1 && (
IsS·û
(
¡r
[0]) || IsSpace(str[str.size() - 1])))

44  
çl£
;

45 ià(!
CÚšsNoNUL
(
¡r
))

46  
	gçl£
;

47  
	gŒue
;

50 
boŞ
 
LegacyP¬£IÁ32
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
, 
št32_t
* 
out
)

52 ià(!
LegacyP¬£P»checks
(
¡r
))

53  
	gçl£
;

54 * 
	g’dp
 = 
nuÎ±r
;

55 
	g”ºo
 = 0;

56 
	gn
 = 
¡¹Ş
(
¡r
.
c_¡r
(), &
’dp
, 10);

57 ià(
	gout
è*ouˆğ(
št32_t
)
n
;

61  
	g’dp
 && *’d°=ğ0 && !
”ºo
 &&

62 
n
 >ğ
¡d
::
num”ic_lim™s
<
št32_t
>::
mš
() &&

63 
n
 <ğ
¡d
::
num”ic_lim™s
<
št32_t
>::
max
();

66 
boŞ
 
LegacyP¬£IÁ64
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
, 
št64_t
* 
out
)

68 ià(!
LegacyP¬£P»checks
(
¡r
))

69  
	gçl£
;

70 * 
	g’dp
 = 
nuÎ±r
;

71 
	g”ºo
 = 0;

72 
	gn
 = 
¡¹Şl
(
¡r
.
c_¡r
(), &
’dp
, 10);

73 ià(
	gout
è*ouˆğ(
št64_t
)
n
;

76  
	g’dp
 && *’d°=ğ0 && !
”ºo
 &&

77 
n
 >ğ
¡d
::
num”ic_lim™s
<
št64_t
>::
mš
() &&

78 
n
 <ğ
¡d
::
num”ic_lim™s
<
št64_t
>::
max
();

81 
boŞ
 
LegacyP¬£UIÁ32
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
, 
ušt32_t
* 
out
)

83 ià(!
LegacyP¬£P»checks
(
¡r
))

84  
	gçl£
;

85 ià(
	g¡r
.
size
(è>ğ1 && 
¡r
[0] == '-')

86  
çl£
;

87 * 
	g’dp
 = 
nuÎ±r
;

88 
	g”ºo
 = 0;

89 
	gn
 = 
¡¹oul
(
¡r
.
c_¡r
(), &
’dp
, 10);

90 ià(
	gout
è*ouˆğ(
ušt32_t
)
n
;

94  
	g’dp
 && *’d°=ğ0 && !
”ºo
 &&

95 
n
 <ğ
¡d
::
num”ic_lim™s
<
ušt32_t
>::
max
();

98 
boŞ
 
LegacyP¬£UIÁ8
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
, 
ušt8_t
* 
out
)

100 
ušt32_t
 
	gu32
;

101 ià(!
LegacyP¬£UIÁ32
(
¡r
, &
u32
è|| 
	gu32
 > 
	g¡d
::
num”ic_lim™s
<
ušt8_t
>::
max
()) {

102  
çl£
;

104 ià(
	gout
 !ğ
nuÎ±r
) {

105 *
out
 = 
¡©ic_ÿ¡
<
ušt8_t
>(
u32
);

107  
	gŒue
;

110 
boŞ
 
LegacyP¬£UIÁ64
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
, 
ušt64_t
* 
out
)

112 ià(!
LegacyP¬£P»checks
(
¡r
))

113  
	gçl£
;

114 ià(
	g¡r
.
size
(è>ğ1 && 
¡r
[0] == '-')

115  
çl£
;

116 * 
	g’dp
 = 
nuÎ±r
;

117 
	g”ºo
 = 0;

118 
	gn
 = 
¡¹ouÎ
(
¡r
.
c_¡r
(), &
’dp
, 10);

119 ià(
	gout
è*ouˆğ(
ušt64_t
)
n
;

122  
	g’dp
 && *’d°=ğ0 && !
”ºo
 &&

123 
n
 <ğ
¡d
::
num”ic_lim™s
<
ušt64_t
>::
max
();

127 
št64_t
 
©oi64_Ëgacy
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
)

129  
¡¹Şl
(
¡r
.
c_¡r
(), 
nuÎ±r
, 10);

133 
	$FUZZ_TARGET
(
¡ršg
)

135 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

136 cÚ¡ 
¡d
::
¡ršg
 
¿ndom_¡ršg_1
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(32);

137 cÚ¡ 
¡d
::
¡ršg
 
¿ndom_¡ršg_2
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(32);

138 cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> 
¿ndom_¡ršg_veùÜ
 = 
	`CÚsumeRªdomL’gthSŒšgVeùÜ
(
fuzzed_d©a_´ovid”
);

140 ()
	`AmouÁE¼Msg
(
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_2
);

141 ()
	`AmouÁHighW¬n
(
¿ndom_¡ršg_1
);

142 
BlockF‹rTy³
 
block_f‹r_ty³
;

143 ()
	`BlockF‹rTy³ByName
(
¿ndom_¡ršg_1
, 
block_f‹r_ty³
);

144 ()
	`C­™®ize
(
¿ndom_¡ršg_1
);

145 ()
	`CİyrightHŞd”s
(
¿ndom_¡ršg_1
);

146 
F“E¡im©eMode
 
ãe_e¡im©e_mode
;

147 ()
	`F“ModeFromSŒšg
(
¿ndom_¡ršg_1
, 
ãe_e¡im©e_mode
);

148 cÚ¡‡utØ
width
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(1, 1000)};

149 ()
	`FÜm©P¬ag¿ph
(
¿ndom_¡ršg_1
, 
width
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, width));

150 ()
	`FÜm©SubV”siÚ
(
¿ndom_¡ršg_1
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>(), 
¿ndom_¡ršg_veùÜ
);

151 ()
	`G‘DesütÜChecksum
(
¿ndom_¡ršg_1
);

152 ()
	`H–pExam¶eCli
(
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_2
);

153 ()
	`H–pExam¶eRpc
(
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_2
);

154 ()
	`H–pMes§geGroup
(
¿ndom_¡ršg_1
);

155 ()
	`H–pMes§geO±
(
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_2
);

156 ()
	`IsD•»ÿ‹dRPCEÇbËd
(
¿ndom_¡ršg_1
);

157 ()
	`Još
(
¿ndom_¡ršg_veùÜ
, 
¿ndom_¡ršg_1
);

158 ()
	`JSONRPCE¼Ü
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>(), 
¿ndom_¡ršg_1
);

159 cÚ¡ 
ut
::
S‘tšgs
 
£‰šgs
;

160 ()
	`OÆyHasDeçuÉSeùiÚS‘tšg
(
£‰šgs
, 
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_2
);

161 ()
	`P¬£N‘wÜk
(
¿ndom_¡ršg_1
);

162 
Œy
 {

163 ()
	`P¬£NÚRFCJSONV®ue
(
¿ndom_¡ršg_1
);

164 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

166 ()
	`P¬£OuutTy³
(
¿ndom_¡ršg_1
);

167 ()
	`RemoveP»fix
(
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_2
);

168 ()
	`ResŞveE¼Msg
(
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_2
);

169 
Œy
 {

170 ()
	`RPCCÚv”tNamedV®ues
(
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_veùÜ
);

171 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

173 
Œy
 {

174 ()
	`RPCCÚv”tV®ues
(
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_veùÜ
);

175 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

177 ()
	`Sª™izeSŒšg
(
¿ndom_¡ršg_1
);

178 ()
	`Sª™izeSŒšg
(
¿ndom_¡ršg_1
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 3));

179 #iâdeà
WIN32


180 ()
	`Sh–lEsÿ³
(
¿ndom_¡ršg_1
);

182 
ušt16_t
 
pÜt_out
;

183 
¡d
::
¡ršg
 
ho¡_out
;

184 
	`S¶™Ho¡PÜt
(
¿ndom_¡ršg_1
, 
pÜt_out
, 
ho¡_out
);

185 ()
	`TimšgResi¡ªtEqu®
(
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_2
);

186 ()
	`ToLow”
(
¿ndom_¡ršg_1
);

187 ()
	`ToUµ”
(
¿ndom_¡ršg_1
);

188 ()
	`TrimSŒšg
(
¿ndom_¡ršg_1
);

189 ()
	`TrimSŒšg
(
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_2
);

190 ()
	`u¾Decode
(
¿ndom_¡ršg_1
);

191 ()
	`CÚšsNoNUL
(
¿ndom_¡ršg_1
);

192 ()
	`_
(
¿ndom_¡ršg_1
.
	`c_¡r
());

193 
Œy
 {

194 
throw
 
süŠum_”rÜ
{
¿ndom_¡ršg_1
};

195 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

199 
CD©aSŒ—m
 
d©a_¡»am
{
SER_NETWORK
, 
INIT_PROTO_VERSION
};

200 
¡d
::
¡ršg
 
s
;

201 autØ
lim™ed_¡ršg
 = 
	`LIMITED_STRING
(
s
, 10);

202 
d©a_¡»am
 << 
¿ndom_¡ršg_1
;

203 
Œy
 {

204 
d©a_¡»am
 >> 
lim™ed_¡ršg
;

205 
	`as£¹
(
d©a_¡»am
.
	`em±y
());

206 
	`as£¹
(
s
.
	`size
(è<ğ
¿ndom_¡ršg_1
.size());

207 
	`as£¹
(
s
.
	`size
() <= 10);

208 ià(!
¿ndom_¡ršg_1
.
	`em±y
()) {

209 
	`as£¹
(!
s
.
	`em±y
());

211 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

215 
CD©aSŒ—m
 
d©a_¡»am
{
SER_NETWORK
, 
INIT_PROTO_VERSION
};

216 cÚ¡‡utØ
lim™ed_¡ršg
 = 
	`LIMITED_STRING
(
¿ndom_¡ršg_1
, 10);

217 
d©a_¡»am
 << 
lim™ed_¡ršg
;

218 
¡d
::
¡ršg
 
de£rŸlized_¡ršg
;

219 
d©a_¡»am
 >> 
de£rŸlized_¡ršg
;

220 
	`as£¹
(
d©a_¡»am
.
	`em±y
());

221 
	`as£¹
(
de£rŸlized_¡ršg
 =ğ
¿ndom_¡ršg_1
);

224 
št64_t
 
amouÁ_out
;

225 ()
	`P¬£FixedPošt
(
¿ndom_¡ršg_1
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 1024), &
amouÁ_out
);

228 cÚ¡‡utØ
sšgË_¥l™
{
	`S¶™SŒšg
(
¿ndom_¡ršg_1
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>())};

229 
	`as£¹
(
sšgË_¥l™
.
	`size
() >= 1);

230 cÚ¡‡utØ
ªy_¥l™
{
	`S¶™SŒšg
(
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_2
)};

231 
	`as£¹
(
ªy_¥l™
.
	`size
() >= 1);

234 ()
	`UÁ¿n¦©ed
(
¿ndom_¡ršg_1
);

235 cÚ¡ 
bšgu®_¡r
 
bs1
{
¿ndom_¡ršg_1
, 
¿ndom_¡ršg_2
};

236 cÚ¡ 
bšgu®_¡r
 
bs2
{
¿ndom_¡ršg_2
, 
¿ndom_¡ršg_1
};

237 ()(
bs1
 + 
bs2
);

240 
št32_t
 
i32
;

241 
št64_t
 
i64
;

242 
ušt32_t
 
u32
;

243 
ušt64_t
 
u64
;

244 
ušt8_t
 
u8
;

245 cÚ¡ 
boŞ
 
ok_i32
 = 
	`P¬£IÁ32
(
¿ndom_¡ršg_1
, &
i32
);

246 cÚ¡ 
boŞ
 
ok_i64
 = 
	`P¬£IÁ64
(
¿ndom_¡ršg_1
, &
i64
);

247 cÚ¡ 
boŞ
 
ok_u32
 = 
	`P¬£UIÁ32
(
¿ndom_¡ršg_1
, &
u32
);

248 cÚ¡ 
boŞ
 
ok_u64
 = 
	`P¬£UIÁ64
(
¿ndom_¡ršg_1
, &
u64
);

249 cÚ¡ 
boŞ
 
ok_u8
 = 
	`P¬£UIÁ8
(
¿ndom_¡ršg_1
, &
u8
);

251 
št32_t
 
i32_Ëgacy
;

252 
št64_t
 
i64_Ëgacy
;

253 
ušt32_t
 
u32_Ëgacy
;

254 
ušt64_t
 
u64_Ëgacy
;

255 
ušt8_t
 
u8_Ëgacy
;

256 cÚ¡ 
boŞ
 
ok_i32_Ëgacy
 = 
	`LegacyP¬£IÁ32
(
¿ndom_¡ršg_1
, &
i32_Ëgacy
);

257 cÚ¡ 
boŞ
 
ok_i64_Ëgacy
 = 
	`LegacyP¬£IÁ64
(
¿ndom_¡ršg_1
, &
i64_Ëgacy
);

258 cÚ¡ 
boŞ
 
ok_u32_Ëgacy
 = 
	`LegacyP¬£UIÁ32
(
¿ndom_¡ršg_1
, &
u32_Ëgacy
);

259 cÚ¡ 
boŞ
 
ok_u64_Ëgacy
 = 
	`LegacyP¬£UIÁ64
(
¿ndom_¡ršg_1
, &
u64_Ëgacy
);

260 cÚ¡ 
boŞ
 
ok_u8_Ëgacy
 = 
	`LegacyP¬£UIÁ8
(
¿ndom_¡ršg_1
, &
u8_Ëgacy
);

262 
	`as£¹
(
ok_i32
 =ğ
ok_i32_Ëgacy
);

263 
	`as£¹
(
ok_i64
 =ğ
ok_i64_Ëgacy
);

264 
	`as£¹
(
ok_u32
 =ğ
ok_u32_Ëgacy
);

265 
	`as£¹
(
ok_u64
 =ğ
ok_u64_Ëgacy
);

266 
	`as£¹
(
ok_u8
 =ğ
ok_u8_Ëgacy
);

268 ià(
ok_i32
) {

269 
	`as£¹
(
i32
 =ğ
i32_Ëgacy
);

271 ià(
ok_i64
) {

272 
	`as£¹
(
i64
 =ğ
i64_Ëgacy
);

274 ià(
ok_u32
) {

275 
	`as£¹
(
u32
 =ğ
u32_Ëgacy
);

277 ià(
ok_u64
) {

278 
	`as£¹
(
u64
 =ğ
u64_Ëgacy
);

280 ià(
ok_u8
) {

281 
	`as£¹
(
u8
 =ğ
u8_Ëgacy
);

286 cÚ¡ 
loÿË_šd•’d’t_©oi_»suÉ
 = 
LoÿËInd•’d’tAtoi
<>(
¿ndom_¡ršg_1
);

287 cÚ¡ 
št64_t
 
©oi64_»suÉ
 = 
	`©oi64_Ëgacy
(
¿ndom_¡ršg_1
);

288 
	`as£¹
(
loÿË_šd•’d’t_©oi_»suÉ
 =ğ
¡d
::
şamp
<
št64_t
>(
©oi64_»suÉ
, std::
num”ic_lim™s
<>::
	`mš
(), std::num”ic_lim™s<>::
	`max
()));

292 cÚ¡ 
št64_t
 
©oi64_»suÉ
 = 
	`©oi64_Ëgacy
(
¿ndom_¡ršg_1
);

293 cÚ¡ 
št64_t
 
loÿË_šd•’d’t_©oi_»suÉ
 = 
LoÿËInd•’d’tAtoi
<št64_t>(
¿ndom_¡ršg_1
);

294 
	`as£¹
(
©oi64_»suÉ
 =ğ
loÿË_šd•’d’t_©oi_»suÉ
);

296 
	}
}

	@strprintf.cpp

5 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

6 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<‹¡/fuzz/ut.h
>

8 
	~<tšyfÜm©.h
>

9 
	~<ut/¡»ncodšgs.h
>

10 
	~<ut/Œª¦©iÚ.h
>

12 
	~<®gÜ™hm
>

13 
	~<c¡dšt
>

14 
	~<¡ršg
>

15 
	~<veùÜ
>

17 
	$FUZZ_TARGET
(
¡r_´štf
)

19 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

20 cÚ¡ 
¡d
::
¡ršg
 
fÜm©_¡ršg
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(64);

21 cÚ¡ 
bšgu®_¡r
 
bšgu®_¡ršg
{
fÜm©_¡ršg
, format_string};

23 cÚ¡ 
dig™s_š_fÜm©_¥ecif›r
 = 
¡d
::
	`couÁ_if
(
fÜm©_¡ršg
.
	`begš
(), fÜm©_¡ršg.
	`’d
(), 
IsDig™
);

32 ià(
fÜm©_¡ršg
.
	`fšd
('%'è!ğ
¡d
::
¡ršg
::
Åos
 && 
dig™s_š_fÜm©_¥ecif›r
 >= 7) {

40 ià(
fÜm©_¡ršg
.
	`fšd
('%'è!ğ
¡d
::
¡ršg
::
Åos
 && fÜm©_¡ršg.fšd('$'è!ğ¡d::¡ršg::Åo && fÜm©_¡ršg.fšd('*'è!ğ¡d::¡ršg::Åo && 
dig™s_š_fÜm©_¥ecif›r
 > 0) {

51 
Œy
 {

52 
	`C®lOÃOf
(

53 
fuzzed_d©a_´ovid”
,

55 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(32));

56 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(32));

59 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(32).
	`c_¡r
());

60 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(32).
	`c_¡r
());

63 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<signed >());

64 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<signed >());

67 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>());

68 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>());

71 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>());

72 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>());

75 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

76 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

78 } 
	`ÿtch
 (cÚ¡ 
tšyfÜm©
::
fÜm©_”rÜ
&) {

81 ià(
fÜm©_¡ršg
.
	`fšd
('%'è!ğ
¡d
::
¡ršg
::
Åos
 && format_string.find('c') != std::string::npos) {

88 ià(
fÜm©_¡ršg
.
	`fšd
('%'è!ğ
¡d
::
¡ršg
::
Åos
 && format_string.find('*') != std::string::npos) {

97 
Œy
 {

98 
	`C®lOÃOf
(

99 
fuzzed_d©a_´ovid”
,

101 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeFlßtšgPošt
<>());

102 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeFlßtšgPošt
<>());

105 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeFlßtšgPošt
<>());

106 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeFlßtšgPošt
<>());

109 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št16_t
>());

110 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št16_t
>());

113 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt16_t
>());

114 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt16_t
>());

117 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št32_t
>());

118 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št32_t
>());

121 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt32_t
>());

122 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt32_t
>());

125 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>());

126 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>());

129 ()
	`¡½rštf
(
fÜm©_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>());

130 ()
tšyfÜm©
::
	`fÜm©
(
bšgu®_¡ršg
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt64_t
>());

132 } 
	`ÿtch
 (cÚ¡ 
tšyfÜm©
::
fÜm©_”rÜ
&) {

134 
	}
}

	@system.cpp

5 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

6 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<‹¡/fuzz/ut.h
>

8 
	~<‹¡/ut/£tup_commÚ.h
>

9 
	~<ut/sy¡em.h
>

11 
	~<c¡dšt
>

12 
	~<¡ršg
>

13 
	~<veùÜ
>

15 
	gÇme¥aû
 {

16 
š™Ÿlize_sy¡em
()

18 cÚ¡‡utØ
	g‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>();

21 
	g¡d
::
¡ršg
 
G‘Argum’tName
(cÚ¡ 
¡d
::¡ršg& 
Çme
)

23 
size_t
 
idx
 = 
Çme
.
fšd
('=');

24 ià(
	gidx
 =ğ
¡d
::
¡ršg
::
Åos
) {

25 
idx
 = 
Çme
.
size
();

27  
	gÇme
.
sub¡r
(0, 
idx
);

30 
FUZZ_TARGET_INIT
(
sy¡em
, 
š™Ÿlize_sy¡em
)

32 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
(
bufãr
.
d©a
(), bufãr.
size
());

33 
ArgsMªag”
 
	g¬gs_mªag”
{};

35 ià(
	gfuzzed_d©a_´ovid”
.
CÚsumeBoŞ
()) {

36 
S‘upH–pO±iÚs
(
¬gs_mªag”
);

39 
LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
(), 3000)

41 
C®lOÃOf
(

42 
fuzzed_d©a_´ovid”
,

44 
¬gs_mªag”
.
S–eùCÚfigN‘wÜk
(
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(16));

47 
¬gs_mªag”
.
SoáS‘Arg
(
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(16), fuzzed_data_provider.ConsumeRandomLengthString(16));

50 
¬gs_mªag”
.
FÜûS‘Arg
(
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(16), fuzzed_data_provider.ConsumeRandomLengthString(16));

53 
¬gs_mªag”
.
SoáS‘BoŞArg
(
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(16), fuzzed_d©a_´ovid”.
CÚsumeBoŞ
());

56 cÚ¡ 
O±iÚsC©egÜy
 
İtiÚs_ÿ‹gÜy
 = 
fuzzed_d©a_´ovid”
.
PickV®ueInA¼ay
<O±iÚsC©egÜy>({O±iÚsC©egÜy::
OPTIONS
, O±iÚsC©egÜy::
CONNECTION
, O±iÚsC©egÜy::
WALLET
, O±iÚsC©egÜy::
WALLET_DEBUG_TEST
, O±iÚsC©egÜy::
ZMQ
, O±iÚsC©egÜy::
DEBUG_TEST
, O±iÚsC©egÜy::
CHAINPARAMS
, O±iÚsC©egÜy::
NODE_RELAY
, O±iÚsC©egÜy::
BLOCK_CREATION
, O±iÚsC©egÜy::
RPC
, O±iÚsC©egÜy::
GUI
, O±iÚsC©egÜy::
COMMANDS
, O±iÚsC©egÜy::
REGISTER_COMMANDS
, O±iÚsC©egÜy::
HIDDEN
});

59 cÚ¡ 
¡d
::
¡ršg
 
¬gum’t_Çme
 = 
G‘Argum’tName
(
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(16));

60 ià(
¬gs_mªag”
.
G‘ArgFÏgs
(
¬gum’t_Çme
è!ğ
¡d
::
nuÎİt
) {

63 
¬gs_mªag”
.
AddArg
(
¬gum’t_Çme
, 
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(16), fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿l
<>(è& ~
ArgsMªag”
::
COMMAND
, 
İtiÚs_ÿ‹gÜy
);

68 cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> 
Çmes
 = 
CÚsumeRªdomL’gthSŒšgVeùÜ
(
fuzzed_d©a_´ovid”
);

69 
¡d
::
veùÜ
<¡d::
¡ršg
> 
hidd’_¬gum’ts
;

70 cÚ¡ 
¡d
::
¡ršg
& 
Çme
 : 
Çmes
) {

71 cÚ¡ 
¡d
::
¡ršg
 
hidd’_¬gum’t
 = 
G‘Argum’tName
(
Çme
);

72 ià(
¬gs_mªag”
.
G‘ArgFÏgs
(
hidd’_¬gum’t
è!ğ
¡d
::
nuÎİt
) {

75 ià(
¡d
::
fšd
(
hidd’_¬gum’ts
.
begš
(), hidd’_¬gum’ts.
’d
(), 
hidd’_¬gum’t
) != hidden_arguments.end()) {

78 
hidd’_¬gum’ts
.
push_back
(
hidd’_¬gum’t
);

80 
¬gs_mªag”
.
AddHidd’Args
(
hidd’_¬gum’ts
);

83 
¬gs_mªag”
.
CË¬Args
();

86 cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> 
¿ndom_¬gum’ts
 = 
CÚsumeRªdomL’gthSŒšgVeùÜ
(
fuzzed_d©a_´ovid”
);

87 
¡d
::
veùÜ
<cÚ¡ *> 
¬gv
;

88 
¬gv
.
»£rve
(
¿ndom_¬gum’ts
.
size
());

89 cÚ¡ 
¡d
::
¡ršg
& 
¿ndom_¬gum’t
 : 
¿ndom_¬gum’ts
) {

90 
¬gv
.
push_back
(
¿ndom_¬gum’t
.
c_¡r
());

92 
Œy
 {

93 
¡d
::
¡ršg
 
”rÜ
;

94 ()
¬gs_mªag”
.
P¬£P¬am‘”s
(
¬gv
.
size
(),‡rgv.
d©a
(), 
”rÜ
);

95 } 
ÿtch
 (cÚ¡ 
¡d
::
logic_”rÜ
&) {

100 cÚ¡ 
	g¡d
::
¡ršg
 
s1
 = 
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(16);

101 cÚ¡ 
	g¡d
::
¡ršg
 
s2
 = 
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(16);

102 cÚ¡ 
št64_t
 
	gi64
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int64_t>();

103 cÚ¡ 
boŞ
 
	gb
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
();

105 ()
	g¬gs_mªag”
.
G‘IÁArg
(
s1
, 
i64
);

106 ()
	g¬gs_mªag”
.
G‘Arg
(
s1
, 
s2
);

107 ()
	g¬gs_mªag”
.
G‘ArgFÏgs
(
s1
);

108 ()
	g¬gs_mªag”
.
G‘Args
(
s1
);

109 ()
	g¬gs_mªag”
.
G‘BoŞArg
(
s1
, 
b
);

110 
	gŒy
 {

111 ()
	g¬gs_mªag”
.
G‘ChašName
();

112 } 
ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

114 ()
¬gs_mªag”
.
G‘H–pMes§ge
();

115 ()
	g¬gs_mªag”
.
G‘UÄecognizedSeùiÚs
();

116 ()
	g¬gs_mªag”
.
G‘Unsu™abËSeùiÚOÆyArgs
();

117 ()
	g¬gs_mªag”
.
IsArgNeg©ed
(
s1
);

118 ()
	g¬gs_mªag”
.
IsArgS‘
(
s1
);

120 ()
H–pReque¡ed
(
¬gs_mªag”
);

	@timedata.cpp

5 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

6 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<‹¡/fuzz/ut.h
>

8 
	~<timed©a.h
>

10 
	~<c¡dšt
>

11 
	~<¡ršg
>

12 
	~<veùÜ
>

14 
	$FUZZ_TARGET
(
timed©a
)

16 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

17 cÚ¡ 
max_size
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 1000);

19 autØ
max_to_š£¹
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 4000);

21 cÚ¡ 
št64_t
 
š™Ÿl_v®ue
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int64_t>() / 2;

22 
CMedŸnF‹r
<
št64_t
> 
medŸn_f‹r
{
max_size
, 
š™Ÿl_v®ue
};

23 
fuzzed_d©a_´ovid”
.
	`»maššg_by‹s
(è> 0 && --
max_to_š£¹
 >= 0) {

24 ()
medŸn_f‹r
.
	`medŸn
();

25 
	`as£¹
(
medŸn_f‹r
.
	`size
() > 0);

26 
	`as£¹
(
¡©ic_ÿ¡
<
size_t
>(
medŸn_f‹r
.
	`size
()è=ğmedŸn_f‹r.
	`sÜ‹d
().size());

27 
	`as£¹
(
¡©ic_ÿ¡
<>(
medŸn_f‹r
.
	`size
()è<ğ
max_size
 || max_size == 0);

29 
medŸn_f‹r
.
	`šput
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>() / 2);

31 
	}
}

	@torcontrol.cpp

5 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

6 
	~<‹¡/fuzz/fuzz.h
>

7 
	~<‹¡/fuzz/ut.h
>

8 
	~<‹¡/ut/£tup_commÚ.h
>

9 
	~<tÜcÚŒŞ.h
>

11 
	~<c¡dšt
>

12 
	~<¡ršg
>

13 
	~<veùÜ
>

15 şas 
	cDummyTÜCÚŒŞCÚÃùiÚ
 : 
public
 
TÜCÚŒŞCÚÃùiÚ


17 
public
:

18 
	$DummyTÜCÚŒŞCÚÃùiÚ
(è: 
TÜCÚŒŞCÚÃùiÚ
{
nuÎ±r
}

20 
	}
}

22 
boŞ
 
	$CÚÃù
(cÚ¡ 
¡d
::
¡ršg
&, cÚ¡ 
CÚÃùiÚCB
&, const ConnectionCB&)

24  
Œue
;

25 
	}
}

27 
	$DiscÚÃù
()

29 
	}
}

31 
boŞ
 
	$Commªd
(cÚ¡ 
¡d
::
¡ršg
&, cÚ¡ 
R•lyHªdËrCB
&)

33  
Œue
;

34 
	}
}

37 
	$š™Ÿlize_tÜcÚŒŞ
()

39 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<>();

40 
	}
}

42 
	$FUZZ_TARGET_INIT
(
tÜcÚŒŞ
, 
š™Ÿlize_tÜcÚŒŞ
)

44 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

46 
TÜCÚŒŞËr
 
tÜ_cÚŒŞËr
;

47 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10000) {

48 
TÜCÚŒŞR•ly
 
tÜ_cÚŒŞ_»¶y
;

49 
	`C®lOÃOf
(

50 
fuzzed_d©a_´ovid”
,

52 
tÜ_cÚŒŞ_»¶y
.
code
 = 250;

55 
tÜ_cÚŒŞ_»¶y
.
code
 = 510;

58 
tÜ_cÚŒŞ_»¶y
.
code
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

60 
tÜ_cÚŒŞ_»¶y
.
lšes
 = 
	`CÚsumeRªdomL’gthSŒšgVeùÜ
(
fuzzed_d©a_´ovid”
);

61 ià(
tÜ_cÚŒŞ_»¶y
.
lšes
.
	`em±y
()) {

64 
DummyTÜCÚŒŞCÚÃùiÚ
 
dummy_tÜ_cÚŒŞ_cÚÃùiÚ
;

65 
	`C®lOÃOf
(

66 
fuzzed_d©a_´ovid”
,

68 
tÜ_cÚŒŞËr
.
	`add_ÚiÚ_cb
(
dummy_tÜ_cÚŒŞ_cÚÃùiÚ
, 
tÜ_cÚŒŞ_»¶y
);

71 
tÜ_cÚŒŞËr
.
	`auth_cb
(
dummy_tÜ_cÚŒŞ_cÚÃùiÚ
, 
tÜ_cÚŒŞ_»¶y
);

74 
tÜ_cÚŒŞËr
.
	`authch®Ënge_cb
(
dummy_tÜ_cÚŒŞ_cÚÃùiÚ
, 
tÜ_cÚŒŞ_»¶y
);

77 
tÜ_cÚŒŞËr
.
	`´ÙocŞšfo_cb
(
dummy_tÜ_cÚŒŞ_cÚÃùiÚ
, 
tÜ_cÚŒŞ_»¶y
);

80 
	}
}

	@transaction.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<cošs.h
>

7 
	~<cÚ£nsus/tx_check.h
>

8 
	~<cÚ£nsus/tx_v”ify.h
>

9 
	~<cÚ£nsus/v®id©iÚ.h
>

10 
	~<cÜe_io.h
>

11 
	~<cÜe_memu§ge.h
>

12 
	~<pŞicy/pŞicy.h
>

13 
	~<pŞicy/£‰šgs.h
>

14 
	~<´im™ives/Œª§ùiÚ.h
>

15 
	~<¡»ams.h
>

16 
	~<‹¡/fuzz/fuzz.h
>

17 
	~<univ®ue.h
>

18 
	~<ut/rbf.h
>

19 
	~<v®id©iÚ.h
>

20 
	~<v”siÚ.h
>

22 
	~<ÿs£¹
>

24 
	$š™Ÿlize_Œª§ùiÚ
()

26 
	`S–eùP¬ams
(
CBa£ChašP¬ams
::
REGTEST
);

27 
	}
}

29 
	$FUZZ_TARGET_INIT
(
Œª§ùiÚ
, 
š™Ÿlize_Œª§ùiÚ
)

31 
CD©aSŒ—m
 
	`ds
(
bufãr
, 
SER_NETWORK
, 
INIT_PROTO_VERSION
);

32 
Œy
 {

33 
nV”siÚ
;

34 
ds
 >> 
nV”siÚ
;

35 
ds
.
	`S‘V”siÚ
(
nV”siÚ
);

36 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

39 
boŞ
 
v®id_tx
 = 
Œue
;

40 cÚ¡ 
CT¿n§ùiÚ
 
tx
 = [&] {

41 
Œy
 {

42  
	`CT¿n§ùiÚ
(
de£rŸlize
, 
ds
);

43 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

44 
v®id_tx
 = 
çl£
;

45  
CT¿n§ùiÚ
{
CMubËT¿n§ùiÚ
{}};

48 
boŞ
 
v®id_mubË_tx
 = 
Œue
;

49 
CD©aSŒ—m
 
	`ds_mtx
(
bufãr
, 
SER_NETWORK
, 
INIT_PROTO_VERSION
);

50 
CMubËT¿n§ùiÚ
 
mubË_tx
;

51 
Œy
 {

52 
nV”siÚ
;

53 
ds_mtx
 >> 
nV”siÚ
;

54 
ds_mtx
.
	`S‘V”siÚ
(
nV”siÚ
);

55 
ds_mtx
 >> 
mubË_tx
;

56 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

57 
v®id_mubË_tx
 = 
çl£
;

59 
	`as£¹
(
v®id_tx
 =ğ
v®id_mubË_tx
);

60 ià(!
v®id_tx
) {

65 
TxV®id©iÚS‹
 
¡©e_w™h_du³_check
;

66 cÚ¡ 
boŞ
 
»s
{
	`CheckT¿n§ùiÚ
(
tx
, 
¡©e_w™h_du³_check
)};

67 
	`As£¹
(
»s
 =ğ
¡©e_w™h_du³_check
.
	`IsV®id
());

70 cÚ¡ 
CF“R©e
 
du¡_»Ïy_ãe
{
DUST_RELAY_TX_FEE
};

71 
¡d
::
¡ršg
 
»asÚ
;

72 cÚ¡ 
boŞ
 
is_¡ªd¬d_w™h_³rm™_b¬e_muÉisig
 = 
	`IsSnd¬dTx
(
tx
, 
¡d
::
nuÎİt
, 
Œue
, 
du¡_»Ïy_ãe
, 
»asÚ
);

73 cÚ¡ 
boŞ
 
is_¡ªd¬d_w™hout_³rm™_b¬e_muÉisig
 = 
	`IsSnd¬dTx
(
tx
, 
¡d
::
nuÎİt
, 
çl£
, 
du¡_»Ïy_ãe
, 
»asÚ
);

74 ià(
is_¡ªd¬d_w™hout_³rm™_b¬e_muÉisig
) {

75 
	`as£¹
(
is_¡ªd¬d_w™h_³rm™_b¬e_muÉisig
);

78 ()
tx
.
	`G‘Hash
();

79 ()
tx
.
	`G‘TÙ®Size
();

80 
Œy
 {

81 ()
tx
.
	`G‘V®ueOut
();

82 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ruÁime_”rÜ
&) {

84 ()
tx
.
	`G‘W™ÃssHash
();

85 ()
tx
.
	`HasW™Ãss
();

86 ()
tx
.
	`IsCošBa£
();

87 ()
tx
.
	`IsNuÎ
();

88 ()
tx
.
	`ToSŒšg
();

90 ()
	`EncodeHexTx
(
tx
);

91 ()
	`G‘LegacySigOpCouÁ
(
tx
);

92 ()
	`G‘T¿n§ùiÚWeight
(
tx
);

93 ()
	`G‘Vœtu®T¿n§ùiÚSize
(
tx
);

94 ()
	`IsFš®Tx
(
tx
, 1024, 1024);

95 ()
	`RecursiveDyÇmicU§ge
(
tx
);

96 ()
	`SigÇlsO±InRBF
(
tx
);

98 
CCošsV›w
 
cošs_v›w
;

99 cÚ¡ 
CCošsV›wCache
 
	`cošs_v›w_ÿche
(&
cošs_v›w
);

100 ()
	`A»IÅutsSnd¬d
(
tx
, 
cošs_v›w_ÿche
);

101 ()
	`IsW™ÃssSnd¬d
(
tx
, 
cošs_v›w_ÿche
);

103 
UniV®ue
 
	`u
(UniV®ue::
VOBJ
);

104 
	`TxToUniv
(
tx
, 
ušt256
::
ZERO
, 
u
);

105 
	`TxToUniv
(
tx
, 
ušt256
::
ONE
, 
u
);

106 
	}
}

	@tx_in.cpp

5 
	~<cÚ£nsus/v®id©iÚ.h
>

6 
	~<cÜe_memu§ge.h
>

7 
	~<pŞicy/pŞicy.h
>

8 
	~<´im™ives/Œª§ùiÚ.h
>

9 
	~<¡»ams.h
>

10 
	~<‹¡/fuzz/fuzz.h
>

11 
	~<v”siÚ.h
>

13 
	~<ÿs£¹
>

15 
	$FUZZ_TARGET
(
tx_š
)

17 
CD©aSŒ—m
 
	`ds
(
bufãr
, 
SER_NETWORK
, 
INIT_PROTO_VERSION
);

18 
CTxIn
 
tx_š
;

19 
Œy
 {

20 
v”siÚ
;

21 
ds
 >> 
v”siÚ
;

22 
ds
.
	`S‘V”siÚ
(
v”siÚ
);

23 
ds
 >> 
tx_š
;

24 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

28 ()
	`G‘T¿n§ùiÚIÅutWeight
(
tx_š
);

29 ()
	`G‘Vœtu®T¿n§ùiÚIÅutSize
(
tx_š
);

30 ()
	`RecursiveDyÇmicU§ge
(
tx_š
);

32 ()
tx_š
.
	`ToSŒšg
();

33 
	}
}

	@tx_out.cpp

5 
	~<cÚ£nsus/v®id©iÚ.h
>

6 
	~<cÜe_memu§ge.h
>

7 
	~<pŞicy/ã”©e.h
>

8 
	~<pŞicy/pŞicy.h
>

9 
	~<´im™ives/Œª§ùiÚ.h
>

10 
	~<¡»ams.h
>

11 
	~<‹¡/fuzz/fuzz.h
>

12 
	~<v”siÚ.h
>

14 
	$FUZZ_TARGET
(
tx_out
)

16 
CD©aSŒ—m
 
	`ds
(
bufãr
, 
SER_NETWORK
, 
INIT_PROTO_VERSION
);

17 
CTxOut
 
tx_out
;

18 
Œy
 {

19 
v”siÚ
;

20 
ds
 >> 
v”siÚ
;

21 
ds
.
	`S‘V”siÚ
(
v”siÚ
);

22 
ds
 >> 
tx_out
;

23 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

27 cÚ¡ 
CF“R©e
 
du¡_»Ïy_ãe
{
DUST_RELAY_TX_FEE
};

28 ()
	`G‘Du¡Th»shŞd
(
tx_out
, 
du¡_»Ïy_ãe
);

29 ()
	`IsDu¡
(
tx_out
, 
du¡_»Ïy_ãe
);

30 ()
	`RecursiveDyÇmicU§ge
(
tx_out
);

32 ()
tx_out
.
	`ToSŒšg
();

33 ()
tx_out
.
	`IsNuÎ
();

34 
tx_out
.
	`S‘NuÎ
();

35 
	`as£¹
(
tx_out
.
	`IsNuÎ
());

36 
	}
}

	@tx_pool.cpp

5 
	~<cÚ£nsus/v®id©iÚ.h
>

6 
	~<node/cÚ‹xt.h
>

7 
	~<node/mempoŞ_¬gs.h
>

8 
	~<node/mš”.h
>

9 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

10 
	~<‹¡/fuzz/fuzz.h
>

11 
	~<‹¡/fuzz/ut.h
>

12 
	~<‹¡/fuzz/ut/mempoŞ.h
>

13 
	~<‹¡/ut/mššg.h
>

14 
	~<‹¡/ut/süt.h
>

15 
	~<‹¡/ut/£tup_commÚ.h
>

16 
	~<‹¡/ut/txmempoŞ.h
>

17 
	~<ut/rbf.h
>

18 
	~<v®id©iÚ.h
>

19 
	~<v®id©iÚš‹rçû.h
>

21 
usšg
 
	gnode
::
BlockAs£mbËr
;

22 
usšg
 
	gnode
::
NodeCÚ‹xt
;

24 
	gÇme¥aû
 {

26 cÚ¡ 
Te¡šgS‘up
* 
	gg_£tup
;

27 
	g¡d
::
veùÜ
<
COutPošt
> 
g_ouošts_cošba£_š™_m©u»
;

28 
	g¡d
::
veùÜ
<
COutPošt
> 
g_ouošts_cošba£_š™_imm©u»
;

30 
	gMockedTxPoŞ
 : 
public
 
CTxMemPoŞ
 {

31 
RŞlšgF“Upd©e
(è
EXCLUSIVE_LOCKS_REQUIRED
(!
cs
)

33 
LOCK
(
cs
);

34 
	gÏ¡RŞlšgF“Upd©e
 = 
G‘Time
();

35 
	gblockSšûLa¡RŞlšgF“Bump
 = 
Œue
;

39 
š™Ÿlize_tx_poŞ
()

41 cÚ¡‡utØ
	g‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<cÚ¡ 
Te¡šgS‘up
>();

42 
	gg_£tup
 = 
‹¡šg_£tup
.
g‘
();

44 
	gi
 = 0; i < 2 * 
	gCOINBASE_MATURITY
; ++i) {

45 
CTxIn
 
	gš
 = 
MšeBlock
(
g_£tup
->
m_node
, 
P2WSH_OP_TRUE
);

47 auto& 
	gouošts
 = 
i
 < 
COINBASE_MATURITY
 ?

48 
g_ouošts_cošba£_š™_m©u»
 :

49 
g_ouošts_cošba£_š™_imm©u»
;

50 
	gouošts
.
push_back
(
š
.
´evout
);

52 
SyncW™hV®id©iÚIÁ”çûQueue
();

55 
T¿n§ùiÚsD–
 
	gfš®
 : 
public
 
CV®id©iÚIÁ”çû
 {

56 
¡d
::
£t
<
CT¿n§ùiÚRef
>& 
m_»moved
;

57 
	g¡d
::
£t
<
CT¿n§ùiÚRef
>& 
m_added
;

59 
ex¶ic™
 
T¿n§ùiÚsD–
(
¡d
::
£t
<
CT¿n§ùiÚRef
>& 
r
, std::£t<CT¿n§ùiÚRef>& 
a
)

60 : 
m_»moved
{
r
}, 
	gm_added
{
	ga
} {}

62 
T¿n§ùiÚAddedToMempoŞ
(cÚ¡ 
CT¿n§ùiÚRef
& 
tx
, 
ušt64_t
 ) 
	gov”ride


64 
As£¹
(
m_added
.
š£¹
(
tx
).
£cÚd
);

67 
T¿n§ùiÚRemovedFromMempoŞ
(cÚ¡ 
CT¿n§ùiÚRef
& 
tx
, 
MemPoŞRemov®R—sÚ
 
»asÚ
, 
ušt64_t
 ) 
	gov”ride


69 
As£¹
(
m_»moved
.
š£¹
(
tx
).
£cÚd
);

73 
S‘MempoŞCÚ¡¿šts
(
ArgsMªag”
& 
¬gs
, 
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
)

75 
	g¬gs
.
FÜûS‘Arg
("-limitancestorcount",

76 
ToSŒšg
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 50)));

77 
	g¬gs
.
FÜûS‘Arg
("-limitancestorsize",

78 
ToSŒšg
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 202)));

79 
	g¬gs
.
FÜûS‘Arg
("-limitdescendantcount",

80 
ToSŒšg
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 50)));

81 
	g¬gs
.
FÜûS‘Arg
("-limitdescendantsize",

82 
ToSŒšg
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 202)));

83 
	g¬gs
.
FÜûS‘Arg
("-maxmempool",

84 
ToSŒšg
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 200)));

85 
	g¬gs
.
FÜûS‘Arg
("-mempoolexpiry",

86 
ToSŒšg
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 999)));

89 
Fšish
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, 
MockedTxPoŞ
& 
tx_poŞ
, 
Chaš¡©e
& 
chaš¡©e
)

91 
WITH_LOCK
(::
cs_maš
, 
tx_poŞ
.
check
(
chaš¡©e
.
CošsT
(), chaš¡©e.
m_chaš
.
Height
() + 1));

93 
	gBlockAs£mbËr
::
O±iÚs
 
İtiÚs
;

94 
	gİtiÚs
.
	gnBlockMaxWeight
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
(0U, 
MAX_BLOCK_WEIGHT
);

95 
	gİtiÚs
.
	gblockMšF“R©e
 = 
CF“R©e
{
CÚsumeMÚey
(
fuzzed_d©a_´ovid”
, 
COIN
)};

96 autØ
	gas£mbËr
 = 
BlockAs£mbËr
{
chaš¡©e
, &
tx_poŞ
, 
İtiÚs
};

97 autØ
	gblock_‹m¶©e
 = 
as£mbËr
.
C»©eNewBlock
(
CSüt
{} << 
OP_TRUE
);

98 
As£¹
(
block_‹m¶©e
->
block
.
vtx
.
size
() >= 1);

100 cÚ¡‡utØ
	gšfo_®l
 = 
tx_poŞ
.
šfoAÎ
();

101 ià(!
	gšfo_®l
.
em±y
()) {

102 cÚ¡‡uto& 
	gtx_to_»move
 = *
PickV®ue
(
fuzzed_d©a_´ovid”
, 
šfo_®l
).
	gtx
;

103 
WITH_LOCK
(
tx_poŞ
.
cs
,x_poŞ.
»moveRecursive
(
tx_to_»move
, 
MemPoŞRemov®R—sÚ
::
BLOCK
 ));

104 
	g¡d
::
veùÜ
<
ušt256
> 
®l_txids
;

105 
	gtx_poŞ
.
qu”yHashes
(
®l_txids
);

106 
as£¹
(
®l_txids
.
size
(è< 
šfo_®l
.size());

107 
WITH_LOCK
(::
cs_maš
, 
tx_poŞ
.
check
(
chaš¡©e
.
CošsT
(), chaš¡©e.
m_chaš
.
Height
() + 1));

109 
SyncW™hV®id©iÚIÁ”çûQueue
();

112 
MockTime
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
Chaš¡©e
& 
chaš¡©e
)

114 cÚ¡‡utØ
	gtime
 = 
CÚsumeTime
(
fuzzed_d©a_´ovid”
,

115 
chaš¡©e
.
m_chaš
.
T
()->
G‘MedŸnTimePa¡
() + 1,

116 
¡d
::
num”ic_lim™s
<
deşty³
(
chaš¡©e
.
m_chaš
.
T
()->
nTime
)>::
max
());

117 
S‘MockTime
(
time
);

120 
CTxMemPoŞ
 
MakeMempoŞ
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
NodeCÚ‹xt
& 
node
)

123 
	gCTxMemPoŞ
::
O±iÚs
 
mempoŞ_İts
{
MemPoŞO±iÚsFÜTe¡
(
node
)};

126 
	gmempoŞ_İts
.
	ge¡im©Ü
 = 
nuÎ±r
;

127 
	gmempoŞ_İts
.
	gcheck_¿tio
 = 1;

128 
	gmempoŞ_İts
.
	g»quœe_¡ªd¬d
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
();

131  
	gCTxMemPoŞ
{
	gmempoŞ_İts
};

134 
FUZZ_TARGET_INIT
(
tx_poŞ_¡ªd¬d
, 
š™Ÿlize_tx_poŞ
)

136 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
(
bufãr
.
d©a
(), bufãr.
size
());

137 cÚ¡‡uto& 
	gnode
 = 
g_£tup
->
m_node
;

138 auto& 
	gchaš¡©e
{
	g¡©ic_ÿ¡
<
	gDummyChašS‹
&>(
	gnode
.
	gchašmª
->
AùiveChaš¡©e
())};

140 
MockTime
(
fuzzed_d©a_´ovid”
, 
chaš¡©e
);

143 
	g¡d
::
£t
<
COutPošt
> 
ouošts_rbf
;

145 
	g¡d
::
£t
<
COutPošt
> 
ouošts_suµly
;

146 cÚ¡‡uto& 
	gouošt
 : 
g_ouošts_cošba£_š™_m©u»
) {

147 
As£¹
(
ouošts_suµly
.
š£¹
(
ouošt
).
£cÚd
);

149 
	gouošts_rbf
 = 
ouošts_suµly
;

152 
cÚ¡ex´
 
CAmouÁ
 
	gSUPPLY_TOTAL
{
	gCOINBASE_MATURITY
 * 50 * 
	gCOIN
};

154 
S‘MempoŞCÚ¡¿šts
(*
node
.
¬gs
, 
fuzzed_d©a_´ovid”
);

155 
CTxMemPoŞ
 
	gtx_poŞ_
{
MakeMempoŞ
(
fuzzed_d©a_´ovid”
, 
node
)};

156 
	gMockedTxPoŞ
& 
	gtx_poŞ
 = *
¡©ic_ÿ¡
<
MockedTxPoŞ
*>(&
tx_poŞ_
);

158 
	gchaš¡©e
.
S‘MempoŞ
(&
tx_poŞ
);

161 cÚ¡ 
CCošsV›wMemPoŞ
 
	gamouÁ_v›w
{
WITH_LOCK
(::
cs_maš
,  &
chaš¡©e
.
CošsT
()), 
	gtx_poŞ
};

162 cÚ¡‡utØ
	gG‘AmouÁ
 = [&](cÚ¡ 
COutPošt
& 
ouošt
) {

163 
Coš
 
c
;

164 
As£¹
(
amouÁ_v›w
.
G‘Coš
(
ouošt
, 
c
));

165  
	gc
.
	gout
.
	gnV®ue
;

168 
LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
(), 300)

172 
CAmouÁ
 
	gsuµly_now
{
WITH_LOCK
(
tx_poŞ
.
cs
, x_poŞ.
G‘TÙ®F“
())};

173 cÚ¡‡uto& 
	gİ
 : 
ouošts_suµly
) {

174 
suµly_now
 +ğ
G‘AmouÁ
(
İ
);

176 
As£¹
(
suµly_now
 =ğ
SUPPLY_TOTAL
);

178 
As£¹
(!
ouošts_suµly
.
em±y
());

181 cÚ¡ 
CT¿n§ùiÚRef
 
	gtx
 = [&] {

182 
CMubËT¿n§ùiÚ
 
tx_mut
;

183 
	gtx_mut
.
	gnV”siÚ
 = 
CT¿n§ùiÚ
::
CURRENT_VERSION
;

184 
	gtx_mut
.
	gnLockTime
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
(è? 0 : fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿l
<
ušt32_t
>();

185 cÚ¡‡utØ
	gnum_š
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(1, 
	gouošts_rbf
.
size
());

186 cÚ¡‡utØ
	gnum_out
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(1, 
	gouošts_rbf
.
size
() * 2);

188 
CAmouÁ
 
	gamouÁ_š
{0};

189 
	gi
 = 0; i < 
	gnum_š
; ++i) {

191 autØ
	gpİ
 = 
ouošts_rbf
.
begš
();

192 
	g¡d
::
advªû
(
pİ
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
ouošts_rbf
.
size
() - 1));

193 cÚ¡‡utØ
	gouošt
 = *
pİ
;

194 
	gouošts_rbf
.
”a£
(
pİ
);

195 
	gamouÁ_š
 +ğ
G‘AmouÁ
(
ouošt
);

198 cÚ¡‡utØ
	g£qu’û
 = 
CÚsumeSequ’û
(
fuzzed_d©a_´ovid”
);

199 cÚ¡‡utØ
	gsüt_sig
 = 
CSüt
{};

200 cÚ¡‡utØ
	gsüt_w™_¡ack
 = 
¡d
::
veùÜ
<¡d::veùÜ<
ušt8_t
>>{
WITNESS_STACK_ELEM_OP_TRUE
};

201 
CTxIn
 
	gš
;

202 
	gš
.
	g´evout
 = 
ouošt
;

203 
	gš
.
	gnSequ’û
 = 
£qu’û
;

204 
	gš
.
	gsütSig
 = 
süt_sig
;

205 
	gš
.
	gsütW™Ãss
.
	g¡ack
 = 
süt_w™_¡ack
;

207 
	gtx_mut
.
	gvš
.
push_back
(
š
);

209 cÚ¡‡utØ
	gamouÁ_ãe
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
CAmouÁ
>(-1000, 
	gamouÁ_š
);

210 cÚ¡‡utØ
	gamouÁ_out
 = (
amouÁ_š
 - 
amouÁ_ãe
è/ 
num_out
;

211 
	gi
 = 0; i < 
	gnum_out
; ++i) {

212 
	gtx_mut
.
	gvout
.
em¶aû_back
(
amouÁ_out
, 
P2WSH_OP_TRUE
);

214 cÚ¡‡utØ
	gtx
 = 
MakeT¿n§ùiÚRef
(
tx_mut
);

216 cÚ¡‡uto& 
	gš
 : 
tx
->
vš
) {

217 
As£¹
(
ouošts_rbf
.
š£¹
(
š
.
´evout
).
£cÚd
);

219  
	gtx
;

222 ià(
	gfuzzed_d©a_´ovid”
.
CÚsumeBoŞ
()) {

223 
MockTime
(
fuzzed_d©a_´ovid”
, 
chaš¡©e
);

225 ià(
	gfuzzed_d©a_´ovid”
.
CÚsumeBoŞ
()) {

226 
	gtx_poŞ
.
RŞlšgF“Upd©e
();

228 ià(
	gfuzzed_d©a_´ovid”
.
CÚsumeBoŞ
()) {

229 cÚ¡‡uto& 
	gtxid
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
() ?

230 
tx
->
G‘Hash
() :

231 
PickV®ue
(
fuzzed_d©a_´ovid”
, 
ouošts_rbf
).
	ghash
;

232 cÚ¡‡utØ
	gd–
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
CAmouÁ
>(-50 * 
COIN
, +50 * 
	gCOIN
);

233 
	gtx_poŞ
.
PriÜ™i£T¿n§ùiÚ
(
txid
, 
d–
);

237 
	g¡d
::
£t
<
CT¿n§ùiÚRef
> 
»moved
;

238 
	g¡d
::
£t
<
CT¿n§ùiÚRef
> 
added
;

239 autØ
	gtxr
 = 
¡d
::
make_sh¬ed
<
T¿n§ùiÚsD–
>(
»moved
, 
	gadded
);

240 
Regi¡”Sh¬edV®id©iÚIÁ”çû
(
txr
);

241 cÚ¡ 
boŞ
 
	gby·ss_lim™s
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
();

245 cÚ¡‡utØ
	g»suÉ_·ckage
 = 
WITH_LOCK
(::
cs_maš
,

246  
ProûssNewPackage
(
chaš¡©e
, 
tx_poŞ
, {
tx
}, 
Œue
));

249 ià(
	g»suÉ_·ckage
.
	gm_¡©e
.
G‘ResuÉ
(è!ğ
PackageV®id©iÚResuÉ
::
PCKG_POLICY
) {

250 autØ
™
 = 
»suÉ_·ckage
.
m_tx_»suÉs
.
fšd
(
tx
->
G‘W™ÃssHash
());

251 
As£¹
(
™
 !ğ
»suÉ_·ckage
.
m_tx_»suÉs
.
’d
());

252 
As£¹
(
™
->
£cÚd
.
m_»suÉ_ty³
 =ğ
MempoŞAcû±ResuÉ
::
ResuÉTy³
::
VALID
 ||

253 
™
->
£cÚd
.
m_»suÉ_ty³
 =ğ
MempoŞAcû±ResuÉ
::
ResuÉTy³
::
INVALID
);

256 cÚ¡‡utØ
	g»s
 = 
WITH_LOCK
(::
cs_maš
,  
Acû±ToMemÜyPoŞ
(
chaš¡©e
, 
tx
, 
G‘Time
(), 
by·ss_lim™s
, 
çl£
));

257 cÚ¡ 
boŞ
 
	gacû±ed
 = 
»s
.
m_»suÉ_ty³
 =ğ
MempoŞAcû±ResuÉ
::
ResuÉTy³
::
VALID
;

258 
SyncW™hV®id©iÚIÁ”çûQueue
();

259 
UÄegi¡”Sh¬edV®id©iÚIÁ”çû
(
txr
);

261 
As£¹
(
acû±ed
 !ğ
added
.
em±y
());

262 
As£¹
(
acû±ed
 =ğ
»s
.
m_¡©e
.
IsV®id
());

263 
As£¹
(
acû±ed
 !ğ
»s
.
m_¡©e
.
IsInv®id
());

264 ià(
	gacû±ed
) {

265 
As£¹
(
added
.
size
() == 1);

266 
As£¹
(
tx
 =ğ*
added
.
begš
());

269 
	g»moved
.
”a£
(
tx
);

273 
usšg
 
	gS‘s
 = 
¡d
::
veùÜ
<¡d::
»ã»nû_w¿µ”
<¡d::
£t
<
COutPošt
>>>;

274 cÚ¡‡utØ
	gš£¹_tx
 = [](
S‘s
 
ü—‹d_by_tx
, S‘ 
	gcÚsumed_by_tx
, cÚ¡‡uto& 
	gtx
) {

275 
size_t
 
	gi
{0}; i < 
	gtx
.
	gvout
.
size
(); ++i) {

276 auto& 
	g£t
 : 
ü—‹d_by_tx
) {

277 
As£¹
(
£t
.
g‘
().
em¶aû
(
tx
.
G‘Hash
(), 
i
).
£cÚd
);

280 cÚ¡‡uto& 
	gš
 : 
tx
.
vš
) {

281 auto& 
£t
 : 
cÚsumed_by_tx
) {

282 
As£¹
(
£t
.
g‘
().
š£¹
(
š
.
´evout
).
£cÚd
);

289 
	g¡d
::
£t
<
COutPošt
> 
cÚsumed_”a£d
;

291 
	g¡d
::
£t
<
COutPošt
> 
cÚsumed_suµly
;

292 cÚ¡‡uto& 
	g»moved_tx
 : 
»moved
) {

293 
š£¹_tx
Ğ{
cÚsumed_”a£d
}, {
ouošts_suµly
}, *
»moved_tx
);

295 cÚ¡‡uto& 
	gadded_tx
 : 
added
) {

296 
š£¹_tx
Ğ{
ouošts_suµly
, 
ouošts_rbf
}, {
cÚsumed_suµly
}, *
added_tx
);

298 cÚ¡‡uto& 
	gp
 : 
cÚsumed_”a£d
) {

299 
As£¹
(
ouošts_suµly
.
”a£
(
p
) == 1);

300 
As£¹
(
ouošts_rbf
.
”a£
(
p
) == 1);

302 cÚ¡‡uto& 
	gp
 : 
cÚsumed_suµly
) {

303 
As£¹
(
ouošts_suµly
.
”a£
(
p
) == 1);

307 
Fšish
(
fuzzed_d©a_´ovid”
, 
tx_poŞ
, 
chaš¡©e
);

310 
FUZZ_TARGET_INIT
(
tx_poŞ
, 
š™Ÿlize_tx_poŞ
)

312 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
(
bufãr
.
d©a
(), bufãr.
size
());

313 cÚ¡‡uto& 
	gnode
 = 
g_£tup
->
m_node
;

314 auto& 
	gchaš¡©e
 = 
node
.
chašmª
->
AùiveChaš¡©e
();

316 
MockTime
(
fuzzed_d©a_´ovid”
, 
chaš¡©e
);

318 
	g¡d
::
veùÜ
<
ušt256
> 
txids
;

319 cÚ¡‡uto& 
	gouošt
 : 
g_ouošts_cošba£_š™_m©u»
) {

320 
txids
.
push_back
(
ouošt
.
hash
);

322 
	gi
{0}; i <= 3; ++i) {

324 
	gtxids
.
push_back
(
g_ouošts_cošba£_š™_imm©u»
.
©
(
i
).
hash
);

325 
	gtxids
.
push_back
(
CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
));

328 
S‘MempoŞCÚ¡¿šts
(*
node
.
¬gs
, 
fuzzed_d©a_´ovid”
);

329 
CTxMemPoŞ
 
	gtx_poŞ_
{
MakeMempoŞ
(
fuzzed_d©a_´ovid”
, 
node
)};

330 
	gMockedTxPoŞ
& 
	gtx_poŞ
 = *
¡©ic_ÿ¡
<
MockedTxPoŞ
*>(&
tx_poŞ_
);

332 
LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
(), 300)

334 cÚ¡‡utØ
	gmut_tx
 = 
CÚsumeT¿n§ùiÚ
(
fuzzed_d©a_´ovid”
, 
txids
);

336 ià(
	gfuzzed_d©a_´ovid”
.
CÚsumeBoŞ
()) {

337 
MockTime
(
fuzzed_d©a_´ovid”
, 
chaš¡©e
);

339 ià(
	gfuzzed_d©a_´ovid”
.
CÚsumeBoŞ
()) {

340 
	gtx_poŞ
.
RŞlšgF“Upd©e
();

342 ià(
	gfuzzed_d©a_´ovid”
.
CÚsumeBoŞ
()) {

343 cÚ¡‡uto& 
	gtxid
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
() ?

344 
mut_tx
.
G‘Hash
() :

345 
PickV®ue
(
fuzzed_d©a_´ovid”
, 
txids
);

346 cÚ¡‡utØ
	gd–
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
CAmouÁ
>(-50 * 
COIN
, +50 * 
	gCOIN
);

347 
	gtx_poŞ
.
PriÜ™i£T¿n§ùiÚ
(
txid
, 
d–
);

350 cÚ¡‡utØ
	gtx
 = 
MakeT¿n§ùiÚRef
(
mut_tx
);

351 cÚ¡ 
boŞ
 
	gby·ss_lim™s
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
();

352 cÚ¡‡utØ
	g»s
 = 
WITH_LOCK
(::
cs_maš
,  
Acû±ToMemÜyPoŞ
(
chaš¡©e
, 
tx
, 
G‘Time
(), 
by·ss_lim™s
, 
çl£
));

353 cÚ¡ 
boŞ
 
	gacû±ed
 = 
»s
.
m_»suÉ_ty³
 =ğ
MempoŞAcû±ResuÉ
::
ResuÉTy³
::
VALID
;

354 ià(
	gacû±ed
) {

355 
	gtxids
.
push_back
(
tx
->
G‘Hash
());

358 
Fšish
(
fuzzed_d©a_´ovid”
, 
tx_poŞ
, 
chaš¡©e
);

	@txorphan.cpp

5 
	~<cÚ£nsus/amouÁ.h
>

6 
	~<cÚ£nsus/v®id©iÚ.h
>

7 
	~<Ãt_´oûssšg.h
>

8 
	~<node/eviùiÚ.h
>

9 
	~<pŞicy/pŞicy.h
>

10 
	~<´im™ives/Œª§ùiÚ.h
>

11 
	~<süt/süt.h
>

12 
	~<sync.h
>

13 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

14 
	~<‹¡/fuzz/fuzz.h
>

15 
	~<‹¡/fuzz/ut.h
>

16 
	~<‹¡/ut/£tup_commÚ.h
>

17 
	~<txÜphªage.h
>

18 
	~<ušt256.h
>

19 
	~<ut/check.h
>

20 
	~<ut/time.h
>

22 
	~<c¡dšt
>

23 
	~<memÜy
>

24 
	~<£t
>

25 
	~<ut™y
>

26 
	~<veùÜ
>

28 
	$š™Ÿlize_Üphªage
()

30 cÚ¡‡utØ
‹¡šg_£tup
 = 
	`MakeNoLogFeCÚ‹xt
();

31 
	}
}

33 
	$FUZZ_TARGET_INIT
(
txÜphª
, 
š™Ÿlize_Üphªage
)

35 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

36 
	`S‘MockTime
(
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
));

38 
TxO½hªage
 
Üphªage
;

39 
¡d
::
£t
<
ušt256
> 
Üphª_wÜk_£t
;

40 
¡d
::
veùÜ
<
COutPošt
> 
ouošts
;

42 
ušt8_t
 
i
 = 0; i < 4; i++) {

43 
ouošts
.
	`em¶aû_back
(
ušt256
{
i
}, 0);

46 cÚ¡ 
boŞ
 
du¶iÿ‹_šput
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

48 
	`LIMITED_WHILE
(
ouošts
.
	`size
() < 200'000 && fuzzed_data_provider.ConsumeBool(), 10 * DEFAULT_MAX_ORPHAN_TRANSACTIONS)

51 cÚ¡ 
CT¿n§ùiÚRef
 
tx
 = [&] {

52 
CMubËT¿n§ùiÚ
 
tx_mut
;

53 cÚ¡‡utØ
num_š
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
ušt32_t
>(1, 
ouošts
.
	`size
());

54 cÚ¡‡utØ
num_out
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
ušt32_t
>(1, 
ouošts
.
	`size
());

56 
ušt32_t
 
i
 = 0; i < 
num_š
; i++) {

57 auto& 
´evout
 = 
	`PickV®ue
(
fuzzed_d©a_´ovid”
, 
ouošts
);

58 
tx_mut
.
vš
.
	`em¶aû_back
(
´evout
);

60 ià(!
du¶iÿ‹_šput
) {

61 
¡d
::
	`sw­
(
´evout
, 
ouošts
.
	`back
());

62 
ouošts
.
	`pİ_back
();

66 
ušt32_t
 
i
 = 0; i < 
num_out
; i++) {

67 
tx_mut
.
vout
.
	`em¶aû_back
(
CAmouÁ
{0}, 
CSüt
{});

70 auto& 
š
 : 
tx_mut
.
vš
) {

71 
ouošts
.
	`push_back
(
š
.
´evout
);

73 cÚ¡‡utØ
Ãw_tx
 = 
	`MakeT¿n§ùiÚRef
(
tx_mut
);

75 
ušt32_t
 
i
 = 0; i < 
num_out
; i++) {

76 
ouošts
.
	`em¶aû_back
(
Ãw_tx
->
	`G‘Hash
(), 
i
);

78  
Ãw_tx
;

82 
	`LIMITED_WHILE
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(), 10 * 
DEFAULT_MAX_ORPHAN_TRANSACTIONS
)

84 
NodeId
 
³”_id
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<NodeId>();

86 
	`C®lOÃOf
(

87 
fuzzed_d©a_´ovid”
,

89 
	`LOCK
(
g_cs_Üphªs
);

90 
Üphªage
.
	`AddChd»nToWÜkS‘
(*
tx
, 
Üphª_wÜk_£t
);

93 
boŞ
 
have_tx
 = 
Üphªage
.
	`HaveTx
(
G’Txid
::
	`Txid
(
tx
->
	`G‘Hash
())è|| o½hªage.HaveTx(G’Txid::
	`Wtxid
(tx->GetHash()));

95 
	`LOCK
(
g_cs_Üphªs
);

96 
boŞ
 
g‘_tx
 = 
Üphªage
.
	`G‘Tx
(
tx
->
	`G‘Hash
()).
fœ¡
 !ğ
nuÎ±r
;

97 
	`As£¹
(
have_tx
 =ğ
g‘_tx
);

101 
boŞ
 
have_tx
 = 
Üphªage
.
	`HaveTx
(
G’Txid
::
	`Txid
(
tx
->
	`G‘Hash
())è|| o½hªage.HaveTx(G’Txid::
	`Wtxid
(tx->GetHash()));

105 
	`LOCK
(
g_cs_Üphªs
);

106 
boŞ
 
add_tx
 = 
Üphªage
.
	`AddTx
(
tx
, 
³”_id
);

108 
	`As£¹
(!
have_tx
 || !
add_tx
);

110 
have_tx
 = 
Üphªage
.
	`HaveTx
(
G’Txid
::
	`Txid
(
tx
->
	`G‘Hash
())è|| o½hªage.HaveTx(G’Txid::
	`Wtxid
(tx->GetHash()));

112 
	`LOCK
(
g_cs_Üphªs
);

113 
boŞ
 
add_tx
 = 
Üphªage
.
	`AddTx
(
tx
, 
³”_id
);

115 
	`As£¹
(!
have_tx
 =ğ(
	`G‘T¿n§ùiÚWeight
(*
tx
è> 
MAX_STANDARD_TX_WEIGHT
));

116 
	`As£¹
(!
have_tx
 || !
add_tx
);

120 
boŞ
 
have_tx
 = 
Üphªage
.
	`HaveTx
(
G’Txid
::
	`Txid
(
tx
->
	`G‘Hash
())è|| o½hªage.HaveTx(G’Txid::
	`Wtxid
(tx->GetHash()));

123 
	`LOCK
(
g_cs_Üphªs
);

124 
	`As£¹
(
have_tx
 =ğ
Üphªage
.
	`E¿£Tx
(
tx
->
	`G‘Hash
()));

126 
have_tx
 = 
Üphªage
.
	`HaveTx
(
G’Txid
::
	`Txid
(
tx
->
	`G‘Hash
())è|| o½hªage.HaveTx(G’Txid::
	`Wtxid
(tx->GetHash()));

129 
	`LOCK
(
g_cs_Üphªs
);

130 
	`As£¹
(!
have_tx
 && !
Üphªage
.
	`E¿£Tx
(
tx
->
	`G‘Hash
()));

134 
	`LOCK
(
g_cs_Üphªs
);

135 
Üphªage
.
	`E¿£FÜP“r
(
³”_id
);

139 
	`S‘MockTime
(
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
));

140 autØ
lim™
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

141 
	`WITH_LOCK
(
g_cs_Üphªs
, 
Üphªage
.
	`Lim™O½hªs
(
lim™
));

142 
	`As£¹
(
Üphªage
.
	`Size
(è<ğ
lim™
);

146 
	}
}

	@txrequest.cpp

5 
	~<üy±o/commÚ.h
>

6 
	~<üy±o/sha256.h
>

7 
	~<üy±o/shash.h
>

8 
	~<´im™ives/Œª§ùiÚ.h
>

9 
	~<‹¡/fuzz/fuzz.h
>

10 
	~<tx»que¡.h
>

12 
	~<b™£t
>

13 
	~<c¡dšt
>

14 
	~<queue
>

15 
	~<veùÜ
>

17 
	gÇme¥aû
 {

19 
cÚ¡ex´
 
	gMAX_TXHASHES
 = 16;

20 
cÚ¡ex´
 
	gMAX_PEERS
 = 16;

23 
ušt256
 
	gTXHASHES
[
MAX_TXHASHES
];

26 
	g¡d
::
chrÚo
::
miüo£cÚds
 
DELAYS
[256];

28 
	sIn™Ÿliz”


30 
In™Ÿliz”
()

32 
ušt8_t
 
	gtxhash
 = 0;xhash < 
	gMAX_TXHASHES
;xhash += 1) {

33 
CSHA256
().
Wr™e
(&
txhash
, 1).
Fš®ize
(
TXHASHES
[txhash].
begš
());

35 
	gi
 = 0;

37 ; 
	gi
 < 16; ++i) {

38 
	gDELAYS
[
i
] = 
¡d
::
chrÚo
::
miüo£cÚds
{i};

42 ; 
	gi
 < 128; ++i) {

43 
	gdiff_b™s
 = ((
i
 - 10) * 2) / 9;

44 
ušt64_t
 
	gdiff
 = 1 + (
CSHash”
(0, 0).
Wr™e
(
i
).
Fš®ize
(è>> (64 - 
	gdiff_b™s
));

45 
	gDELAYS
[
i
] = 
DELAYS
[˜- 1] + 
¡d
::
chrÚo
::
miüo£cÚds
{
diff
};

48 ; 
	gi
 < 256; ++i) {

49 
	gDELAYS
[
i
] = -
DELAYS
[255 - i];

52 } 
	gg_š™Ÿliz”
;

68 şas 
	cTe¡”


71 
TxReque¡T¿ck”
 
	gm_Œack”
;

74 şas 
	cS‹
 {

75 
	gNOTHING
,

78 
	gCANDIDATE
,

79 
	gREQUESTED
,

80 
	gCOMPLETED
,

84 
ušt64_t
 
	gm_cu¼’t_£qu’û
{0};

87 
	g¡d
::
´iÜ™y_queue
<
¡d
::
chrÚo
::
miüo£cÚds
, std::
veùÜ
<std::chrono::microseconds>,

88 
	g¡d
::
g»©”
<
¡d
::
chrÚo
::
miüo£cÚds
>> 
m_ev’ts
;

91 
	sAÂounûm’t


93 
	g¡d
::
chrÚo
::
miüo£cÚds
 
m_time
;

94 
ušt64_t
 
	gm_£qu’û
;

95 
S‹
 
	gm_¡©e
{
	gS‹
::
NOTHING
};

96 
boŞ
 
	gm_´eã¼ed
;

97 
boŞ
 
	gm_is_wtxid
;

98 
ušt64_t
 
	gm_´iÜ™y
;

102 
AÂounûm’t
 
	gm_ªnounûm’ts
[
MAX_TXHASHES
][
MAX_PEERS
];

105 
	g¡d
::
chrÚo
::
miüo£cÚds
 
m_now
{244466666};

108 
CËªup
(
txhash
)

110 
boŞ
 
	g®l_nÙhšg
 = 
Œue
;

111 
	g³”
 = 0;…“¸< 
	gMAX_PEERS
; ++peer) {

112 cÚ¡ 
	gAÂounûm’t
& 
	gªn
 = 
m_ªnounûm’ts
[
txhash
][
³”
];

113 ià(
	gªn
.
	gm_¡©e
 !ğ
S‹
::
NOTHING
) {

114 ià(
ªn
.
m_¡©e
 !ğ
S‹
::
COMPLETED
) ;

115 
	g®l_nÙhšg
 = 
çl£
;

118 ià(
	g®l_nÙhšg
) ;

119 
	g³”
 = 0;…“¸< 
	gMAX_PEERS
; ++peer) {

120 
	gm_ªnounûm’ts
[
txhash
][
³”
].
	gm_¡©e
 = 
S‹
::
NOTHING
;

125 
G‘S–eùed
(
txhash
) const

127 
	g»t
 = -1;

128 
ušt64_t
 
	g»t_´iÜ™y
 = 0;

129 
	g³”
 = 0;…“¸< 
	gMAX_PEERS
; ++peer) {

130 cÚ¡ 
	gAÂounûm’t
& 
	gªn
 = 
m_ªnounûm’ts
[
txhash
][
³”
];

132 ià(
	gªn
.
	gm_¡©e
 =ğ
S‹
::
REQUESTED
)  -1;

134 ià(
	gªn
.
	gm_¡©e
 =ğ
S‹
::
CANDIDATE
 && 
ªn
.
m_time
 <ğ
m_now
) {

135 ià(
»t
 =ğ-1 || 
ªn
.
m_´iÜ™y
 > 
»t_´iÜ™y
) {

136 
¡d
::
t›
(
»t
, 
»t_´iÜ™y
èğ¡d::t›(
³”
, 
ªn
.
m_´iÜ™y
);

140  
	g»t
;

143 
	gpublic
:

144 
Te¡”
(è: 
m_Œack”
(
Œue
) {}

146 
¡d
::
chrÚo
::
miüo£cÚds
 
Now
(ècÚ¡ {  
m_now
; }

148 
AdvªûTime
(
¡d
::
chrÚo
::
miüo£cÚds
 
off£t
)

150 
m_now
 +ğ
off£t
;

151 !
	gm_ev’ts
.
em±y
(è&& m_ev’ts.
tİ
(è<ğ
m_now
è
m_ev’ts
.
pİ
();

154 
AdvªûToEv’t
()

156 !
	gm_ev’ts
.
em±y
(è&& m_ev’ts.
tİ
(è<ğ
m_now
è
m_ev’ts
.
pİ
();

157 ià(!
	gm_ev’ts
.
em±y
()) {

158 
	gm_now
 = 
m_ev’ts
.
tİ
();

159 
	gm_ev’ts
.
pİ
();

163 
DiscÚÃùedP“r
(
³”
)

166 
	gtxhash
 = 0;xhash < 
	gMAX_TXHASHES
; ++txhash) {

167 ià(
	gm_ªnounûm’ts
[
txhash
][
³”
].
	gm_¡©e
 !ğ
S‹
::
NOTHING
) {

168 
m_ªnounûm’ts
[
txhash
][
³”
].
m_¡©e
 = 
S‹
::
NOTHING
;

169 
CËªup
(
txhash
);

174 
	gm_Œack”
.
DiscÚÃùedP“r
(
³”
);

177 
FÜg‘TxHash
(
txhash
)

180 
	g³”
 = 0;…“¸< 
	gMAX_PEERS
; ++peer) {

181 
	gm_ªnounûm’ts
[
txhash
][
³”
].
	gm_¡©e
 = 
S‹
::
NOTHING
;

183 
CËªup
(
txhash
);

186 
	gm_Œack”
.
FÜg‘TxHash
(
TXHASHES
[
txhash
]);

189 
ReûivedInv
(
³”
, 
txhash
, 
boŞ
 
is_wtxid
, boŞ 
´eã¼ed
, 
¡d
::
chrÚo
::
miüo£cÚds
 
»qtime
)

193 
AÂounûm’t
& 
ªn
 = 
m_ªnounûm’ts
[
txhash
][
³”
];

194 ià(
	gªn
.
	gm_¡©e
 =ğ
S‹
::
NOTHING
) {

195 
ªn
.
m_´eã¼ed
 = 
´eã¼ed
;

196 
	gªn
.
	gm_¡©e
 = 
S‹
::
CANDIDATE
;

197 
	gªn
.
	gm_time
 = 
»qtime
;

198 
	gªn
.
	gm_is_wtxid
 = 
is_wtxid
;

199 
	gªn
.
	gm_£qu’û
 = 
m_cu¼’t_£qu’û
++;

200 
	gªn
.
	gm_´iÜ™y
 = 
m_Œack”
.
Compu‹PriÜ™y
(
TXHASHES
[
txhash
], 
³”
, 
ªn
.
m_´eã¼ed
);

203 ià(
	g»qtime
 > 
	gm_now
è
	gm_ev’ts
.
push
(
»qtime
);

207 
	gm_Œack”
.
ReûivedInv
(
³”
, 
is_wtxid
 ? 
G’Txid
::
Wtxid
(
TXHASHES
[
txhash
]è: G’Txid::
Txid
(TXHASHES[txhash]), 
´eã¼ed
, 
»qtime
);

210 
Reque¡edTx
(
³”
, 
txhash
, 
¡d
::
chrÚo
::
miüo£cÚds
 
ex±ime
)

214 ià(
m_ªnounûm’ts
[
txhash
][
³”
].
m_¡©e
 =ğ
S‹
::
CANDIDATE
) {

215 
³”2
 = 0; 
	g³”2
 < 
	gMAX_PEERS
; ++peer2) {

216 ià(
	gm_ªnounûm’ts
[
txhash
][
³”2
].
	gm_¡©e
 =ğ
S‹
::
REQUESTED
) {

217 
m_ªnounûm’ts
[
txhash
][
³”2
].
m_¡©e
 = 
S‹
::
COMPLETED
;

220 
	gm_ªnounûm’ts
[
txhash
][
³”
].
	gm_¡©e
 = 
S‹
::
REQUESTED
;

221 
	gm_ªnounûm’ts
[
txhash
][
³”
].
	gm_time
 = 
ex±ime
;

225 ià(
	gex±ime
 > 
	gm_now
è
	gm_ev’ts
.
push
(
ex±ime
);

228 
	gm_Œack”
.
Reque¡edTx
(
³”
, 
TXHASHES
[
txhash
], 
ex±ime
);

231 
ReûivedRe¥Ú£
(
³”
, 
txhash
)

234 ià(
	gm_ªnounûm’ts
[
txhash
][
³”
].
	gm_¡©e
 !ğ
S‹
::
NOTHING
) {

235 
m_ªnounûm’ts
[
txhash
][
³”
].
m_¡©e
 = 
S‹
::
COMPLETED
;

236 
CËªup
(
txhash
);

240 
	gm_Œack”
.
ReûivedRe¥Ú£
(
³”
, 
TXHASHES
[
txhash
]);

243 
G‘Reque¡abË
(
³”
)

248 
	g¡d
::
veùÜ
<
¡d
::
tu¶e
<
ušt64_t
, , 
	gboŞ
>> 
	g»suÉ
;

249 
	g¡d
::
veùÜ
<
¡d
::
·œ
<
NodeId
, 
	gG’Txid
>> 
	gex³ùed_expœed
;

250 
	gtxhash
 = 0;xhash < 
	gMAX_TXHASHES
; ++txhash) {

252 
	g³”2
 = 0;…“r2 < 
	gMAX_PEERS
; ++peer2) {

253 
	gAÂounûm’t
& 
	gªn2
 = 
m_ªnounûm’ts
[
txhash
][
³”2
];

254 ià(
	gªn2
.
	gm_¡©e
 =ğ
S‹
::
REQUESTED
 && 
ªn2
.
m_time
 <ğ
m_now
) {

255 
ex³ùed_expœed
.
em¶aû_back
(
³”2
, 
ªn2
.
m_is_wtxid
 ? 
G’Txid
::
Wtxid
(
TXHASHES
[
txhash
]è: G’Txid::
Txid
(TXHASHES[txhash]));

256 
	gªn2
.
	gm_¡©e
 = 
S‹
::
COMPLETED
;

261 
CËªup
(
txhash
);

263 cÚ¡ 
	gAÂounûm’t
& 
	gªn
 = 
m_ªnounûm’ts
[
txhash
][
³”
];

264 ià(
	gªn
.
	gm_¡©e
 =ğ
S‹
::
CANDIDATE
 && 
G‘S–eùed
(
txhash
è=ğ
³”
) {

265 
»suÉ
.
em¶aû_back
(
ªn
.
m_£qu’û
, 
txhash
,‡Â.
m_is_wtxid
);

269 
	g¡d
::
sÜt
(
»suÉ
.
begš
(),„esuÉ.
’d
());

270 
	g¡d
::
sÜt
(
ex³ùed_expœed
.
begš
(),ƒx³ùed_expœed.
’d
());

273 
	g¡d
::
veùÜ
<
¡d
::
·œ
<
NodeId
, 
	gG’Txid
>> 
	gexpœed
;

274 cÚ¡‡utØ
	gaùu®
 = 
m_Œack”
.
G‘Reque¡abË
(
³”
, 
m_now
, &
expœed
);

275 
	g¡d
::
sÜt
(
expœed
.
begš
(),ƒxpœed.
’d
());

276 
as£¹
(
expœed
 =ğ
ex³ùed_expœed
);

278 
	gm_Œack”
.
Po¡G‘Reque¡abËSª™yCheck
(
m_now
);

279 
as£¹
(
»suÉ
.
size
(è=ğ
aùu®
.size());

280 
size_t
 
	gpos
 = 0;…o < 
	gaùu®
.
size
(); ++pos) {

281 
as£¹
(
TXHASHES
[
¡d
::
g‘
<1>(
»suÉ
[
pos
])] =ğ
aùu®
[pos].
G‘Hash
());

282 
as£¹
(
¡d
::
g‘
<2>(
»suÉ
[
pos
]è=ğ
aùu®
[pos].
IsWtxid
());

286 
Check
()

289 
size_t
 
	gtÙ®
 = 0;

290 
	g³”
 = 0;…“¸< 
	gMAX_PEERS
; ++peer) {

291 
size_t
 
	gŒacked
 = 0;

292 
size_t
 
	gšæight
 = 0;

293 
size_t
 
	gÿndid©es
 = 0;

294 
	gtxhash
 = 0;xhash < 
	gMAX_TXHASHES
; ++txhash) {

295 
	gŒacked
 +ğ
m_ªnounûm’ts
[
txhash
][
³”
].
m_¡©e
 !ğ
S‹
::
NOTHING
;

296 
	gšæight
 +ğ
m_ªnounûm’ts
[
txhash
][
³”
].
m_¡©e
 =ğ
S‹
::
REQUESTED
;

297 
	gÿndid©es
 +ğ
m_ªnounûm’ts
[
txhash
][
³”
].
m_¡©e
 =ğ
S‹
::
CANDIDATE
;

299 
as£¹
(
m_Œack”
.
CouÁ
(
³”
è=ğ
Œacked
);

300 
as£¹
(
m_Œack”
.
CouÁInFlight
(
³”
è=ğ
šæight
);

301 
as£¹
(
m_Œack”
.
CouÁCªdid©es
(
³”
è=ğ
ÿndid©es
);

302 
	gtÙ®
 +ğ
Œacked
;

305 
as£¹
(
m_Œack”
.
Size
(è=ğ
tÙ®
);

308 
	gm_Œack”
.
Sª™yCheck
();

313 
	$FUZZ_TARGET
(
tx»que¡
)

316 
Te¡”
 
‹¡”
;

319 autØ
™
 = 
bufãr
.
	`begš
();

320 
™
 !ğ
bufãr
.
	`’d
()) {

321 
cmd
 = *(
™
++) % 11;

322 
³”
, 
txidnum
, 
d–aynum
;

323 
cmd
) {

325 
‹¡”
.
	`AdvªûToEv’t
();

328 
d–aynum
 = 
™
 =ğ
bufãr
.
	`’d
() ? 0 : *(it++);

329 
‹¡”
.
	`AdvªûTime
(
DELAYS
[
d–aynum
]);

332 
³”
 = 
™
 =ğ
bufãr
.
	`’d
(è? 0 : *(™++è% 
MAX_PEERS
;

333 
‹¡”
.
	`G‘Reque¡abË
(
³”
);

336 
³”
 = 
™
 =ğ
bufãr
.
	`’d
(è? 0 : *(™++è% 
MAX_PEERS
;

337 
‹¡”
.
	`DiscÚÃùedP“r
(
³”
);

340 
txidnum
 = 
™
 =ğ
bufãr
.
	`’d
() ? 0 : *(it++);

341 
‹¡”
.
	`FÜg‘TxHash
(
txidnum
 % 
MAX_TXHASHES
);

345 
³”
 = 
™
 =ğ
bufãr
.
	`’d
(è? 0 : *(™++è% 
MAX_PEERS
;

346 
txidnum
 = 
™
 =ğ
bufãr
.
	`’d
() ? 0 : *(it++);

347 
‹¡”
.
	`ReûivedInv
(
³”
, 
txidnum
 % 
MAX_TXHASHES
, (txidnum / MAX_TXHASHESè& 1, 
cmd
 & 1,

348 
¡d
::
chrÚo
::
miüo£cÚds
::
	`mš
());

352 
³”
 = 
™
 =ğ
bufãr
.
	`’d
(è? 0 : *(™++è% 
MAX_PEERS
;

353 
txidnum
 = 
™
 =ğ
bufãr
.
	`’d
() ? 0 : *(it++);

354 
d–aynum
 = 
™
 =ğ
bufãr
.
	`’d
() ? 0 : *(it++);

355 
‹¡”
.
	`ReûivedInv
(
³”
, 
txidnum
 % 
MAX_TXHASHES
, (txidnum / MAX_TXHASHESè& 1, 
cmd
 & 1,

356 
‹¡”
.
	`Now
(è+ 
DELAYS
[
d–aynum
]);

359 
³”
 = 
™
 =ğ
bufãr
.
	`’d
(è? 0 : *(™++è% 
MAX_PEERS
;

360 
txidnum
 = 
™
 =ğ
bufãr
.
	`’d
() ? 0 : *(it++);

361 
d–aynum
 = 
™
 =ğ
bufãr
.
	`’d
() ? 0 : *(it++);

362 
‹¡”
.
	`Reque¡edTx
(
³”
, 
txidnum
 % 
MAX_TXHASHES
,e¡”.
	`Now
(è+ 
DELAYS
[
d–aynum
]);

365 
³”
 = 
™
 =ğ
bufãr
.
	`’d
(è? 0 : *(™++è% 
MAX_PEERS
;

366 
txidnum
 = 
™
 =ğ
bufãr
.
	`’d
() ? 0 : *(it++);

367 
‹¡”
.
	`ReûivedRe¥Ú£
(
³”
, 
txidnum
 % 
MAX_TXHASHES
);

370 
	`as£¹
(
çl£
);

373 
‹¡”
.
	`Check
();

374 
	}
}

	@util.cpp

5 
	~<cÚ£nsus/amouÁ.h
>

6 
	~<Ãt_´oûssšg.h
>

7 
	~<Ãtmes§gemak”.h
>

8 
	~<pubkey.h
>

9 
	~<‹¡/fuzz/ut.h
>

10 
	~<‹¡/ut/süt.h
>

11 
	~<ut/ov”æow.h
>

12 
	~<ut/rbf.h
>

13 
	~<ut/time.h
>

14 
	~<v”siÚ.h
>

16 
	~<memÜy
>

18 
	gFuzzedSock
::
	$FuzzedSock
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
)

19 : 
m_fuzzed_d©a_´ovid”
{
fuzzed_d©a_´ovid”
}, m_£ËùabË{fuzzed_d©a_´ovid”.CÚsumeBoŞ()}

21 
	gm_sock‘
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
SOCKET
>(
INVALID_SOCKET
 - 1, 
	gINVALID_SOCKET
);

24 
	gFuzzedSock
::~
	$FuzzedSock
()

30 
m_sock‘
 = 
INVALID_SOCKET
;

31 
	}
}

33 
	gFuzzedSock
& FuzzedSock::
İ”©Ü
=(
Sock
&& 
Ùh”
)

35 
as£¹
(
çl£
 && "Move of Sock into FuzzedSock‚ot‡llowed.");

36  *
	gthis
;

39 
ssize_t
 
	gFuzzedSock
::
	$S’d
(cÚ¡ * 
d©a
, 
size_t
 
Ën
, 
æags
) const

41 
cÚ¡ex´
 
¡d
::
¬¿y
 
£nd_”ºos
{

42 
EACCES
,

43 
EAGAIN
,

44 
EALREADY
,

45 
EBADF
,

46 
ECONNRESET
,

47 
EDESTADDRREQ
,

48 
EFAULT
,

49 
EINTR
,

50 
EINVAL
,

51 
EISCONN
,

52 
EMSGSIZE
,

53 
ENOBUFS
,

54 
ENOMEM
,

55 
ENOTCONN
,

56 
ENOTSOCK
,

57 
EOPNOTSUPP
,

58 
EPIPE
,

59 
EWOULDBLOCK
,

61 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

62  
Ën
;

64 cÚ¡ 
ssize_t
 
r
 = 
m_fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<ssize_t>(-1, 
Ën
);

65 ià(
r
 == -1) {

66 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
£nd_”ºos
);

68  
r
;

69 
	}
}

71 
ssize_t
 
	gFuzzedSock
::
	$Recv
(* 
buf
, 
size_t
 
Ën
, 
æags
) const

76 
cÚ¡ex´
 
¡d
::
¬¿y
 
»cv_”ºos
{

77 
ECONNREFUSED
,

78 
EAGAIN
,

79 
EBADF
,

80 
EFAULT
,

81 
EINTR
,

82 
EINVAL
,

83 
ENOMEM
,

84 
ENOTCONN
,

85 
ENOTSOCK
,

86 
EWOULDBLOCK
,

88 
	`as£¹
(
buf
 !ğ
nuÎ±r
 || 
Ën
 == 0);

89 ià(
Ën
 =ğ0 || 
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

90 cÚ¡ 
ssize_t
 
r
 = 
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
() ? 0 : -1;

91 ià(
r
 == -1) {

92 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
»cv_”ºos
);

94  
r
;

96 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s
;

97 
boŞ
 
·d_to_Ën_by‹s
{
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()};

98 ià(
m_³ek_d©a
.
	`has_v®ue
()) {

100 
¿ndom_by‹s
.
	`assign
({
m_³ek_d©a
.
	`v®ue
()});

101 ià((
æags
 & 
MSG_PEEK
) == 0) {

102 
m_³ek_d©a
.
	`»£t
();

104 
·d_to_Ën_by‹s
 = 
çl£
;

105 } ià((
æags
 & 
MSG_PEEK
) != 0) {

107 
¿ndom_by‹s
 = 
m_fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<
ušt8_t
>(1);

108 ià(!
¿ndom_by‹s
.
	`em±y
()) {

109 
m_³ek_d©a
 = 
¿ndom_by‹s
[0];

110 
·d_to_Ën_by‹s
 = 
çl£
;

113 
¿ndom_by‹s
 = 
m_fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<
ušt8_t
>(

114 
m_fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
Ën
));

116 ià(
¿ndom_by‹s
.
	`em±y
()) {

117 cÚ¡ 
ssize_t
 
r
 = 
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
() ? 0 : -1;

118 ià(
r
 == -1) {

119 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
»cv_”ºos
);

121  
r
;

123 
¡d
::
	`memıy
(
buf
, 
¿ndom_by‹s
.
	`d©a
(),„ªdom_by‹s.
	`size
());

124 ià(
·d_to_Ën_by‹s
) {

125 ià(
Ën
 > 
¿ndom_by‹s
.
	`size
()) {

126 
¡d
::
	`mem£t
((*)
buf
 + 
¿ndom_by‹s
.
	`size
(), 0, 
Ën
 -„andom_bytes.size());

128  
Ën
;

130 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è&& 
¡d
::
	`g‘’v
("FUZZED_SOCKET_FAKE_LATENCY"è!ğ
nuÎ±r
) {

131 
¡d
::
this_th»ad
::
	`¦“p_fÜ
(¡d::
chrÚo
::
mli£cÚds
{2});

133  
¿ndom_by‹s
.
	`size
();

134 
	}
}

136 
	gFuzzedSock
::
	$CÚÃù
(cÚ¡ 
sockaddr
*, 
sockËn_t
) const

141 
cÚ¡ex´
 
¡d
::
¬¿y
 
cÚÃù_”ºos
{

142 
ECONNREFUSED
,

143 
EAGAIN
,

144 
ECONNRESET
,

145 
EHOSTUNREACH
,

146 
EINPROGRESS
,

147 
EINTR
,

148 
ENETUNREACH
,

149 
ETIMEDOUT
,

151 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

152 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
cÚÃù_”ºos
);

156 
	}
}

158 
	gFuzzedSock
::
	$Bšd
(cÚ¡ 
sockaddr
*, 
sockËn_t
) const

165 
cÚ¡ex´
 
¡d
::
¬¿y
 
bšd_”ºos
{

166 
EACCES
,

167 
EADDRINUSE
,

168 
EADDRNOTAVAIL
,

169 
EAGAIN
,

171 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

172 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
bšd_”ºos
);

176 
	}
}

178 
	gFuzzedSock
::
	$Li¡’
() const

185 
cÚ¡ex´
 
¡d
::
¬¿y
 
li¡’_”ºos
{

186 
EADDRINUSE
,

187 
EINVAL
,

188 
EOPNOTSUPP
,

190 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

191 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
li¡’_”ºos
);

195 
	}
}

197 
	g¡d
::
unique_±r
<
Sock
> 
FuzzedSock
::
	$Acû±
(
sockaddr
* 
addr
, 
sockËn_t
* 
addr_Ën
) const

199 
cÚ¡ex´
 
¡d
::
¬¿y
 
acû±_”ºos
{

200 
ECONNABORTED
,

201 
EINTR
,

202 
ENOMEM
,

204 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

205 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
acû±_”ºos
);

206  
¡d
::
unique_±r
<
FuzzedSock
>();

208  
¡d
::
make_unique
<
FuzzedSock
>(
m_fuzzed_d©a_´ovid”
);

209 
	}
}

211 
	gFuzzedSock
::
	$G‘SockO±
(
Ëv–
, 
İt_Çme
, * 
İt_v®
, 
sockËn_t
* 
İt_Ën
) const

213 
cÚ¡ex´
 
¡d
::
¬¿y
 
g‘sockİt_”ºos
{

214 
ENOMEM
,

215 
ENOBUFS
,

217 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

218 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
g‘sockİt_”ºos
);

221 ià(
İt_v®
 =ğ
nuÎ±r
) {

224 
¡d
::
	`memıy
(
İt_v®
,

225 
	`CÚsumeFixedL’gthBy‹VeùÜ
(
m_fuzzed_d©a_´ovid”
, *
İt_Ën
).
	`d©a
(),

226 *
İt_Ën
);

228 
	}
}

230 
	gFuzzedSock
::
	$S‘SockO±
(, , cÚ¡ *, 
sockËn_t
) const

232 
cÚ¡ex´
 
¡d
::
¬¿y
 
£tsockİt_”ºos
{

233 
ENOMEM
,

234 
ENOBUFS
,

236 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

237 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
£tsockİt_”ºos
);

241 
	}
}

243 
	gFuzzedSock
::
	$G‘SockName
(
sockaddr
* 
Çme
, 
sockËn_t
* 
Çme_Ën
) const

245 
cÚ¡ex´
 
¡d
::
¬¿y
 
g‘sockÇme_”ºos
{

246 
ECONNRESET
,

247 
ENOBUFS
,

249 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

250 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
g‘sockÇme_”ºos
);

253 *
Çme_Ën
 = 
m_fuzzed_d©a_´ovid”
.
	`CÚsumeD©a
(
Çme
, *name_len);

255 
	}
}

257 
boŞ
 
	gFuzzedSock
::
	$S‘NÚBlockšg
() const

259 
cÚ¡ex´
 
¡d
::
¬¿y
 
£ŠÚblockšg_”ºos
{

260 
EBADF
,

261 
EPERM
,

263 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

264 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
£ŠÚblockšg_”ºos
);

265  
çl£
;

267  
Œue
;

268 
	}
}

270 
boŞ
 
	gFuzzedSock
::
	$IsS–eùabË
() const

272  
m_£ËùabË
;

273 
	}
}

275 
boŞ
 
	gFuzzedSock
::
	$Wa™
(
¡d
::
chrÚo
::
mli£cÚds
 
timeout
, 
Ev’t
 
»que¡ed
, Ev’t* 
occu¼ed
) const

277 
cÚ¡ex´
 
¡d
::
¬¿y
 
wa™_”ºos
{

278 
EBADF
,

279 
EINTR
,

280 
EINVAL
,

282 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

283 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
, 
wa™_”ºos
);

284  
çl£
;

286 ià(
occu¼ed
 !ğ
nuÎ±r
) {

287 *
occu¼ed
 = 
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è? 
»que¡ed
 : 0;

289  
Œue
;

290 
	}
}

292 
boŞ
 
	gFuzzedSock
::
	$Wa™Mªy
(
¡d
::
chrÚo
::
mli£cÚds
 
timeout
, 
Ev’tsP”Sock
& 
ev’ts_³r_sock
) const

294 auto& [
sock
, 
ev’ts
] : 
ev’ts_³r_sock
) {

295 ()
sock
;

296 
ev’ts
.
occu¼ed
 = 
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è?ƒv’ts.
»que¡ed
 : 0;

298  
Œue
;

299 
	}
}

301 
boŞ
 
	gFuzzedSock
::
	$IsCÚÃùed
(
¡d
::
¡ršg
& 
”rmsg
) const

303 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

304  
Œue
;

306 
”rmsg
 = "disconnected‡t„andom byhe fuzzer";

307  
çl£
;

308 
	}
}

310 
	$FlNode
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, 
CÚnmªTe¡Msg
& 
cÚnmª
, 
CNode
& 
node
è
nÛxû±


312 
cÚnmª
.
	`Hªdshake
(
node
,

313  
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(),

314  
	`CÚsumeW—kEnum
(
fuzzed_d©a_´ovid”
, 
ALL_SERVICE_FLAGS
),

315  
	`CÚsumeW—kEnum
(
fuzzed_d©a_´ovid”
, 
ALL_SERVICE_FLAGS
),

316  
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
št32_t
>(
MIN_PEER_PROTO_VERSION
, 
¡d
::
num”ic_lim™s
<št32_t>::
	`max
()),

317  
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
());

318 
	}
}

320 
CAmouÁ
 
CÚsumeMÚey
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::
İtiÚ®
<CAmouÁ>& 
max
è
nÛxû±


322  
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
CAmouÁ
>(0, 
	gmax
.
v®ue_Ü
(
MAX_MONEY
));

325 
št64_t
 
CÚsumeTime
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::
İtiÚ®
<št64_t>& 
mš
, cÚ¡ std::İtiÚ®<št64_t>& 
max
è
nÛxû±


328 cÚ¡ 
št64_t
 
time_mš
{946684801};

329 cÚ¡ 
št64_t
 
	gtime_max
{4133980799};

330  
	gfuzzed_d©a_´ovid”
.
	gCÚsumeIÁeg¿lInRªge
<
	gšt64_t
>(
	gmš
.
v®ue_Ü
(
time_mš
), 
	gmax
.v®ue_Ü(
time_max
));

333 
CMubËT¿n§ùiÚ
 
CÚsumeT¿n§ùiÚ
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::
İtiÚ®
<¡d::
veùÜ
<
ušt256
>>& 
´evout_txids
, cÚ¡ 
max_num_š
, cÚ¡ 
max_num_out
è
	gnÛxû±


335 
CMubËT¿n§ùiÚ
 
	gtx_mut
;

336 cÚ¡‡utØ
	gp2wsh_İ_Œue
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
();

337 
	gtx_mut
.
	gnV”siÚ
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBoŞ
() ?

338 
CT¿n§ùiÚ
::
CURRENT_VERSION
 :

339 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št32_t
>();

340 
	gtx_mut
.
	gnLockTime
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt32_t
>();

341 cÚ¡‡utØ
	gnum_š
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 
	gmax_num_š
);

342 cÚ¡‡utØ
	gnum_out
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 
	gmax_num_out
);

343 
	gi
 = 0; i < 
	gnum_š
; ++i) {

344 cÚ¡‡uto& 
	gtxid_´ev
 = 
´evout_txids
 ?

345 
PickV®ue
(
fuzzed_d©a_´ovid”
, *
´evout_txids
) :

346 
CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
);

347 cÚ¡‡utØ
	gšdex_out
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
ušt32_t
>(0, 
	gmax_num_out
);

348 cÚ¡‡utØ
	g£qu’û
 = 
CÚsumeSequ’û
(
fuzzed_d©a_´ovid”
);

349 cÚ¡‡utØ
	gsüt_sig
 = 
p2wsh_İ_Œue
 ? 
CSüt
{} : 
CÚsumeSüt
(
fuzzed_d©a_´ovid”
);

350 
CSütW™Ãss
 
	gsüt_w™
;

351 ià(
	gp2wsh_İ_Œue
) {

352 
	gsüt_w™
.
	g¡ack
 = 
¡d
::
veùÜ
<¡d::veùÜ<
ušt8_t
>>{
WITNESS_STACK_ELEM_OP_TRUE
};

354 
	gsüt_w™
 = 
CÚsumeSütW™Ãss
(
fuzzed_d©a_´ovid”
);

356 
CTxIn
 
	gš
;

357 
	gš
.
	g´evout
 = 
COutPošt
{
txid_´ev
, 
šdex_out
};

358 
	gš
.
	gnSequ’û
 = 
£qu’û
;

359 
	gš
.
	gsütSig
 = 
süt_sig
;

360 
	gš
.
	gsütW™Ãss
 = 
süt_w™
;

362 
	gtx_mut
.
	gvš
.
push_back
(
š
);

364 
	gi
 = 0; i < 
	gnum_out
; ++i) {

365 cÚ¡‡utØ
	gamouÁ
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
CAmouÁ
>(-10, 50 * 
	gCOIN
 + 10);

366 cÚ¡‡utØ
	gsüt_pk
 = 
p2wsh_İ_Œue
 ?

367 
P2WSH_OP_TRUE
 :

368 
CÚsumeSüt
(
fuzzed_d©a_´ovid”
, 
Œue
);

369 
	gtx_mut
.
	gvout
.
em¶aû_back
(
amouÁ
, 
süt_pk
);

371  
	gtx_mut
;

374 
CSütW™Ãss
 
	$CÚsumeSütW™Ãss
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
size_t
 
max_¡ack_–em_size
è
nÛxû±


376 
CSütW™Ãss
 
»t
;

377 cÚ¡‡utØ
n_–em’ts
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
size_t
>(0, 
max_¡ack_–em_size
);

378 
size_t
 
i
 = 0; i < 
n_–em’ts
; ++i) {

379 
»t
.
¡ack
.
	`push_back
(
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
));

381  
»t
;

382 
	}
}

384 
CSüt
 
	$CÚsumeSüt
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
boŞ
 
maybe_p2wsh
è
nÛxû±


386 
CSüt
 
r_süt
{};

390 
cÚ¡ex´
 
MAX_BUFFER_SZ
{128};

391 
¡d
::
veùÜ
<
ušt8_t
> 
	`bufãr
(
MAX_BUFFER_SZ
, uint8_t{'a'});

392 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

393 
	`C®lOÃOf
(

394 
fuzzed_d©a_´ovid”
,

397 
r_süt
.
	`š£¹
Ô_süt.
	`’d
(), 
bufãr
.
	`begš
(), bufãr.begš(è+ 
fuzzed_d©a_´ovid”
.
	`CÚsumeIÁeg¿lInRªge
(0U, 
MAX_BUFFER_SZ
));

401 
r_süt
 << 
¡d
::
veùÜ
<
ušt8_t
>{
bufãr
.
	`begš
(), bufãr.begš(è+ 
fuzzed_d©a_´ovid”
.
	`CÚsumeIÁeg¿lInRªge
(0U, 
MAX_BUFFER_SZ
)};

407 
r_süt
 << 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
št64_t
>(0, 22);

408 
num_d©a
{
fuzzed_d©a_´ovid”
.
	`CÚsumeIÁeg¿lInRªge
(1, 22)};

409 
¡d
::
veùÜ
<
ušt8_t
> 
pubkey_comp
{
bufãr
.
	`begš
(), bufãr.begš(è+ 
CPubKey
::
COMPRESSED_SIZE
};

410 
pubkey_comp
.
	`äÚt
(èğ
fuzzed_d©a_´ovid”
.
	`CÚsumeIÁeg¿lInRªge
(2, 3);

411 
¡d
::
veùÜ
<
ušt8_t
> 
pubkey_uncomp
{
bufãr
.
	`begš
(), bufãr.begš(è+ 
CPubKey
::
SIZE
};

412 
pubkey_uncomp
.
	`äÚt
(èğ
fuzzed_d©a_´ovid”
.
	`CÚsumeIÁeg¿lInRªge
(4, 7);

413 
num_d©a
--) {

414 auto& 
pubkey
{
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è? 
pubkey_uncomp
 : 
pubkey_comp
};

415 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

416 
pubkey
.
	`back
(èğ
num_d©a
;

418 
r_süt
 << 
pubkey
;

420 
r_süt
 << 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
št64_t
>(0, 22);

424 cÚ¡‡utØ
vec
{
	`CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
MAX_BUFFER_SZ
)};

425 
¡d
::
	`cİy
(
vec
.
	`begš
(), vec.
	`’d
(), 
bufãr
.begin());

429 
r_süt
 << 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>();

433 
r_süt
 << 
	`CÚsumeOpcodeTy³
(
fuzzed_d©a_´ovid”
);

437 
r_süt
 << 
	`CÚsumeSütNum
(
fuzzed_d©a_´ovid”
);

441 ià(
maybe_p2wsh
 && 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

442 
ušt256
 
süt_hash
;

443 
	`CSHA256
().
	`Wr™e
(
r_süt
.
	`d©a
(),„_süt.
	`size
()).
	`Fš®ize
(
süt_hash
.
	`begš
());

444 
r_süt
.
	`ş—r
();

445 
r_süt
 << 
OP_0
 << 
	`ToBy‹VeùÜ
(
süt_hash
);

447  
r_süt
;

448 
	}
}

450 
ušt32_t
 
	$CÚsumeSequ’û
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


452  
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
() ?

453 
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
({

454 
CTxIn
::
SEQUENCE_FINAL
,

455 
CTxIn
::
MAX_SEQUENCE_NONFINAL
,

456 
MAX_BIP125_RBF_SEQUENCE
,

458 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt32_t
>();

459 
	}
}

461 
CTxDe¡š©iÚ
 
	$CÚsumeTxDe¡š©iÚ
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


463 
CTxDe¡š©iÚ
 
tx_de¡š©iÚ
;

464 cÚ¡ 
size_t
 
ÿÎ_size
{
	`C®lOÃOf
(

465 
fuzzed_d©a_´ovid”
,

467 
tx_de¡š©iÚ
 = 
CNoDe¡š©iÚ
{};

470 
tx_de¡š©iÚ
 = 
PKHash
{
	`CÚsumeUIÁ160
(
fuzzed_d©a_´ovid”
)};

473 
tx_de¡š©iÚ
 = 
SütHash
{
	`CÚsumeUIÁ160
(
fuzzed_d©a_´ovid”
)};

476 
tx_de¡š©iÚ
 = 
W™ÃssV0SütHash
{
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
)};

479 
tx_de¡š©iÚ
 = 
W™ÃssV0KeyHash
{
	`CÚsumeUIÁ160
(
fuzzed_d©a_´ovid”
)};

482 
tx_de¡š©iÚ
 = 
W™ÃssV1T­roÙ
{
XOÆyPubKey
{
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
)}};

485 
W™ÃssUnknown
 
w™Ãss_unknown
{};

486 
w™Ãss_unknown
.
v”siÚ
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeIÁeg¿lInRªge
(2, 16);

487 
¡d
::
veùÜ
<
ušt8_t
> 
w™Ãss_unknown_´og¿m_1
{
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<uint8_t>(40)};

488 ià(
w™Ãss_unknown_´og¿m_1
.
	`size
() < 2) {

489 
w™Ãss_unknown_´og¿m_1
 = {0, 0};

491 
w™Ãss_unknown
.
Ëngth
 = 
w™Ãss_unknown_´og¿m_1
.
	`size
();

492 
¡d
::
	`cİy
(
w™Ãss_unknown_´og¿m_1
.
	`begš
(), w™Ãss_unknown_´og¿m_1.
	`’d
(), 
w™Ãss_unknown
.
´og¿m
);

493 
tx_de¡š©iÚ
 = 
w™Ãss_unknown
;

495 
	`As£¹
(
ÿÎ_size
 =ğ
¡d
::
v¬ŸÁ_size_v
<
CTxDe¡š©iÚ
>);

496  
tx_de¡š©iÚ
;

497 
	}
}

499 
boŞ
 
	$CÚšsS³ÁIÅut
(cÚ¡ 
CT¿n§ùiÚ
& 
tx
, cÚ¡ 
CCošsV›wCache
& 
šputs
è
nÛxû±


501 cÚ¡ 
CTxIn
& 
tx_š
 : 
tx
.
vš
) {

502 cÚ¡ 
Coš
& 
coš
 = 
šputs
.
	`AcûssCoš
(
tx_š
.
´evout
);

503 ià(
coš
.
	`IsS³Á
()) {

504  
Œue
;

507  
çl£
;

508 
	}
}

510 
CN‘Addr
 
	$CÚsumeN‘Addr
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


512 cÚ¡ 
N‘wÜk
 
ÃtwÜk
 = 
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
({N‘wÜk::
NET_IPV4
, N‘wÜk::
NET_IPV6
, N‘wÜk::
NET_INTERNAL
, N‘wÜk::
NET_ONION
});

513 
CN‘Addr
 
Ãt_addr
;

514 ià(
ÃtwÜk
 =ğ
N‘wÜk
::
NET_IPV4
) {

515 
š_addr
 
v4_addr
 = {};

516 
v4_addr
.
s_addr
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt32_t
>();

517 
Ãt_addr
 = 
CN‘Addr
{
v4_addr
};

518 } ià(
ÃtwÜk
 =ğ
N‘wÜk
::
NET_IPV6
) {

519 ià(
fuzzed_d©a_´ovid”
.
	`»maššg_by‹s
() >= 16) {

520 
š6_addr
 
v6_addr
 = {};

521 
	`memıy
(
v6_addr
.
s6_addr
, 
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<
ušt8_t
>(16).
	`d©a
(), 16);

522 
Ãt_addr
 = 
CN‘Addr
{
v6_addr
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ušt32_t
>()};

524 } ià(
ÃtwÜk
 =ğ
N‘wÜk
::
NET_INTERNAL
) {

525 
Ãt_addr
.
	`S‘IÁ”Çl
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBy‹sAsSŒšg
(32));

526 } ià(
ÃtwÜk
 =ğ
N‘wÜk
::
NET_ONION
) {

527 
Ãt_addr
.
	`S‘S³cŸl
(
fuzzed_d©a_´ovid”
.
	`CÚsumeBy‹sAsSŒšg
(32));

529  
Ãt_addr
;

530 
	}
}

532 
CAdd»ss
 
	$CÚsumeAdd»ss
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


534  {
	`CÚsumeS”viû
(
fuzzed_d©a_´ovid”
), 
	`CÚsumeW—kEnum
(fuzzed_d©a_´ovid”, 
ALL_SERVICE_FLAGS
), 
NodeSecÚds
{
¡d
::
chrÚo
::
£cÚds
{fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿l
<
ušt32_t
>()}}};

535 
	}
}

537 
FILE
* 
	gFuzzedFeProvid”
::
	$İ’
()

539 
	`S‘FuzzedE¼No
(
m_fuzzed_d©a_´ovid”
);

540 ià(
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

541  
nuÎ±r
;

543 
¡d
::
¡ršg
 
mode
;

544 
	`C®lOÃOf
(

545 
m_fuzzed_d©a_´ovid”
,

547 
mode
 = "r";

550 
mode
 = "r+";

553 
mode
 = "w";

556 
mode
 = "w+";

559 
mode
 = "a";

562 
mode
 = "a+";

564 #ià
defšed
 
_GNU_SOURCE
 && !defšed 
__ANDROID__


565 cÚ¡ 
cook›_io_funùiÚs_t
 
io_hooks
 = {

566 
FuzzedFeProvid”
::
»ad
,

567 
FuzzedFeProvid”
::
wr™e
,

568 
FuzzedFeProvid”
::
£ek
,

569 
FuzzedFeProvid”
::
şo£
,

571  
	`fİ’cook›
(
this
, 
mode
.
	`c_¡r
(), 
io_hooks
);

573 ()
mode
;

574  
nuÎ±r
;

576 
	}
}

578 
ssize_t
 
	gFuzzedFeProvid”
::
	$»ad
(* 
cook›
, * 
buf
, 
size_t
 
size
)

580 
FuzzedFeProvid”
* 
fuzzed_fe
 = (FuzzedFeProvid”*)
cook›
;

581 
	`S‘FuzzedE¼No
(
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
);

582 ià(
buf
 =ğ
nuÎ±r
 || 
size
 =ğ0 || 
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

583  
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
() ? 0 : -1;

585 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s
 = 
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<ušt8_t>(
size
);

586 ià(
¿ndom_by‹s
.
	`em±y
()) {

589 
¡d
::
	`memıy
(
buf
, 
¿ndom_by‹s
.
	`d©a
(),„ªdom_by‹s.
	`size
());

590 ià(
	`Add™iÚOv”æow
(
fuzzed_fe
->
m_off£t
, (
št64_t
)
¿ndom_by‹s
.
	`size
())) {

591  
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
() ? 0 : -1;

593 
fuzzed_fe
->
m_off£t
 +ğ
¿ndom_by‹s
.
	`size
();

594  
¿ndom_by‹s
.
	`size
();

595 
	}
}

597 
ssize_t
 
	gFuzzedFeProvid”
::
	$wr™e
(* 
cook›
, cÚ¡ * 
buf
, 
size_t
 
size
)

599 
FuzzedFeProvid”
* 
fuzzed_fe
 = (FuzzedFeProvid”*)
cook›
;

600 
	`S‘FuzzedE¼No
(
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
);

601 cÚ¡ 
ssize_t
 
n
 = 
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<ssize_t>(0, 
size
);

602 ià(
	`Add™iÚOv”æow
(
fuzzed_fe
->
m_off£t
, (
št64_t
)
n
)) {

605 
fuzzed_fe
->
m_off£t
 +ğ
n
;

606  
n
;

607 
	}
}

609 
	gFuzzedFeProvid”
::
	$£ek
(* 
cook›
, 
št64_t
* 
off£t
, 
wh’û
)

611 
	`as£¹
(
wh’û
 =ğ
SEEK_SET
 || wh’û =ğ
SEEK_CUR
 || wh’û =ğ
SEEK_END
);

612 
FuzzedFeProvid”
* 
fuzzed_fe
 = (FuzzedFeProvid”*)
cook›
;

613 
	`S‘FuzzedE¼No
(
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
);

614 
št64_t
 
Ãw_off£t
 = 0;

615 ià(
wh’û
 =ğ
SEEK_SET
) {

616 
Ãw_off£t
 = *
off£t
;

617 } ià(
wh’û
 =ğ
SEEK_CUR
) {

618 ià(
	`Add™iÚOv”æow
(
fuzzed_fe
->
m_off£t
, *
off£t
)) {

621 
Ãw_off£t
 = 
fuzzed_fe
->
m_off£t
 + *
off£t
;

622 } ià(
wh’û
 =ğ
SEEK_END
) {

623 cÚ¡ 
št64_t
 
n
 = 
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<int64_t>(0, 4096);

624 ià(
	`Add™iÚOv”æow
(
n
, *
off£t
)) {

627 
Ãw_off£t
 = 
n
 + *
off£t
;

629 ià(
Ãw_off£t
 < 0) {

632 
fuzzed_fe
->
m_off£t
 = 
Ãw_off£t
;

633 *
off£t
 = 
Ãw_off£t
;

634  
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(-1, 0);

635 
	}
}

637 
	gFuzzedFeProvid”
::
	$şo£
(* 
cook›
)

639 
FuzzedFeProvid”
* 
fuzzed_fe
 = (FuzzedFeProvid”*)
cook›
;

640 
	`S‘FuzzedE¼No
(
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
);

641  
fuzzed_fe
->
m_fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(-1, 0);

642 
	}
}

	@util.h

5 #iâdeà
BITCOIN_TEST_FUZZ_UTIL_H


6 
	#BITCOIN_TEST_FUZZ_UTIL_H


	)

8 
	~<¬™h_ušt256.h
>

9 
	~<chaš·¿msba£.h
>

10 
	~<cošs.h
>

11 
	~<com·t/com·t.h
>

12 
	~<cÚ£nsus/amouÁ.h
>

13 
	~<cÚ£nsus/cÚ£nsus.h
>

14 
	~<m”kËblock.h
>

15 
	~<Ãt.h
>

16 
	~<Ãdd»ss.h
>

17 
	~<Ãtba£.h
>

18 
	~<´im™ives/Œª§ùiÚ.h
>

19 
	~<süt/süt.h
>

20 
	~<süt/¡ªd¬d.h
>

21 
	~<£rŸlize.h
>

22 
	~<¡»ams.h
>

23 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

24 
	~<‹¡/fuzz/fuzz.h
>

25 
	~<‹¡/ut/Ãt.h
>

26 
	~<ušt256.h
>

27 
	~<v”siÚ.h
>

29 
	~<®gÜ™hm
>

30 
	~<¬¿y
>

31 
	~<c¡dšt
>

32 
	~<c¡dio
>

33 
	~<İtiÚ®
>

34 
	~<¡ršg
>

35 
	~<veùÜ
>

37 
şass
 
	gP“rMªag”
;

39 şas 
	cFuzzedSock
 : 
public
 
Sock


41 
FuzzedD©aProvid”
& 
m_fuzzed_d©a_´ovid”
;

48 
mubË
 
	m¡d
::
İtiÚ®
<
ušt8_t
> 
m_³ek_d©a
;

55 cÚ¡ 
boŞ
 
	mm_£ËùabË
;

57 
	mpublic
:

58 
ex¶ic™
 
FuzzedSock
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
);

60 ~
	$FuzzedSock
(è
ov”ride
;

62 
FuzzedSock
& 
İ”©Ü
=(
Sock
&& 
Ùh”
è
ov”ride
;

64 
ssize_t
 
	$S’d
(cÚ¡ * 
d©a
, 
size_t
 
Ën
, 
æags
ècÚ¡ 
ov”ride
;

66 
ssize_t
 
	$Recv
(* 
buf
, 
size_t
 
Ën
, 
æags
ècÚ¡ 
ov”ride
;

68 
	$CÚÃù
(cÚ¡ 
sockaddr
*, 
sockËn_t
ècÚ¡ 
ov”ride
;

70 
	$Bšd
(cÚ¡ 
sockaddr
*, 
sockËn_t
ècÚ¡ 
ov”ride
;

72 
	$Li¡’
(
backlog
ècÚ¡ 
ov”ride
;

74 
¡d
::
unique_±r
<
Sock
> 
	$Acû±
(
sockaddr
* 
addr
, 
sockËn_t
* 
addr_Ën
ècÚ¡ 
ov”ride
;

76 
	$G‘SockO±
(
Ëv–
, 
İt_Çme
, * 
İt_v®
, 
sockËn_t
* 
İt_Ën
ècÚ¡ 
ov”ride
;

78 
	$S‘SockO±
(
Ëv–
, 
İt_Çme
, cÚ¡ * 
İt_v®
, 
sockËn_t
 
İt_Ën
ècÚ¡ 
ov”ride
;

80 
	$G‘SockName
(
sockaddr
* 
Çme
, 
sockËn_t
* 
Çme_Ën
ècÚ¡ 
ov”ride
;

82 
boŞ
 
	$S‘NÚBlockšg
(ècÚ¡ 
ov”ride
;

84 
boŞ
 
	$IsS–eùabË
(ècÚ¡ 
ov”ride
;

86 
boŞ
 
	$Wa™
(
¡d
::
chrÚo
::
mli£cÚds
 
timeout
, 
Ev’t
 
»que¡ed
, Ev’t* 
occu¼ed
 = 
nuÎ±r
ècÚ¡ 
ov”ride
;

88 
boŞ
 
	$Wa™Mªy
(
¡d
::
chrÚo
::
mli£cÚds
 
timeout
, 
Ev’tsP”Sock
& 
ev’ts_³r_sock
ècÚ¡ 
ov”ride
;

90 
boŞ
 
	$IsCÚÃùed
(
¡d
::
¡ršg
& 
”rmsg
ècÚ¡ 
ov”ride
;

93 [[
nodisÿrd
]] 
šlše
 
FuzzedSock
 
	$CÚsumeSock
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
)

95  
FuzzedSock
{
fuzzed_d©a_´ovid”
};

96 
	}
}

98 
	g‹m¶©e
 <
	gty³Çme
... 
	gC®ÏbËs
>

99 
size_t
 
	$C®lOÃOf
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, 
C®ÏbËs
... 
ÿÎabËs
)

101 
cÚ¡ex´
 
size_t
 
ÿÎ_size
{...(
ÿÎabËs
)};

102 
	`¡©ic_as£¹
(
ÿÎ_size
 >= 1);

103 cÚ¡ 
size_t
 
ÿÎ_šdex
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
ÿÎ_size
 - 1)};

105 
size_t
 
i
{0};

106 ((
i
++ =ğ
ÿÎ_šdex
 ? 
	`ÿÎabËs
() : ()), ...);

107  
ÿÎ_size
;

108 
	}
}

110 
	g‹m¶©e
 <
ty³Çme
 
	gCŞËùiÚ
>

111 auto& 
	$PickV®ue
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, 
CŞËùiÚ
& 
cŞ
)

113 cÚ¡‡utØ
sz
 = 
cŞ
.
	`size
();

114 
	`as£¹
(
sz
 >= 1);

115 autØ
™
 = 
cŞ
.
	`begš
();

116 
¡d
::
	`advªû
(
™
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
	`deşty³
(
sz
)>(0, sz - 1));

117  *
™
;

118 
	}
}

120 [[
nodisÿrd
]] 
šlše
 
	g¡d
::
veùÜ
<
ušt8_t
> 
CÚsumeRªdomL’gthBy‹VeùÜ
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::
İtiÚ®
<
size_t
>& 
max_Ëngth
 = std::
nuÎİt
è
nÛxû±


122 cÚ¡ 
¡d
::
¡ršg
 
s
 = 
max_Ëngth
 ?

123 
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
(*
max_Ëngth
) :

124 
fuzzed_d©a_´ovid”
.
CÚsumeRªdomL’gthSŒšg
();

125  {
	gs
.
begš
(), s.
’d
()};

128 [[
nodisÿrd
]] 
šlše
 
	g¡d
::
veùÜ
<
boŞ
> 
CÚsumeRªdomL’gthB™VeùÜ
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::
İtiÚ®
<
size_t
>& 
max_Ëngth
 = std::
nuÎİt
è
nÛxû±


130  
By‹sToB™s
(
CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
max_Ëngth
));

133 [[
nodisÿrd
]] 
šlše
 
CD©aSŒ—m
 
CÚsumeD©aSŒ—m
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::
İtiÚ®
<
size_t
>& 
max_Ëngth
 = std::
nuÎİt
è
nÛxû±


135  
CD©aSŒ—m
{
CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
max_Ëngth
), 
SER_NETWORK
, 
INIT_PROTO_VERSION
};

138 [[
nodisÿrd
]] 
šlše
 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
	$CÚsumeRªdomL’gthSŒšgVeùÜ
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
size_t
 
max_veùÜ_size
 = 16, cÚ¡ size_ˆ
max_¡ršg_Ëngth
 = 16è
nÛxû±


140 cÚ¡ 
size_t
 
n_–em’ts
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
max_veùÜ_size
);

141 
¡d
::
veùÜ
<¡d::
¡ršg
> 
r
;

142 
size_t
 
i
 = 0; i < 
n_–em’ts
; ++i) {

143 
r
.
	`push_back
(
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(
max_¡ršg_Ëngth
));

145  
r
;

146 
	}
}

148 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

149 [[
nodisÿrd
]] 
šlše
 
	g¡d
::
veùÜ
<
T
> 
	$CÚsumeRªdomL’gthIÁeg¿lVeùÜ
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
size_t
 
max_veùÜ_size
 = 16è
nÛxû±


151 cÚ¡ 
size_t
 
n_–em’ts
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<size_t>(0, 
max_veùÜ_size
);

152 
¡d
::
veùÜ
<
T
> 
r
;

153 
size_t
 
i
 = 0; i < 
n_–em’ts
; ++i) {

154 
r
.
	`push_back
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
T
>());

156  
r
;

157 
	}
}

159 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

160 [[
nodisÿrd
]] 
šlše
 
	g¡d
::
İtiÚ®
<
T
> 
CÚsumeDe£rŸlizabË
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::İtiÚ®<
size_t
>& 
max_Ëngth
 = std::
nuÎİt
è
nÛxû±


162 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
bufãr
 = 
CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
, 
max_Ëngth
);

163 
CD©aSŒ—m
 
	gds
{
	gbufãr
, 
	gSER_NETWORK
, 
	gINIT_PROTO_VERSION
};

164 
T
 
	gobj
;

165 
	gŒy
 {

166 
	gds
 >> 
	gobj
;

167 } 
ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

168  
¡d
::
nuÎİt
;

170  
	gobj
;

173 
	g‹m¶©e
 <
ty³Çme
 
	gW—kEnumTy³
, 
size_t
 
	gsize
>

174 [[
nodisÿrd
]] 
W—kEnumTy³
 
CÚsumeW—kEnum
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ W—kEnumTy³ (&
®l_ty³s
)[
size
]è
	gnÛxû±


176  
	gfuzzed_d©a_´ovid”
.
CÚsumeBoŞ
() ?

177 
	gfuzzed_d©a_´ovid”
.
	gPickV®ueInA¼ay
<
	gW—kEnumTy³
>(
	g®l_ty³s
) :

178 
W—kEnumTy³
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
ty³Çme
 
¡d
::
und”lyšg_ty³
<W—kEnumTy³>::
ty³
>());

181 [[
nodisÿrd
]] 
šlše
 
İcod‘y³
 
	$CÚsumeOpcodeTy³
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


183  
¡©ic_ÿ¡
<
İcod‘y³
>(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
ušt32_t
>(0, 
MAX_OPCODE
));

184 
	}
}

186 [[
nodisÿrd
]] 
CAmouÁ
 
CÚsumeMÚey
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::
İtiÚ®
<CAmouÁ>& 
max
 = std::
nuÎİt
è
nÛxû±
;

188 [[
nodisÿrd
]] 
št64_t
 
CÚsumeTime
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::
İtiÚ®
<št64_t>& 
mš
 = std::
nuÎİt
, cÚ¡ std::İtiÚ®<št64_t>& 
max
 = std::nuÎİtè
nÛxû±
;

190 [[
nodisÿrd
]] 
CMubËT¿n§ùiÚ
 
CÚsumeT¿n§ùiÚ
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::
İtiÚ®
<¡d::
veùÜ
<
ušt256
>>& 
´evout_txids
, cÚ¡ 
max_num_š
 = 10, cÚ¡ 
max_num_out
 = 10è
nÛxû±
;

192 [[
nodisÿrd
]] 
CSütW™Ãss
 
	$CÚsumeSütW™Ãss
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
size_t
 
max_¡ack_–em_size
 = 32è
nÛxû±
;

194 [[
nodisÿrd
]] 
CSüt
 
	$CÚsumeSüt
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
boŞ
 
maybe_p2wsh
 = 
çl£
è
nÛxû±
;

196 [[
nodisÿrd
]] 
ušt32_t
 
	$CÚsumeSequ’û
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±
;

198 [[
nodisÿrd
]] 
šlše
 
CSütNum
 
	$CÚsumeSütNum
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


200  
CSütNum
{
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<
št64_t
>()};

201 
	}
}

203 [[
nodisÿrd
]] 
šlše
 
ušt160
 
	$CÚsumeUIÁ160
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


205 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
v160
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<uint8_t>(160 / 8);

206 ià(
v160
.
	`size
() != 160 / 8) {

209  
ušt160
{
v160
};

210 
	}
}

212 [[
nodisÿrd
]] 
šlše
 
ušt256
 
	$CÚsumeUIÁ256
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


214 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
v256
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<uint8_t>(256 / 8);

215 ià(
v256
.
	`size
() != 256 / 8) {

218  
ušt256
{
v256
};

219 
	}
}

221 [[
nodisÿrd
]] 
šlše
 
¬™h_ušt256
 
	$CÚsumeAr™hUIÁ256
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


223  
	`UštToAr™h256
(
	`CÚsumeUIÁ256
(
fuzzed_d©a_´ovid”
));

224 
	}
}

226 [[
nodisÿrd
]] 
CTxDe¡š©iÚ
 
	$CÚsumeTxDe¡š©iÚ
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±
;

228 
‹m¶©e
 <
ty³Çme
 
T
>

229 [[
nodisÿrd
]] 
boŞ
 
	$MuÉliÿtiÚOv”æow
(cÚ¡ 
T
 
i
, cÚ¡ T 
j
è
nÛxû±


231 
	`¡©ic_as£¹
(
¡d
::
is_š‹g¿l
<
T
>::
v®ue
, "Integral„equired.");

232 ià(
¡d
::
num”ic_lim™s
<
T
>::
is_sigÃd
) {

233 ià(
i
 > 0) {

234 ià(
j
 > 0) {

235  
i
 > (
¡d
::
num”ic_lim™s
<
T
>::
	`max
(è/ 
j
);

237  
j
 < (
¡d
::
num”ic_lim™s
<
T
>::
	`mš
(è/ 
i
);

240 ià(
j
 > 0) {

241  
i
 < (
¡d
::
num”ic_lim™s
<
T
>::
	`mš
(è/ 
j
);

243  
i
 !ğ0 && (
j
 < (
¡d
::
num”ic_lim™s
<
T
>::
	`max
() / i));

247  
j
 !ğ0 && 
i
 > 
¡d
::
num”ic_lim™s
<
T
>::
	`max
() / j;

249 
	}
}

251 [[
nodisÿrd
]] 
boŞ
 
	$CÚšsS³ÁIÅut
(cÚ¡ 
CT¿n§ùiÚ
& 
tx
, cÚ¡ 
CCošsV›wCache
& 
šputs
è
nÛxû±
;

256 
‹m¶©e
 <
ty³Çme
 
T
, 
size_t
 
size
>

257 
	`S‘FuzzedE¼No
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::
¬¿y
<
T
, 
size
>& 
”ºos
)

259 
”ºo
 = 
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
(
”ºos
);

260 
	}
}

267 
šlše
 
	$S‘FuzzedE¼No
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


269 
”ºo
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 133);

270 
	}
}

276 [[
nodisÿrd
]] 
šlše
 
	g¡d
::
veùÜ
<
ušt8_t
> 
	$CÚsumeFixedL’gthBy‹VeùÜ
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
size_t
 
Ëngth
è
nÛxû±


278 
¡d
::
veùÜ
<
ušt8_t
> 
	`»suÉ
(
Ëngth
);

279 cÚ¡ 
¡d
::
veùÜ
<
ušt8_t
> 
¿ndom_by‹s
 = 
fuzzed_d©a_´ovid”
.
CÚsumeBy‹s
<ušt8_t>(
Ëngth
);

280 ià(!
¿ndom_by‹s
.
	`em±y
()) {

281 
¡d
::
	`memıy
(
»suÉ
.
	`d©a
(), 
¿ndom_by‹s
.d©a(),„ªdom_by‹s.
	`size
());

283  
»suÉ
;

284 
	}
}

286 
CN‘Addr
 
	$CÚsumeN‘Addr
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±
;

288 
šlše
 
CSubN‘
 
	$CÚsumeSubN‘
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


290  {
	`CÚsumeN‘Addr
(
fuzzed_d©a_´ovid”
), fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿l
<
ušt8_t
>()};

291 
	}
}

293 
šlše
 
CS”viû
 
	$CÚsumeS”viû
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


295  {
	`CÚsumeN‘Addr
(
fuzzed_d©a_´ovid”
), fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿l
<
ušt16_t
>()};

296 
	}
}

298 
CAdd»ss
 
	$CÚsumeAdd»ss
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±
;

300 
‹m¶©e
 <
boŞ
 
R‘uºUniquePŒ
 = 
çl£
>

301 autØ
	`CÚsumeNode
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
¡d
::
İtiÚ®
<
NodeId
>& 
node_id_š
 = std::
nuÎİt
è
nÛxû±


303 cÚ¡ 
NodeId
 
node_id
 = 
node_id_š
.
	`v®ue_Ü
(
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<NodeId>(0, 
¡d
::
num”ic_lim™s
<NodeId>::
	`max
()));

304 cÚ¡‡utØ
sock
 = 
¡d
::
make_sh¬ed
<
FuzzedSock
>(
fuzzed_d©a_´ovid”
);

305 cÚ¡ 
CAdd»ss
 
add»ss
 = 
	`CÚsumeAdd»ss
(
fuzzed_d©a_´ovid”
);

306 cÚ¡ 
ušt64_t
 
keyed_Ãt_group
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint64_t>();

307 cÚ¡ 
ušt64_t
 
loÿl_ho¡_nÚû
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint64_t>();

308 cÚ¡ 
CAdd»ss
 
addr_bšd
 = 
	`CÚsumeAdd»ss
(
fuzzed_d©a_´ovid”
);

309 cÚ¡ 
¡d
::
¡ršg
 
addr_Çme
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(64);

310 cÚ¡ 
CÚÃùiÚTy³
 
cÚn_ty³
 = 
fuzzed_d©a_´ovid”
.
	`PickV®ueInA¼ay
(
ALL_CONNECTION_TYPES
);

311 cÚ¡ 
boŞ
 
šbound_ÚiÚ
{
cÚn_ty³
 =ğ
CÚÃùiÚTy³
::
INBOUND
 ? 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è: 
çl£
};

312 
N‘P”missiÚFÏgs
 
³rmissiÚ_æags
 = 
	`CÚsumeW—kEnum
(
fuzzed_d©a_´ovid”
, 
ALL_NET_PERMISSION_FLAGS
);

313 
	`cÚ¡ex´
 (
R‘uºUniquePŒ
) {

314  
¡d
::
make_unique
<
CNode
>(
node_id
,

315 
sock
,

316 
add»ss
,

317 
keyed_Ãt_group
,

318 
loÿl_ho¡_nÚû
,

319 
addr_bšd
,

320 
addr_Çme
,

321 
cÚn_ty³
,

322 
šbound_ÚiÚ
,

323 
CNodeO±iÚs
{ .
³rmissiÚ_æags
 =…ermission_flags });

325  
CNode
{
node_id
,

326 
sock
,

327 
add»ss
,

328 
keyed_Ãt_group
,

329 
loÿl_ho¡_nÚû
,

330 
addr_bšd
,

331 
addr_Çme
,

332 
cÚn_ty³
,

333 
šbound_ÚiÚ
,

334 
CNodeO±iÚs
{ .
³rmissiÚ_æags
 =…ermission_flags }};

336 
	}
}

337 
šlše
 
	g¡d
::
unique_±r
<
CNode
> 
CÚsumeNodeAsUniquePŒ
(
FuzzedD©aProvid”
& 
fdp
, cÚ¡ 
¡d
::
İtiÚ®
<
NodeId
>& 
node_id_š
 = std::
nuÎİt
è{  
CÚsumeNode
<
Œue
>(fdp,‚ode_id_in); }

339 
	$FlNode
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, 
CÚnmªTe¡Msg
& 
cÚnmª
, 
CNode
& 
node
è
nÛxû±
 
	`EXCLUSIVE_LOCKS_REQUIRED
(
N‘Ev’tsIÁ”çû
::
g_msg´oc_mu‹x
);

341 şas 
	cFuzzedFeProvid”


343 
FuzzedD©aProvid”
& 
m_fuzzed_d©a_´ovid”
;

344 
št64_t
 
m_off£t
 = 0;

346 
public
:

347 
	$FuzzedFeProvid”
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è: 
m_fuzzed_d©a_´ovid”
{fuzzed_data_provider}

349 
	}
}

351 
FILE
* 
İ’
();

353 
ssize_t
 
»ad
(* 
cook›
, * 
buf
, 
size_t
 
size
);

355 
ssize_t
 
wr™e
(* 
cook›
, cÚ¡ * 
buf
, 
size_t
 
size
);

357 
£ek
(* 
cook›
, 
št64_t
* 
off£t
, 
wh’û
);

359 
şo£
(* 
cook›
);

362 [[
nodisÿrd
]] 
šlše
 
FuzzedFeProvid”
 
	$CÚsumeFe
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


364  {
fuzzed_d©a_´ovid”
};

365 
	}
}

367 şas 
	cFuzzedAutoFeProvid”


369 
FuzzedFeProvid”
 
	mm_fuzzed_fe_´ovid”
;

371 
	mpublic
:

372 
	$FuzzedAutoFeProvid”
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è: 
m_fuzzed_fe_´ovid”
{fuzzed_data_provider}

374 
	}
}

376 
AutoFe
 
	$İ’
()

378  
AutoFe
{
m_fuzzed_fe_´ovid”
.
	`İ’
()};

379 
	}
}

382 [[
nodisÿrd
]] 
šlše
 
FuzzedAutoFeProvid”
 
	$CÚsumeAutoFe
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
è
nÛxû±


384  {
fuzzed_d©a_´ovid”
};

385 
	}
}

387 
	#WRITE_TO_STREAM_CASE
(
ty³
, 
cÚsume
) \

389 
ty³
 
o
 = 
cÚsume
; \

390 
¡»am
 << 
o
; \

391 }

	)

392 
	g‹m¶©e
 <
ty³Çme
 
	gSŒ—m
>

393 
	$Wr™eToSŒ—m
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, 
SŒ—m
& 
¡»am
è
nÛxû±


395 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

396 
Œy
 {

397 
	`C®lOÃOf
(

398 
fuzzed_d©a_´ovid”
,

399 
	`WRITE_TO_STREAM_CASE
(
boŞ
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()),

400 
	`WRITE_TO_STREAM_CASE
(
št8_t
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int8_t>()),

401 
	`WRITE_TO_STREAM_CASE
(
ušt8_t
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint8_t>()),

402 
	`WRITE_TO_STREAM_CASE
(
št16_t
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int16_t>()),

403 
	`WRITE_TO_STREAM_CASE
(
ušt16_t
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint16_t>()),

404 
	`WRITE_TO_STREAM_CASE
(
št32_t
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int32_t>()),

405 
	`WRITE_TO_STREAM_CASE
(
ušt32_t
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>()),

406 
	`WRITE_TO_STREAM_CASE
(
št64_t
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int64_t>()),

407 
	`WRITE_TO_STREAM_CASE
(
ušt64_t
, 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint64_t>()),

408 
	`WRITE_TO_STREAM_CASE
(
¡d
::
¡ršg
, 
fuzzed_d©a_´ovid”
.
	`CÚsumeRªdomL’gthSŒšg
(32)),

409 
	`WRITE_TO_STREAM_CASE
(
¡d
::
veùÜ
<
ušt8_t
>, 
CÚsumeRªdomL’gthIÁeg¿lVeùÜ
<ušt8_t>(
fuzzed_d©a_´ovid”
)));

410 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

414 
	}
}

416 
	#READ_FROM_STREAM_CASE
(
ty³
) \

418 
ty³
 
o
; \

419 
¡»am
 >> 
o
; \

420 }

	)

421 
	g‹m¶©e
 <
ty³Çme
 
	gSŒ—m
>

422 
	$R—dFromSŒ—m
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, 
SŒ—m
& 
¡»am
è
nÛxû±


424 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

425 
Œy
 {

426 
	`C®lOÃOf
(

427 
fuzzed_d©a_´ovid”
,

428 
	`READ_FROM_STREAM_CASE
(
boŞ
),

429 
	`READ_FROM_STREAM_CASE
(
št8_t
),

430 
	`READ_FROM_STREAM_CASE
(
ušt8_t
),

431 
	`READ_FROM_STREAM_CASE
(
št16_t
),

432 
	`READ_FROM_STREAM_CASE
(
ušt16_t
),

433 
	`READ_FROM_STREAM_CASE
(
št32_t
),

434 
	`READ_FROM_STREAM_CASE
(
ušt32_t
),

435 
	`READ_FROM_STREAM_CASE
(
št64_t
),

436 
	`READ_FROM_STREAM_CASE
(
ušt64_t
),

437 
	`READ_FROM_STREAM_CASE
(
¡d
::
¡ršg
),

438 
	`READ_FROM_STREAM_CASE
(
¡d
::
veùÜ
<
ušt8_t
>));

439 } 
	`ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

443 
	}
}

	@util/mempool.cpp

5 
	~<cÚ£nsus/amouÁ.h
>

6 
	~<´im™ives/Œª§ùiÚ.h
>

7 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

8 
	~<‹¡/fuzz/ut.h
>

9 
	~<‹¡/fuzz/ut/mempoŞ.h
>

10 
	~<txmempoŞ.h
>

12 
	~<lim™s
>

14 
CTxMemPoŞEÁry
 
	$CÚsumeTxMemPoŞEÁry
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
CT¿n§ùiÚ
& 
tx
è
nÛxû±


20 cÚ¡ 
CAmouÁ
 
ãe
{
	`CÚsumeMÚey
(
fuzzed_d©a_´ovid”
, 
¡d
::
num”ic_lim™s
<CAmouÁ>::
	`max
() / CAmount{100'000})};

21 
	`as£¹
(
	`MÚeyRªge
(
ãe
));

22 cÚ¡ 
št64_t
 
time
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int64_t>();

23 cÚ¡ 
’Œy_height
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<>();

24 cÚ¡ 
boŞ
 
¥’ds_cošba£
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

25 cÚ¡ 
sig_İ_co¡
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 
MAX_BLOCK_SIGOPS_COST
);

26  
CTxMemPoŞEÁry
{
	`MakeT¿n§ùiÚRef
(
tx
), 
ãe
, 
time
, 
’Œy_height
, 
¥’ds_cošba£
, 
sig_İ_co¡
, {}};

	@util/mempool.h

5 #iâdeà
BITCOIN_TEST_FUZZ_UTIL_MEMPOOL_H


6 
	#BITCOIN_TEST_FUZZ_UTIL_MEMPOOL_H


	)

8 
	~<´im™ives/Œª§ùiÚ.h
>

9 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

10 
	~<txmempoŞ.h
>

11 
	~<v®id©iÚ.h
>

13 şas 
	cDummyChašS‹
 
	mfš®
 : 
public
 
Chaš¡©e


15 
public
:

16 
	$S‘MempoŞ
(
CTxMemPoŞ
* 
mempoŞ
)

18 
m_mempoŞ
 = 
mempoŞ
;

20 
	}
};

22 [[
nodisÿrd
]] 
CTxMemPoŞEÁry
 
	$CÚsumeTxMemPoŞEÁry
(
FuzzedD©aProvid”
& 
fuzzed_d©a_´ovid”
, cÚ¡ 
CT¿n§ùiÚ
& 
tx
è
nÛxû±
;

	@utxo_snapshot.cpp

5 
	~<chaš·¿ms.h
>

6 
	~<cÚ£nsus/v®id©iÚ.h
>

7 
	~<fs.h
>

8 
	~<node/utxo_¢­shÙ.h
>

9 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

10 
	~<‹¡/fuzz/fuzz.h
>

11 
	~<‹¡/fuzz/ut.h
>

12 
	~<‹¡/ut/mššg.h
>

13 
	~<‹¡/ut/£tup_commÚ.h
>

14 
	~<v®id©iÚ.h
>

15 
	~<v®id©iÚš‹rçû.h
>

17 
usšg
 
	gnode
::
SÇpshÙM‘ad©a
;

19 
	gÇme¥aû
 {

21 cÚ¡ 
	g¡d
::
veùÜ
<
¡d
::
sh¬ed_±r
<
CBlock
>>* 
g_chaš
;

23 
š™Ÿlize_chaš
()

25 cÚ¡‡utØ
	g·¿ms
{
C»©eChašP¬ams
(
ArgsMªag”
{}, 
CBa£ChašP¬ams
::
REGTEST
)};

26 cÚ¡‡utØ
	gchaš
{
C»©eBlockChaš
(2 * 
COINBASE_MATURITY
, *
·¿ms
)};

27 
	gg_chaš
 = &
chaš
;

30 
FUZZ_TARGET_INIT
(
utxo_¢­shÙ
, 
š™Ÿlize_chaš
)

32 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
(
bufãr
.
d©a
(), bufãr.
size
());

33 
	g¡d
::
unique_±r
<cÚ¡ 
Te¡šgS‘up
> 
£tup
{
MakeNoLogFeCÚ‹xt
<const TestingSetup>()};

34 cÚ¡‡uto& 
	gnode
 = 
£tup
->
m_node
;

35 auto& 
	gchašmª
{*
	gnode
.chainman};

37 cÚ¡‡utØ
	g¢­shÙ_·th
 = 
gArgs
.
G‘D©aDœN‘
() / "fuzzed_snapshot.dat";

39 
As£¹
(!
chašmª
.
SÇpshÙBlockhash
());

42 
AutoFe
 
	goutfe
{
	gfsbridge
::
fİ’
(
¢­shÙ_·th
, "wb")};

43 cÚ¡‡utØ
	gfe_d©a
{
CÚsumeRªdomL’gthBy‹VeùÜ
(
fuzzed_d©a_´ovid”
)};

44 
	goutfe
 << 
	gS·n
{
	gfe_d©a
};

47 cÚ¡‡utØ
	gAùiv©eFuzzedSÇpshÙ
{[&] {

48 
AutoFe
 
	gšfe
{
	gfsbridge
::
fİ’
(
¢­shÙ_·th
, "rb")};

49 
SÇpshÙM‘ad©a
 
	gm‘ad©a
;

50 
	gŒy
 {

51 
	gšfe
 >> 
	gm‘ad©a
;

52 } 
ÿtch
 (cÚ¡ 
¡d
::
ios_ba£
::
çu»
&) {

53  
çl£
;

55  
	gchašmª
.
Aùiv©eSÇpshÙ
(
šfe
, 
m‘ad©a
, 
Œue
);

58 ià(
	gfuzzed_d©a_´ovid”
.
CÚsumeBoŞ
()) {

59 cÚ¡‡uto& 
	gblock
 : *
g_chaš
) {

60 
BlockV®id©iÚS‹
 
dummy
;

61 
boŞ
 
	g´oûs£d
{
	gchašmª
.
ProûssNewBlockH—d”s
({*
block
}, 
Œue
, 
dummy
)};

62 
As£¹
(
´oûs£d
);

63 cÚ¡‡uto* 
	gšdex
{
WITH_LOCK
(::
cs_maš
,  
chašmª
.
m_blockmª
.
LookupBlockIndex
(
block
->
G‘Hash
()))};

64 
As£¹
(
šdex
);

68 ià(
Aùiv©eFuzzedSÇpshÙ
()) {

69 
LOCK
(::
cs_maš
);

70 
As£¹
(!
chašmª
.
AùiveChaš¡©e
().
m_äom_¢­shÙ_blockhash
->
IsNuÎ
());

71 
As£¹
(*
chašmª
.
AùiveChaš¡©e
().
m_äom_¢­shÙ_blockhash
 ==

72 *
chašmª
.
SÇpshÙBlockhash
());

73 cÚ¡‡uto& 
	gcošsÿche
{
	gchašmª
.
AùiveChaš¡©e
().
CošsT
()};

74 
št64_t
 
	gchaš_tx
{};

75 cÚ¡‡uto& 
	gblock
 : *
g_chaš
) {

76 
As£¹
(
cošsÿche
.
HaveCoš
(
COutPošt
{
block
->
vtx
.
©
(0)->
G‘Hash
(), 0}));

77 cÚ¡‡uto* 
	gšdex
{
	gchašmª
.
	gm_blockmª
.
LookupBlockIndex
(
block
->
G‘Hash
())};

78 cÚ¡‡utØ
	gnum_tx
{
As£¹
(
šdex
)->
	gnTx
};

79 
As£¹
(
num_tx
 == 1);

80 
	gchaš_tx
 +ğ
num_tx
;

82 
As£¹
(
g_chaš
->
size
(è=ğ
cošsÿche
.
G‘CacheSize
());

83 
As£¹
(
chaš_tx
 =ğ
chašmª
.
AùiveT
()->
nChašTx
);

85 
As£¹
(!
chašmª
.
SÇpshÙBlockhash
());

86 
As£¹
(!
chašmª
.
AùiveChaš¡©e
().
m_äom_¢­shÙ_blockhash
);

89 
As£¹
(!
Aùiv©eFuzzedSÇpshÙ
());

	@validation_load_mempool.cpp

5 
	~<k”Ãl/mempoŞ_³rsi¡.h
>

7 
	~<chaš·¿msba£.h
>

8 
	~<node/mempoŞ_¬gs.h
>

9 
	~<node/mempoŞ_³rsi¡_¬gs.h
>

10 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

11 
	~<‹¡/fuzz/fuzz.h
>

12 
	~<‹¡/fuzz/ut.h
>

13 
	~<‹¡/fuzz/ut/mempoŞ.h
>

14 
	~<‹¡/ut/£tup_commÚ.h
>

15 
	~<‹¡/ut/txmempoŞ.h
>

16 
	~<txmempoŞ.h
>

17 
	~<ut/time.h
>

18 
	~<v®id©iÚ.h
>

20 
	~<c¡dšt
>

21 
	~<veùÜ
>

23 
usšg
 
	gk”Ãl
::
DumpMempoŞ
;

25 
usšg
 
	gnode
::
MempoŞP©h
;

27 
	gÇme¥aû
 {

28 cÚ¡ 
Te¡šgS‘up
* 
	gg_£tup
;

31 
	$š™Ÿlize_v®id©iÚ_lßd_mempoŞ
()

33 cÚ¡‡utØ
‹¡šg_£tup
 = 
MakeNoLogFeCÚ‹xt
<cÚ¡ 
Te¡šgS‘up
>();

34 
g_£tup
 = 
‹¡šg_£tup
.
	`g‘
();

35 
	}
}

37 
	$FUZZ_TARGET_INIT
(
v®id©iÚ_lßd_mempoŞ
, 
š™Ÿlize_v®id©iÚ_lßd_mempoŞ
)

39 
FuzzedD©aProvid”
 
fuzzed_d©a_´ovid”
{
bufãr
.
	`d©a
(), bufãr.
	`size
()};

40 
	`S‘MockTime
(
	`CÚsumeTime
(
fuzzed_d©a_´ovid”
));

41 
FuzzedFeProvid”
 
fuzzed_fe_´ovid”
 = 
	`CÚsumeFe
(
fuzzed_d©a_´ovid”
);

43 
CTxMemPoŞ
 
poŞ
{
	`MemPoŞO±iÚsFÜTe¡
(
g_£tup
->
m_node
)};

45 auto& 
chaš¡©e
{
¡©ic_ÿ¡
<
DummyChašS‹
&>(
g_£tup
->
m_node
.
chašmª
->
	`AùiveChaš¡©e
())};

46 
chaš¡©e
.
	`S‘MempoŞ
(&
poŞ
);

48 autØ
fuzzed_fİ’
 = [&](cÚ¡ 
fs
::
·th
&, const *) {

49  
fuzzed_fe_´ovid”
.
	`İ’
();

51 ()
chaš¡©e
.
	`LßdMempoŞ
(
	`MempoŞP©h
(
g_£tup
->
m_¬gs
), 
fuzzed_fİ’
);

52 ()
	`DumpMempoŞ
(
poŞ
, 
	`MempoŞP©h
(
g_£tup
->
m_¬gs
), 
fuzzed_fİ’
, 
Œue
);

53 
	}
}

	@versionbits.cpp

5 
	~<chaš.h
>

6 
	~<chaš·¿ms.h
>

7 
	~<cÚ£nsus/·¿ms.h
>

8 
	~<´im™ives/block.h
>

9 
	~<ut/sy¡em.h
>

10 
	~<v”siÚb™s.h
>

12 
	~<‹¡/fuzz/FuzzedD©aProvid”.h
>

13 
	~<‹¡/fuzz/fuzz.h
>

14 
	~<‹¡/fuzz/ut.h
>

16 
	~<c¡dšt
>

17 
	~<lim™s
>

18 
	~<memÜy
>

19 
	~<veùÜ
>

21 
	gÇme¥aû
 {

22 şas 
	cTe¡CÚd™iÚCheck”
 : 
public
 
Ab¡¿ùTh»shŞdCÚd™iÚCheck”


24 
´iv©e
:

25 
mubË
 
Th»shŞdCÚd™iÚCache
 
m_ÿche
;

26 cÚ¡ 
	gCÚ£nsus
::
P¬ams
 
dummy_·¿ms
{};

28 
	gpublic
:

29 cÚ¡ 
št64_t
 
m_begš
;

30 cÚ¡ 
št64_t
 
	gm_’d
;

31 cÚ¡ 
	gm_³riod
;

32 cÚ¡ 
	gm_th»shŞd
;

33 cÚ¡ 
	gm_mš_aùiv©iÚ_height
;

34 cÚ¡ 
	gm_b™
;

36 
Te¡CÚd™iÚCheck”
(
št64_t
 
begš
, iÁ64_ˆ
’d
, 
³riod
, 
th»shŞd
, 
mš_aùiv©iÚ_height
, 
b™
)

37 : 
m_begš
{
begš
}, 
	gm_’d
{
	g’d
}, 
	gm_³riod
{
	g³riod
}, 
	gm_th»shŞd
{
	gth»shŞd
}, 
	gm_mš_aùiv©iÚ_height
{
	gmš_aùiv©iÚ_height
}, 
	gm_b™
{
	gb™
}

39 
as£¹
(
m_³riod
 > 0);

40 
as£¹
(0 <ğ
m_th»shŞd
 && m_th»shŞd <ğ
m_³riod
);

41 
as£¹
(0 <ğ
m_b™
 && m_b™ < 32 && m_b™ < 
VERSIONBITS_NUM_BITS
);

42 
as£¹
(0 <ğ
m_mš_aùiv©iÚ_height
);

45 
boŞ
 
CÚd™iÚ
(cÚ¡ 
CBlockIndex
* 
pšdex
, cÚ¡ 
CÚ£nsus
::
P¬ams
& 
·¿ms
ècÚ¡ 
ov”ride
 {  CÚd™iÚÕšdex->
nV”siÚ
); }

46 
št64_t
 
BegšTime
(cÚ¡ 
CÚ£nsus
::
P¬ams
& 
·¿ms
ècÚ¡ 
ov”ride
 {  
m_begš
; }

47 
št64_t
 
EndTime
(cÚ¡ 
CÚ£nsus
::
P¬ams
& 
·¿ms
ècÚ¡ 
ov”ride
 {  
m_’d
; }

48 
P”iod
(cÚ¡ 
CÚ£nsus
::
P¬ams
& 
·¿ms
ècÚ¡ 
ov”ride
 {  
m_³riod
; }

49 
Th»shŞd
(cÚ¡ 
CÚ£nsus
::
P¬ams
& 
·¿ms
ècÚ¡ 
ov”ride
 {  
m_th»shŞd
; }

50 
MšAùiv©iÚHeight
(cÚ¡ 
CÚ£nsus
::
P¬ams
& 
·¿ms
ècÚ¡ 
ov”ride
 {  
m_mš_aùiv©iÚ_height
; }

52 
Th»shŞdS‹
 
G‘S‹FÜ
(cÚ¡ 
CBlockIndex
* 
pšdexP»v
ècÚ¡ {  
	gAb¡¿ùTh»shŞdCÚd™iÚCheck”
::G‘S‹FÜÕšdexP»v, 
dummy_·¿ms
, 
m_ÿche
); }

53 
G‘S‹SšûHeightFÜ
(cÚ¡ 
CBlockIndex
* 
pšdexP»v
ècÚ¡ {  
	gAb¡¿ùTh»shŞdCÚd™iÚCheck”
::G‘S‹SšûHeightFÜÕšdexP»v, 
dummy_·¿ms
, 
m_ÿche
); }

54 
BIP9Sts
 
G‘S‹Sti¡icsFÜ
(cÚ¡ 
CBlockIndex
* 
pšdex
, 
¡d
::
veùÜ
<
boŞ
>* 
sigÇls
=
nuÎ±r
ècÚ¡ {  
Ab¡¿ùTh»shŞdCÚd™iÚCheck”
::G‘S‹Sti¡icsFÜÕšdex, 
dummy_·¿ms
, signals); }

56 
boŞ
 
CÚd™iÚ
(
št32_t
 
v”siÚ
) const

58 
ušt32_t
 
	gmask
 = ((ušt32_t)1è<< 
m_b™
;

59  (((
	gv”siÚ
 & 
	gVERSIONBITS_TOP_MASK
è=ğ
VERSIONBITS_TOP_BITS
è&& (
v”siÚ
 & 
mask
) != 0);

62 
boŞ
 
CÚd™iÚ
(cÚ¡ 
CBlockIndex
* 
pšdex
ècÚ¡ {  CÚd™iÚÕšdex->
nV”siÚ
); }

66 şas 
	cBlocks


68 
	g´iv©e
:

69 
¡d
::
veùÜ
<¡d::
unique_±r
<
CBlockIndex
>> 
m_blocks
;

70 cÚ¡ 
ušt32_t
 
	gm_¡¬t_time
;

71 cÚ¡ 
ušt32_t
 
	gm_š‹rv®
;

72 cÚ¡ 
št32_t
 
	gm_sigÇl
;

73 cÚ¡ 
št32_t
 
	gm_no_sigÇl
;

75 
	gpublic
:

76 
Blocks
(
ušt32_t
 
¡¬t_time
, ušt32_ˆ
š‹rv®
, 
št32_t
 
sigÇl
, iÁ32_ˆ
no_sigÇl
)

77 : 
m_¡¬t_time
{
¡¬t_time
}, 
	gm_š‹rv®
{
	gš‹rv®
}, 
	gm_sigÇl
{
	gsigÇl
}, 
	gm_no_sigÇl
{
	gno_sigÇl
} {}

79 
size_t
 
size
(ècÚ¡ {  
	gm_blocks
.size(); }

81 
CBlockIndex
* 
t
() const

83  
	gm_blocks
.
em±y
(è? 
	gnuÎ±r
 : 
m_blocks
.
back
().
g‘
();

86 
CBlockIndex
* 
mše_block
(
boŞ
 
sigÇl
)

88 
CBlockH—d”
 
	gh—d”
;

89 
	gh—d”
.
	gnV”siÚ
 = 
sigÇl
 ? 
m_sigÇl
 : 
m_no_sigÇl
;

90 
	gh—d”
.
	gnTime
 = 
m_¡¬t_time
 + 
m_blocks
.
size
(è* 
m_š‹rv®
;

91 
	gh—d”
.
	gnB™s
 = 0x1d00ffff;

93 autØ
	gcu¼’t_block
 = 
¡d
::
make_unique
<
CBlockIndex
>(
h—d”
);

94 
	gcu¼’t_block
->
	gµ»v
 = 
t
();

95 
	gcu¼’t_block
->
	gnHeight
 = 
m_blocks
.
size
();

96 
	gcu¼’t_block
->
BudSk
();

98  
	gm_blocks
.
em¶aû_back
(
¡d
::
move
(
cu¼’t_block
)).
g‘
();

102 
	g¡d
::
unique_±r
<cÚ¡ 
CChašP¬ams
> 
g_·¿ms
;

104 
	$š™Ÿlize
()

107 
g_·¿ms
 = 
	`C»©eChašP¬ams
(
ArgsMªag”
{}, 
CBa£ChašP¬ams
::
MAIN
);

108 
	`as£¹
(
g_·¿ms
 !ğ
nuÎ±r
);

109 
	}
}

111 
cÚ¡ex´
 
ušt32_t
 
	gMAX_START_TIME
 = 4102444800;

113 
	$FUZZ_TARGET_INIT
(
v”siÚb™s
, 
š™Ÿlize
)

115 cÚ¡ 
CChašP¬ams
& 
·¿ms
 = *
g_·¿ms
;

116 cÚ¡ 
št64_t
 
š‹rv®
 = 
·¿ms
.
	`G‘CÚ£nsus
().
nPowT¬g‘S·cšg
;

117 
	`as£¹
(
š‹rv®
 > 1);

118 
	`as£¹
(
š‹rv®
 < 
¡d
::
num”ic_lim™s
<
št32_t
>::
	`max
());

120 
FuzzedD©aProvid”
 
	`fuzzed_d©a_´ovid”
(
bufãr
.
	`d©a
(), bufãr.
	`size
());

123 cÚ¡ 
³riod
 = 32;

124 cÚ¡ 
size_t
 
max_³riods
 = 16;

125 cÚ¡ 
size_t
 
max_blocks
 = 2 * 
³riod
 * 
max_³riods
;

127 cÚ¡ 
th»shŞd
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeIÁeg¿lInRªge
(1, 
³riod
);

128 
	`as£¹
(0 < 
th»shŞd
 &&h»shŞd <ğ
³riod
);

132 
	`as£¹
(
¡d
::
num”ic_lim™s
<
ušt32_t
>::
	`max
(è- 
MAX_START_TIME
 > 
š‹rv®
 * 
max_blocks
);

134 cÚ¡ 
št64_t
 
block_¡¬t_time
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<
ušt32_t
>(
·¿ms
.
	`G’esisBlock
().
nTime
, 
MAX_START_TIME
);

137 cÚ¡ 
št32_t
 
v”_sigÇl
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int32_t>();

138 cÚ¡ 
št32_t
 
v”_nosigÇl
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<int32_t>();

141 cÚ¡ 
b™
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 
VERSIONBITS_NUM_BITS
 - 1);

143 
boŞ
 
®ways_aùive_‹¡
 = 
çl£
;

144 
boŞ
 
Ãv”_aùive_‹¡
 = 
çl£
;

145 
št64_t
 
¡¬t_time
;

146 
št64_t
 
timeout
;

147 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

150 
¡¬t_block
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 
³riod
 * (
max_³riods
 - 3));

151 
’d_block
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 
³riod
 * (
max_³riods
 - 3));

153 
¡¬t_time
 = 
block_¡¬t_time
 + 
¡¬t_block
 * 
š‹rv®
;

154 
timeout
 = 
block_¡¬t_time
 + 
’d_block
 * 
š‹rv®
;

157 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()è
¡¬t_time
 +ğ
š‹rv®
 / 2;

158 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()è
timeout
 +ğ
š‹rv®
 / 2;

160 ià(
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
()) {

161 
¡¬t_time
 = 
CÚ£nsus
::
BIP9D•loym’t
::
ALWAYS_ACTIVE
;

162 
®ways_aùive_‹¡
 = 
Œue
;

164 
¡¬t_time
 = 
CÚ£nsus
::
BIP9D•loym’t
::
NEVER_ACTIVE
;

165 
Ãv”_aùive_‹¡
 = 
Œue
;

167 
timeout
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
(è? 
CÚ£nsus
::
BIP9D•loym’t
::
NO_TIMEOUT
 : fuzzed_d©a_´ovid”.
CÚsumeIÁeg¿l
<
št64_t
>();

169 
mš_aùiv©iÚ
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿lInRªge
<>(0, 
³riod
 * 
max_³riods
);

171 
Te¡CÚd™iÚCheck”
 
	`check”
(
¡¬t_time
, 
timeout
, 
³riod
, 
th»shŞd
, 
mš_aùiv©iÚ
, 
b™
);

174 ià(!
check”
.
	`CÚd™iÚ
(
v”_sigÇl
)) ;

175 ià(
check”
.
	`CÚd™iÚ
(
v”_nosigÇl
)) ;

176 ià(
v”_nosigÇl
 < 0) ;

180 
	`as£¹
(
v”_sigÇl
 > 0);

181 
	`as£¹
(
v”_sigÇl
 >ğ
VERSIONBITS_LAST_OLD_BLOCK_VERSION
);

184 
Blocks
 
	`blocks
(
block_¡¬t_time
, 
š‹rv®
, 
v”_sigÇl
, 
v”_nosigÇl
);

199 cÚ¡ 
ušt32_t
 
sigÇÎšg_mask
 = 
fuzzed_d©a_´ovid”
.
CÚsumeIÁeg¿l
<uint32_t>();

202 
fuzzed_d©a_´ovid”
.
	`»maššg_by‹s
() > 0) {

204 
boŞ
 
sigÇl
 = 
fuzzed_d©a_´ovid”
.
	`CÚsumeBoŞ
();

205 
b
 = 0; b < 
³riod
; ++b) {

206 
blocks
.
	`mše_block
(
sigÇl
);

210 ià(
blocks
.
	`size
(è+ 2 * 
³riod
 > 
max_blocks
) ;

217 
blocks_sig
 = 0;

220 
CBlockIndex
* 
´ev
 = 
blocks
.
	`t
();

221 cÚ¡ 
exp_sšû
 = 
check”
.
	`G‘S‹SšûHeightFÜ
(
´ev
);

222 cÚ¡ 
Th»shŞdS‹
 
exp_¡©e
 = 
check”
.
	`G‘S‹FÜ
(
´ev
);

225 
BIP9Sts
 
Ï¡_¡©s
;

226 
Ï¡_¡©s
.
³riod
 =…eriod;

227 
Ï¡_¡©s
.
th»shŞd
 =hreshold;

228 
Ï¡_¡©s
.
couÁ
 =†a¡_¡©s.
–­£d
 = 0;

229 
Ï¡_¡©s
.
possibË
 = (
³riod
 >ğ
th»shŞd
);

230 
¡d
::
veùÜ
<
boŞ
> 
Ï¡_sigÇls
{};

232 
´ev_Ãxt_height
 = (
´ev
 =ğ
nuÎ±r
 ? 0 :…»v->
nHeight
 + 1);

233 
	`as£¹
(
exp_sšû
 <ğ
´ev_Ãxt_height
);

236 
b
 = 1; b < 
³riod
; ++b) {

237 cÚ¡ 
boŞ
 
sigÇl
 = (
sigÇÎšg_mask
 >> (
b
 % 32)) & 1;

238 ià(
sigÇl
è++
blocks_sig
;

240 
CBlockIndex
* 
cu¼’t_block
 = 
blocks
.
	`mše_block
(
sigÇl
);

243 
	`as£¹
(
check”
.
	`CÚd™iÚ
(
cu¼’t_block
è=ğ
sigÇl
);

246 cÚ¡ 
Th»shŞdS‹
 
¡©e
 = 
check”
.
	`G‘S‹FÜ
(
cu¼’t_block
);

247 cÚ¡ 
sšû
 = 
check”
.
	`G‘S‹SšûHeightFÜ
(
cu¼’t_block
);

248 
	`as£¹
(
¡©e
 =ğ
exp_¡©e
);

249 
	`as£¹
(
sšû
 =ğ
exp_sšû
);

252 
¡d
::
veùÜ
<
boŞ
> 
sigÇls
;

253 cÚ¡ 
BIP9Sts
 
¡©s
 = 
check”
.
	`G‘S‹Sti¡icsFÜ
(
cu¼’t_block
, &
sigÇls
);

254 cÚ¡ 
BIP9Sts
 
¡©s_no_sigÇls
 = 
check”
.
	`G‘S‹Sti¡icsFÜ
(
cu¼’t_block
);

255 
	`as£¹
(
¡©s
.
³riod
 =ğ
¡©s_no_sigÇls
.³riod && sts.
th»shŞd
 == stats_no_signals.threshold

256 && 
¡©s
.
–­£d
 =ğ
¡©s_no_sigÇls
.–­£d && sts.
couÁ
 == stats_no_signals.count

257 && 
¡©s
.
possibË
 =ğ
¡©s_no_sigÇls
.possible);

259 
	`as£¹
(
¡©s
.
³riod
 ==…eriod);

260 
	`as£¹
(
¡©s
.
th»shŞd
 ==hreshold);

261 
	`as£¹
(
¡©s
.
–­£d
 =ğ
b
);

262 
	`as£¹
(
¡©s
.
couÁ
 =ğ
Ï¡_¡©s
.couÁ + (
sigÇl
 ? 1 : 0));

263 
	`as£¹
(
¡©s
.
possibË
 =ğ(¡©s.
couÁ
 + 
³riod
 >ğ¡©s.
–­£d
 + 
th»shŞd
));

264 
Ï¡_¡©s
 = 
¡©s
;

266 
	`as£¹
(
sigÇls
.
	`size
(è=ğ
Ï¡_sigÇls
.size() + 1);

267 
	`as£¹
(
sigÇls
.
	`back
(è=ğ
sigÇl
);

268 
Ï¡_sigÇls
.
	`push_back
(
sigÇl
);

269 
	`as£¹
(
sigÇls
 =ğ
Ï¡_sigÇls
);

272 ià(
exp_¡©e
 =ğ
Th»shŞdS‹
::
STARTED
) {

274 ià(
blocks_sig
 >ğ
th»shŞd
 - 1è
	`as£¹
(
Ï¡_¡©s
.
possibË
);

278 
boŞ
 
sigÇl
 = (
sigÇÎšg_mask
 >> (
³riod
 % 32)) & 1;

279 ià(
sigÇl
è++
blocks_sig
;

280 
CBlockIndex
* 
cu¼’t_block
 = 
blocks
.
	`mše_block
(
sigÇl
);

281 
	`as£¹
(
check”
.
	`CÚd™iÚ
(
cu¼’t_block
è=ğ
sigÇl
);

283 cÚ¡ 
BIP9Sts
 
¡©s
 = 
check”
.
	`G‘S‹Sti¡icsFÜ
(
cu¼’t_block
);

284 
	`as£¹
(
¡©s
.
³riod
 ==…eriod);

285 
	`as£¹
(
¡©s
.
th»shŞd
 ==hreshold);

286 
	`as£¹
(
¡©s
.
–­£d
 =ğ
³riod
);

287 
	`as£¹
(
¡©s
.
couÁ
 =ğ
blocks_sig
);

288 
	`as£¹
(
¡©s
.
possibË
 =ğ(¡©s.
couÁ
 + 
³riod
 >ğ¡©s.
–­£d
 + 
th»shŞd
));

291 cÚ¡ 
Th»shŞdS‹
 
¡©e
 = 
check”
.
	`G‘S‹FÜ
(
cu¼’t_block
);

292 cÚ¡ 
sšû
 = 
check”
.
	`G‘S‹SšûHeightFÜ
(
cu¼’t_block
);

295 
	`as£¹
(
sšû
 % 
³riod
 == 0);

296 
	`as£¹
(0 <ğ
sšû
 && sšû <ğ
cu¼’t_block
->
nHeight
 + 1);

297 ià(
¡©e
 =ğ
exp_¡©e
) {

298 
	`as£¹
(
sšû
 =ğ
exp_sšû
);

300 
	`as£¹
(
sšû
 =ğ
cu¼’t_block
->
nHeight
 + 1);

304 
¡©e
) {

305 
Th»shŞdS‹
::
DEFINED
:

306 
	`as£¹
(
sšû
 == 0);

307 
	`as£¹
(
exp_¡©e
 =ğ
Th»shŞdS‹
::
DEFINED
);

308 
	`as£¹
(
cu¼’t_block
->
	`G‘MedŸnTimePa¡
(è< 
check”
.
m_begš
);

310 
Th»shŞdS‹
::
STARTED
:

311 
	`as£¹
(
cu¼’t_block
->
	`G‘MedŸnTimePa¡
(è>ğ
check”
.
m_begš
);

312 ià(
exp_¡©e
 =ğ
Th»shŞdS‹
::
STARTED
) {

313 
	`as£¹
(
blocks_sig
 < 
th»shŞd
);

314 
	`as£¹
(
cu¼’t_block
->
	`G‘MedŸnTimePa¡
(è< 
check”
.
m_’d
);

316 
	`as£¹
(
exp_¡©e
 =ğ
Th»shŞdS‹
::
DEFINED
);

319 
Th»shŞdS‹
::
LOCKED_IN
:

320 ià(
exp_¡©e
 =ğ
Th»shŞdS‹
::
LOCKED_IN
) {

321 
	`as£¹
(
cu¼’t_block
->
nHeight
 + 1 < 
mš_aùiv©iÚ
);

323 
	`as£¹
(
exp_¡©e
 =ğ
Th»shŞdS‹
::
STARTED
);

324 
	`as£¹
(
blocks_sig
 >ğ
th»shŞd
);

327 
Th»shŞdS‹
::
ACTIVE
:

328 
	`as£¹
(
®ways_aùive_‹¡
 || 
mš_aùiv©iÚ
 <ğ
cu¼’t_block
->
nHeight
 + 1);

329 
	`as£¹
(
exp_¡©e
 =ğ
Th»shŞdS‹
::
ACTIVE
 ||ƒxp_¡©=ğTh»shŞdS‹::
LOCKED_IN
);

331 
Th»shŞdS‹
::
FAILED
:

332 
	`as£¹
(
Ãv”_aùive_‹¡
 || 
cu¼’t_block
->
	`G‘MedŸnTimePa¡
(è>ğ
check”
.
m_’d
);

333 ià(
exp_¡©e
 =ğ
Th»shŞdS‹
::
STARTED
) {

334 
	`as£¹
(
blocks_sig
 < 
th»shŞd
);

336 
	`as£¹
(
exp_¡©e
 =ğ
Th»shŞdS‹
::
FAILED
);

340 
	`as£¹
(
çl£
);

343 ià(
blocks
.
	`size
(è>ğ
³riod
 * 
max_³riods
) {

345 
	`as£¹
(
¡©e
 =ğ
Th»shŞdS‹
::
ACTIVE
 || s‹ =ğTh»shŞdS‹::
FAILED
);

348 ià(
®ways_aùive_‹¡
) {

350 
	`as£¹
(
¡©e
 =ğ
Th»shŞdS‹
::
ACTIVE
);

351 
	`as£¹
(
exp_¡©e
 =ğ
Th»shŞdS‹
::
ACTIVE
);

352 
	`as£¹
(
sšû
 == 0);

353 } ià(
Ãv”_aùive_‹¡
) {

355 
	`as£¹
(
¡©e
 =ğ
Th»shŞdS‹
::
FAILED
);

356 
	`as£¹
(
exp_¡©e
 =ğ
Th»shŞdS‹
::
FAILED
);

357 
	`as£¹
(
sšû
 == 0);

360 
	`as£¹
(
sšû
 > 0 || 
¡©e
 =ğ
Th»shŞdS‹
::
DEFINED
);

361 
	`as£¹
(
exp_sšû
 > 0 || 
exp_¡©e
 =ğ
Th»shŞdS‹
::
DEFINED
);

363 
	}
}

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


91 #ià
defšed
 
__ılu¥lus


92 
	#as£¹
(
ex´
) \

93 (
¡©ic_ÿ¡
 <
boŞ
> (
ex´
) \

95 : 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

96 #–ià!
defšed
 
__GNUC__
 || defšed 
__STRICT_ANSI__


97 
	#as£¹
(
ex´
) \

98 ((
ex´
) \

99 ? 
	`__ASSERT_VOID_CAST
 (0) \

100 : 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

107 
	#as£¹
(
ex´
) \

108 ((è ((
ex´
è? 1 : 0), 
	`__ex‹nsiÚ__
 ({ \

109 ià(
ex´
) \

112 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
); \

113 
	}
}))

	)

116 #ifdef 
__USE_GNU


117 
	#as£¹_³¼Ü
(
”ºum
) \

118 (!(
”ºum
) \

119 ? 
	`__ASSERT_VOID_CAST
 (0) \

120 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

128 #ià
defšed
 
__ılu¥lus
 ? 
__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

129 
	#__ASSERT_FUNCTION
 
__ex‹nsiÚ__
 
__PRETTY_FUNCTION__


	)

131 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

132 
	#__ASSERT_FUNCTION
 
__func__


	)

134 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

141 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


142 #undeà
¡©ic_as£¹


143 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<b™s/’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

108 
__exùy³
 (
i§Êum
);

109 
__exùy³
 (
i§Íha
);

110 
__exùy³
 (
isúŒl
);

111 
__exùy³
 (
isdig™
);

112 
__exùy³
 (
i¦ow”
);

113 
__exùy³
 (
isg¿ph
);

114 
__exùy³
 (
i¥ršt
);

115 
__exùy³
 (
i¥unù
);

116 
__exùy³
 (
is¥aû
);

117 
__exùy³
 (
isuµ”
);

118 
__exùy³
 (
isxdig™
);

122 
	$tŞow”
 (
__c
è
__THROW
;

125 
	$touµ”
 (
__c
è
__THROW
;

129 #ifdef 
__USE_ISOC99


130 
	`__exùy³
 (
isbÏnk
);

133 #ifdeà
__USE_GNU


135 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

138 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


142 
	$i§scii
 (
__c
è
__THROW
;

146 
	$tßscii
 (
__c
è
__THROW
;

150 
	`__exùy³
 (
_touµ”
);

151 
	`__exùy³
 (
_tŞow”
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

156 (
__ex‹nsiÚ__
 \

157 ({ 
__»s
; \

158 ià( (
c
) > 1) \

160 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

166 
__»s
 = 
f
 
¬gs
; \

169 
__»s
 = (
a
)[(è(
c
)]; \

170 
__»s
; 
	}
}))

	)

172 #ià!
defšed
 
__NO_CTYPE


173 #ifdeà
__isùy³_f


174 
	$__isùy³_f
 (
®num
)

175 
	$__isùy³_f
 (
®pha
)

176 
	$__isùy³_f
 (
úŒl
)

177 
	$__isùy³_f
 (
dig™
)

178 
	$__isùy³_f
 (
low”
)

179 
	$__isùy³_f
 (
g¿ph
)

180 
	$__isùy³_f
 (
´št
)

181 
	$__isùy³_f
 (
punù
)

182 
	$__isùy³_f
 (
¥aû
)

183 
	$__isùy³_f
 (
uµ”
)

184 
	$__isùy³_f
 (
xdig™
)

185 #ifdeà
__USE_ISOC99


186 
	$__isùy³_f
 (
bÏnk
)

188 #–ià
defšed
 
__isùy³


189 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

190 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

191 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

192 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

193 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

194 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

195 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

196 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

197 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

198 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

199 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

200 #ifdeà
__USE_ISOC99


201 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

205 #ifdeà
__USE_EXTERN_INLINES


206 
__ex‹º_šlše
 

207 
	`__NTH
 (
	$tŞow”
 (
__c
))

209  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

210 
	}
}

212 
__ex‹º_šlše
 

213 
__NTH
 (
	$touµ”
 (
__c
))

215  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

216 
	}
}

219 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


220 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

221 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

224 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


225 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

226 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

228 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

229 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

235 #ifdeà
__USE_XOPEN2K8


237 
	~<b™s/ty³s/loÿË_t.h
>

241 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

242 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

244 
	#__exùy³_l
(
Çme
) \

245 
	`Çme
 (, 
loÿË_t
è
__THROW


	)

251 
__exùy³_l
 (
i§Êum_l
);

252 
__exùy³_l
 (
i§Íha_l
);

253 
__exùy³_l
 (
isúŒl_l
);

254 
__exùy³_l
 (
isdig™_l
);

255 
__exùy³_l
 (
i¦ow”_l
);

256 
__exùy³_l
 (
isg¿ph_l
);

257 
__exùy³_l
 (
i¥ršt_l
);

258 
__exùy³_l
 (
i¥unù_l
);

259 
__exùy³_l
 (
is¥aû_l
);

260 
__exùy³_l
 (
isuµ”_l
);

261 
__exùy³_l
 (
isxdig™_l
);

263 
__exùy³_l
 (
isbÏnk_l
);

267 
	$__tŞow”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

268 
	$tŞow”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

271 
	$__touµ”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

272 
	$touµ”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

274 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


275 
	#__tŞow”_l
(
c
, 
loÿË
) \

276 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

277 
	#__touµ”_l
(
c
, 
loÿË
) \

278 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

279 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

280 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

284 #iâdeà
__NO_CTYPE


285 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

286 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

287 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

288 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

289 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

290 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

291 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

292 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

293 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

294 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

295 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

297 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

299 #ifdeà
__USE_MISC


300 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

301 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

304 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

305 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

306 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

307 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

308 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

309 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

310 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

311 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

312 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

313 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

314 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

316 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

318 #ifdeà
__USE_MISC


319 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

320 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

327 
__END_DECLS


	@/usr/include/event2/buffer.h

26 #iâdeà
EVENT2_BUFFER_H_INCLUDED_


27 
	#EVENT2_BUFFER_H_INCLUDED_


	)

75 
	~<ev’t2/visib™y.h
>

77 #ifdeà
__ılu¥lus


81 
	~<ev’t2/ev’t-cÚfig.h
>

82 
	~<¡d¬g.h
>

83 #ifdeà
EVENT__HAVE_SYS_TYPES_H


84 
	~<sys/ty³s.h
>

86 #ifdeà
EVENT__HAVE_SYS_UIO_H


87 
	~<sys/uio.h
>

89 
	~<ev’t2/ut.h
>

97 
evbufãr


98 #ifdeà
EVENT_IN_DOXYGEN_


116 
	sevbufãr_±r
 {

117 
ev_ssize_t
 
pos
;

122 *
chaš
;

123 
size_t
 
pos_š_chaš
;

124 } 
š‹º®_
;

132 #ifdeà
EVENT__HAVE_SYS_UIO_H


133 
	#evbufãr_iovec
 
iovec


	)

135 
	#EVBUFFER_IOVEC_IS_NATIVE_


	)

137 
	sevbufãr_iovec
 {

139 *
iov_ba£
;

141 
size_t
 
iov_Ën
;

151 
EVENT2_EXPORT_SYMBOL


152 
evbufãr
 *
evbufãr_Ãw
();

158 
EVENT2_EXPORT_SYMBOL


159 
evbufãr_ä“
(
evbufãr
 *
buf
);

173 
EVENT2_EXPORT_SYMBOL


174 
evbufãr_’abË_lockšg
(
evbufãr
 *
buf
, *
lock
);

180 
EVENT2_EXPORT_SYMBOL


181 
evbufãr_lock
(
evbufãr
 *
buf
);

187 
EVENT2_EXPORT_SYMBOL


188 
evbufãr_uÆock
(
evbufãr
 *
buf
);

206 
	#EVBUFFER_FLAG_DRAINS_TO_FD
 1

	)

215 
EVENT2_EXPORT_SYMBOL


216 
evbufãr_£t_æags
(
evbufãr
 *
buf
, 
ev_ušt64_t
 
æags
);

224 
EVENT2_EXPORT_SYMBOL


225 
evbufãr_ş—r_æags
(
evbufãr
 *
buf
, 
ev_ušt64_t
 
æags
);

233 
EVENT2_EXPORT_SYMBOL


234 
size_t
 
evbufãr_g‘_Ëngth
(cÚ¡ 
evbufãr
 *
buf
);

248 
EVENT2_EXPORT_SYMBOL


249 
size_t
 
evbufãr_g‘_cÚtiguous_¥aû
(cÚ¡ 
evbufãr
 *
buf
);

261 
EVENT2_EXPORT_SYMBOL


262 
evbufãr_ex·nd
(
evbufãr
 *
buf
, 
size_t
 
d©Ën
);

297 
EVENT2_EXPORT_SYMBOL


299 
evbufãr_»£rve_¥aû
(
evbufãr
 *
buf
, 
ev_ssize_t
 
size
,

300 
evbufãr_iovec
 *
vec
, 
n_vec
);

323 
EVENT2_EXPORT_SYMBOL


324 
evbufãr_comm™_¥aû
(
evbufãr
 *
buf
,

325 
evbufãr_iovec
 *
vec
, 
n_vecs
);

335 
EVENT2_EXPORT_SYMBOL


336 
evbufãr_add
(
evbufãr
 *
buf
, cÚ¡ *
d©a
, 
size_t
 
d©Ën
);

350 
EVENT2_EXPORT_SYMBOL


351 
evbufãr_»move
(
evbufãr
 *
buf
, *
d©a
, 
size_t
 
d©Ën
);

364 
EVENT2_EXPORT_SYMBOL


365 
ev_ssize_t
 
evbufãr_cİyout
(
evbufãr
 *
buf
, *
d©a_out
, 
size_t
 
d©Ën
);

379 
EVENT2_EXPORT_SYMBOL


380 
ev_ssize_t
 
evbufãr_cİyout_äom
(
evbufãr
 *
buf
, cÚ¡ 
evbufãr_±r
 *
pos
, *
d©a_out
, 
size_t
 
d©Ën
);

395 
EVENT2_EXPORT_SYMBOL


396 
evbufãr_»move_bufãr
(
evbufãr
 *
¤c
, evbufã¸*
d¡
,

397 
size_t
 
d©Ën
);

401 
	eevbufãr_eŞ_¡yË
 {

411 
EVBUFFER_EOL_ANY
,

414 
EVBUFFER_EOL_CRLF
,

416 
EVBUFFER_EOL_CRLF_STRICT
,

418 
EVBUFFER_EOL_LF
,

420 
EVBUFFER_EOL_NUL


437 
EVENT2_EXPORT_SYMBOL


438 *
evbufãr_»adÊ
(
evbufãr
 *
bufãr
, 
size_t
 *
n_»ad_out
,

439 
evbufãr_eŞ_¡yË
 
eŞ_¡yË
);

453 
EVENT2_EXPORT_SYMBOL


454 
evbufãr_add_bufãr
(
evbufãr
 *
outbuf
, evbufã¸*
šbuf
);

469 
EVENT2_EXPORT_SYMBOL


470 
evbufãr_add_bufãr_»ã»nû
(
evbufãr
 *
outbuf
,

471 
evbufãr
 *
šbuf
);

479 (*
evbufãr_»f_ş—nup_cb
)(cÚ¡ *
	td©a
,

480 
	tsize_t
 
	td©®’
, *
	texŒa
);

497 
EVENT2_EXPORT_SYMBOL


498 
evbufãr_add_»ã»nû
(
evbufãr
 *
outbuf
,

499 cÚ¡ *
d©a
, 
size_t
 
d©Ën
,

500 
evbufãr_»f_ş—nup_cb
 
ş—nupâ
, *
ş—nupâ_¬g
);

526 
EVENT2_EXPORT_SYMBOL


527 
evbufãr_add_fe
(
evbufãr
 *
outbuf
, 
fd
, 
ev_off_t
 
off£t
,

528 
ev_off_t
 
Ëngth
);

538 
evbufãr_fe_£gm’t
;

545 
	#EVBUF_FS_CLOSE_ON_FREE
 0x01

	)

550 
	#EVBUF_FS_DISABLE_MMAP
 0x02

	)

560 
	#EVBUF_FS_DISABLE_SENDFILE
 0x04

	)

567 
	#EVBUF_FS_DISABLE_LOCKING
 0x08

	)

573 (*
evbufãr_fe_£gm’t_ş—nup_cb
)(

574 
	tevbufãr_fe_£gm’t
 cÚ¡* 
	t£g
, 
	tæags
, * 
	t¬g
);

598 
EVENT2_EXPORT_SYMBOL


599 
evbufãr_fe_£gm’t
 *
evbufãr_fe_£gm’t_Ãw
(

600 
fd
, 
ev_off_t
 
off£t
,ƒv_off_ˆ
Ëngth
, 
æags
);

609 
EVENT2_EXPORT_SYMBOL


610 
evbufãr_fe_£gm’t_ä“
(
evbufãr_fe_£gm’t
 *
£g
);

619 
EVENT2_EXPORT_SYMBOL


620 
evbufãr_fe_£gm’t_add_ş—nup_cb
(
evbufãr_fe_£gm’t
 *
£g
,

621 
evbufãr_fe_£gm’t_ş—nup_cb
 
cb
, * 
¬g
);

645 
EVENT2_EXPORT_SYMBOL


646 
evbufãr_add_fe_£gm’t
(
evbufãr
 *
buf
,

647 
evbufãr_fe_£gm’t
 *
£g
, 
ev_off_t
 
off£t
,ƒv_off_ˆ
Ëngth
);

661 
EVENT2_EXPORT_SYMBOL


662 
evbufãr_add_´štf
(
evbufãr
 *
buf
, cÚ¡ *
fmt
, ...)

663 #ifdeà
__GNUC__


664 
__©Œibu‹__
((
fÜm©
(
´štf
, 2, 3)))

676 
EVENT2_EXPORT_SYMBOL


677 
evbufãr_add_v´štf
(
evbufãr
 *
buf
, cÚ¡ *
fmt
, 
va_li¡
 
­
)

678 #ifdeà
__GNUC__


679 
__©Œibu‹__
((
fÜm©
(
´štf
, 2, 0)))

691 
EVENT2_EXPORT_SYMBOL


692 
evbufãr_d¿š
(
evbufãr
 *
buf
, 
size_t
 
Ën
);

705 
EVENT2_EXPORT_SYMBOL


706 
evbufãr_wr™e
(
evbufãr
 *
bufãr
, 
evut_sock‘_t
 
fd
);

720 
EVENT2_EXPORT_SYMBOL


721 
evbufãr_wr™e_©mo¡
(
evbufãr
 *
bufãr
, 
evut_sock‘_t
 
fd
,

722 
ev_ssize_t
 
howmuch
);

734 
EVENT2_EXPORT_SYMBOL


735 
evbufãr_»ad
(
evbufãr
 *
bufãr
, 
evut_sock‘_t
 
fd
, 
howmuch
);

748 
EVENT2_EXPORT_SYMBOL


749 
evbufãr_±r
 
evbufãr_£¬ch
(
evbufãr
 *
bufãr
, cÚ¡ *
wh©
, 
size_t
 
Ën
, cÚ¡ evbufãr_±¸*
¡¬t
);

765 
EVENT2_EXPORT_SYMBOL


766 
evbufãr_±r
 
evbufãr_£¬ch_¿nge
(
evbufãr
 *
bufãr
, cÚ¡ *
wh©
, 
size_t
 
Ën
, cÚ¡ evbufãr_±¸*
¡¬t
, cÚ¡ evbufãr_±¸*
’d
);

772 
	eevbufãr_±r_how
 {

775 
EVBUFFER_PTR_SET
,

777 
EVBUFFER_PTR_ADD


801 
EVENT2_EXPORT_SYMBOL


803 
evbufãr_±r_£t
(
evbufãr
 *
bufãr
, 
evbufãr_±r
 *
±r
,

804 
size_t
 
pos™iÚ
, 
evbufãr_±r_how
 
how
);

820 
EVENT2_EXPORT_SYMBOL


821 
evbufãr_±r
 
evbufãr_£¬ch_eŞ
(
evbufãr
 *
bufãr
,

822 
evbufãr_±r
 *
¡¬t
, 
size_t
 *
eŞ_Ën_out
,

823 
evbufãr_eŞ_¡yË
 
eŞ_¡yË
);

853 
EVENT2_EXPORT_SYMBOL


854 
evbufãr_³ek
(
evbufãr
 *
bufãr
, 
ev_ssize_t
 
Ën
,

855 
evbufãr_±r
 *
¡¬t_©
,

856 
evbufãr_iovec
 *
vec_out
, 
n_vec
);

863 
	sevbufãr_cb_šfo
 {

866 
size_t
 
Üig_size
;

868 
size_t
 
n_added
;

870 
size_t
 
n_d–‘ed
;

892 (*
evbufãr_cb_func
)(
	tevbufãr
 *
	tbufãr
, cÚ¡ 
	tevbufãr_cb_šfo
 *
	tšfo
, *
	t¬g
);

894 
evbufãr_cb_’Œy
;

906 
EVENT2_EXPORT_SYMBOL


907 
evbufãr_cb_’Œy
 *
evbufãr_add_cb
(
evbufãr
 *
bufãr
, 
evbufãr_cb_func
 
cb
, *
cb¬g
);

917 
EVENT2_EXPORT_SYMBOL


918 
evbufãr_»move_cb_’Œy
(
evbufãr
 *
bufãr
,

919 
evbufãr_cb_’Œy
 *
’t
);

927 
EVENT2_EXPORT_SYMBOL


928 
evbufãr_»move_cb
(
evbufãr
 *
bufãr
, 
evbufãr_cb_func
 
cb
, *
cb¬g
);

935 
	#EVBUFFER_CB_ENABLED
 1

	)

944 
EVENT2_EXPORT_SYMBOL


945 
evbufãr_cb_£t_æags
(
evbufãr
 *
bufãr
,

946 
evbufãr_cb_’Œy
 *
cb
, 
ev_ušt32_t
 
æags
);

955 
EVENT2_EXPORT_SYMBOL


956 
evbufãr_cb_ş—r_æags
(
evbufãr
 *
bufãr
,

957 
evbufãr_cb_’Œy
 *
cb
, 
ev_ušt32_t
 
æags
);

969 
EVENT2_EXPORT_SYMBOL


970 
evbufãr_cb_su¥’d
(
evbufãr
 *
bufãr
, 
evbufãr_cb_’Œy
 *
cb
);

979 
EVENT2_EXPORT_SYMBOL


980 
evbufãr_cb_unsu¥’d
(
evbufãr
 *
bufãr
, 
evbufãr_cb_’Œy
 *
cb
);

993 
EVENT2_EXPORT_SYMBOL


994 *
evbufãr_puÎup
(
evbufãr
 *
buf
, 
ev_ssize_t
 
size
);

1005 
EVENT2_EXPORT_SYMBOL


1006 
evbufãr_´•’d
(
evbufãr
 *
buf
, cÚ¡ *
d©a
, 
size_t
 
size
);

1016 
EVENT2_EXPORT_SYMBOL


1017 
evbufãr_´•’d_bufãr
(
evbufãr
 *
d¡
, evbufãr* 
¤c
);

1033 
EVENT2_EXPORT_SYMBOL


1034 
evbufãr_ä“ze
(
evbufãr
 *
buf
, 
©_äÚt
);

1043 
EVENT2_EXPORT_SYMBOL


1044 
evbufãr_unä“ze
(
evbufãr
 *
buf
, 
©_äÚt
);

1046 
ev’t_ba£
;

1054 
EVENT2_EXPORT_SYMBOL


1055 
evbufãr_deãr_ÿÎbacks
(
evbufãr
 *
bufãr
, 
ev’t_ba£
 *
ba£
);

1070 
EVENT2_EXPORT_SYMBOL


1071 
size_t
 
evbufãr_add_iovec
(
evbufãr
 * 
bufãr
, 
evbufãr_iovec
 * 
vec
, 
n_vec
);

1073 #ifdeà
__ılu¥lus


	@/usr/include/event2/event.h

27 #iâdeà
EVENT2_EVENT_H_INCLUDED_


28 
	#EVENT2_EVENT_H_INCLUDED_


	)

185 
	~<ev’t2/visib™y.h
>

187 #ifdeà
__ılu¥lus


191 
	~<ev’t2/ev’t-cÚfig.h
>

192 #ifdeà
EVENT__HAVE_SYS_TYPES_H


193 
	~<sys/ty³s.h
>

195 #ifdeà
EVENT__HAVE_SYS_TIME_H


196 
	~<sys/time.h
>

199 
	~<¡dio.h
>

202 
	~<ev’t2/ut.h
>

217 
ev’t_ba£


218 #ifdeà
EVENT_IN_DOXYGEN_


276 
ev’t


277 #ifdeà
EVENT_IN_DOXYGEN_


295 
ev’t_cÚfig


296 #ifdeà
EVENT_IN_DOXYGEN_


321 
EVENT2_EXPORT_SYMBOL


322 
ev’t_’abË_debug_mode
();

333 
EVENT2_EXPORT_SYMBOL


334 
ev’t_debug_uÇssign
(
ev’t
 *);

343 
EVENT2_EXPORT_SYMBOL


344 
ev’t_ba£
 *
ev’t_ba£_Ãw
();

356 
EVENT2_EXPORT_SYMBOL


357 
ev’t_»š™
(
ev’t_ba£
 *
ba£
);

372 
EVENT2_EXPORT_SYMBOL


373 
ev’t_ba£_di¥©ch
(
ev’t_ba£
 *);

381 
EVENT2_EXPORT_SYMBOL


382 cÚ¡ *
ev’t_ba£_g‘_m‘hod
(cÚ¡ 
ev’t_ba£
 *);

396 
EVENT2_EXPORT_SYMBOL


397 cÚ¡ **
ev’t_g‘_suµÜ‹d_m‘hods
();

402 
EVENT2_EXPORT_SYMBOL


403 
ev’t_g‘time_mÚÙÚic
(
ev’t_ba£
 *
ba£
, 
timev®
 *

);

413 
	#EVENT_BASE_COUNT_ACTIVE
 1U

	)

416 
	#EVENT_BASE_COUNT_VIRTUAL
 2U

	)

419 
	#EVENT_BASE_COUNT_ADDED
 4U

	)

440 
EVENT2_EXPORT_SYMBOL


441 
ev’t_ba£_g‘_num_ev’ts
(
ev’t_ba£
 *, );

453 
EVENT2_EXPORT_SYMBOL


454 
ev’t_ba£_g‘_max_ev’ts
(
ev’t_ba£
 *, , );

466 
EVENT2_EXPORT_SYMBOL


467 
ev’t_cÚfig
 *
ev’t_cÚfig_Ãw
();

474 
EVENT2_EXPORT_SYMBOL


475 
ev’t_cÚfig_ä“
(
ev’t_cÚfig
 *
cfg
);

489 
EVENT2_EXPORT_SYMBOL


490 
ev’t_cÚfig_avoid_m‘hod
(
ev’t_cÚfig
 *
cfg
, cÚ¡ *
m‘hod
);

501 
	eev’t_m‘hod_ã©u»
 {

503 
EV_FEATURE_ET
 = 0x01,

508 
EV_FEATURE_O1
 = 0x02,

511 
EV_FEATURE_FDS
 = 0x04,

518 
EV_FEATURE_EARLY_CLOSE
 = 0x08

529 
	eev’t_ba£_cÚfig_æag
 {

536 
EVENT_BASE_FLAG_NOLOCK
 = 0x01,

539 
EVENT_BASE_FLAG_IGNORE_ENV
 = 0x02,

546 
EVENT_BASE_FLAG_STARTUP_IOCP
 = 0x04,

550 
EVENT_BASE_FLAG_NO_CACHE_TIME
 = 0x08,

566 
EVENT_BASE_FLAG_EPOLL_USE_CHANGELIST
 = 0x10,

573 
EVENT_BASE_FLAG_PRECISE_TIMER
 = 0x20

583 
EVENT2_EXPORT_SYMBOL


584 
ev’t_ba£_g‘_ã©u»s
(cÚ¡ 
ev’t_ba£
 *
ba£
);

608 
EVENT2_EXPORT_SYMBOL


609 
ev’t_cÚfig_»quœe_ã©u»s
(
ev’t_cÚfig
 *
cfg
, 
ã©u»
);

617 
EVENT2_EXPORT_SYMBOL


618 
ev’t_cÚfig_£t_æag
(
ev’t_cÚfig
 *
cfg
, 
æag
);

629 
EVENT2_EXPORT_SYMBOL


630 
ev’t_cÚfig_£t_num_ıus_hšt
(
ev’t_cÚfig
 *
cfg
, 
ıus
);

660 
EVENT2_EXPORT_SYMBOL


661 
ev’t_cÚfig_£t_max_di¥©ch_š‹rv®
(
ev’t_cÚfig
 *
cfg
,

662 cÚ¡ 
timev®
 *
max_š‹rv®
, 
max_ÿÎbacks
,

663 
mš_´iÜ™y
);

677 
EVENT2_EXPORT_SYMBOL


678 
ev’t_ba£
 *
ev’t_ba£_Ãw_w™h_cÚfig
(cÚ¡ 
ev’t_cÚfig
 *);

691 
EVENT2_EXPORT_SYMBOL


692 
ev’t_ba£_ä“
(
ev’t_ba£
 *);

697 
EVENT2_EXPORT_SYMBOL


698 
ev’t_ba£_ä“_nofš®ize
(
ev’t_ba£
 *);

703 
	#EVENT_LOG_DEBUG
 0

	)

704 
	#EVENT_LOG_MSG
 1

	)

705 
	#EVENT_LOG_WARN
 2

	)

706 
	#EVENT_LOG_ERR
 3

	)

711 
	#_EVENT_LOG_DEBUG
 
EVENT_LOG_DEBUG


	)

712 
	#_EVENT_LOG_MSG
 
EVENT_LOG_MSG


	)

713 
	#_EVENT_LOG_WARN
 
EVENT_LOG_WARN


	)

714 
	#_EVENT_LOG_ERR
 
EVENT_LOG_ERR


	)

721 (*
ev’t_log_cb
)(
	t£v”™y
, cÚ¡ *
	tmsg
);

732 
EVENT2_EXPORT_SYMBOL


733 
ev’t_£t_log_ÿÎback
(
ev’t_log_cb
 
cb
);

740 (*
ev’t_çl_cb
)(
	t”r
);

754 
EVENT2_EXPORT_SYMBOL


755 
ev’t_£t_çl_ÿÎback
(
ev’t_çl_cb
 
cb
);

757 
	#EVENT_DBG_ALL
 0xffffffffu

	)

758 
	#EVENT_DBG_NONE
 0

	)

774 
EVENT2_EXPORT_SYMBOL


775 
ev’t_’abË_debug_loggšg
(
ev_ušt32_t
 
which
);

786 
EVENT2_EXPORT_SYMBOL


787 
ev’t_ba£_£t
(
ev’t_ba£
 *, 
ev’t
 *);

796 
	#EVLOOP_ONCE
 0x01

	)

799 
	#EVLOOP_NONBLOCK
 0x02

	)

804 
	#EVLOOP_NO_EXIT_ON_EMPTY
 0x04

	)

825 
EVENT2_EXPORT_SYMBOL


826 
ev’t_ba£_loİ
(
ev’t_ba£
 *, );

843 
EVENT2_EXPORT_SYMBOL


844 
ev’t_ba£_loİex™
(
ev’t_ba£
 *, cÚ¡ 
timev®
 *);

859 
EVENT2_EXPORT_SYMBOL


860 
ev’t_ba£_loİb»ak
(
ev’t_ba£
 *);

879 
EVENT2_EXPORT_SYMBOL


880 
ev’t_ba£_loİcÚtšue
(
ev’t_ba£
 *);

894 
EVENT2_EXPORT_SYMBOL


895 
ev’t_ba£_gÙ_ex™
(
ev’t_ba£
 *);

909 
EVENT2_EXPORT_SYMBOL


910 
ev’t_ba£_gÙ_b»ak
(
ev’t_ba£
 *);

921 
	#EV_TIMEOUT
 0x01

	)

923 
	#EV_READ
 0x02

	)

925 
	#EV_WRITE
 0x04

	)

927 
	#EV_SIGNAL
 0x08

	)

934 
	#EV_PERSIST
 0x10

	)

936 
	#EV_ET
 0x20

	)

945 
	#EV_FINALIZE
 0x40

	)

954 
	#EV_CLOSED
 0x80

	)

964 
	#evtim”_assign
(
ev
, 
b
, 
cb
, 
¬g
) \

965 
	`ev’t_assign
((
ev
), (
b
), -1, 0, (
cb
), (
¬g
))

	)

966 
	#evtim”_Ãw
(
b
, 
cb
, 
¬g
è
	`ev’t_Ãw
((b), -1, 0, (cb), (¬g))

	)

967 
	#evtim”_add
(
ev
, 
tv
è
	`ev’t_add
(Óv), (tv))

	)

968 
	#evtim”_d–
(
ev
è
	`ev’t_d–
Óv)

	)

969 
	#evtim”_³ndšg
(
ev
, 
tv
è
	`ev’t_³ndšg
(Óv), 
EV_TIMEOUT
, (tv))

	)

970 
	#evtim”_š™Ÿlized
(
ev
è
	`ev’t_š™Ÿlized
Óv)

	)

979 
	#evsigÇl_add
(
ev
, 
tv
è
	`ev’t_add
(Óv), (tv))

	)

980 
	#evsigÇl_assign
(
ev
, 
b
, 
x
, 
cb
, 
¬g
) \

981 
	`ev’t_assign
((
ev
), (
b
), (
x
), 
EV_SIGNAL
|
EV_PERSIST
, 
cb
, (
¬g
))

	)

982 
	#evsigÇl_Ãw
(
b
, 
x
, 
cb
, 
¬g
) \

983 
	`ev’t_Ãw
((
b
), (
x
), 
EV_SIGNAL
|
EV_PERSIST
, (
cb
), (
¬g
))

	)

984 
	#evsigÇl_d–
(
ev
è
	`ev’t_d–
Óv)

	)

985 
	#evsigÇl_³ndšg
(
ev
, 
tv
è
	`ev’t_³ndšg
(Óv), 
EV_SIGNAL
, (tv))

	)

986 
	#evsigÇl_š™Ÿlized
(
ev
è
	`ev’t_š™Ÿlized
Óv)

	)

996 
	#evu£r_Ãw
(
b
, 
cb
, 
¬g
è
	`ev’t_Ãw
((b), -1, 0, (cb), (¬g))

	)

997 
	#evu£r_d–
(
ev
è
	`ev’t_d–
Óv)

	)

998 
	#evu£r_³ndšg
(
ev
, 
tv
è
	`ev’t_³ndšg
(Óv), 0, (tv))

	)

999 
	#evu£r_š™Ÿlized
(
ev
è
	`ev’t_š™Ÿlized
Óv)

	)

1000 
	#evu£r_Œigg”
(
ev
è
	`ev’t_aùive
(Óv), 0, 0)

	)

1014 (*
ev’t_ÿÎback_â
)(
	tevut_sock‘_t
, , *);

1038 
EVENT2_EXPORT_SYMBOL


1039 *
ev’t_£lf_cb¬g
();

1089 
EVENT2_EXPORT_SYMBOL


1090 
ev’t
 *
ev’t_Ãw
(
ev’t_ba£
 *, 
evut_sock‘_t
, , 
ev’t_ÿÎback_â
, *);

1131 
EVENT2_EXPORT_SYMBOL


1132 
ev’t_assign
(
ev’t
 *, 
ev’t_ba£
 *, 
evut_sock‘_t
, , 
ev’t_ÿÎback_â
, *);

1140 
EVENT2_EXPORT_SYMBOL


1141 
ev’t_ä“
(
ev’t
 *);

1146 (*
ev’t_fš®ize_ÿÎback_â
)(
	tev’t
 *, *);

1178 
EVENT2_EXPORT_SYMBOL


1179 
ev’t_fš®ize
(, 
ev’t
 *, 
ev’t_fš®ize_ÿÎback_â
);

1180 
EVENT2_EXPORT_SYMBOL


1181 
ev’t_ä“_fš®ize
(, 
ev’t
 *, 
ev’t_fš®ize_ÿÎback_â
);

1208 
EVENT2_EXPORT_SYMBOL


1209 
ev’t_ba£_Úû
(
ev’t_ba£
 *, 
evut_sock‘_t
, , 
ev’t_ÿÎback_â
, *, cÚ¡ 
timev®
 *);

1232 
EVENT2_EXPORT_SYMBOL


1233 
ev’t_add
(
ev’t
 *
ev
, cÚ¡ 
timev®
 *
timeout
);

1244 
EVENT2_EXPORT_SYMBOL


1245 
ev’t_»move_tim”
(
ev’t
 *
ev
);

1258 
EVENT2_EXPORT_SYMBOL


1259 
ev’t_d–
(
ev’t
 *);

1266 
EVENT2_EXPORT_SYMBOL


1267 
ev’t_d–_noblock
(
ev’t
 *
ev
);

1273 
EVENT2_EXPORT_SYMBOL


1274 
ev’t_d–_block
(
ev’t
 *
ev
);

1290 
EVENT2_EXPORT_SYMBOL


1291 
ev’t_aùive
(
ev’t
 *
ev
, 
»s
, 
nÿÎs
);

1306 
EVENT2_EXPORT_SYMBOL


1307 
ev’t_³ndšg
(cÚ¡ 
ev’t
 *
ev
, 
ev’ts
, 
timev®
 *
tv
);

1315 
EVENT2_EXPORT_SYMBOL


1316 
ev’t
 *
ev’t_ba£_g‘_ruÂšg_ev’t
(
ev’t_ba£
 *
ba£
);

1333 
EVENT2_EXPORT_SYMBOL


1334 
ev’t_š™Ÿlized
(cÚ¡ 
ev’t
 *
ev
);

1339 
	#ev’t_g‘_sigÇl
(
ev
è(()
	`ev’t_g‘_fd
Óv))

	)

1345 
EVENT2_EXPORT_SYMBOL


1346 
evut_sock‘_t
 
ev’t_g‘_fd
(cÚ¡ 
ev’t
 *
ev
);

1351 
EVENT2_EXPORT_SYMBOL


1352 
ev’t_ba£
 *
ev’t_g‘_ba£
(cÚ¡ 
ev’t
 *
ev
);

1357 
EVENT2_EXPORT_SYMBOL


1358 
ev’t_g‘_ev’ts
(cÚ¡ 
ev’t
 *
ev
);

1363 
EVENT2_EXPORT_SYMBOL


1364 
ev’t_ÿÎback_â
 
ev’t_g‘_ÿÎback
(cÚ¡ 
ev’t
 *
ev
);

1369 
EVENT2_EXPORT_SYMBOL


1370 *
ev’t_g‘_ÿÎback_¬g
(cÚ¡ 
ev’t
 *
ev
);

1376 
EVENT2_EXPORT_SYMBOL


1377 
ev’t_g‘_´iÜ™y
(cÚ¡ 
ev’t
 *
ev
);

1386 
EVENT2_EXPORT_SYMBOL


1387 
ev’t_g‘_assignm’t
(cÚ¡ 
ev’t
 *event,

1388 
ev’t_ba£
 **
ba£_out
, 
evut_sock‘_t
 *
fd_out
, *
ev’ts_out
,

1389 
ev’t_ÿÎback_â
 *
ÿÎback_out
, **
¬g_out
);

1404 
EVENT2_EXPORT_SYMBOL


1405 
size_t
 
ev’t_g‘_¡ruù_ev’t_size
();

1416 
EVENT2_EXPORT_SYMBOL


1417 cÚ¡ *
ev’t_g‘_v”siÚ
();

1430 
EVENT2_EXPORT_SYMBOL


1431 
ev_ušt32_t
 
ev’t_g‘_v”siÚ_numb”
();

1434 
	#LIBEVENT_VERSION
 
EVENT__VERSION


	)

1437 
	#LIBEVENT_VERSION_NUMBER
 
EVENT__NUMERIC_VERSION


	)

1440 
	#EVENT_MAX_PRIORITIES
 256

	)

1468 
EVENT2_EXPORT_SYMBOL


1469 
ev’t_ba£_´iÜ™y_š™
(
ev’t_ba£
 *, );

1478 
EVENT2_EXPORT_SYMBOL


1479 
ev’t_ba£_g‘_ÅriÜ™›s
(
ev’t_ba£
 *
eb
);

1489 
EVENT2_EXPORT_SYMBOL


1490 
ev’t_´iÜ™y_£t
(
ev’t
 *, );

1511 
EVENT2_EXPORT_SYMBOL


1512 cÚ¡ 
timev®
 *
ev’t_ba£_š™_commÚ_timeout
(
ev’t_ba£
 *
ba£
,

1513 cÚ¡ 
timev®
 *
du¿tiÚ
);

1515 #ià!
defšed
(
EVENT__DISABLE_MM_REPLACEMENT
è|| defšed(
EVENT_IN_DOXYGEN_
)

1538 
EVENT2_EXPORT_SYMBOL


1539 
ev’t_£t_mem_funùiÚs
(

1540 *(*
m®loc_â
)(
size_t
 
sz
),

1541 *(*
»®loc_â
)(*
±r
, 
size_t
 
sz
),

1542 (*
ä“_â
)(*
±r
));

1545 
	#EVENT_SET_MEM_FUNCTIONS_IMPLEMENTED


	)

1558 
EVENT2_EXPORT_SYMBOL


1559 
ev’t_ba£_dump_ev’ts
(
ev’t_ba£
 *, 
FILE
 *);

1572 
EVENT2_EXPORT_SYMBOL


1573 
ev’t_ba£_aùive_by_fd
(
ev’t_ba£
 *
ba£
, 
evut_sock‘_t
 
fd
, 
ev’ts
);

1584 
EVENT2_EXPORT_SYMBOL


1585 
ev’t_ba£_aùive_by_sigÇl
(
ev’t_ba£
 *
ba£
, 
sig
);

1590 (*
ev’t_ba£_fÜ—ch_ev’t_cb
)(cÚ¡ 
	tev’t_ba£
 *, cÚ¡ 
	tev’t
 *, *);

1617 
EVENT2_EXPORT_SYMBOL


1618 
ev’t_ba£_fÜ—ch_ev’t
(
ev’t_ba£
 *
ba£
, 
ev’t_ba£_fÜ—ch_ev’t_cb
 
â
, *
¬g
);

1632 
EVENT2_EXPORT_SYMBOL


1633 
ev’t_ba£_g‘timeofday_ÿched
(
ev’t_ba£
 *
ba£
,

1634 
timev®
 *
tv
);

1648 
EVENT2_EXPORT_SYMBOL


1649 
ev’t_ba£_upd©e_ÿche_time
(
ev’t_ba£
 *
ba£
);

1665 
EVENT2_EXPORT_SYMBOL


1666 
libev’t_glob®_shutdown
();

1668 #ifdeà
__ılu¥lus


	@/usr/include/event2/http.h

27 #iâdeà
EVENT2_HTTP_H_INCLUDED_


28 
	#EVENT2_HTTP_H_INCLUDED_


	)

31 
	~<ev’t2/ut.h
>

32 
	~<ev’t2/visib™y.h
>

34 #ifdeà
__ılu¥lus


39 
evbufãr
;

40 
ev’t_ba£
;

41 
bufã»v’t
;

42 
evh‰p_cÚÃùiÚ
;

56 
	#HTTP_OK
 200

	)

57 
	#HTTP_NOCONTENT
 204

	)

58 
	#HTTP_MOVEPERM
 301

	)

59 
	#HTTP_MOVETEMP
 302

	)

60 
	#HTTP_NOTMODIFIED
 304

	)

61 
	#HTTP_BADREQUEST
 400

	)

62 
	#HTTP_NOTFOUND
 404

	)

63 
	#HTTP_BADMETHOD
 405

	)

64 
	#HTTP_ENTITYTOOLARGE
 413

	)

65 
	#HTTP_EXPECTATIONFAILED
 417

	)

66 
	#HTTP_INTERNAL
 500

	)

67 
	#HTTP_NOTIMPLEMENTED
 501

	)

68 
	#HTTP_SERVUNAVAIL
 503

	)

70 
evh‰p
;

71 
evh‰p_»que¡
;

72 
evkeyv®q
;

73 
evh‰p_bound_sock‘
;

74 
evcÚÆi¡’”
;

75 
evdns_ba£
;

85 
EVENT2_EXPORT_SYMBOL


86 
evh‰p
 *
evh‰p_Ãw
(
ev’t_ba£
 *
ba£
);

100 
EVENT2_EXPORT_SYMBOL


101 
evh‰p_bšd_sock‘
(
evh‰p
 *
h‰p
, cÚ¡ *
add»ss
, 
ev_ušt16_t
 
pÜt
);

114 
EVENT2_EXPORT_SYMBOL


115 
evh‰p_bound_sock‘
 *
evh‰p_bšd_sock‘_w™h_hªdË
(
evh‰p
 *
h‰p
, cÚ¡ *
add»ss
, 
ev_ušt16_t
 
pÜt
);

133 
EVENT2_EXPORT_SYMBOL


134 
evh‰p_acû±_sock‘
(
evh‰p
 *
h‰p
, 
evut_sock‘_t
 
fd
);

146 
EVENT2_EXPORT_SYMBOL


147 
evh‰p_bound_sock‘
 *
evh‰p_acû±_sock‘_w™h_hªdË
(
evh‰p
 *
h‰p
, 
evut_sock‘_t
 
fd
);

154 
EVENT2_EXPORT_SYMBOL


155 
evh‰p_bound_sock‘
 *
evh‰p_bšd_li¡’”
(
evh‰p
 *
h‰p
, 
evcÚÆi¡’”
 *
li¡’”
);

160 
EVENT2_EXPORT_SYMBOL


161 
evcÚÆi¡’”
 *
evh‰p_bound_sock‘_g‘_li¡’”
(
evh‰p_bound_sock‘
 *
bound
);

163 
	tevh‰p_bound_sock‘_fÜ—ch_â
(
	tevh‰p_bound_sock‘
 *, *);

174 
EVENT2_EXPORT_SYMBOL


175 
evh‰p_fÜ—ch_bound_sock‘
(
evh‰p
 *
h‰p
, 
evh‰p_bound_sock‘_fÜ—ch_â
 *
funùiÚ
, *
¬gum’t
);

194 
EVENT2_EXPORT_SYMBOL


195 
evh‰p_d–_acû±_sock‘
(
evh‰p
 *
h‰p
, 
evh‰p_bound_sock‘
 *
bound_sock‘
);

204 
EVENT2_EXPORT_SYMBOL


205 
evut_sock‘_t
 
evh‰p_bound_sock‘_g‘_fd
(
evh‰p_bound_sock‘
 *
bound_sock‘
);

215 
EVENT2_EXPORT_SYMBOL


216 
evh‰p_ä“
(
evh‰p
* 
h‰p
);

219 
EVENT2_EXPORT_SYMBOL


220 
evh‰p_£t_max_h—d”s_size
(
evh‰p
* 
h‰p
, 
ev_ssize_t
 
max_h—d”s_size
);

222 
EVENT2_EXPORT_SYMBOL


223 
evh‰p_£t_max_body_size
(
evh‰p
* 
h‰p
, 
ev_ssize_t
 
max_body_size
);

233 
EVENT2_EXPORT_SYMBOL


234 
evh‰p_£t_deçuÉ_cÚ‹Á_ty³
(
evh‰p
 *
h‰p
,

235 cÚ¡ *
cÚ‹Á_ty³
);

248 
EVENT2_EXPORT_SYMBOL


249 
evh‰p_£t_®lowed_m‘hods
(
evh‰p
* 
h‰p
, 
ev_ušt16_t
 
m‘hods
);

260 
EVENT2_EXPORT_SYMBOL


261 
evh‰p_£t_cb
(
evh‰p
 *
h‰p
, cÚ¡ *
·th
,

262 (*
cb
)(
evh‰p_»que¡
 *, *), *
cb_¬g
);

265 
EVENT2_EXPORT_SYMBOL


266 
evh‰p_d–_cb
(
evh‰p
 *, const *);

279 
EVENT2_EXPORT_SYMBOL


280 
evh‰p_£t_g’cb
(
evh‰p
 *
h‰p
,

281 (*
cb
)(
evh‰p_»que¡
 *, *), *
¬g
);

297 
EVENT2_EXPORT_SYMBOL


298 
evh‰p_£t_bevcb
(
evh‰p
 *
h‰p
,

299 
bufã»v’t
 *(*
cb
)(
ev’t_ba£
 *, *), *
¬g
);

323 
EVENT2_EXPORT_SYMBOL


324 
evh‰p_add_vœtu®_ho¡
(
evh‰p
* 
h‰p
, cÚ¡ *
·‰”n
,

325 
evh‰p
* 
vho¡
);

335 
EVENT2_EXPORT_SYMBOL


336 
evh‰p_»move_vœtu®_ho¡
(
evh‰p
* 
h‰p
, evh‰p* 
vho¡
);

346 
EVENT2_EXPORT_SYMBOL


347 
evh‰p_add_£rv”_®Ÿs
(
evh‰p
 *
h‰p
, cÚ¡ *
®Ÿs
);

356 
EVENT2_EXPORT_SYMBOL


357 
evh‰p_»move_£rv”_®Ÿs
(
evh‰p
 *
h‰p
, cÚ¡ *
®Ÿs
);

365 
EVENT2_EXPORT_SYMBOL


366 
evh‰p_£t_timeout
(
evh‰p
 *
h‰p
, 
timeout_š_£cs
);

374 
EVENT2_EXPORT_SYMBOL


375 
evh‰p_£t_timeout_tv
(
evh‰p
 *
h‰p
, cÚ¡ 
timev®
* 
tv
);

379 
	#EVHTTP_SERVER_LINGERING_CLOSE
 0x0001

	)

387 
EVENT2_EXPORT_SYMBOL


388 
evh‰p_£t_æags
(
evh‰p
 *
h‰p
, 
æags
);

400 
EVENT2_EXPORT_SYMBOL


401 
evh‰p_£nd_”rÜ
(
evh‰p_»que¡
 *
»q
, 
”rÜ
,

402 cÚ¡ *
»asÚ
);

417 
EVENT2_EXPORT_SYMBOL


418 
evh‰p_£nd_»¶y
(
evh‰p_»que¡
 *
»q
, 
code
,

419 cÚ¡ *
»asÚ
, 
evbufãr
 *
d©abuf
);

437 
EVENT2_EXPORT_SYMBOL


438 
evh‰p_£nd_»¶y_¡¬t
(
evh‰p_»que¡
 *
»q
, 
code
,

439 cÚ¡ *
»asÚ
);

452 
EVENT2_EXPORT_SYMBOL


453 
evh‰p_£nd_»¶y_chunk
(
evh‰p_»que¡
 *
»q
,

454 
evbufãr
 *
d©abuf
);

469 
EVENT2_EXPORT_SYMBOL


470 
evh‰p_£nd_»¶y_chunk_w™h_cb
(
evh‰p_»que¡
 *, 
evbufãr
 *,

471 (*
cb
)(
evh‰p_cÚÃùiÚ
 *, *), *
¬g
);

478 
EVENT2_EXPORT_SYMBOL


479 
evh‰p_£nd_»¶y_’d
(
evh‰p_»que¡
 *
»q
);

492 
	eevh‰p_cmd_ty³
 {

493 
EVHTTP_REQ_GET
 = 1 << 0,

494 
EVHTTP_REQ_POST
 = 1 << 1,

495 
EVHTTP_REQ_HEAD
 = 1 << 2,

496 
EVHTTP_REQ_PUT
 = 1 << 3,

497 
EVHTTP_REQ_DELETE
 = 1 << 4,

498 
EVHTTP_REQ_OPTIONS
 = 1 << 5,

499 
EVHTTP_REQ_TRACE
 = 1 << 6,

500 
EVHTTP_REQ_CONNECT
 = 1 << 7,

501 
EVHTTP_REQ_PATCH
 = 1 << 8

505 
	eevh‰p_»que¡_kšd
 { 
EVHTTP_REQUEST
, 
EVHTTP_RESPONSE
 };

523 
EVENT2_EXPORT_SYMBOL


524 
evh‰p_cÚÃùiÚ
 *
evh‰p_cÚÃùiÚ_ba£_bufã»v’t_Ãw
(

525 
ev’t_ba£
 *
ba£
, 
evdns_ba£
 *
dnsba£
, 
bufã»v’t
* 
bev
, cÚ¡ *
add»ss
, 
ev_ušt16_t
 
pÜt
);

530 
EVENT2_EXPORT_SYMBOL


531 
bufã»v’t
* 
evh‰p_cÚÃùiÚ_g‘_bufã»v’t
(
evh‰p_cÚÃùiÚ
 *
evcÚ
);

536 
EVENT2_EXPORT_SYMBOL


537 
evh‰p
 *
evh‰p_cÚÃùiÚ_g‘_£rv”
(
evh‰p_cÚÃùiÚ
 *
evcÚ
);

544 
EVENT2_EXPORT_SYMBOL


545 
evh‰p_»que¡
 *
evh‰p_»que¡_Ãw
(

546 (*
cb
)(
evh‰p_»que¡
 *, *), *
¬g
);

555 
EVENT2_EXPORT_SYMBOL


556 
evh‰p_»que¡_£t_chunked_cb
(
evh‰p_»que¡
 *,

557 (*
cb
)(
evh‰p_»que¡
 *, *));

565 
EVENT2_EXPORT_SYMBOL


566 
evh‰p_»que¡_£t_h—d”_cb
(
evh‰p_»que¡
 *,

567 (*
cb
)(
evh‰p_»que¡
 *, *));

574 
	eevh‰p_»que¡_”rÜ
 {

578 
EVREQ_HTTP_TIMEOUT
,

582 
EVREQ_HTTP_EOF
,

586 
EVREQ_HTTP_INVALID_HEADER
,

590 
EVREQ_HTTP_BUFFER_ERROR
,

594 
EVREQ_HTTP_REQUEST_CANCEL
,

598 
EVREQ_HTTP_DATA_TOO_LONG


607 
EVENT2_EXPORT_SYMBOL


608 
evh‰p_»que¡_£t_”rÜ_cb
(
evh‰p_»que¡
 *,

609 (*)(
evh‰p_»que¡_”rÜ
, *));

623 
EVENT2_EXPORT_SYMBOL


624 
evh‰p_»que¡_£t_Ú_com¶‘e_cb
(
evh‰p_»que¡
 *
»q
,

625 (*
cb
)(
evh‰p_»que¡
 *, *), *
cb_¬g
);

628 
EVENT2_EXPORT_SYMBOL


629 
evh‰p_»que¡_ä“
(
evh‰p_»que¡
 *
»q
);

644 
EVENT2_EXPORT_SYMBOL


645 
evh‰p_cÚÃùiÚ
 *
evh‰p_cÚÃùiÚ_ba£_Ãw
(

646 
ev’t_ba£
 *
ba£
, 
evdns_ba£
 *
dnsba£
,

647 cÚ¡ *
add»ss
, 
ev_ušt16_t
 
pÜt
);

652 
EVENT2_EXPORT_SYMBOL


653 
evh‰p_cÚÃùiÚ_£t_çmy
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

654 
çmy
);

657 
	#EVHTTP_CON_REUSE_CONNECTED_ADDR
 0x0008

	)

661 
	#EVHTTP_CON_READ_ON_WRITE_ERROR
 0x0010

	)

663 
	#EVHTTP_CON_LINGERING_CLOSE
 0x0020

	)

665 
	#EVHTTP_CON_PUBLIC_FLAGS_END
 0x100000

	)

673 
EVENT2_EXPORT_SYMBOL


674 
evh‰p_cÚÃùiÚ_£t_æags
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

675 
æags
);

682 
EVENT2_EXPORT_SYMBOL


683 
evh‰p_»que¡_own
(
evh‰p_»que¡
 *
»q
);

686 
EVENT2_EXPORT_SYMBOL


687 
evh‰p_»que¡_is_owÃd
(
evh‰p_»que¡
 *
»q
);

695 
EVENT2_EXPORT_SYMBOL


696 
evh‰p_cÚÃùiÚ
 *
evh‰p_»que¡_g‘_cÚÃùiÚ
(
evh‰p_»que¡
 *
»q
);

701 
EVENT2_EXPORT_SYMBOL


702 
ev’t_ba£
 *
evh‰p_cÚÃùiÚ_g‘_ba£
(
evh‰p_cÚÃùiÚ
 *
»q
);

704 
EVENT2_EXPORT_SYMBOL


705 
evh‰p_cÚÃùiÚ_£t_max_h—d”s_size
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

706 
ev_ssize_t
 
Ãw_max_h—d”s_size
);

708 
EVENT2_EXPORT_SYMBOL


709 
evh‰p_cÚÃùiÚ_£t_max_body_size
(
evh‰p_cÚÃùiÚ
* 
evcÚ
,

710 
ev_ssize_t
 
Ãw_max_body_size
);

713 
EVENT2_EXPORT_SYMBOL


714 
evh‰p_cÚÃùiÚ_ä“
(
evh‰p_cÚÃùiÚ
 *
evcÚ
);

721 
EVENT2_EXPORT_SYMBOL


722 
evh‰p_cÚÃùiÚ_ä“_Ú_com¶‘iÚ
(
evh‰p_cÚÃùiÚ
 *
evcÚ
);

725 
EVENT2_EXPORT_SYMBOL


726 
evh‰p_cÚÃùiÚ_£t_loÿl_add»ss
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

727 cÚ¡ *
add»ss
);

730 
EVENT2_EXPORT_SYMBOL


731 
evh‰p_cÚÃùiÚ_£t_loÿl_pÜt
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

732 
ev_ušt16_t
 
pÜt
);

735 
EVENT2_EXPORT_SYMBOL


736 
evh‰p_cÚÃùiÚ_£t_timeout
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

737 
timeout_š_£cs
);

741 
EVENT2_EXPORT_SYMBOL


742 
evh‰p_cÚÃùiÚ_£t_timeout_tv
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

743 cÚ¡ 
timev®
 *
tv
);

749 
EVENT2_EXPORT_SYMBOL


750 
evh‰p_cÚÃùiÚ_£t_š™Ÿl_»Œy_tv
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

751 cÚ¡ 
timev®
 *
tv
);

754 
EVENT2_EXPORT_SYMBOL


755 
evh‰p_cÚÃùiÚ_£t_»Œ›s
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

756 
»Œy_max
);

759 
EVENT2_EXPORT_SYMBOL


760 
evh‰p_cÚÃùiÚ_£t_şo£cb
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

761 (*)(
evh‰p_cÚÃùiÚ
 *, *), *);

764 
EVENT2_EXPORT_SYMBOL


765 
evh‰p_cÚÃùiÚ_g‘_³”
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

766 **
add»ss
, 
ev_ušt16_t
 *
pÜt
);

774 
EVENT2_EXPORT_SYMBOL


775 cÚ¡ 
sockaddr
*

776 
evh‰p_cÚÃùiÚ_g‘_addr
(
evh‰p_cÚÃùiÚ
 *
evcÚ
);

791 
EVENT2_EXPORT_SYMBOL


792 
evh‰p_make_»que¡
(
evh‰p_cÚÃùiÚ
 *
evcÚ
,

793 
evh‰p_»que¡
 *
»q
,

794 
evh‰p_cmd_ty³
 
ty³
, cÚ¡ *
uri
);

809 
EVENT2_EXPORT_SYMBOL


810 
evh‰p_ÿnûl_»que¡
(
evh‰p_»que¡
 *
»q
);

815 
evh‰p_uri
;

818 
EVENT2_EXPORT_SYMBOL


819 cÚ¡ *
evh‰p_»que¡_g‘_uri
(cÚ¡ 
evh‰p_»que¡
 *
»q
);

821 
EVENT2_EXPORT_SYMBOL


822 cÚ¡ 
evh‰p_uri
 *
evh‰p_»que¡_g‘_evh‰p_uri
(cÚ¡ 
evh‰p_»que¡
 *
»q
);

824 
EVENT2_EXPORT_SYMBOL


825 
evh‰p_cmd_ty³
 
evh‰p_»que¡_g‘_commªd
(cÚ¡ 
evh‰p_»que¡
 *
»q
);

827 
EVENT2_EXPORT_SYMBOL


828 
evh‰p_»que¡_g‘_»¥Ú£_code
(cÚ¡ 
evh‰p_»que¡
 *
»q
);

829 
EVENT2_EXPORT_SYMBOL


830 cÚ¡ * 
evh‰p_»que¡_g‘_»¥Ú£_code_lše
(cÚ¡ 
evh‰p_»que¡
 *
»q
);

833 
EVENT2_EXPORT_SYMBOL


834 
evkeyv®q
 *
evh‰p_»que¡_g‘_šput_h—d”s
(
evh‰p_»que¡
 *
»q
);

836 
EVENT2_EXPORT_SYMBOL


837 
evkeyv®q
 *
evh‰p_»que¡_g‘_ouut_h—d”s
(
evh‰p_»que¡
 *
»q
);

839 
EVENT2_EXPORT_SYMBOL


840 
evbufãr
 *
evh‰p_»que¡_g‘_šput_bufãr
(
evh‰p_»que¡
 *
»q
);

842 
EVENT2_EXPORT_SYMBOL


843 
evbufãr
 *
evh‰p_»que¡_g‘_ouut_bufãr
(
evh‰p_»que¡
 *
»q
);

848 
EVENT2_EXPORT_SYMBOL


849 cÚ¡ *
evh‰p_»que¡_g‘_ho¡
(
evh‰p_»que¡
 *
»q
);

862 
EVENT2_EXPORT_SYMBOL


863 cÚ¡ *
evh‰p_fšd_h—d”
(cÚ¡ 
evkeyv®q
 *
h—d”s
,

864 cÚ¡ *
key
);

874 
EVENT2_EXPORT_SYMBOL


875 
evh‰p_»move_h—d”
(
evkeyv®q
 *
h—d”s
, cÚ¡ *
key
);

886 
EVENT2_EXPORT_SYMBOL


887 
evh‰p_add_h—d”
(
evkeyv®q
 *
h—d”s
, cÚ¡ *
key
, cÚ¡ *
v®ue
);

894 
EVENT2_EXPORT_SYMBOL


895 
evh‰p_ş—r_h—d”s
(
evkeyv®q
 *
h—d”s
);

911 
EVENT2_EXPORT_SYMBOL


912 *
evh‰p_’code_uri
(cÚ¡ *
¡r
);

928 
EVENT2_EXPORT_SYMBOL


929 *
evh‰p_ur›ncode
(cÚ¡ *
¡r
, 
ev_ssize_t
 
size
, 
¥aû_to_¶us
);

945 
EVENT2_EXPORT_SYMBOL


946 *
evh‰p_decode_uri
(cÚ¡ *
uri
);

963 
EVENT2_EXPORT_SYMBOL


964 *
evh‰p_uridecode
(cÚ¡ *
uri
, 
decode_¶us
,

965 
size_t
 *
size_out
);

986 
EVENT2_EXPORT_SYMBOL


987 
evh‰p_·r£_qu”y
(cÚ¡ *
uri
, 
evkeyv®q
 *
h—d”s
);

1006 
EVENT2_EXPORT_SYMBOL


1007 
evh‰p_·r£_qu”y_¡r
(cÚ¡ *
uri
, 
evkeyv®q
 *
h—d”s
);

1020 
EVENT2_EXPORT_SYMBOL


1021 *
evh‰p_htmËsÿ³
(cÚ¡ *
html
);

1026 
EVENT2_EXPORT_SYMBOL


1027 
evh‰p_uri
 *
evh‰p_uri_Ãw
();

1033 
EVENT2_EXPORT_SYMBOL


1034 
evh‰p_uri_£t_æags
(
evh‰p_uri
 *
uri
, 
æags
);

1038 
EVENT2_EXPORT_SYMBOL


1039 cÚ¡ *
evh‰p_uri_g‘_scheme
(cÚ¡ 
evh‰p_uri
 *
uri
);

1044 
EVENT2_EXPORT_SYMBOL


1045 cÚ¡ *
evh‰p_uri_g‘_u£ršfo
(cÚ¡ 
evh‰p_uri
 *
uri
);

1058 
EVENT2_EXPORT_SYMBOL


1059 cÚ¡ *
evh‰p_uri_g‘_ho¡
(cÚ¡ 
evh‰p_uri
 *
uri
);

1061 
EVENT2_EXPORT_SYMBOL


1062 
evh‰p_uri_g‘_pÜt
(cÚ¡ 
evh‰p_uri
 *
uri
);

1064 
EVENT2_EXPORT_SYMBOL


1065 cÚ¡ *
evh‰p_uri_g‘_·th
(cÚ¡ 
evh‰p_uri
 *
uri
);

1068 
EVENT2_EXPORT_SYMBOL


1069 cÚ¡ *
evh‰p_uri_g‘_qu”y
(cÚ¡ 
evh‰p_uri
 *
uri
);

1072 
EVENT2_EXPORT_SYMBOL


1073 cÚ¡ *
evh‰p_uri_g‘_äagm’t
(cÚ¡ 
evh‰p_uri
 *
uri
);

1077 
EVENT2_EXPORT_SYMBOL


1078 
evh‰p_uri_£t_scheme
(
evh‰p_uri
 *
uri
, cÚ¡ *
scheme
);

1081 
EVENT2_EXPORT_SYMBOL


1082 
evh‰p_uri_£t_u£ršfo
(
evh‰p_uri
 *
uri
, cÚ¡ *
u£ršfo
);

1085 
EVENT2_EXPORT_SYMBOL


1086 
evh‰p_uri_£t_ho¡
(
evh‰p_uri
 *
uri
, cÚ¡ *
ho¡
);

1089 
EVENT2_EXPORT_SYMBOL


1090 
evh‰p_uri_£t_pÜt
(
evh‰p_uri
 *
uri
, 
pÜt
);

1093 
EVENT2_EXPORT_SYMBOL


1094 
evh‰p_uri_£t_·th
(
evh‰p_uri
 *
uri
, cÚ¡ *
·th
);

1098 
EVENT2_EXPORT_SYMBOL


1099 
evh‰p_uri_£t_qu”y
(
evh‰p_uri
 *
uri
, cÚ¡ *
qu”y
);

1103 
EVENT2_EXPORT_SYMBOL


1104 
evh‰p_uri_£t_äagm’t
(
evh‰p_uri
 *
uri
, cÚ¡ *
äagm’t
);

1140 
EVENT2_EXPORT_SYMBOL


1141 
evh‰p_uri
 *
evh‰p_uri_·r£_w™h_æags
(cÚ¡ *
sourû_uri
,

1142 
æags
);

1156 
	#EVHTTP_URI_NONCONFORMANT
 0x01

	)

1159 
EVENT2_EXPORT_SYMBOL


1160 
evh‰p_uri
 *
evh‰p_uri_·r£
(cÚ¡ *
sourû_uri
);

1169 
EVENT2_EXPORT_SYMBOL


1170 
evh‰p_uri_ä“
(
evh‰p_uri
 *
uri
);

1185 
EVENT2_EXPORT_SYMBOL


1186 *
evh‰p_uri_još
(
evh‰p_uri
 *
uri
, *
buf
, 
size_t
 
lim™
);

1188 #ifdeà
__ılu¥lus


	@/usr/include/event2/http_struct.h

27 #iâdeà
EVENT2_HTTP_STRUCT_H_INCLUDED_


28 
	#EVENT2_HTTP_STRUCT_H_INCLUDED_


	)

37 #ifdeà
__ılu¥lus


41 
	~<ev’t2/ev’t-cÚfig.h
>

42 #ifdeà
EVENT__HAVE_SYS_TYPES_H


43 
	~<sys/ty³s.h
>

45 #ifdeà
EVENT__HAVE_SYS_TIME_H


46 
	~<sys/time.h
>

50 
	~<ev’t2/ut.h
>

57 
	sevh‰p_»que¡
 {

58 #ià
defšed
(
TAILQ_ENTRY
)

59 
TAILQ_ENTRY
(
evh‰p_»que¡
è
Ãxt
;

62 
evh‰p_»que¡
 *
tqe_Ãxt
;

63 
evh‰p_»que¡
 **
tqe_´ev
;

64 } 
Ãxt
;

68 
evh‰p_cÚÃùiÚ
 *
evcÚ
;

69 
æags
;

71 
	#EVHTTP_REQ_OWN_CONNECTION
 0x0001

	)

73 
	#EVHTTP_PROXY_REQUEST
 0x0002

	)

75 
	#EVHTTP_USER_OWNED
 0x0004

	)

77 
	#EVHTTP_REQ_DEFER_FREE
 0x0008

	)

79 
	#EVHTTP_REQ_NEEDS_FREE
 0x0010

	)

81 
evkeyv®q
 *
šput_h—d”s
;

82 
evkeyv®q
 *
ouut_h—d”s
;

85 *
»mÙe_ho¡
;

86 
ev_ušt16_t
 
»mÙe_pÜt
;

89 *
ho¡_ÿche
;

91 
evh‰p_»que¡_kšd
 
kšd
;

92 
evh‰p_cmd_ty³
 
ty³
;

94 
size_t
 
h—d”s_size
;

95 
size_t
 
body_size
;

97 *
uri
;

98 
evh‰p_uri
 *
uri_–ems
;

100 
majÜ
;

101 
mšÜ
;

103 
»¥Ú£_code
;

104 *
»¥Ú£_code_lše
;

106 
evbufãr
 *
šput_bufãr
;

107 
ev_št64_t
 
ÁÜ—d
;

108 
chunked
:1,

109 
u£rdÚe
:1;

111 
evbufãr
 *
ouut_bufãr
;

114 (*
cb
)(
evh‰p_»que¡
 *, *);

115 *
cb_¬g
;

122 (*
chunk_cb
)(
evh‰p_»que¡
 *, *);

129 (*
h—d”_cb
)(
evh‰p_»que¡
 *, *);

137 (*
”rÜ_cb
)(
evh‰p_»que¡_”rÜ
, *);

143 (*
Ú_com¶‘e_cb
)(
evh‰p_»que¡
 *, *);

144 *
Ú_com¶‘e_cb_¬g
;

147 #ifdeà
__ılu¥lus


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

27 
	~<b™s/ty³s.h
>

28 
	~<b™s/wch¬.h
>

29 
	~<b™s/wÜdsize.h
>

34 
	~<b™s/¡dšt-šŠ.h
>

37 
	~<b™s/¡dšt-ušŠ.h
>

43 
__št_Ëa¡8_t
 
	tšt_Ëa¡8_t
;

44 
__št_Ëa¡16_t
 
	tšt_Ëa¡16_t
;

45 
__št_Ëa¡32_t
 
	tšt_Ëa¡32_t
;

46 
__št_Ëa¡64_t
 
	tšt_Ëa¡64_t
;

49 
__ušt_Ëa¡8_t
 
	tušt_Ëa¡8_t
;

50 
__ušt_Ëa¡16_t
 
	tušt_Ëa¡16_t
;

51 
__ušt_Ëa¡32_t
 
	tušt_Ëa¡32_t
;

52 
__ušt_Ëa¡64_t
 
	tušt_Ëa¡64_t
;

58 sigÃd 
	tšt_ç¡8_t
;

59 #ià
__WORDSIZE
 == 64

60 
	tšt_ç¡16_t
;

61 
	tšt_ç¡32_t
;

62 
	tšt_ç¡64_t
;

64 
	tšt_ç¡16_t
;

65 
	tšt_ç¡32_t
;

66 
__ex‹nsiÚ__


67 
	tšt_ç¡64_t
;

71 
	tušt_ç¡8_t
;

72 #ià
__WORDSIZE
 == 64

73 
	tušt_ç¡16_t
;

74 
	tušt_ç¡32_t
;

75 
	tušt_ç¡64_t
;

77 
	tušt_ç¡16_t
;

78 
	tušt_ç¡32_t
;

79 
__ex‹nsiÚ__


80 
	tušt_ç¡64_t
;

85 #ià
__WORDSIZE
 == 64

86 #iâdeà
__šŒ_t_defšed


87 
	tšŒ_t
;

88 
	#__šŒ_t_defšed


	)

90 
	tušŒ_t
;

92 #iâdeà
__šŒ_t_defšed


93 
	tšŒ_t
;

94 
	#__šŒ_t_defšed


	)

96 
	tušŒ_t
;

101 
__štmax_t
 
	tštmax_t
;

102 
__uštmax_t
 
	tuštmax_t
;

105 #ià
__WORDSIZE
 == 64

106 
	#__INT64_C
(
c
èø## 
L


	)

107 
	#__UINT64_C
(
c
èø## 
UL


	)

109 
	#__INT64_C
(
c
èø## 
LL


	)

110 
	#__UINT64_C
(
c
èø## 
ULL


	)

116 
	#INT8_MIN
 (-128)

	)

117 
	#INT16_MIN
 (-32767-1)

	)

118 
	#INT32_MIN
 (-2147483647-1)

	)

119 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

121 
	#INT8_MAX
 (127)

	)

122 
	#INT16_MAX
 (32767)

	)

123 
	#INT32_MAX
 (2147483647)

	)

124 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

127 
	#UINT8_MAX
 (255)

	)

128 
	#UINT16_MAX
 (65535)

	)

129 
	#UINT32_MAX
 (4294967295U)

	)

130 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

134 
	#INT_LEAST8_MIN
 (-128)

	)

135 
	#INT_LEAST16_MIN
 (-32767-1)

	)

136 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

137 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

139 
	#INT_LEAST8_MAX
 (127)

	)

140 
	#INT_LEAST16_MAX
 (32767)

	)

141 
	#INT_LEAST32_MAX
 (2147483647)

	)

142 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

145 
	#UINT_LEAST8_MAX
 (255)

	)

146 
	#UINT_LEAST16_MAX
 (65535)

	)

147 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

148 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

152 
	#INT_FAST8_MIN
 (-128)

	)

153 #ià
__WORDSIZE
 == 64

154 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

155 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

157 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

158 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

160 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

162 
	#INT_FAST8_MAX
 (127)

	)

163 #ià
__WORDSIZE
 == 64

164 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

165 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

167 
	#INT_FAST16_MAX
 (2147483647)

	)

168 
	#INT_FAST32_MAX
 (2147483647)

	)

170 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

173 
	#UINT_FAST8_MAX
 (255)

	)

174 #ià
__WORDSIZE
 == 64

175 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

176 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

178 
	#UINT_FAST16_MAX
 (4294967295U)

	)

179 
	#UINT_FAST32_MAX
 (4294967295U)

	)

181 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

185 #ià
__WORDSIZE
 == 64

186 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

187 
	#INTPTR_MAX
 (9223372036854775807L)

	)

188 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

190 
	#INTPTR_MIN
 (-2147483647-1)

	)

191 
	#INTPTR_MAX
 (2147483647)

	)

192 
	#UINTPTR_MAX
 (4294967295U)

	)

197 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

199 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

202 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

208 #ià
__WORDSIZE
 == 64

209 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

210 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

212 #ià
__WORDSIZE32_PTRDIFF_LONG


213 
	#PTRDIFF_MIN
 (-2147483647L-1)

	)

214 
	#PTRDIFF_MAX
 (2147483647L)

	)

216 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

217 
	#PTRDIFF_MAX
 (2147483647)

	)

222 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

223 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

226 #ià
__WORDSIZE
 == 64

227 
	#SIZE_MAX
 (18446744073709551615UL)

	)

229 #ià
__WORDSIZE32_SIZE_ULONG


230 
	#SIZE_MAX
 (4294967295UL)

	)

232 
	#SIZE_MAX
 (4294967295U)

	)

237 #iâdeà
WCHAR_MIN


239 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

240 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

244 
	#WINT_MIN
 (0u)

	)

245 
	#WINT_MAX
 (4294967295u)

	)

248 
	#INT8_C
(
c
è
	)
c

249 
	#INT16_C
(
c
è
	)
c

250 
	#INT32_C
(
c
è
	)
c

251 #ià
__WORDSIZE
 == 64

252 
	#INT64_C
(
c
èø## 
L


	)

254 
	#INT64_C
(
c
èø## 
LL


	)

258 
	#UINT8_C
(
c
è
	)
c

259 
	#UINT16_C
(
c
è
	)
c

260 
	#UINT32_C
(
c
èø## 
U


	)

261 #ià
__WORDSIZE
 == 64

262 
	#UINT64_C
(
c
èø## 
UL


	)

264 
	#UINT64_C
(
c
èø## 
ULL


	)

268 #ià
__WORDSIZE
 == 64

269 
	#INTMAX_C
(
c
èø## 
L


	)

270 
	#UINTMAX_C
(
c
èø## 
UL


	)

272 
	#INTMAX_C
(
c
èø## 
LL


	)

273 
	#UINTMAX_C
(
c
èø## 
ULL


	)

276 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT_C2X
)

278 
	#INT8_WIDTH
 8

	)

279 
	#UINT8_WIDTH
 8

	)

280 
	#INT16_WIDTH
 16

	)

281 
	#UINT16_WIDTH
 16

	)

282 
	#INT32_WIDTH
 32

	)

283 
	#UINT32_WIDTH
 32

	)

284 
	#INT64_WIDTH
 64

	)

285 
	#UINT64_WIDTH
 64

	)

287 
	#INT_LEAST8_WIDTH
 8

	)

288 
	#UINT_LEAST8_WIDTH
 8

	)

289 
	#INT_LEAST16_WIDTH
 16

	)

290 
	#UINT_LEAST16_WIDTH
 16

	)

291 
	#INT_LEAST32_WIDTH
 32

	)

292 
	#UINT_LEAST32_WIDTH
 32

	)

293 
	#INT_LEAST64_WIDTH
 64

	)

294 
	#UINT_LEAST64_WIDTH
 64

	)

296 
	#INT_FAST8_WIDTH
 8

	)

297 
	#UINT_FAST8_WIDTH
 8

	)

298 
	#INT_FAST16_WIDTH
 
__WORDSIZE


	)

299 
	#UINT_FAST16_WIDTH
 
__WORDSIZE


	)

300 
	#INT_FAST32_WIDTH
 
__WORDSIZE


	)

301 
	#UINT_FAST32_WIDTH
 
__WORDSIZE


	)

302 
	#INT_FAST64_WIDTH
 64

	)

303 
	#UINT_FAST64_WIDTH
 64

	)

305 
	#INTPTR_WIDTH
 
__WORDSIZE


	)

306 
	#UINTPTR_WIDTH
 
__WORDSIZE


	)

308 
	#INTMAX_WIDTH
 64

	)

309 
	#UINTMAX_WIDTH
 64

	)

311 
	#PTRDIFF_WIDTH
 
__WORDSIZE


	)

312 
	#SIG_ATOMIC_WIDTH
 32

	)

313 
	#SIZE_WIDTH
 
__WORDSIZE


	)

314 
	#WCHAR_WIDTH
 32

	)

315 
	#WINT_WIDTH
 32

	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


24 
	#_STDIO_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	#__Ãed___va_li¡


	)

36 
	~<¡d¬g.h
>

38 
	~<b™s/ty³s.h
>

39 
	~<b™s/ty³s/__åos_t.h
>

40 
	~<b™s/ty³s/__åos64_t.h
>

41 
	~<b™s/ty³s/__FILE.h
>

42 
	~<b™s/ty³s/FILE.h
>

43 
	~<b™s/ty³s/¡ruù_FILE.h
>

45 #ifdeà
__USE_GNU


46 
	~<b™s/ty³s/cook›_io_funùiÚs_t.h
>

49 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


50 #ifdeà
__GNUC__


51 #iâdeà
_VA_LIST_DEFINED


52 
__gnuc_va_li¡
 
	tva_li¡
;

53 
	#_VA_LIST_DEFINED


	)

56 
	~<¡d¬g.h
>

60 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


61 #iâdeà
__off_t_defšed


62 #iâdeà
__USE_FILE_OFFSET64


63 
__off_t
 
	toff_t
;

65 
__off64_t
 
	toff_t
;

67 
	#__off_t_defšed


	)

69 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


70 
__off64_t
 
	toff64_t
;

71 
	#__off64_t_defšed


	)

75 #ifdeà
__USE_XOPEN2K8


76 #iâdeà
__ssize_t_defšed


77 
__ssize_t
 
	tssize_t
;

78 
	#__ssize_t_defšed


	)

83 #iâdeà
__USE_FILE_OFFSET64


84 
__åos_t
 
	tåos_t
;

86 
__åos64_t
 
	tåos_t
;

88 #ifdeà
__USE_LARGEFILE64


89 
__åos64_t
 
	tåos64_t
;

93 
	#_IOFBF
 0

	)

94 
	#_IOLBF
 1

	)

95 
	#_IONBF
 2

	)

99 
	#BUFSIZ
 8192

	)

104 
	#EOF
 (-1)

	)

109 
	#SEEK_SET
 0

	)

110 
	#SEEK_CUR
 1

	)

111 
	#SEEK_END
 2

	)

112 #ifdeà
__USE_GNU


113 
	#SEEK_DATA
 3

	)

114 
	#SEEK_HOLE
 4

	)

118 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


120 
	#P_tmpdœ
 "/tmp"

	)

133 
	~<b™s/¡dio_lim.h
>

137 
FILE
 *
¡dš
;

138 
FILE
 *
¡dout
;

139 
FILE
 *
¡d”r
;

141 
	#¡dš
 
¡dš


	)

142 
	#¡dout
 
¡dout


	)

143 
	#¡d”r
 
¡d”r


	)

146 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

148 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

150 #ifdeà
__USE_ATFILE


152 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

153 cÚ¡ *
__Ãw
è
__THROW
;

156 #ifdeà
__USE_GNU


158 
	#RENAME_NOREPLACE
 (1 << 0)

	)

159 
	#RENAME_EXCHANGE
 (1 << 1)

	)

160 
	#RENAME_WHITEOUT
 (1 << 2)

	)

164 
	$»Çm—t2
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

165 cÚ¡ *
__Ãw
, 
__æags
è
__THROW
;

172 #iâdeà
__USE_FILE_OFFSET64


173 
FILE
 *
	$tmpfe
 (è
__wur
;

175 #ifdeà
__REDIRECT


176 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

178 
	#tmpfe
 
tmpfe64


	)

182 #ifdeà
__USE_LARGEFILE64


183 
FILE
 *
	$tmpfe64
 (è
__wur
;

187 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

189 #ifdeà
__USE_MISC


192 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

196 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


204 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

205 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

213 
	`fşo£
 (
FILE
 *
__¡»am
);

218 
	`fæush
 (
FILE
 *
__¡»am
);

220 #ifdeà
__USE_MISC


227 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

230 #ifdeà
__USE_GNU


237 
	`fşo£®l
 ();

241 #iâdeà
__USE_FILE_OFFSET64


246 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

247 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

252 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

253 cÚ¡ *
__»¡riù
 
__modes
,

254 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

256 #ifdeà
__REDIRECT


257 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

258 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

259 
__wur
;

260 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

261 cÚ¡ *
__»¡riù
 
__modes
,

262 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

263 
__wur
;

265 
	#fİ’
 
fİ’64


	)

266 
	#äeİ’
 
äeİ’64


	)

269 #ifdeà
__USE_LARGEFILE64


270 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

271 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

272 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

273 cÚ¡ *
__»¡riù
 
__modes
,

274 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

277 #ifdef 
__USE_POSIX


279 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

282 #ifdef 
__USE_GNU


285 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

286 cÚ¡ *
__»¡riù
 
__modes
,

287 
cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

290 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

292 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

293 
__THROW
 
__wur
;

298 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

304 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

308 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

309 
__modes
, 
size_t
 
__n
è
__THROW
;

311 #ifdef 
__USE_MISC


314 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

315 
size_t
 
__size
è
__THROW
;

318 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

326 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

327 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

332 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

334 
	$¥rštf
 (*
__»¡riù
 
__s
,

335 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

341 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

342 
__gnuc_va_li¡
 
__¬g
);

347 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
__gnuc_va_li¡
 
__¬g
);

349 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

350 
__gnuc_va_li¡
 
__¬g
è
__THROWNL
;

352 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


354 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

355 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

356 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

358 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

359 cÚ¡ *
__»¡riù
 
__fÜm©
, 
__gnuc_va_li¡
 
__¬g
)

360 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

363 #ià
	`__GLIBC_USE
 (
LIB_EXT2
)

366 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

367 
__gnuc_va_li¡
 
__¬g
)

368 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

369 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

370 cÚ¡ *
__»¡riù
 
__fmt
, ...)

371 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

372 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

373 cÚ¡ *
__»¡riù
 
__fmt
, ...)

374 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

377 #ifdeà
__USE_XOPEN2K8


379 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

380 
__gnuc_va_li¡
 
__¬g
)

381 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

382 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

383 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

391 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

392 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

397 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

399 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

400 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

405 #ià!
	`__GLIBC_USE
 (
DEPRECATED_SCANF
è&& !
defšed
 
__LDBL_COMPAT


406 #ifdeà
__REDIRECT


407 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

408 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

409 
__isoc99_fsÿnf
è
__wur
;

410 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

411 
__isoc99_sÿnf
è
__wur
;

412 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

413 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

414 
__isoc99_ssÿnf
);

416 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

417 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

418 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

419 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

420 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

421 
	#fsÿnf
 
__isoc99_fsÿnf


	)

422 
	#sÿnf
 
__isoc99_sÿnf


	)

423 
	#ssÿnf
 
__isoc99_ssÿnf


	)

427 #ifdef 
__USE_ISOC99


432 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

433 
__gnuc_va_li¡
 
__¬g
)

434 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

440 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
__gnuc_va_li¡
 
__¬g
)

441 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

444 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

445 cÚ¡ *
__»¡riù
 
__fÜm©
, 
__gnuc_va_li¡
 
__¬g
)

446 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

449 #ià!
	`__GLIBC_USE
 (
DEPRECATED_SCANF
)

450 #ià
defšed
 
__REDIRECT
 && !defšed 
__LDBL_COMPAT


451 
	`__REDIRECT
 (
vfsÿnf
,

452 (
FILE
 *
__»¡riù
 
__s
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
, 
__gnuc_va_li¡
 
__¬g
),

454 
__isoc99_vfsÿnf
)

455 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

456 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

457 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

458 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

459 
	`__REDIRECT_NTH
 (
vssÿnf
,

460 (cÚ¡ *
__»¡riù
 
__s
,

461 cÚ¡ *
__»¡riù
 
__fÜm©
,

462 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

463 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

464 #–ià!
defšed
 
__REDIRECT


465 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

466 cÚ¡ *
__»¡riù
 
__fÜm©
,

467 
__gnuc_va_li¡
 
__¬g
è
__wur
;

468 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

469 
__gnuc_va_li¡
 
__¬g
è
__wur
;

470 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

471 cÚ¡ *
__»¡riù
 
__fÜm©
,

472 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

473 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

474 
	#vsÿnf
 
__isoc99_vsÿnf


	)

475 
	#vssÿnf
 
__isoc99_vssÿnf


	)

485 
	`fg‘c
 (
FILE
 *
__¡»am
);

486 
	`g‘c
 (
FILE
 *
__¡»am
);

492 
	`g‘ch¬
 ();

494 #ifdeà
__USE_POSIX199506


499 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

500 
	`g‘ch¬_uÆocked
 ();

503 #ifdeà
__USE_MISC


510 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

521 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

522 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

528 
	`putch¬
 (
__c
);

530 #ifdeà
__USE_MISC


537 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

540 #ifdeà
__USE_POSIX199506


545 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

546 
	`putch¬_uÆocked
 (
__c
);

550 #ià
defšed
 
__USE_MISC
 \

551 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

553 
	`g‘w
 (
FILE
 *
__¡»am
);

556 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

564 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

565 
__wur
;

567 #ià
	`__GLIBC_USE
 (
DEPRECATED_GETS
)

577 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

580 #ifdeà
__USE_GNU


587 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

588 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

592 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

603 
__ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

604 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

605 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

606 
__ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

607 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

608 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

616 
__ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

617 
size_t
 *
__»¡riù
 
__n
,

618 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

626 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

632 
	`puts
 (cÚ¡ *
__s
);

639 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

646 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

647 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

652 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

653 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

655 #ifdeà
__USE_GNU


662 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

663 
FILE
 *
__»¡riù
 
__¡»am
);

666 #ifdeà
__USE_MISC


673 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

674 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

675 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

676 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

684 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

689 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

694 
	`»wšd
 (
FILE
 *
__¡»am
);

701 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


702 #iâdeà
__USE_FILE_OFFSET64


707 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

712 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

714 #ifdeà
__REDIRECT


715 
	`__REDIRECT
 (
f£eko
,

716 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

717 
f£eko64
);

718 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

720 
	#f£eko
 
f£eko64


	)

721 
	#á–lo
 
á–lo64


	)

726 #iâdeà
__USE_FILE_OFFSET64


731 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

736 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

738 #ifdeà
__REDIRECT


739 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

740 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

741 
	`__REDIRECT
 (
f£os
,

742 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

744 
	#fg‘pos
 
fg‘pos64


	)

745 
	#f£os
 
f£os64


	)

749 #ifdeà
__USE_LARGEFILE64


750 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

751 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

752 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

753 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

757 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

759 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

761 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

763 #ifdeà
__USE_MISC


765 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

766 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

767 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

775 
	`³¼Ü
 (cÚ¡ *
__s
);

781 
	~<b™s/sys_”¾i¡.h
>

784 #ifdef 
__USE_POSIX


786 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

789 #ifdeà
__USE_MISC


791 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

795 #ifdeà
__USE_POSIX2


800 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

806 
	`pşo£
 (
FILE
 *
__¡»am
);

810 #ifdef 
__USE_POSIX


812 *
	$ù”mid
 (*
__s
è
__THROW
;

816 #ià(
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
è|| defšed 
__USE_GNU


818 *
	`cu£rid
 (*
__s
);

822 #ifdef 
__USE_GNU


823 
ob¡ack
;

826 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

827 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

828 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

829 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

830 cÚ¡ *
__»¡riù
 
__fÜm©
,

831 
__gnuc_va_li¡
 
__¬gs
)

832 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

836 #ifdeà
__USE_POSIX199506


840 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

844 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

847 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

850 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


853 
	~<b™s/g‘İt_posix.h
>

858 
	`__uæow
 (
FILE
 *);

859 
	`__ov”æow
 (
FILE
 *, );

863 #ifdeà
__USE_EXTERN_INLINES


864 
	~<b™s/¡dio.h
>

866 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


867 
	~<b™s/¡dio2.h
>

869 #ifdeà
__LDBL_COMPAT


870 
	~<b™s/¡dio-ldbl.h
>

873 
__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


23 
	#_TIME_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 
	#__Ãed_NULL


	)

29 
	~<¡ddef.h
>

33 
	~<b™s/time.h
>

37 
	~<b™s/ty³s/şock_t.h
>

38 
	~<b™s/ty³s/time_t.h
>

39 
	~<b™s/ty³s/¡ruù_tm.h
>

41 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_ISOC11


42 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

45 #ifdeà
__USE_POSIX199309


46 
	~<b™s/ty³s/şockid_t.h
>

47 
	~<b™s/ty³s/tim”_t.h
>

48 
	~<b™s/ty³s/¡ruù_™im”¥ec.h
>

49 
	gsigev’t
;

52 #ifdeà
__USE_XOPEN2K


53 #iâdeà
__pid_t_defšed


54 
__pid_t
 
	tpid_t
;

55 
	#__pid_t_defšed


	)

59 #ifdeà
__USE_XOPEN2K8


60 
	~<b™s/ty³s/loÿË_t.h
>

63 #ifdeà
__USE_ISOC11


65 
	#TIME_UTC
 1

	)

68 
__BEGIN_DECLS


72 
şock_t
 
	$şock
 (è
__THROW
;

75 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

78 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

79 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

82 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

88 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

89 cÚ¡ *
__»¡riù
 
__fÜm©
,

90 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

92 #ifdeà
__USE_XOPEN


95 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

96 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

97 
__THROW
;

100 #ifdeà
__USE_XOPEN2K8


104 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

105 cÚ¡ *
__»¡riù
 
__fÜm©
,

106 cÚ¡ 
tm
 *
__»¡riù
 
__
,

107 
loÿË_t
 
__loc
è
__THROW
;

110 #ifdeà
__USE_GNU


111 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

112 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

113 
loÿË_t
 
__loc
è
__THROW
;

119 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

123 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

125 #ià
defšed
 
__USE_POSIX
 || 
	`__GLIBC_USE
 (
ISOC2X
)

128 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

129 
tm
 *
__»¡riù
 
__
è
__THROW
;

133 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

134 
tm
 *
__»¡riù
 
__
è
__THROW
;

139 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

142 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

144 #ià
defšed
 
__USE_POSIX
 || 
	`__GLIBC_USE
 (
ISOC2X
)

149 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

150 *
__»¡riù
 
__buf
è
__THROW
;

153 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

154 *
__»¡riù
 
__buf
è
__THROW
;

159 *
__tzÇme
[2];

160 
__daylight
;

161 
__timezÚe
;

164 #ifdef 
__USE_POSIX


166 *
tzÇme
[2];

170 
	$tz£t
 (è
__THROW
;

173 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


174 
daylight
;

175 
timezÚe
;

181 
	#__i¦—p
(
y—r
) \

182 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

185 #ifdeà
__USE_MISC


190 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

193 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

196 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

200 #ifdeà
__USE_POSIX199309


205 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

206 
time¥ec
 *
__»maššg
);

210 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

213 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

216 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

217 
__THROW
;

219 #ifdeà
__USE_XOPEN2K


224 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

225 cÚ¡ 
time¥ec
 *
__»q
,

226 
time¥ec
 *
__»m
);

229 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

234 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

235 
sigev’t
 *
__»¡riù
 
__evp
,

236 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

239 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

242 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

243 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

244 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

247 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

248 
__THROW
;

251 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

255 #ifdeà
__USE_ISOC11


257 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

258 
__THROW
 
	`__nÚnuÎ
 ((1));

262 #ifdeà
__USE_XOPEN_EXTENDED


274 
g‘d©e_”r
;

283 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

286 #ifdeà
__USE_GNU


297 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

298 
tm
 *
__»¡riù
 
__»sbuå
);

301 
__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

70 
	#_POSIX2_C_VERSION
 
__POSIX2_THIS_VERSION


	)

74 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

78 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

82 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

86 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

89 #ifdeà
__USE_XOPEN2K8


90 
	#_XOPEN_VERSION
 700

	)

91 #–ià
defšed
 
__USE_XOPEN2K


92 
	#_XOPEN_VERSION
 600

	)

93 #–ià
defšed
 
__USE_UNIX98


94 
	#_XOPEN_VERSION
 500

	)

96 
	#_XOPEN_VERSION
 4

	)

100 
	#_XOPEN_XCU_VERSION
 4

	)

103 
	#_XOPEN_XPG2
 1

	)

104 
	#_XOPEN_XPG3
 1

	)

105 
	#_XOPEN_XPG4
 1

	)

108 
	#_XOPEN_UNIX
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<b™s/posix_İt.h
>

205 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


206 
	~<b™s/’vœÚm’ts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<b™s/ty³s.h
>

219 #iâdef 
__ssize_t_defšed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_defšed


	)

224 
	#__Ãed_size_t


	)

225 
	#__Ãed_NULL


	)

226 
	~<¡ddef.h
>

228 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


231 #iâdeà
__gid_t_defšed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_defšed


	)

236 #iâdeà
__uid_t_defšed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_defšed


	)

241 #iâdeà
__off_t_defšed


242 #iâdeà
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_defšed


	)

249 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_defšed


	)

254 #iâdeà
__u£cÚds_t_defšed


255 
__u£cÚds_t
 
	tu£cÚds_t
;

256 
	#__u£cÚds_t_defšed


	)

259 #iâdeà
__pid_t_defšed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_defšed


	)

265 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


266 #iâdeà
__šŒ_t_defšed


267 
__šŒ_t
 
	tšŒ_t
;

268 
	#__šŒ_t_defšed


	)

272 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


273 #iâdeà
__sockËn_t_defšed


274 
__sockËn_t
 
	tsockËn_t
;

275 
	#__sockËn_t_defšed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

289 #ifdeà
__USE_GNU


292 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

293 
__THROW
 
	`__nÚnuÎ
 ((1));

296 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

297 
__THROW
 
	`__nÚnuÎ
 ((1));

300 #ifdeà
__USE_ATFILE


304 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

305 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

310 #iâdef 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifdeà
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #ià
defšed
 
__USE_MISC
 && !defšed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #iâdeà
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

336 #ifdeà
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifdeà
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

346 
__THROW
;

353 
	`şo£
 (
__fd
);

360 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

366 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

368 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


369 #iâdeà
__USE_FILE_OFFSET64


376 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

377 
__off_t
 
__off£t
è
__wur
;

384 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
è
__wur
;

387 #ifdeà
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

389 
__off64_t
 
__off£t
),

390 
´—d64
è
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

392 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

393 
pwr™e64
è
__wur
;

395 
	#´—d
 
´—d64


	)

396 
	#pwr™e
 
pwr™e64


	)

400 #ifdeà
__USE_LARGEFILE64


404 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

405 
__off64_t
 
__off£t
è
__wur
;

408 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
è
__wur
;

417 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

419 #ifdeà
__USE_GNU


422 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

432 
	$®¬m
 (
__£cÚds
è
__THROW
;

444 
	`¦“p
 (
__£cÚds
);

446 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

447 || 
defšed
 
__USE_MISC


452 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

453 
__THROW
;

460 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

469 
	`·u£
 ();

473 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

476 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

483 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

488 #ifdeà
__USE_ATFILE


491 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

492 
__gid_t
 
__group
, 
__æag
)

493 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

497 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

499 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


501 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

511 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

520 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

521 || 
defšed
 
__USE_MISC


525 *
	$g‘wd
 (*
__buf
)

526 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

531 
	$dup
 (
__fd
è
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

536 #ifdeà
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

543 **
__’vœÚ
;

544 #ifdeà
__USE_GNU


545 **
’vœÚ
;

551 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

552 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

554 #ifdeà
__USE_XOPEN2K8


557 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

558 
__THROW
 
	`__nÚnuÎ
 ((2));

563 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

564 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

568 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

569 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

573 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

574 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

578 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

584 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

585 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 #ifdeà
__USE_GNU


590 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

591 *cÚ¡ 
__’vp
[])

592 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

596 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


598 
	$niû
 (
__šc
è
__THROW
 
__wur
;

603 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

609 
	~<b™s/cÚâame.h
>

612 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

613 
__THROW
 
	`__nÚnuÎ
 ((1));

616 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

619 
	$syscÚf
 (
__Çme
è
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

628 
__pid_t
 
	$g‘pid
 (è
__THROW
;

631 
__pid_t
 
	$g‘µid
 (è
__THROW
;

634 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

637 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

638 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


639 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

646 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

648 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


660 
	$£g½
 (è
__THROW
;

667 
__pid_t
 
	$£tsid
 (è
__THROW
;

669 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


671 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

675 
__uid_t
 
	$g‘uid
 (è
__THROW
;

678 
__uid_t
 
	$g‘euid
 (è
__THROW
;

681 
__gid_t
 
	$g‘gid
 (è
__THROW
;

684 
__gid_t
 
	$g‘egid
 (è
__THROW
;

689 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

691 #ifdef 
__USE_GNU


693 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

700 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

702 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


705 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

708 #ifdeà
__USE_XOPEN2K


710 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

717 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

719 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


722 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

725 #ifdeà
__USE_XOPEN2K


727 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

730 #ifdeà
__USE_GNU


733 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

734 
__THROW
;

738 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

739 
__THROW
;

743 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

744 
__THROW
 
__wur
;

748 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

749 
__THROW
 
__wur
;

756 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

758 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

759 || 
defšed
 
__USE_MISC


764 
__pid_t
 
	$vfÜk
 (è
__THROW
;

770 *
	$‰yÇme
 (
__fd
è
__THROW
;

774 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

775 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

779 
	$i§‰y
 (
__fd
è
__THROW
;

781 #ifdeà
__USE_MISC


784 
	$‰y¦Ù
 (è
__THROW
;

789 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

790 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

792 #ifdeà
__USE_ATFILE


795 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

796 cÚ¡ *
__to
, 
__æags
)

797 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

800 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


802 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

803 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

808 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

809 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

810 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

813 #ifdeà
__USE_ATFILE


815 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

816 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

819 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

820 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

821 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

825 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

827 #ifdeà
__USE_ATFILE


829 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

830 
__THROW
 
	`__nÚnuÎ
 ((2));

834 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

838 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

841 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

848 *
	`g‘logš
 ();

849 #ifdeà
__USE_POSIX199506


856 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

859 #ifdef 
__USE_MISC


861 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

865 #ifdef 
__USE_POSIX2


869 
	~<b™s/g‘İt_posix.h
>

873 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


877 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

881 #ià
defšed
 
__USE_MISC


884 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

885 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

889 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

895 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

896 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

897 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

898 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

904 
	$vhªgup
 (è
__THROW
;

907 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

915 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

916 
size_t
 
__off£t
, 
__sÿË
)

917 
__THROW
 
	`__nÚnuÎ
 ((1));

923 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

927 *
	$g‘u£rsh–l
 (è
__THROW
;

928 
	$’du£rsh–l
 (è
__THROW
;

929 
	$£tu£rsh–l
 (è
__THROW
;

935 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

939 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

942 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

946 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

954 
	`fsync
 (
__fd
);

957 #ifdeà
__USE_GNU


960 
	$syncfs
 (
__fd
è
__THROW
;

964 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


967 
	`g‘ho¡id
 ();

970 
	$sync
 (è
__THROW
;

973 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K


976 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

981 
	$g‘dbËsize
 (è
__THROW
;

987 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


990 #iâdeà
__USE_FILE_OFFSET64


991 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

992 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

994 #ifdeà
__REDIRECT_NTH


995 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

996 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

997 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

999 
	#Œunÿ‹
 
Œunÿ‹64


	)

1002 #ifdeà
__USE_LARGEFILE64


1003 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1004 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1009 #ià
defšed
 
__USE_POSIX199309
 \

1010 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1013 #iâdeà
__USE_FILE_OFFSET64


1014 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1016 #ifdeà
__REDIRECT_NTH


1017 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1018 
árunÿ‹64
è
__wur
;

1020 
	#árunÿ‹
 
árunÿ‹64


	)

1023 #ifdeà
__USE_LARGEFILE64


1024 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1030 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1031 || 
defšed
 
__USE_MISC


1035 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1041 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1045 #ifdeà
__USE_MISC


1056 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1061 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1073 
	#F_ULOCK
 0

	)

1074 
	#F_LOCK
 1

	)

1075 
	#F_TLOCK
 2

	)

1076 
	#F_TEST
 3

	)

1078 #iâdeà
__USE_FILE_OFFSET64


1079 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1081 #ifdeà
__REDIRECT


1082 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1083 
lockf64
è
__wur
;

1085 
	#lockf
 
lockf64


	)

1088 #ifdeà
__USE_LARGEFILE64


1089 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1094 #ifdeà
__USE_GNU


1099 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1100 (
__ex‹nsiÚ__
 \

1101 ({ 
__»suÉ
; \

1102 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1103 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1104 
__»suÉ
; 
	}
}))

	)

1107 
ssize_t
 
cİy_fe_¿nge
 (
__šfd
, 
__off64_t
 *
__pšoff
,

1108 
__outfd
, 
__off64_t
 *
__poutoff
,

1109 
size_t
 
__Ëngth
, 
__æags
);

1112 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1115 
fd©async
 (
__fdes
);

1118 #ifdeà
__USE_MISC


1124 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1125 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1128 #ifdef 
__USE_XOPEN


1133 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1134 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1141 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1143 *
	$ù”mid
 (*
__s
è
__THROW
;

1146 *
	`cu£rid
 (*
__s
);

1152 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_XOPEN2K


1153 
	$±h»ad_©fÜk
 ((*
__´•¬e
) (),

1154 (*
__·»Á
) (),

1155 (*
__chd
è()è
__THROW
;

1158 #ifdeà
__USE_MISC


1161 
	$g‘’Œİy
 (*
__bufãr
, 
size_t
 
__Ëngth
è
__wur
;

1165 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1166 
	~<b™s/uni¡d.h
>

1170 
	~<b™s/uni¡d_ext.h
>

1172 
__END_DECLS


	@/usr/include/event2/event-config.h

11 #iâdeà
EVENT2_EVENT_CONFIG_H_INCLUDED_


12 
	#EVENT2_EVENT_CONFIG_H_INCLUDED_


	)

27 
	#EVENT__HAVE_ACCEPT4
 1

	)

42 
	#EVENT__HAVE_ARPA_INET_H
 1

	)

45 
	#EVENT__HAVE_CLOCK_GETTIME
 1

	)

59 
	#EVENT__HAVE_DLFCN_H
 1

	)

62 
	#EVENT__HAVE_EPOLL
 1

	)

65 
	#EVENT__HAVE_EPOLL_CREATE1
 1

	)

68 
	#EVENT__HAVE_EPOLL_CTL
 1

	)

71 
	#EVENT__HAVE_ERRNO_H
 1

	)

74 
	#EVENT__HAVE_EVENTFD
 1

	)

80 
	#EVENT__HAVE_FCNTL
 1

	)

83 
	#EVENT__HAVE_FCNTL_H
 1

	)

86 
	#EVENT__HAVE_FD_MASK
 1

	)

89 
	#EVENT__HAVE_GETADDRINFO
 1

	)

92 
	#EVENT__HAVE_GETEGID
 1

	)

95 
	#EVENT__HAVE_GETEUID
 1

	)

110 
	#EVENT__HAVE_GETIFADDRS
 1

	)

113 
	#EVENT__HAVE_GETNAMEINFO
 1

	)

116 
	#EVENT__HAVE_GETPROTOBYNUMBER
 1

	)

119 
	#EVENT__HAVE_GETRANDOM
 1

	)

122 
	#EVENT__HAVE_GETSERVBYNAME
 1

	)

125 
	#EVENT__HAVE_GETTIMEOFDAY
 1

	)

128 
	#EVENT__HAVE_IFADDRS_H
 1

	)

131 
	#EVENT__HAVE_INET_NTOP
 1

	)

134 
	#EVENT__HAVE_INET_PTON
 1

	)

137 
	#EVENT__HAVE_INTTYPES_H
 1

	)

161 
	#EVENT__HAVE_MEMORY_H
 1

	)

164 
	#EVENT__HAVE_MMAP
 1

	)

167 
	#EVENT__HAVE_NANOSLEEP
 1

	)

170 
	#EVENT__HAVE_NETDB_H
 1

	)

176 
	#EVENT__HAVE_NETINET_IN_H
 1

	)

179 
	#EVENT__HAVE_NETINET_TCP_H
 1

	)

182 
	#EVENT__HAVE_OPENSSL
 1

	)

185 
	#EVENT__HAVE_OPENSSL_SSL_H
 1

	)

188 
	#EVENT__HAVE_PIPE
 1

	)

191 
	#EVENT__HAVE_PIPE2
 1

	)

194 
	#EVENT__HAVE_POLL
 1

	)

197 
	#EVENT__HAVE_POLL_H
 1

	)

209 
	#EVENT__HAVE_PTHREADS
 1

	)

212 
	#EVENT__HAVE_PUTENV
 1

	)

215 
	#EVENT__HAVE_SA_FAMILY_T
 1

	)

218 
	#EVENT__HAVE_SELECT
 1

	)

221 
	#EVENT__HAVE_SENDFILE
 1

	)

224 
	#EVENT__HAVE_SETENV
 1

	)

227 
	#EVENT__HAVE_SETFD
 1

	)

230 
	#EVENT__HAVE_SETRLIMIT
 1

	)

233 
	#EVENT__HAVE_SIGACTION
 1

	)

236 
	#EVENT__HAVE_SIGNAL
 1

	)

239 
	#EVENT__HAVE_SPLICE
 1

	)

242 
	#EVENT__HAVE_STDARG_H
 1

	)

245 
	#EVENT__HAVE_STDDEF_H
 1

	)

248 
	#EVENT__HAVE_STDINT_H
 1

	)

251 
	#EVENT__HAVE_STDLIB_H
 1

	)

254 
	#EVENT__HAVE_STRINGS_H
 1

	)

257 
	#EVENT__HAVE_STRING_H
 1

	)

263 
	#EVENT__HAVE_STRSEP
 1

	)

266 
	#EVENT__HAVE_STRTOK_R
 1

	)

269 
	#EVENT__HAVE_STRTOLL
 1

	)

272 
	#EVENT__HAVE_STRUCT_ADDRINFO
 1

	)

275 
	#EVENT__HAVE_STRUCT_IN6_ADDR
 1

	)

278 
	#EVENT__HAVE_STRUCT_IN6_ADDR_S6_ADDR16
 1

	)

281 
	#EVENT__HAVE_STRUCT_IN6_ADDR_S6_ADDR32
 1

	)

284 
	#EVENT__HAVE_STRUCT_LINGER
 1

	)

287 
	#EVENT__HAVE_STRUCT_SOCKADDR_IN6
 1

	)

296 
	#EVENT__HAVE_STRUCT_SOCKADDR_STORAGE
 1

	)

299 
	#EVENT__HAVE_STRUCT_SOCKADDR_STORAGE_SS_FAMILY
 1

	)

305 
	#EVENT__HAVE_STRUCT_SOCKADDR_UN
 1

	)

308 
	#EVENT__HAVE_SYSCTL
 1

	)

314 
	#EVENT__HAVE_SYS_EPOLL_H
 1

	)

317 
	#EVENT__HAVE_SYS_EVENTFD_H
 1

	)

323 
	#EVENT__HAVE_SYS_IOCTL_H
 1

	)

326 
	#EVENT__HAVE_SYS_MMAN_H
 1

	)

329 
	#EVENT__HAVE_SYS_PARAM_H
 1

	)

332 
	#EVENT__HAVE_SYS_QUEUE_H
 1

	)

335 
	#EVENT__HAVE_SYS_RANDOM_H
 1

	)

338 
	#EVENT__HAVE_SYS_RESOURCE_H
 1

	)

341 
	#EVENT__HAVE_SYS_SELECT_H
 1

	)

344 
	#EVENT__HAVE_SYS_SENDFILE_H
 1

	)

347 
	#EVENT__HAVE_SYS_SOCKET_H
 1

	)

350 
	#EVENT__HAVE_SYS_STAT_H
 1

	)

356 
	#EVENT__HAVE_SYS_TIMERFD_H
 1

	)

359 
	#EVENT__HAVE_SYS_TIME_H
 1

	)

362 
	#EVENT__HAVE_SYS_TYPES_H
 1

	)

365 
	#EVENT__HAVE_SYS_UIO_H
 1

	)

368 
	#EVENT__HAVE_SYS_UN_H
 1

	)

371 
	#EVENT__HAVE_SYS_WAIT_H
 1

	)

374 
	#EVENT__HAVE_TAILQFOREACH
 1

	)

377 
	#EVENT__HAVE_TIMERADD
 1

	)

380 
	#EVENT__HAVE_TIMERCLEAR
 1

	)

383 
	#EVENT__HAVE_TIMERCMP
 1

	)

386 
	#EVENT__HAVE_TIMERFD_CREATE
 1

	)

389 
	#EVENT__HAVE_TIMERISSET
 1

	)

392 
	#EVENT__HAVE_UINT16_T
 1

	)

395 
	#EVENT__HAVE_UINT32_T
 1

	)

398 
	#EVENT__HAVE_UINT64_T
 1

	)

401 
	#EVENT__HAVE_UINT8_T
 1

	)

404 
	#EVENT__HAVE_UINTPTR_T
 1

	)

407 
	#EVENT__HAVE_UMASK
 1

	)

410 
	#EVENT__HAVE_UNISTD_H
 1

	)

413 
	#EVENT__HAVE_UNSETENV
 1

	)

416 
	#EVENT__HAVE_USLEEP
 1

	)

419 
	#EVENT__HAVE_VASPRINTF
 1

	)

434 
	#EVENT__HAVE___FUNCTION__
 1

	)

437 
	#EVENT__HAVE___func__
 1

	)

440 
	#EVENT__LT_OBJDIR
 ".libs/"

	)

443 
	#EVENT__NUMERIC_VERSION
 0x02010c00

	)

446 
	#EVENT__PACKAGE
 "libev’t"

	)

449 
	#EVENT__PACKAGE_BUGREPORT
 ""

	)

452 
	#EVENT__PACKAGE_NAME
 "libev’t"

	)

455 
	#EVENT__PACKAGE_STRING
 "libev’ˆ2.1.12-¡abË"

	)

458 
	#EVENT__PACKAGE_TARNAME
 "libev’t"

	)

461 
	#EVENT__PACKAGE_URL
 ""

	)

464 
	#EVENT__PACKAGE_VERSION
 "2.1.12-¡abË"

	)

471 
	#EVENT__SIZEOF_INT
 4

	)

474 
	#EVENT__SIZEOF_LONG
 8

	)

477 
	#EVENT__SIZEOF_LONG_LONG
 8

	)

480 
	#EVENT__SIZEOF_OFF_T
 8

	)

483 
	#EVENT__SIZEOF_PTHREAD_T
 8

	)

486 
	#EVENT__SIZEOF_SHORT
 2

	)

489 
	#EVENT__SIZEOF_SIZE_T
 8

	)

492 
	#EVENT__SIZEOF_TIME_T
 8

	)

495 
	#EVENT__SIZEOF_VOID_P
 8

	)

498 
	#STDC_HEADERS
 1

	)

501 
	#EVENT__TIME_WITH_SYS_TIME
 1

	)

504 #iâdeà
_ALL_SOURCE


505 
	#_ALL_SOURCE
 1

	)

508 #iâdeà
_GNU_SOURCE


509 
	#_GNU_SOURCE
 1

	)

512 #iâdeà
_POSIX_PTHREAD_SEMANTICS


513 
	#_POSIX_PTHREAD_SEMANTICS
 1

	)

516 #iâdeà
_TANDEM_SOURCE


517 
	#_TANDEM_SOURCE
 1

	)

520 #iâdeà
__EXTENSIONS__


521 
	#__EXTENSIONS__
 1

	)

526 
	#EVENT__VERSION
 "2.1.12-¡abË"

	)

529 #iâdeà
_DARWIN_USE_64_BIT_INODE


530 
	#_DARWIN_USE_64_BIT_INODE
 1

	)

554 #iâdeà
__ılu¥lus


	@/usr/include/event2/util.h

26 #iâdeà
EVENT2_UTIL_H_INCLUDED_


27 
	#EVENT2_UTIL_H_INCLUDED_


	)

35 
	~<ev’t2/visib™y.h
>

37 #ifdeà
__ılu¥lus


41 
	~<ev’t2/ev’t-cÚfig.h
>

42 #ifdeà
EVENT__HAVE_SYS_TIME_H


43 
	~<sys/time.h
>

45 #ifdeà
EVENT__HAVE_STDINT_H


46 
	~<¡dšt.h
>

47 #–ià
defšed
(
EVENT__HAVE_INTTYPES_H
)

48 
	~<š‰y³s.h
>

50 #ifdeà
EVENT__HAVE_SYS_TYPES_H


51 
	~<sys/ty³s.h
>

53 #ifdeà
EVENT__HAVE_STDDEF_H


54 
	~<¡ddef.h
>

56 #ifdeà
_MSC_VER


57 
	~<Ba£Tsd.h
>

59 
	~<¡d¬g.h
>

60 #ifdeà
EVENT__HAVE_NETDB_H


61 
	~<Ãtdb.h
>

64 #ifdeà
_WIN32


65 
	~<wšsock2.h
>

66 #ifdeà
EVENT__HAVE_GETADDRINFO


68 
	~<ws2tı.h
>

71 #ifdeà
EVENT__HAVE_ERRNO_H


72 
	~<”ºo.h
>

74 
	~<sys/sock‘.h
>

77 
	~<time.h
>

80 #ià
defšed
(
EVENT__SIZEOF_VOID__
è&& !defšed(
EVENT__SIZEOF_VOID_P
)

81 
	#EVENT__SIZEOF_VOID_P
 
EVENT__SIZEOF_VOID__


	)

113 #ifdeà
EVENT__HAVE_UINT64_T


114 
	#ev_ušt64_t
 
ušt64_t


	)

115 
	#ev_št64_t
 
št64_t


	)

116 #–ià
defšed
(
_WIN32
)

117 
	#ev_ušt64_t
 
__št64


	)

118 
	#ev_št64_t
 sigÃd 
__št64


	)

119 #–ià
EVENT__SIZEOF_LONG_LONG
 == 8

120 
	#ev_ušt64_t
 

	)

121 
	#ev_št64_t
 

	)

122 #–ià
EVENT__SIZEOF_LONG
 == 8

123 
	#ev_ušt64_t
 

	)

124 
	#ev_št64_t
 

	)

125 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

126 
	#ev_ušt64_t
 ...

	)

127 
	#ev_št64_t
 ...

	)

132 #ifdeà
EVENT__HAVE_UINT32_T


133 
	#ev_ušt32_t
 
ušt32_t


	)

134 
	#ev_št32_t
 
št32_t


	)

135 #–ià
defšed
(
_WIN32
)

136 
	#ev_ušt32_t
 

	)

137 
	#ev_št32_t
 sigÃd 

	)

138 #–ià
EVENT__SIZEOF_LONG
 == 4

139 
	#ev_ušt32_t
 

	)

140 
	#ev_št32_t
 sigÃd 

	)

141 #–ià
EVENT__SIZEOF_INT
 == 4

142 
	#ev_ušt32_t
 

	)

143 
	#ev_št32_t
 sigÃd 

	)

144 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

145 
	#ev_ušt32_t
 ...

	)

146 
	#ev_št32_t
 ...

	)

151 #ifdeà
EVENT__HAVE_UINT16_T


152 
	#ev_ušt16_t
 
ušt16_t


	)

153 
	#ev_št16_t
 
št16_t


	)

154 #–ià
defšed
(
_WIN32
)

155 
	#ev_ušt16_t
 

	)

156 
	#ev_št16_t
 sigÃd 

	)

157 #–ià
EVENT__SIZEOF_INT
 == 2

158 
	#ev_ušt16_t
 

	)

159 
	#ev_št16_t
 sigÃd 

	)

160 #–ià
EVENT__SIZEOF_SHORT
 == 2

161 
	#ev_ušt16_t
 

	)

162 
	#ev_št16_t
 sigÃd 

	)

163 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

164 
	#ev_ušt16_t
 ...

	)

165 
	#ev_št16_t
 ...

	)

170 #ifdeà
EVENT__HAVE_UINT8_T


171 
	#ev_ušt8_t
 
ušt8_t


	)

172 
	#ev_št8_t
 
št8_t


	)

173 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

174 
	#ev_ušt8_t
 ...

	)

175 
	#ev_št8_t
 ...

	)

177 
	#ev_ušt8_t
 

	)

178 
	#ev_št8_t
 sigÃd 

	)

181 #ifdeà
EVENT__HAVE_UINTPTR_T


182 
	#ev_ušŒ_t
 
ušŒ_t


	)

183 
	#ev_šŒ_t
 
šŒ_t


	)

184 #–ià
EVENT__SIZEOF_VOID_P
 <= 4

185 
	#ev_ušŒ_t
 
ev_ušt32_t


	)

186 
	#ev_šŒ_t
 
ev_št32_t


	)

187 #–ià
EVENT__SIZEOF_VOID_P
 <= 8

188 
	#ev_ušŒ_t
 
ev_ušt64_t


	)

189 
	#ev_šŒ_t
 
ev_št64_t


	)

190 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

191 
	#ev_ušŒ_t
 ...

	)

192 
	#ev_šŒ_t
 ...

	)

197 #ifdeà
EVENT__ssize_t


198 
	#ev_ssize_t
 
EVENT__ssize_t


	)

200 
	#ev_ssize_t
 
ssize_t


	)

210 #ifdeà
_WIN32


211 
	#ev_off_t
 
ev_št64_t


	)

212 #–ià
EVENT__SIZEOF_OFF_T
 == 8

213 
	#ev_off_t
 
ev_št64_t


	)

214 #–ià
EVENT__SIZEOF_OFF_T
 == 4

215 
	#ev_off_t
 
ev_št32_t


	)

216 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

217 
	#ev_off_t
 ...

	)

219 
	#ev_off_t
 
off_t


	)

238 #iâdeà
EVENT__HAVE_STDINT_H


239 
	#EV_UINT64_MAX
 ((((
ev_ušt64_t
)0xffffffffULè<< 32è| 0xffffffffUL)

	)

240 
	#EV_INT64_MAX
 ((((
ev_št64_t
è0x7fffffffLè<< 32è| 0xffffffffL)

	)

241 
	#EV_INT64_MIN
 ((-
EV_INT64_MAX
è- 1)

	)

242 
	#EV_UINT32_MAX
 ((
ev_ušt32_t
)0xffffffffUL)

	)

243 
	#EV_INT32_MAX
 ((
ev_št32_t
è0x7fffffffL)

	)

244 
	#EV_INT32_MIN
 ((-
EV_INT32_MAX
è- 1)

	)

245 
	#EV_UINT16_MAX
 ((
ev_ušt16_t
)0xffffUL)

	)

246 
	#EV_INT16_MAX
 ((
ev_št16_t
è0x7fffL)

	)

247 
	#EV_INT16_MIN
 ((-
EV_INT16_MAX
è- 1)

	)

248 
	#EV_UINT8_MAX
 255

	)

249 
	#EV_INT8_MAX
 127

	)

250 
	#EV_INT8_MIN
 ((-
EV_INT8_MAX
è- 1)

	)

252 
	#EV_UINT64_MAX
 
UINT64_MAX


	)

253 
	#EV_INT64_MAX
 
INT64_MAX


	)

254 
	#EV_INT64_MIN
 
INT64_MIN


	)

255 
	#EV_UINT32_MAX
 
UINT32_MAX


	)

256 
	#EV_INT32_MAX
 
INT32_MAX


	)

257 
	#EV_INT32_MIN
 
INT32_MIN


	)

258 
	#EV_UINT16_MAX
 
UINT16_MAX


	)

259 
	#EV_INT16_MIN
 
INT16_MIN


	)

260 
	#EV_INT16_MAX
 
INT16_MAX


	)

261 
	#EV_UINT8_MAX
 
UINT8_MAX


	)

262 
	#EV_INT8_MAX
 
INT8_MAX


	)

263 
	#EV_INT8_MIN
 
INT8_MIN


	)

273 #ià
EVENT__SIZEOF_SIZE_T
 == 8

274 
	#EV_SIZE_MAX
 
EV_UINT64_MAX


	)

275 
	#EV_SSIZE_MAX
 
EV_INT64_MAX


	)

276 #–ià
EVENT__SIZEOF_SIZE_T
 == 4

277 
	#EV_SIZE_MAX
 
EV_UINT32_MAX


	)

278 
	#EV_SSIZE_MAX
 
EV_INT32_MAX


	)

279 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

280 
	#EV_SIZE_MAX
 ...

	)

281 
	#EV_SSIZE_MAX
 ...

	)

286 
	#EV_SSIZE_MIN
 ((-
EV_SSIZE_MAX
è- 1)

	)

289 #ifdeà
_WIN32


290 
	#ev_sockËn_t
 

	)

291 #–ià
defšed
(
EVENT__sockËn_t
)

292 
	#ev_sockËn_t
 
EVENT__sockËn_t


	)

294 
	#ev_sockËn_t
 
sockËn_t


	)

297 #ifdeà
EVENT__HAVE_STRUCT_SOCKADDR_STORAGE___SS_FAMILY


298 #ià!
defšed
(
EVENT__HAVE_STRUCT_SOCKADDR_STORAGE_SS_FAMILY
) \

299 && !
defšed
(
ss_çmy
)

300 
	#ss_çmy
 
__ss_çmy


	)

307 #ifdeà
_WIN32


308 
	#evut_sock‘_t
 
šŒ_t


	)

310 
	#evut_sock‘_t
 

	)

325 
evut_mÚÙÚic_tim”


326 #ifdeà
EVENT_IN_DOXYGEN_


331 
	#EV_MONOT_PRECISE
 1

	)

332 
	#EV_MONOT_FALLBACK
 2

	)

340 
EVENT2_EXPORT_SYMBOL
 

341 
evut_d©e_rfc1123
(*
d©e
, cÚ¡ 
size_t
 
d©–’
, cÚ¡ 
tm
 *tm);

348 
EVENT2_EXPORT_SYMBOL


349 
evut_mÚÙÚic_tim”
 * 
evut_mÚÙÚic_tim”_Ãw
();

354 
EVENT2_EXPORT_SYMBOL


355 
evut_mÚÙÚic_tim”_ä“
(
evut_mÚÙÚic_tim”
 *
tim”
);

360 
EVENT2_EXPORT_SYMBOL


361 
evut_cÚfigu»_mÚÙÚic_time
(
evut_mÚÙÚic_tim”
 *
tim”
,

362 
æags
);

374 
EVENT2_EXPORT_SYMBOL


375 
evut_g‘time_mÚÙÚic
(
evut_mÚÙÚic_tim”
 *
tim”
,

376 
timev®
 *

);

389 
EVENT2_EXPORT_SYMBOL


390 
evut_sock‘·œ
(
d
, 
ty³
, 
´ÙocŞ
, 
evut_sock‘_t
 
sv
[2]);

396 
EVENT2_EXPORT_SYMBOL


397 
evut_make_sock‘_nÚblockšg
(
evut_sock‘_t
 
sock
);

410 
EVENT2_EXPORT_SYMBOL


411 
evut_make_li¡’_sock‘_»u£abË
(
evut_sock‘_t
 
sock
);

423 
EVENT2_EXPORT_SYMBOL


424 
evut_make_li¡’_sock‘_»u£abË_pÜt
(
evut_sock‘_t
 
sock
);

435 
EVENT2_EXPORT_SYMBOL


436 
evut_make_li¡’_sock‘_v6Úly
(
evut_sock‘_t
 
sock
);

444 
EVENT2_EXPORT_SYMBOL


445 
evut_make_sock‘_şo£Úexec
(
evut_sock‘_t
 
sock
);

454 
EVENT2_EXPORT_SYMBOL


455 
evut_şo£sock‘
(
evut_sock‘_t
 
sock
);

456 
	#EVUTIL_CLOSESOCKET
(
s
è
	`evut_şo£sock‘
(s)

	)

469 
EVENT2_EXPORT_SYMBOL


470 
evut_make_tı_li¡’_sock‘_deã¼ed
(
evut_sock‘_t
 
sock
);

472 #ifdeà
_WIN32


474 
	#EVUTIL_SOCKET_ERROR
(è
	`WSAG‘La¡E¼Ü
()

	)

476 
	#EVUTIL_SET_SOCKET_ERROR
(
”rcode
) \

477 dØ{ 
	`WSAS‘La¡E¼Ü
(
”rcode
); } 0)

	)

479 
EVENT2_EXPORT_SYMBOL


480 
evut_sock‘_g‘”rÜ
(
evut_sock‘_t
 
sock
);

482 
EVENT2_EXPORT_SYMBOL


483 cÚ¡ *
evut_sock‘_”rÜ_to_¡ršg
(
”rcode
);

484 
	#EVUTIL_INVALID_SOCKET
 
INVALID_SOCKET


	)

485 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

501 
	#EVUTIL_SOCKET_ERROR
(è...

	)

503 
	#EVUTIL_SET_SOCKET_ERROR
(
”rcode
è...

	)

505 
	#evut_sock‘_g‘”rÜ
(
sock
è...

	)

507 
	#evut_sock‘_”rÜ_to_¡ršg
(
”rcode
è...

	)

508 
	#EVUTIL_INVALID_SOCKET
 -1

	)

511 
	#EVUTIL_SOCKET_ERROR
(è(
”ºo
)

	)

512 
	#EVUTIL_SET_SOCKET_ERROR
(
”rcode
) \

513 dØ{ 
”ºo
 = (
”rcode
); } 0)

	)

514 
	#evut_sock‘_g‘”rÜ
(
sock
è(
”ºo
)

	)

515 
	#evut_sock‘_”rÜ_to_¡ršg
(
”rcode
è(
	`¡»¼Ü
Ó¼code))

	)

516 
	#EVUTIL_INVALID_SOCKET
 -1

	)

528 #ifdeà
EVENT__HAVE_TIMERADD


529 
	#evut_tim”add
(
tvp
, 
uvp
, 
vvp
è
	`tim”add
(Ñvp), (uvp), (vvp))

	)

530 
	#evut_tim”sub
(
tvp
, 
uvp
, 
vvp
è
	`tim”sub
(Ñvp), (uvp), (vvp))

	)

532 
	#evut_tim”add
(
tvp
, 
uvp
, 
vvp
) \

534 (
vvp
)->
tv_£c
 = (
tvp
)->tv_£ø+ (
uvp
)->tv_sec; \

535 (
vvp
)->
tv_u£c
 = (
tvp
)->tv_u£ø+ (
uvp
)->tv_usec; \

536 ià((
vvp
)->
tv_u£c
 >= 1000000) { \

537 (
vvp
)->
tv_£c
++; \

538 (
vvp
)->
tv_u£c
 -= 1000000; \

540 } 0)

	)

541 
	#evut_tim”sub
(
tvp
, 
uvp
, 
vvp
) \

543 (
vvp
)->
tv_£c
 = (
tvp
)->tv_£ø- (
uvp
)->tv_sec; \

544 (
vvp
)->
tv_u£c
 = (
tvp
)->tv_u£ø- (
uvp
)->tv_usec; \

545 ià((
vvp
)->
tv_u£c
 < 0) { \

546 (
vvp
)->
tv_£c
--; \

547 (
vvp
)->
tv_u£c
 += 1000000; \

549 } 0)

	)

552 #ifdeà
EVENT__HAVE_TIMERCLEAR


553 
	#evut_tim”ş—r
(
tvp
è
	`tim”ş—r
Ñvp)

	)

555 
	#evut_tim”ş—r
(
tvp
èÑvp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0

	)

561 
	#evut_tim”cmp
(
tvp
, 
uvp
, 
cmp
) \

562 (((
tvp
)->
tv_£c
 =ğ(
uvp
)->tv_sec) ? \

563 ((
tvp
)->
tv_u£c
 
	`cmp
 (
uvp
)->tv_usec) : \

564 ((
tvp
)->
tv_£c
 
	`cmp
 (
uvp
)->tv_£c))

	)

566 #ifdeà
EVENT__HAVE_TIMERISSET


567 
	#evut_tim”is£t
(
tvp
è
	`tim”is£t
Ñvp)

	)

569 
	#evut_tim”is£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

573 #ifdeà
off£tof


574 
	#evut_off£tof
(
ty³
, 
f›ld
è
	`off£tof
Ñy³, f›ld)

	)

576 
	#evut_off£tof
(
ty³
, 
f›ld
è((
off_t
)(&(Ñy³ *)0)->f›ld))

	)

581 
EVENT2_EXPORT_SYMBOL


582 
ev_št64_t
 
evut_¡¹Şl
(cÚ¡ *
s
, **
’d±r
, 
ba£
);

585 #ifdeà
EVENT__HAVE_GETTIMEOFDAY


586 
	#evut_g‘timeofday
(
tv
, 
tz
è
	`g‘timeofday
(Ñv), (tz))

	)

588 
timezÚe
;

589 
EVENT2_EXPORT_SYMBOL


590 
evut_g‘timeofday
(
timev®
 *
tv
, 
timezÚe
 *
tz
);

596 
EVENT2_EXPORT_SYMBOL


597 
evut_¢´štf
(*
buf
, 
size_t
 
buæ’
, cÚ¡ *
fÜm©
, ...)

598 #ifdeà
__GNUC__


599 
__©Œibu‹__
((
fÜm©
(
´štf
, 3, 4)))

605 
EVENT2_EXPORT_SYMBOL


606 
evut_v¢´štf
(*
buf
, 
size_t
 
buæ’
, cÚ¡ *
fÜm©
, 
va_li¡
 
­
)

607 #ifdeà
__GNUC__


608 
__©Œibu‹__
((
fÜm©
(
´štf
, 3, 0)))

613 
EVENT2_EXPORT_SYMBOL


614 cÚ¡ *
evut_š‘_Áİ
(
af
, cÚ¡ *
¤c
, *
d¡
, 
size_t
 
Ën
);

618 
EVENT2_EXPORT_SYMBOL


619 
evut_š‘_±Ú_scİe
(
af
, cÚ¡ *
¤c
, *
d¡
,

620 *
šdexp
);

622 
EVENT2_EXPORT_SYMBOL


623 
evut_š‘_±Ú
(
af
, cÚ¡ *
¤c
, *
d¡
);

624 
sockaddr
;

646 
EVENT2_EXPORT_SYMBOL


647 
evut_·r£_sockaddr_pÜt
(cÚ¡ *
¡r
, 
sockaddr
 *
out
, *
ou’
);

654 
EVENT2_EXPORT_SYMBOL


655 
evut_sockaddr_cmp
(cÚ¡ 
sockaddr
 *
§1
, cÚ¡ sockadd¸*
§2
,

656 
šşude_pÜt
);

661 
EVENT2_EXPORT_SYMBOL


662 
evut_ascii_¡rÿ£cmp
(cÚ¡ *
¡r1
, cÚ¡ *
¡r2
);

666 
EVENT2_EXPORT_SYMBOL


667 
evut_ascii_¡ºÿ£cmp
(cÚ¡ *
¡r1
, cÚ¡ *
¡r2
, 
size_t
 
n
);

671 #ifdeà
EVENT__HAVE_STRUCT_ADDRINFO


672 
	#evut_addršfo
 
addršfo


	)

679 
	sevut_addršfo
 {

680 
ai_æags
;

681 
ai_çmy
;

682 
ai_sockty³
;

683 
ai_´ÙocŞ
;

684 
size_t
 
ai_add¾’
;

685 *
ai_ÿnÚÇme
;

686 
sockaddr
 *
ai_addr
;

687 
evut_addršfo
 *
ai_Ãxt
;

697 #ià
defšed
(
EAI_ADDRFAMILY
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

698 
	#EVUTIL_EAI_ADDRFAMILY
 
EAI_ADDRFAMILY


	)

700 
	#EVUTIL_EAI_ADDRFAMILY
 -901

	)

702 #ià
defšed
(
EAI_AGAIN
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

703 
	#EVUTIL_EAI_AGAIN
 
EAI_AGAIN


	)

705 
	#EVUTIL_EAI_AGAIN
 -902

	)

707 #ià
defšed
(
EAI_BADFLAGS
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

708 
	#EVUTIL_EAI_BADFLAGS
 
EAI_BADFLAGS


	)

710 
	#EVUTIL_EAI_BADFLAGS
 -903

	)

712 #ià
defšed
(
EAI_FAIL
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

713 
	#EVUTIL_EAI_FAIL
 
EAI_FAIL


	)

715 
	#EVUTIL_EAI_FAIL
 -904

	)

717 #ià
defšed
(
EAI_FAMILY
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

718 
	#EVUTIL_EAI_FAMILY
 
EAI_FAMILY


	)

720 
	#EVUTIL_EAI_FAMILY
 -905

	)

722 #ià
defšed
(
EAI_MEMORY
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

723 
	#EVUTIL_EAI_MEMORY
 
EAI_MEMORY


	)

725 
	#EVUTIL_EAI_MEMORY
 -906

	)

730 #ià
defšed
(
EAI_NODATA
è&& defšed(
EVENT__HAVE_GETADDRINFO
è&& (!defšed(
EAI_NONAME
) || EAI_NODATA != EAI_NONAME)

731 
	#EVUTIL_EAI_NODATA
 
EAI_NODATA


	)

733 
	#EVUTIL_EAI_NODATA
 -907

	)

735 #ià
defšed
(
EAI_NONAME
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

736 
	#EVUTIL_EAI_NONAME
 
EAI_NONAME


	)

738 
	#EVUTIL_EAI_NONAME
 -908

	)

740 #ià
defšed
(
EAI_SERVICE
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

741 
	#EVUTIL_EAI_SERVICE
 
EAI_SERVICE


	)

743 
	#EVUTIL_EAI_SERVICE
 -909

	)

745 #ià
defšed
(
EAI_SOCKTYPE
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

746 
	#EVUTIL_EAI_SOCKTYPE
 
EAI_SOCKTYPE


	)

748 
	#EVUTIL_EAI_SOCKTYPE
 -910

	)

750 #ià
defšed
(
EAI_SYSTEM
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

751 
	#EVUTIL_EAI_SYSTEM
 
EAI_SYSTEM


	)

753 
	#EVUTIL_EAI_SYSTEM
 -911

	)

756 
	#EVUTIL_EAI_CANCEL
 -90001

	)

758 #ià
defšed
(
AI_PASSIVE
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

759 
	#EVUTIL_AI_PASSIVE
 
AI_PASSIVE


	)

761 
	#EVUTIL_AI_PASSIVE
 0x1000

	)

763 #ià
defšed
(
AI_CANONNAME
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

764 
	#EVUTIL_AI_CANONNAME
 
AI_CANONNAME


	)

766 
	#EVUTIL_AI_CANONNAME
 0x2000

	)

768 #ià
defšed
(
AI_NUMERICHOST
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

769 
	#EVUTIL_AI_NUMERICHOST
 
AI_NUMERICHOST


	)

771 
	#EVUTIL_AI_NUMERICHOST
 0x4000

	)

773 #ià
defšed
(
AI_NUMERICSERV
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

774 
	#EVUTIL_AI_NUMERICSERV
 
AI_NUMERICSERV


	)

776 
	#EVUTIL_AI_NUMERICSERV
 0x8000

	)

778 #ià
defšed
(
AI_V4MAPPED
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

779 
	#EVUTIL_AI_V4MAPPED
 
AI_V4MAPPED


	)

781 
	#EVUTIL_AI_V4MAPPED
 0x10000

	)

783 #ià
defšed
(
AI_ALL
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

784 
	#EVUTIL_AI_ALL
 
AI_ALL


	)

786 
	#EVUTIL_AI_ALL
 0x20000

	)

788 #ià
defšed
(
AI_ADDRCONFIG
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

789 
	#EVUTIL_AI_ADDRCONFIG
 
AI_ADDRCONFIG


	)

791 
	#EVUTIL_AI_ADDRCONFIG
 0x40000

	)

795 
evut_addršfo
;

807 
EVENT2_EXPORT_SYMBOL


808 
evut_g‘addršfo
(cÚ¡ *
nod’ame
, cÚ¡ *
£rvÇme
,

809 cÚ¡ 
evut_addršfo
 *
hšts_š
, evut_addršfØ**
»s
);

812 
EVENT2_EXPORT_SYMBOL


813 
evut_ä“addršfo
(
evut_addršfo
 *
ai
);

815 
EVENT2_EXPORT_SYMBOL


816 cÚ¡ *
evut_gai_¡»¼Ü
(
”r
);

827 
EVENT2_EXPORT_SYMBOL


828 
evut_£cu»_ºg_g‘_by‹s
(*
buf
, 
size_t
 
n
);

846 
EVENT2_EXPORT_SYMBOL


847 
evut_£cu»_ºg_š™
();

862 
EVENT2_EXPORT_SYMBOL


863 
evut_£cu»_ºg_£t_u¿ndom_deviû_fe
(*
âame
);

865 #ià!
defšed
(
EVENT__HAVE_ARC4RANDOM
è|| defšed(
EVENT__HAVE_ARC4RANDOM_ADDRANDOM
)

880 
EVENT2_EXPORT_SYMBOL


881 
evut_£cu»_ºg_add_by‹s
(cÚ¡ *
d©
, 
size_t
 
d©Ën
);

884 #ifdeà
__ılu¥lus


	@/usr/include/event2/visibility.h

27 #iâdeà
EVENT2_VISIBILITY_H_INCLUDED_


28 
	#EVENT2_VISIBILITY_H_INCLUDED_


	)

30 
	~<ev’t2/ev’t-cÚfig.h
>

32 #ià
defšed
(
ev’t_sh¬ed_EXPORTS
) || \

33 
defšed
(
ev’t_exŒa_sh¬ed_EXPORTS
) || \

34 
defšed
(
ev’t_cÜe_sh¬ed_EXPORTS
) || \

35 
defšed
(
ev’t_±h»ads_sh¬ed_EXPORTS
) || \

36 
	$defšed
(
ev’t_İ’s¦_sh¬ed_EXPORTS
)

38 #ià
	`defšed
 (
__SUNPRO_C
) && (__SUNPRO_C >= 0x550)

39 
	#EVENT2_EXPORT_SYMBOL
 
__glob®


	)

40 #–ià
defšed
 
__GNUC__


41 
	#EVENT2_EXPORT_SYMBOL
 
	`__©Œibu‹__
 ((
	`visib™y
("deçuÉ")))

	)

42 #–ià
	`defšed
(
_MSC_VER
)

43 
	#EVENT2_EXPORT_SYMBOL
 
	`__deş¥ec
(
dÎexpÜt
)

	)

45 
	#EVENT2_EXPORT_SYMBOL


	)

50 
	#EVENT2_EXPORT_SYMBOL


	)

55 #ià
	`defšed
(
_MSC_VER
)

56 #ià
	`defšed
(
ev’t_cÜe_sh¬ed_EXPORTS
)

57 
	#EVENT2_CORE_EXPORT_SYMBOL
 
	`__deş¥ec
(
dÎexpÜt
)

	)

58 #–ià
	`defšed
(
ev’t_exŒa_sh¬ed_EXPORTS
) || \

59 
	$defšed
(
EVENT_VISIBILITY_WANT_DLLIMPORT
)

60 
	#EVENT2_CORE_EXPORT_SYMBOL
 
	`__deş¥ec
(
dÎimpÜt
)

	)

63 #ià!
	`defšed
(
EVENT2_CORE_EXPORT_SYMBOL
)

64 
	#EVENT2_CORE_EXPORT_SYMBOL
 
EVENT2_EXPORT_SYMBOL


	)

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

120 #undeà
__USE_ISOC11


121 #undeà
__USE_ISOC99


122 #undeà
__USE_ISOC95


123 #undeà
__USE_ISOCXX11


124 #undeà
__USE_POSIX


125 #undeà
__USE_POSIX2


126 #undeà
__USE_POSIX199309


127 #undeà
__USE_POSIX199506


128 #undeà
__USE_XOPEN


129 #undeà
__USE_XOPEN_EXTENDED


130 #undeà
__USE_UNIX98


131 #undeà
__USE_XOPEN2K


132 #undeà
__USE_XOPEN2KXSI


133 #undeà
__USE_XOPEN2K8


134 #undeà
__USE_XOPEN2K8XSI


135 #undeà
__USE_LARGEFILE


136 #undeà
__USE_LARGEFILE64


137 #undeà
__USE_FILE_OFFSET64


138 #undeà
__USE_MISC


139 #undeà
__USE_ATFILE


140 #undeà
__USE_GNU


141 #undeà
__USE_FORTIFY_LEVEL


142 #undeà
__KERNEL_STRICT_NAMES


143 #undeà
__GLIBC_USE_ISOC2X


144 #undeà
__GLIBC_USE_DEPRECATED_GETS


145 #undeà
__GLIBC_USE_DEPRECATED_SCANF


149 #iâdeà
_LOOSE_KERNEL_NAMES


150 
	#__KERNEL_STRICT_NAMES


	)

160 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


161 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

162 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

164 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

171 #ià
defšed
 
__şªg_majÜ__
 && defšed 
__şªg_mšÜ__


172 
	#__glibc_şªg_´”eq
(
maj
, 
mš
) \

173 ((
__şªg_majÜ__
 << 16è+ 
__şªg_mšÜ__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

175 
	#__glibc_şªg_´”eq
(
maj
, 
mš
è0

	)

179 
	#__GLIBC_USE
(
F
è
__GLIBC_USE_
 ## 
	)
F

185 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

186 && !
defšed
 
	g_DEFAULT_SOURCE


188 #undeà
_DEFAULT_SOURCE


189 
	#_DEFAULT_SOURCE
 1

	)

193 #ifdeà
_GNU_SOURCE


194 #undeà
_ISOC95_SOURCE


195 
	#_ISOC95_SOURCE
 1

	)

196 #undeà
_ISOC99_SOURCE


197 
	#_ISOC99_SOURCE
 1

	)

198 #undeà
_ISOC11_SOURCE


199 
	#_ISOC11_SOURCE
 1

	)

200 #undeà
_ISOC2X_SOURCE


201 
	#_ISOC2X_SOURCE
 1

	)

202 #undeà
_POSIX_SOURCE


203 
	#_POSIX_SOURCE
 1

	)

204 #undeà
_POSIX_C_SOURCE


205 
	#_POSIX_C_SOURCE
 200809L

	)

206 #undeà
_XOPEN_SOURCE


207 
	#_XOPEN_SOURCE
 700

	)

208 #undeà
_XOPEN_SOURCE_EXTENDED


209 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

210 #undeà
_LARGEFILE64_SOURCE


211 
	#_LARGEFILE64_SOURCE
 1

	)

212 #undeà
_DEFAULT_SOURCE


213 
	#_DEFAULT_SOURCE
 1

	)

214 #undeà
_ATFILE_SOURCE


215 
	#_ATFILE_SOURCE
 1

	)

220 #ià(
defšed
 
_DEFAULT_SOURCE
 \

221 || (!
defšed
 
	g__STRICT_ANSI__
 \

222 && !
defšed
 
	g_ISOC99_SOURCE
 && !defšed 
	g_ISOC11_SOURCE
 \

223 && !
defšed
 
	g_ISOC2X_SOURCE
 \

224 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

225 && !
defšed
 
	g_XOPEN_SOURCE
))

226 #undeà
_DEFAULT_SOURCE


227 
	#_DEFAULT_SOURCE
 1

	)

231 #ià(
defšed
 
_ISOC2X_SOURCE
 \

232 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ > 201710L))

233 
	#__GLIBC_USE_ISOC2X
 1

	)

235 
	#__GLIBC_USE_ISOC2X
 0

	)

239 #ià(
defšed
 
_ISOC11_SOURCE
 || defšed 
_ISOC2X_SOURCE
 \

240 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

241 
	#__USE_ISOC11
 1

	)

245 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

246 || 
defšed
 
_ISOC2X_SOURCE
 \

247 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

248 
	#__USE_ISOC99
 1

	)

252 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

253 || 
defšed
 
_ISOC2X_SOURCE
 \

254 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

255 
	#__USE_ISOC95
 1

	)

258 #ifdeà
__ılu¥lus


260 #ià
__ılu¥lus
 >= 201703L

261 
	#__USE_ISOC11
 1

	)

265 #ià
__ılu¥lus
 >ğ201103L || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__


266 
	#__USE_ISOCXX11
 1

	)

267 
	#__USE_ISOC99
 1

	)

274 #ifdeà
_DEFAULT_SOURCE


275 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


276 
	#__USE_POSIX_IMPLICITLY
 1

	)

278 #undeà
_POSIX_SOURCE


279 
	#_POSIX_SOURCE
 1

	)

280 #undeà
_POSIX_C_SOURCE


281 
	#_POSIX_C_SOURCE
 200809L

	)

284 #ià((!
defšed
 
__STRICT_ANSI__
 \

285 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

286 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

287 
	#_POSIX_SOURCE
 1

	)

288 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

289 
	#_POSIX_C_SOURCE
 2

	)

290 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

291 
	#_POSIX_C_SOURCE
 199506L

	)

292 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

293 
	#_POSIX_C_SOURCE
 200112L

	)

295 
	#_POSIX_C_SOURCE
 200809L

	)

297 
	#__USE_POSIX_IMPLICITLY
 1

	)

306 #ià((!
defšed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

307 && (
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE
))

308 
	#_POSIX_SOURCE
 1

	)

309 #undeà
_POSIX_C_SOURCE


310 
	#_POSIX_C_SOURCE
 199506L

	)

313 #ià(
defšed
 
_POSIX_SOURCE
 \

314 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

315 || 
defšed
 
_XOPEN_SOURCE
)

316 
	#__USE_POSIX
 1

	)

319 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


320 
	#__USE_POSIX2
 1

	)

323 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

324 
	#__USE_POSIX199309
 1

	)

327 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

328 
	#__USE_POSIX199506
 1

	)

331 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

332 
	#__USE_XOPEN2K
 1

	)

333 #undeà
__USE_ISOC95


334 
	#__USE_ISOC95
 1

	)

335 #undeà
__USE_ISOC99


336 
	#__USE_ISOC99
 1

	)

339 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

340 
	#__USE_XOPEN2K8
 1

	)

341 #undeà
_ATFILE_SOURCE


342 
	#_ATFILE_SOURCE
 1

	)

345 #ifdef 
_XOPEN_SOURCE


346 
	#__USE_XOPEN
 1

	)

347 #ià(
_XOPEN_SOURCE
 - 0) >= 500

348 
	#__USE_XOPEN_EXTENDED
 1

	)

349 
	#__USE_UNIX98
 1

	)

350 #undeà
_LARGEFILE_SOURCE


351 
	#_LARGEFILE_SOURCE
 1

	)

352 #ià(
_XOPEN_SOURCE
 - 0) >= 600

353 #ià(
_XOPEN_SOURCE
 - 0) >= 700

354 
	#__USE_XOPEN2K8
 1

	)

355 
	#__USE_XOPEN2K8XSI
 1

	)

357 
	#__USE_XOPEN2K
 1

	)

358 
	#__USE_XOPEN2KXSI
 1

	)

359 #undeà
__USE_ISOC95


360 
	#__USE_ISOC95
 1

	)

361 #undeà
__USE_ISOC99


362 
	#__USE_ISOC99
 1

	)

365 #ifdeà
_XOPEN_SOURCE_EXTENDED


366 
	#__USE_XOPEN_EXTENDED
 1

	)

371 #ifdeà
_LARGEFILE_SOURCE


372 
	#__USE_LARGEFILE
 1

	)

375 #ifdeà
_LARGEFILE64_SOURCE


376 
	#__USE_LARGEFILE64
 1

	)

379 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

380 
	#__USE_FILE_OFFSET64
 1

	)

383 #ià
defšed
 
_DEFAULT_SOURCE


384 
	#__USE_MISC
 1

	)

387 #ifdef 
_ATFILE_SOURCE


388 
	#__USE_ATFILE
 1

	)

391 #ifdef 
_GNU_SOURCE


392 
	#__USE_GNU
 1

	)

395 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

396 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

397 #ià
_FORTIFY_SOURCE
 > 1

398 
	#__USE_FORTIFY_LEVEL
 2

	)

400 
	#__USE_FORTIFY_LEVEL
 1

	)

403 
	#__USE_FORTIFY_LEVEL
 0

	)

410 #ià
defšed
 
__ılu¥lus
 ? __ılu¥lu >ğ201402L : defšed 
__USE_ISOC11


411 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

413 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

428 #ià(
defšed
 
__USE_GNU
 \

429 && (
defšed
 
	g__ılu¥lus
 \

430 ? (
	g__ılu¥lus
 < 201103L && !
defšed
 
	g__GXX_EXPERIMENTAL_CXX0X__
) \

431 : (!
defšed
 
__STDC_VERSION__
 || __STDC_VERSION__ < 199901L)))

432 
	#__GLIBC_USE_DEPRECATED_SCANF
 1

	)

434 
	#__GLIBC_USE_DEPRECATED_SCANF
 0

	)

439 
	~<¡dc-´edef.h
>

447 #undeà
__GNU_LIBRARY__


448 
	#__GNU_LIBRARY__
 6

	)

452 
	#__GLIBC__
 2

	)

453 
	#__GLIBC_MINOR__
 31

	)

455 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

456 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

459 #iâdeà
__ASSEMBLER__


460 #iâdeà
_SYS_CDEFS_H


461 
	~<sys/cdefs.h
>

466 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


467 
	#__USE_LARGEFILE
 1

	)

468 
	#__USE_LARGEFILE64
 1

	)

474 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

475 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

476 && 
defšed
 
	g__ex‹º_šlše


477 
	#__USE_EXTERN_INLINES
 1

	)

485 
	~<gnu/¡ubs.h
>

	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


23 
	#_ERRNO_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/”ºo.h
>

32 #iâdeà
__ASSEMBLER__


34 
__BEGIN_DECLS


37 *
	$__”ºo_loÿtiÚ
 (è
__THROW
 
__©Œibu‹_cÚ¡__
;

38 
	#”ºo
 (*
	`__”ºo_loÿtiÚ
 ())

	)

40 #ifdeà
__USE_GNU


45 *
´og¿m_švoÿtiÚ_Çme
;

46 *
´og¿m_švoÿtiÚ_shÜt_Çme
;

48 
	~<b™s/ty³s/”rÜ_t.h
>

52 
__END_DECLS


	@/usr/include/inttypes.h

22 #iâdeà
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<¡dšt.h
>

30 #iâdeà
____gwch¬_t_defšed


31 #ifdeà
__ılu¥lus


32 
	#__gwch¬_t
 
wch¬_t


	)

33 #–ià
defšed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¬_t
;

36 
	#__Ãed_wch¬_t


	)

37 
	~<¡ddef.h
>

38 
wch¬_t
 
	t__gwch¬_t
;

40 
	#____gwch¬_t_defšed
 1

	)

43 #ià
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Î"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #ià
__WORDSIZE
 == 64

273 
	mquÙ
;

274 
	m»m
;

275 } 
	timaxdiv_t
;

282 
__ex‹nsiÚ__
 
	mquÙ
;

283 
__ex‹nsiÚ__
 
	m»m
;

284 } 
	timaxdiv_t
;

290 
štmax_t
 
	$imaxabs
 (
štmax_t
 
__n
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
štmax_t
 
__num”
, iÁmax_ˆ
__d’om
)

294 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

297 
štmax_t
 
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

298 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

301 
uštmax_t
 
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

302 ** 
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

305 
štmax_t
 
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

306 
__gwch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

307 
__THROW
;

310 
uštmax_t
 
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

311 
__gwch¬_t
 ** 
__»¡riù
 
__’d±r
, 
__ba£
)

312 
__THROW
;

314 #ifdeà
__USE_EXTERN_INLINES


316 #ià
__WORDSIZE
 == 64

318 
	$__¡¹Ş_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

319 **
__»¡riù
 
__’d±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

323 
__ex‹º_šlše
 
štmax_t


324 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

325 
ba£
))

327  
	`__¡¹Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

328 
	}
}

330 
	$__¡¹oul_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 ** 
__»¡riù
 
__’d±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

335 
__ex‹º_šlše
 
uštmax_t


336 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

337 
ba£
))

339  
	`__¡¹oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc¡Ş_š‹º®
 (cÚ¡ 
__gwch¬_t
 * 
__»¡riù
 
__ÅŒ
,

343 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

347 
__ex‹º_šlše
 
štmax_t


348 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

349 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

351  
	`__wc¡Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc¡oul_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

355 
__»¡riù
 
__ÅŒ
,

356 
__gwch¬_t
 **

357 
__»¡riù
 
__’d±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

361 
__ex‹º_šlše
 
uštmax_t


362 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

363 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

365  
	`__wc¡oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

366 
	}
}

370 
__ex‹nsiÚ__


371 
	$__¡¹Şl_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

372 **
__»¡riù
 
__’d±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

376 
__ex‹º_šlše
 
štmax_t


377 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

378 
ba£
))

380  
	`__¡¹Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

381 
	}
}

383 
__ex‹nsiÚ__


384 
	$__¡¹ouÎ_š‹º®
 (const *

385 
__»¡riù
 
__ÅŒ
,

387 
__»¡riù
 
__’d±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

392 
__ex‹º_šlše
 
uštmax_t


393 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

394 
ba£
))

396  
	`__¡¹ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

397 
	}
}

399 
__ex‹nsiÚ__


400 
	$__wc¡Şl_š‹º®
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

401 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

405 
__ex‹º_šlše
 
štmax_t


406 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

407 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

409  
	`__wc¡Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

410 
	}
}

413 
__ex‹nsiÚ__


414 
	$__wc¡ouÎ_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

415 
__»¡riù
 
__ÅŒ
,

416 
__gwch¬_t
 **

417 
__»¡riù
 
__’d±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

422 
__ex‹º_šlše
 
uštmax_t


423 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

424 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

426  
	`__wc¡ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/netdb.h

22 #iâdef 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<Ãtš‘/š.h
>

28 
	~<b™s/¡dšt-ušŠ.h
>

29 #ifdeà
__USE_MISC


32 
	~<½c/Ãtdb.h
>

35 #ifdeà
__USE_GNU


36 
	~<b™s/ty³s/sigev’t_t.h
>

37 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

40 
	~<b™s/Ãtdb.h
>

43 
	#_PATH_HEQUIV
 "/‘c/ho¡s.equiv"

	)

44 
	#_PATH_HOSTS
 "/‘c/ho¡s"

	)

45 
	#_PATH_NETWORKS
 "/‘c/ÃtwÜks"

	)

46 
	#_PATH_NSSWITCH_CONF
 "/‘c/nssw™ch.cÚf"

	)

47 
	#_PATH_PROTOCOLS
 "/‘c/´ÙocŞs"

	)

48 
	#_PATH_SERVICES
 "/‘c/£rviûs"

	)

51 
	g__BEGIN_DECLS


53 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


56 
	#h_”ºo
 (*
	`__h_”ºo_loÿtiÚ
 ())

	)

59 *
	$__h_”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

63 
	#HOST_NOT_FOUND
 1

	)

64 
	#TRY_AGAIN
 2

	)

66 
	#NO_RECOVERY
 3

	)

68 
	#NO_DATA
 4

	)

71 #ifdeà
__USE_MISC


72 
	#NETDB_INTERNAL
 -1

	)

73 
	#NETDB_SUCCESS
 0

	)

74 
	#NO_ADDRESS
 
NO_DATA


	)

77 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_XOPEN_EXTENDED


79 
	#IPPORT_RESERVED
 1024

	)

82 #ifdeà
__USE_GNU


84 
	#SCOPE_DELIMITER
 '%'

	)

87 #ifdeà
__USE_MISC


90 
	$h”rÜ
 (cÚ¡ *
__¡r
è
__THROW
;

93 cÚ¡ *
	$h¡»¼Ü
 (
__”r_num
è
__THROW
;

98 
	sho¡’t


100 *
h_Çme
;

101 **
h_®Ÿ£s
;

102 
h_add¹y³
;

103 
h_Ëngth
;

104 **
h_addr_li¡
;

105 #ifdeà
__USE_MISC


106 
	#h_addr
 
h_addr_li¡
[0]

	)

115 
	`£tho¡’t
 (
__¡ay_İ’
);

121 
	`’dho¡’t
 ();

128 
ho¡’t
 *
	`g‘ho¡’t
 ();

135 
ho¡’t
 *
	`g‘ho¡byaddr
 (cÚ¡ *
__addr
, 
__sockËn_t
 
__Ën
,

136 
__ty³
);

142 
ho¡’t
 *
	`g‘ho¡byÇme
 (cÚ¡ *
__Çme
);

144 #ifdeà
__USE_MISC


153 
ho¡’t
 *
	`g‘ho¡byÇme2
 (cÚ¡ *
__Çme
, 
__af
);

165 
	`g‘ho¡’t_r
 (
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

166 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

167 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

168 *
__»¡riù
 
__h_”ºİ
);

170 
	`g‘ho¡byaddr_r
 (cÚ¡ *
__»¡riù
 
__addr
, 
__sockËn_t
 
__Ën
,

171 
__ty³
,

172 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

173 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

174 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

175 *
__»¡riù
 
__h_”ºİ
);

177 
	`g‘ho¡byÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

178 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

179 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

180 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

181 *
__»¡riù
 
__h_”ºİ
);

183 
	`g‘ho¡byÇme2_r
 (cÚ¡ *
__»¡riù
 
__Çme
, 
__af
,

184 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

185 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

186 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

187 *
__»¡riù
 
__h_”ºİ
);

196 
	`£Š‘’t
 (
__¡ay_İ’
);

202 
	`’dÃ‹Á
 ();

209 
Ã‹Á
 *
	`g‘Ã‹Á
 ();

216 
Ã‹Á
 *
	`g‘Ãtbyaddr
 (
ušt32_t
 
__Ãt
, 
__ty³
);

222 
Ã‹Á
 *
	`g‘ÃtbyÇme
 (cÚ¡ *
__Çme
);

224 #ifdef 
__USE_MISC


235 
	`g‘Ã‹Á_r
 (
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

236 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

237 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

238 *
__»¡riù
 
__h_”ºİ
);

240 
	`g‘Ãtbyaddr_r
 (
ušt32_t
 
__Ãt
, 
__ty³
,

241 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

242 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

243 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

244 *
__»¡riù
 
__h_”ºİ
);

246 
	`g‘ÃtbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

247 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

248 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

249 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

250 *
__»¡riù
 
__h_”ºİ
);

255 
	s£rv’t


257 *
s_Çme
;

258 **
s_®Ÿ£s
;

259 
s_pÜt
;

260 *
s_´Ùo
;

268 
	`£t£rv’t
 (
__¡ay_İ’
);

274 
	`’d£rv’t
 ();

281 
£rv’t
 *
	`g‘£rv’t
 ();

288 
£rv’t
 *
	`g‘£rvbyÇme
 (cÚ¡ *
__Çme
, cÚ¡ *
__´Ùo
);

295 
£rv’t
 *
	`g‘£rvbypÜt
 (
__pÜt
, cÚ¡ *
__´Ùo
);

298 #ifdef 
__USE_MISC


306 
	`g‘£rv’t_r
 (
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

307 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

308 
£rv’t
 **
__»¡riù
 
__»suÉ
);

310 
	`g‘£rvbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

311 cÚ¡ *
__»¡riù
 
__´Ùo
,

312 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

313 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

314 
£rv’t
 **
__»¡riù
 
__»suÉ
);

316 
	`g‘£rvbypÜt_r
 (
__pÜt
, cÚ¡ *
__»¡riù
 
__´Ùo
,

317 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

318 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

319 
£rv’t
 **
__»¡riù
 
__»suÉ
);

324 
	s´ÙÛÁ


326 *
p_Çme
;

327 **
p_®Ÿ£s
;

328 
p_´Ùo
;

336 
	`£rÙÛÁ
 (
__¡ay_İ’
);

342 
	`’d´ÙÛÁ
 ();

349 
´ÙÛÁ
 *
	`g‘´ÙÛÁ
 ();

355 
´ÙÛÁ
 *
	`g‘´ÙobyÇme
 (cÚ¡ *
__Çme
);

361 
´ÙÛÁ
 *
	`g‘´Ùobynumb”
 (
__´Ùo
);

364 #ifdef 
__USE_MISC


372 
	`g‘´ÙÛÁ_r
 (
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

373 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

374 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

376 
	`g‘´ÙobyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

377 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

378 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

379 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

381 
	`g‘´Ùobynumb”_r
 (
__´Ùo
,

382 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

383 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

384 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

393 
	`£Š‘g»Á
 (cÚ¡ *
__Ãtgroup
);

401 
	`’dÃtg»Á
 ();

410 
	`g‘Ãtg»Á
 (**
__»¡riù
 
__ho¡p
,

411 **
__»¡riù
 
__u£½
,

412 **
__»¡riù
 
__domašp
);

421 
	`šÃtgr
 (cÚ¡ *
__Ãtgroup
, cÚ¡ *
__ho¡
,

422 cÚ¡ *
__u£r
, cÚ¡ *
__domaš
);

430 
	`g‘Ãtg»Á_r
 (**
__»¡riù
 
__ho¡p
,

431 **
__»¡riù
 
__u£½
,

432 **
__»¡riù
 
__domašp
,

433 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
);

437 #ifdeà
__USE_MISC


449 
	`rcmd
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

450 cÚ¡ *
__»¡riù
 
__locu£r
,

451 cÚ¡ *
__»¡riù
 
__»mu£r
,

452 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

461 
	`rcmd_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

462 cÚ¡ *
__»¡riù
 
__locu£r
,

463 cÚ¡ *
__»¡riù
 
__»mu£r
,

464 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

465 
§_çmy_t
 
__af
);

477 
	`»xec
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

478 cÚ¡ *
__»¡riù
 
__Çme
,

479 cÚ¡ *
__»¡riù
 
__·ss
,

480 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

489 
	`»xec_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

490 cÚ¡ *
__»¡riù
 
__Çme
,

491 cÚ¡ *
__»¡riù
 
__·ss
,

492 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

493 
§_çmy_t
 
__af
);

503 
	`ru£rok
 (cÚ¡ *
__rho¡
, 
__su£r
,

504 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

513 
	`ru£rok_af
 (cÚ¡ *
__rho¡
, 
__su£r
,

514 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

515 
§_çmy_t
 
__af
);

526 
	`œu£rok
 (
ušt32_t
 
__¿ddr
, 
__su£r
,

527 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

537 
	`œu£rok_af
 (cÚ¡ *
__¿ddr
, 
__su£r
,

538 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

539 
§_çmy_t
 
__af
);

549 
	`¼esvpÜt
 (*
__®pÜt
);

558 
	`¼esvpÜt_af
 (*
__®pÜt
, 
§_çmy_t
 
__af
);

563 #ifdeà
__USE_XOPEN2K


565 
	saddršfo


567 
ai_æags
;

568 
ai_çmy
;

569 
ai_sockty³
;

570 
ai_´ÙocŞ
;

571 
sockËn_t
 
ai_add¾’
;

572 
sockaddr
 *
ai_addr
;

573 *
ai_ÿnÚÇme
;

574 
addršfo
 *
ai_Ãxt
;

577 #ifdeà
__USE_GNU


579 
	sgaicb


581 cÚ¡ *
¬_Çme
;

582 cÚ¡ *
¬_£rviû
;

583 cÚ¡ 
addršfo
 *
¬_»que¡
;

584 
addršfo
 *
¬_»suÉ
;

586 
__»tuº
;

587 
__glibc_»£rved
[5];

591 
	#GAI_WAIT
 0

	)

592 
	#GAI_NOWAIT
 1

	)

596 
	#AI_PASSIVE
 0x0001

	)

597 
	#AI_CANONNAME
 0x0002

	)

598 
	#AI_NUMERICHOST
 0x0004

	)

599 
	#AI_V4MAPPED
 0x0008

	)

600 
	#AI_ALL
 0x0010

	)

601 
	#AI_ADDRCONFIG
 0x0020

	)

603 #ifdeà
__USE_GNU


604 
	#AI_IDN
 0x0040

	)

607 
	#AI_CANONIDN
 0x0080

	)

608 
	#AI_IDN_ALLOW_UNASSIGNED
 \

609 
	`__glibc_maüo_w¬nšg
 ("AI_IDN_ALLOW_UNASSIGNED i d•»ÿ‹d"è0x0100

	)

610 
	#AI_IDN_USE_STD3_ASCII_RULES
 \

611 
	`__glibc_maüo_w¬nšg
 ("AI_IDN_USE_STD3_ASCII_RULES i d•»ÿ‹d"è0x0200

	)

613 
	#AI_NUMERICSERV
 0x0400

	)

616 
	#EAI_BADFLAGS
 -1

	)

617 
	#EAI_NONAME
 -2

	)

618 
	#EAI_AGAIN
 -3

	)

619 
	#EAI_FAIL
 -4

	)

620 
	#EAI_FAMILY
 -6

	)

621 
	#EAI_SOCKTYPE
 -7

	)

622 
	#EAI_SERVICE
 -8

	)

623 
	#EAI_MEMORY
 -10

	)

624 
	#EAI_SYSTEM
 -11

	)

625 
	#EAI_OVERFLOW
 -12

	)

626 #ifdeà
__USE_GNU


627 
	#EAI_NODATA
 -5

	)

628 
	#EAI_ADDRFAMILY
 -9

	)

629 
	#EAI_INPROGRESS
 -100

	)

630 
	#EAI_CANCELED
 -101

	)

631 
	#EAI_NOTCANCELED
 -102

	)

632 
	#EAI_ALLDONE
 -103

	)

633 
	#EAI_INTR
 -104

	)

634 
	#EAI_IDN_ENCODE
 -105

	)

637 #ifdeà
__USE_MISC


638 
	#NI_MAXHOST
 1025

	)

639 
	#NI_MAXSERV
 32

	)

642 
	#NI_NUMERICHOST
 1

	)

643 
	#NI_NUMERICSERV
 2

	)

644 
	#NI_NOFQDN
 4

	)

645 
	#NI_NAMEREQD
 8

	)

646 
	#NI_DGRAM
 16

	)

647 #ifdeà
__USE_GNU


648 
	#NI_IDN
 32

	)

649 
	#NI_IDN_ALLOW_UNASSIGNED
 \

650 
	`__glibc_maüo_w¬nšg
 ("NI_IDN_ALLOW_UNASSIGNED i d•»ÿ‹d"è64

	)

651 
	#NI_IDN_USE_STD3_ASCII_RULES
 \

652 
	`__glibc_maüo_w¬nšg
 ("NI_IDN_USE_STD3_ASCII_RULES i d•»ÿ‹d"è128

	)

660 
	`g‘addršfo
 (cÚ¡ *
__»¡riù
 
__Çme
,

661 cÚ¡ *
__»¡riù
 
__£rviû
,

662 cÚ¡ 
addršfo
 *
__»¡riù
 
__»q
,

663 
addršfo
 **
__»¡riù
 
__·i
);

666 
	$ä“addršfo
 (
addršfo
 *
__ai
è
__THROW
;

669 cÚ¡ *
	$gai_¡»¼Ü
 (
__ecode
è
__THROW
;

675 
	`g‘Çmešfo
 (cÚ¡ 
sockaddr
 *
__»¡riù
 
__§
,

676 
sockËn_t
 
__§Ën
, *
__»¡riù
 
__ho¡
,

677 
sockËn_t
 
__ho¡Ën
, *
__»¡riù
 
__£rv
,

678 
sockËn_t
 
__£rvËn
, 
__æags
);

681 #ifdeà
__USE_GNU


690 
	`g‘addršfo_a
 (
__mode
, 
gaicb
 *
__li¡
[
__»¡riù_¬r
],

691 
__’t
, 
sigev’t
 *
__»¡riù
 
__sig
);

701 
	`gai_su¥’d
 (cÚ¡ 
gaicb
 *cÚ¡ 
__li¡
[], 
__’t
,

702 cÚ¡ 
time¥ec
 *
__timeout
);

705 
	$gai_”rÜ
 (
gaicb
 *
__»q
è
__THROW
;

708 
	$gai_ÿnûl
 (
gaicb
 *
__gaicbp
è
__THROW
;

711 
__END_DECLS


	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

	@/usr/include/netinet/in.h

18 #iâdef 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<b™s/¡dšt-ušŠ.h
>

23 
	~<sys/sock‘.h
>

24 
	~<b™s/ty³s.h
>

27 
__BEGIN_DECLS


30 
ušt32_t
 
	tš_addr_t
;

31 
	sš_addr


33 
š_addr_t
 
	ms_addr
;

37 
	~<b™s/š.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_MPLS
 = 137,

89 
	#IPPROTO_MPLS
 
IPPROTO_MPLS


	)

90 
	mIPPROTO_RAW
 = 255,

91 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

92 
	mIPPROTO_MAX


98 #ià!
__USE_KERNEL_IPV6_DEFS


101 
	mIPPROTO_HOPOPTS
 = 0,

102 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

103 
	mIPPROTO_ROUTING
 = 43,

104 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

105 
	mIPPROTO_FRAGMENT
 = 44,

106 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

107 
	mIPPROTO_ICMPV6
 = 58,

108 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

109 
	mIPPROTO_NONE
 = 59,

110 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

111 
	mIPPROTO_DSTOPTS
 = 60,

112 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

113 
	mIPPROTO_MH
 = 135

114 
	#IPPROTO_MH
 
IPPROTO_MH


	)

119 
ušt16_t
 
	tš_pÜt_t
;

124 
	mIPPORT_ECHO
 = 7,

125 
	mIPPORT_DISCARD
 = 9,

126 
	mIPPORT_SYSTAT
 = 11,

127 
	mIPPORT_DAYTIME
 = 13,

128 
	mIPPORT_NETSTAT
 = 15,

129 
	mIPPORT_FTP
 = 21,

130 
	mIPPORT_TELNET
 = 23,

131 
	mIPPORT_SMTP
 = 25,

132 
	mIPPORT_TIMESERVER
 = 37,

133 
	mIPPORT_NAMESERVER
 = 42,

134 
	mIPPORT_WHOIS
 = 43,

135 
	mIPPORT_MTP
 = 57,

137 
	mIPPORT_TFTP
 = 69,

138 
	mIPPORT_RJE
 = 77,

139 
	mIPPORT_FINGER
 = 79,

140 
	mIPPORT_TTYLINK
 = 87,

141 
	mIPPORT_SUPDUP
 = 95,

144 
	mIPPORT_EXECSERVER
 = 512,

145 
	mIPPORT_LOGINSERVER
 = 513,

146 
	mIPPORT_CMDSERVER
 = 514,

147 
	mIPPORT_EFSSERVER
 = 520,

150 
	mIPPORT_BIFFUDP
 = 512,

151 
	mIPPORT_WHOSERVER
 = 513,

152 
	mIPPORT_ROUTESERVER
 = 520,

155 
	mIPPORT_RESERVED
 = 1024,

158 
	mIPPORT_USERRESERVED
 = 5000

166 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

167 
	#IN_CLASSA_NET
 0xff000000

	)

168 
	#IN_CLASSA_NSHIFT
 24

	)

169 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

170 
	#IN_CLASSA_MAX
 128

	)

172 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

173 
	#IN_CLASSB_NET
 0xffff0000

	)

174 
	#IN_CLASSB_NSHIFT
 16

	)

175 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

176 
	#IN_CLASSB_MAX
 65536

	)

178 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

179 
	#IN_CLASSC_NET
 0xffffff00

	)

180 
	#IN_CLASSC_NSHIFT
 8

	)

181 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

183 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

184 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

186 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

187 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

190 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

192 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

194 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

197 
	#IN_LOOPBACKNET
 127

	)

199 #iâdeà
INADDR_LOOPBACK


200 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

204 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

205 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

206 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

207 
	#INADDR_ALLSNOOPERS_GROUP
 ((
š_addr_t
è0xe000006aè

	)

208 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

210 #ià!
__USE_KERNEL_IPV6_DEFS


212 
	sš6_addr


216 
ušt8_t
 
	m__u6_addr8
[16];

217 
ušt16_t
 
	m__u6_addr16
[8];

218 
ušt32_t
 
	m__u6_addr32
[4];

219 } 
	m__š6_u
;

220 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

221 #ifdeà
__USE_MISC


222 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

223 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

228 cÚ¡ 
š6_addr
 
š6addr_ªy
;

229 cÚ¡ 
š6_addr
 
š6addr_loİback
;

230 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

231 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

233 
	#INET_ADDRSTRLEN
 16

	)

234 
	#INET6_ADDRSTRLEN
 46

	)

238 
	ssockaddr_š


240 
__SOCKADDR_COMMON
 (
sš_
);

241 
š_pÜt_t
 
	msš_pÜt
;

242 
š_addr
 
	msš_addr
;

245 
	msš_z”o
[ (
sockaddr
)

246 - 
__SOCKADDR_COMMON_SIZE


247 -  (
š_pÜt_t
)

248 -  (
š_addr
)];

251 #ià!
__USE_KERNEL_IPV6_DEFS


253 
	ssockaddr_š6


255 
__SOCKADDR_COMMON
 (
sš6_
);

256 
š_pÜt_t
 
	msš6_pÜt
;

257 
ušt32_t
 
	msš6_æowšfo
;

258 
š6_addr
 
	msš6_addr
;

259 
ušt32_t
 
	msš6_scİe_id
;

263 #ifdeà
__USE_MISC


265 
	s_m»q


268 
š_addr
 
	mimr_muÉŸddr
;

271 
š_addr
 
	mimr_š‹rçû
;

274 
	s_m»q_sourû


277 
š_addr
 
	mimr_muÉŸddr
;

280 
š_addr
 
	mimr_š‹rçû
;

283 
š_addr
 
	mimr_sourûaddr
;

287 #ià!
__USE_KERNEL_IPV6_DEFS


289 
	sv6_m»q


292 
š6_addr
 
	mv6mr_muÉŸddr
;

295 
	mv6mr_š‹rçû
;

299 #ifdeà
__USE_MISC


301 
	sgroup_»q


304 
ušt32_t
 
	mgr_š‹rçû
;

307 
sockaddr_¡Üage
 
	mgr_group
;

310 
	sgroup_sourû_»q


313 
ušt32_t
 
	mg¤_š‹rçû
;

316 
sockaddr_¡Üage
 
	mg¤_group
;

319 
sockaddr_¡Üage
 
	mg¤_sourû
;

324 
	s_msf‹r


327 
š_addr
 
	mimsf_muÉŸddr
;

330 
š_addr
 
	mimsf_š‹rçû
;

333 
ušt32_t
 
	mimsf_fmode
;

336 
ušt32_t
 
	mimsf_num¤c
;

338 
š_addr
 
	mimsf_¦i¡
[1];

341 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

342 -  (
š_addr
) \

343 + (
num¤c
è*  (
š_addr
))

	)

345 
	sgroup_f‹r


348 
ušt32_t
 
	mgf_š‹rçû
;

351 
sockaddr_¡Üage
 
	mgf_group
;

354 
ušt32_t
 
	mgf_fmode
;

357 
ušt32_t
 
	mgf_num¤c
;

359 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

362 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

363 -  (
sockaddr_¡Üage
) \

364 + ((
num¤c
) \

365 *  (
sockaddr_¡Üage
)))

	)

375 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

376 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

377 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

378 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

379 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

380 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

381 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

383 
	~<’dŸn.h
>

386 
	~<b™s/by‹sw­.h
>

387 
	~<b™s/ušŠ-id’t™y.h
>

389 #ifdeà
__OPTIMIZE__


393 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


396 
	#Áohl
(
x
è
	`__ušt32_id’t™y
 (x)

	)

397 
	#Áohs
(
x
è
	`__ušt16_id’t™y
 (x)

	)

398 
	#htÚl
(
x
è
	`__ušt32_id’t™y
 (x)

	)

399 
	#htÚs
(
x
è
	`__ušt16_id’t™y
 (x)

	)

401 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


402 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

403 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

404 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

405 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

410 #ifdeà
__GNUC__


411 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

412 (
__ex‹nsiÚ__
 \

413 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

414 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

415 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

416 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

417 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ0; 
	}
}))

	)

419 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

420 (
__ex‹nsiÚ__
 \

421 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

422 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

423 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

424 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

425 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ
	`htÚl
 (1); }))

	)

427 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

428 (
__ex‹nsiÚ__
 \

429 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

430 (
__a
->
__š6_u
.
__u6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xã800000); }))

	)

432 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

433 (
__ex‹nsiÚ__
 \

434 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

435 (
__a
->
__š6_u
.
__u6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xãc00000); }))

	)

437 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

438 (
__ex‹nsiÚ__
 \

439 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

440 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

441 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

442 && 
__a
->
__š6_u
.
__u6_addr32
[2] =ğ
	`htÚl
 (0xffff); }))

	)

444 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

445 (
__ex‹nsiÚ__
 \

446 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

447 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

448 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

449 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

450 && 
	`Áohl
 (
__a
->
__š6_u
.
__u6_addr32
[3]è> 1; }))

	)

452 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

453 (
__ex‹nsiÚ__
 \

454 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

455 cÚ¡ 
š6_addr
 *
__b
 = (cÚ¡ š6_add¸*è(
b
); \

456 
__a
->
__š6_u
.
__u6_addr32
[0] =ğ
__b
->__in6_u.__u6_addr32[0] \

457 && 
__a
->
__š6_u
.
__u6_addr32
[1] =ğ
__b
->__in6_u.__u6_addr32[1] \

458 && 
__a
->
__š6_u
.
__u6_addr32
[2] =ğ
__b
->__in6_u.__u6_addr32[2] \

459 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ
__b
->__š6_u.__u6_addr32[3]; }))

	)

461 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

462 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

463 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

464 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

465 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

467 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

468 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

469 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

470 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

471 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

473 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

474 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

475 =ğ
	`htÚl
 (0xã800000))

	)

477 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

478 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

479 =ğ
	`htÚl
 (0xãc00000))

	)

481 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

482 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

483 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

484 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

486 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

487 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

488 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

489 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0) \

490 && (
	`Áohl
 (((cÚ¡ 
ušt32_t
 *è(
a
))[3]è> 1))

	)

492 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

493 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[0]) \

494 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[1]) \

495 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[2]) \

496 && (((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

499 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((cÚ¡ 
ušt8_t
 *è×))[0] =ğ0xff)

	)

501 #ifdeà
__USE_MISC


503 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

506 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

507 
__THROW
;

511 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

512 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

513 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

515 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

516 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

517 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

519 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

520 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

521 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

523 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

524 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

525 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

527 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

528 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

529 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

532 #ifdeà
__USE_GNU


533 
cmsghdr
;

535 #ià!
__USE_KERNEL_IPV6_DEFS


537 
	sš6_pktšfo


539 
š6_addr
 
i6_addr
;

540 
i6_ifšdex
;

544 
	s6_mtušfo


546 
sockaddr_š6
 
6m_addr
;

547 
ušt32_t
 
6m_mtu
;

552 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

553 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

554 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

555 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

556 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

557 cÚ¡ 
ušt8_t
 *
__ty³p
, 
__muÉx
,

558 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

559 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

560 
__muÉx
, 
__¶usy
)

561 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

562 
	$š‘6_İtiÚ_Ãxt
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

563 
ušt8_t
 **
__Œp
)

564 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

565 
	$š‘6_İtiÚ_fšd
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

566 
ušt8_t
 **
__Œp
, 
__ty³
)

567 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

571 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

572 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

573 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

574 **
__d©abuå
è
__THROW
;

575 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

576 
__THROW
;

577 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

578 
sockËn_t
 
__v®Ën
è
__THROW
;

579 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

580 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

581 **
__d©abuå
è
__THROW
;

582 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

583 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

584 **
__d©abuå
è
__THROW
;

585 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

586 
sockËn_t
 
__v®Ën
è
__THROW
;

590 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

591 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

592 
__£gm’ts
è
__THROW
;

593 
	$š‘6_¹h_add
 (*
__bp
, cÚ¡ 
š6_addr
 *
__addr
è
__THROW
;

594 
	$š‘6_¹h_»v”£
 (cÚ¡ *
__š
, *
__out
è
__THROW
;

595 
	$š‘6_¹h_£gm’ts
 (cÚ¡ *
__bp
è
__THROW
;

596 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (cÚ¡ *
__bp
, 
__šdex
)

597 
__THROW
;

603 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

604 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

605 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

606 
__THROW
;

609 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

610 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

611 
ušt32_t
 
__num¤c
,

612 cÚ¡ 
š_addr
 *
__¦i¡
)

613 
__THROW
;

617 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

618 cÚ¡ 
sockaddr
 *
__group
,

619 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

620 
ušt32_t
 *
__num¤c
,

621 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

624 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

625 cÚ¡ 
sockaddr
 *
__group
,

626 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

627 
ušt32_t
 
__num¤c
,

628 cÚ¡ 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

631 
__END_DECLS


	@/usr/include/rpc/netdb.h

36 #iâdeà
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<ã©u»s.h
>

41 
	#__Ãed_size_t


	)

42 
	~<¡ddef.h
>

44 
__BEGIN_DECLS


46 
	s½ûÁ


48 *
	mr_Çme
;

49 **
	mr_®Ÿ£s
;

50 
	mr_numb”
;

53 
	$£ŒpûÁ
 (
__¡ayİ’
è
__THROW
;

54 
	$’d½ûÁ
 (è
__THROW
;

55 
½ûÁ
 *
	$g‘½cbyÇme
 (cÚ¡ *
__Çme
è
__THROW
;

56 
½ûÁ
 *
	$g‘½cbynumb”
 (
__numb”
è
__THROW
;

57 
½ûÁ
 *
	$g‘½ûÁ
 (è
__THROW
;

59 #ifdeà
__USE_MISC


60 
	$g‘½cbyÇme_r
 (cÚ¡ *
__Çme
, 
½ûÁ
 *
__»suÉ_buf
,

61 *
__bufãr
, 
size_t
 
__buæ’
,

62 
½ûÁ
 **
__»suÉ
è
__THROW
;

64 
	$g‘½cbynumb”_r
 (
__numb”
, 
½ûÁ
 *
__»suÉ_buf
,

65 *
__bufãr
, 
size_t
 
__buæ’
,

66 
½ûÁ
 **
__»suÉ
è
__THROW
;

68 
	$g‘½ûÁ_r
 (
½ûÁ
 *
__»suÉ_buf
, *
__bufãr
,

69 
size_t
 
__buæ’
, 
½ûÁ
 **
__»suÉ
è
__THROW
;

72 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

24 
	~<b™s/’dŸn.h
>

26 #ifdeà
__USE_MISC


27 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

28 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

29 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

30 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

33 #ià
defšed
 
__USE_MISC
 && !defšed 
__ASSEMBLER__


35 
	~<b™s/by‹sw­.h
>

36 
	~<b™s/ušŠ-id’t™y.h
>

38 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


39 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

40 
	#htŞe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

41 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

42 
	#Ë16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

44 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

45 
	#htŞe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

46 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

47 
	#Ë32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

49 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

50 
	#htŞe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

51 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

52 
	#Ë64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

55 
	#htobe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

56 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

57 
	#be16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

58 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

60 
	#htobe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

61 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

62 
	#be32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

63 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

65 
	#htobe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

66 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

67 
	#be64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

68 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@
1
.
1
/usr/include
135
2429
FuzzedDataProvider.h
addition_overflow.cpp
addrman.cpp
asmap.cpp
asmap_direct.cpp
autofile.cpp
banman.cpp
base_encode_decode.cpp
bech32.cpp
bitdeque.cpp
block.cpp
block_header.cpp
blockfilter.cpp
bloom_filter.cpp
buffered_file.cpp
chain.cpp
checkqueue.cpp
coins_view.cpp
connman.cpp
crypto.cpp
crypto_aes256.cpp
crypto_aes256cbc.cpp
crypto_chacha20.cpp
crypto_chacha20_poly1305_aead.cpp
crypto_common.cpp
crypto_diff_fuzz_chacha20.cpp
crypto_hkdf_hmac_sha256_l32.cpp
crypto_poly1305.cpp
cuckoocache.cpp
decode_tx.cpp
descriptor_parse.cpp
deserialize.cpp
eval_script.cpp
fee_rate.cpp
fees.cpp
flatfile.cpp
float.cpp
fuzz.cpp
fuzz.h
golomb_rice.cpp
hex.cpp
http_request.cpp
i2p.cpp
integer.cpp
key.cpp
key_io.cpp
kitchen_sink.cpp
load_external_block_file.cpp
locale.cpp
merkleblock.cpp
message.cpp
miniscript.cpp
minisketch.cpp
muhash.cpp
multiplication_overflow.cpp
net.cpp
net_permissions.cpp
netaddress.cpp
netbase_dns_lookup.cpp
node_eviction.cpp
p2p_transport_serialization.cpp
parse_hd_keypath.cpp
parse_numbers.cpp
parse_script.cpp
parse_univalue.cpp
policy_estimator.cpp
policy_estimator_io.cpp
pow.cpp
prevector.cpp
primitives_transaction.cpp
process_message.cpp
process_messages.cpp
protocol.cpp
psbt.cpp
random.cpp
rbf.cpp
rolling_bloom_filter.cpp
rpc.cpp
script.cpp
script_assets_test_minimizer.cpp
script_bitcoin_consensus.cpp
script_descriptor_cache.cpp
script_flags.cpp
script_format.cpp
script_interpreter.cpp
script_ops.cpp
script_sigcache.cpp
script_sign.cpp
scriptnum_ops.cpp
secp256k1_ec_seckey_import_export_der.cpp
secp256k1_ecdsa_signature_parse_der_lax.cpp
signature_checker.cpp
signet.cpp
socks5.cpp
span.cpp
spanparsing.cpp
string.cpp
strprintf.cpp
system.cpp
timedata.cpp
torcontrol.cpp
transaction.cpp
tx_in.cpp
tx_out.cpp
tx_pool.cpp
txorphan.cpp
txrequest.cpp
util.cpp
util.h
util/mempool.cpp
util/mempool.h
utxo_snapshot.cpp
validation_load_mempool.cpp
versionbits.cpp
/usr/include/assert.h
/usr/include/ctype.h
/usr/include/event2/buffer.h
/usr/include/event2/event.h
/usr/include/event2/http.h
/usr/include/event2/http_struct.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/event2/event-config.h
/usr/include/event2/util.h
/usr/include/event2/visibility.h
/usr/include/features.h
/usr/include/errno.h
/usr/include/inttypes.h
/usr/include/netdb.h
/usr/include/stdc-predef.h
/usr/include/netinet/in.h
/usr/include/rpc/netdb.h
/usr/include/endian.h
